<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Tal Galili" />

<meta name="date" content="2018-02-10" />

<title>Introduction to dendextend</title>

<script src="data:application/x-javascript;base64,KGZ1bmN0aW9uKCkgewogIC8vIElmIHdpbmRvdy5IVE1MV2lkZ2V0cyBpcyBhbHJlYWR5IGRlZmluZWQsIHRoZW4gdXNlIGl0OyBvdGhlcndpc2UgY3JlYXRlIGEKICAvLyBuZXcgb2JqZWN0LiBUaGlzIGFsbG93cyBwcmVjZWRpbmcgY29kZSB0byBzZXQgb3B0aW9ucyB0aGF0IGFmZmVjdCB0aGUKICAvLyBpbml0aWFsaXphdGlvbiBwcm9jZXNzICh0aG91Z2ggbm9uZSBjdXJyZW50bHkgZXhpc3QpLgogIHdpbmRvdy5IVE1MV2lkZ2V0cyA9IHdpbmRvdy5IVE1MV2lkZ2V0cyB8fCB7fTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSB2aWV3ZXIgcGFuZS4gSWYgbm90LCB3ZSdyZSBpbiBhIHdlYiBicm93c2VyLgogIHZhciB2aWV3ZXJNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnZpZXdlck1vZGUgPQogICAgICAvXGJ2aWV3ZXJfcGFuZT0xXGIvLnRlc3Qod2luZG93LmxvY2F0aW9uKTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gU2hpbnkgbW9kZS4gSWYgbm90LCBpdCdzIGEgc3RhdGljIGRvY3VtZW50LgogIC8vIE5vdGUgdGhhdCBzdGF0aWMgd2lkZ2V0cyBjYW4gYXBwZWFyIGluIGJvdGggU2hpbnkgYW5kIHN0YXRpYyBtb2RlcywgYnV0CiAgLy8gb2J2aW91c2x5LCBTaGlueSB3aWRnZXRzIGNhbiBvbmx5IGFwcGVhciBpbiBTaGlueSBhcHBzL2RvY3VtZW50cy4KICB2YXIgc2hpbnlNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnNoaW55TW9kZSA9CiAgICAgIHR5cGVvZih3aW5kb3cuU2hpbnkpICE9PSAidW5kZWZpbmVkIiAmJiAhIXdpbmRvdy5TaGlueS5vdXRwdXRCaW5kaW5nczsKCiAgLy8gV2UgY2FuJ3QgY291bnQgb24galF1ZXJ5IGJlaW5nIGF2YWlsYWJsZSwgc28gd2UgaW1wbGVtZW50IG91ciBvd24KICAvLyB2ZXJzaW9uIGlmIG5lY2Vzc2FyeS4KICBmdW5jdGlvbiBxdWVyeVNlbGVjdG9yQWxsKHNjb3BlLCBzZWxlY3RvcikgewogICAgaWYgKHR5cGVvZihqUXVlcnkpICE9PSAidW5kZWZpbmVkIiAmJiBzY29wZSBpbnN0YW5jZW9mIGpRdWVyeSkgewogICAgICByZXR1cm4gc2NvcGUuZmluZChzZWxlY3Rvcik7CiAgICB9CiAgICBpZiAoc2NvcGUucXVlcnlTZWxlY3RvckFsbCkgewogICAgICByZXR1cm4gc2NvcGUucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhc0FycmF5KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICgkLmlzQXJyYXkodmFsdWUpKQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gW3ZhbHVlXTsKICB9CgogIC8vIEltcGxlbWVudCBqUXVlcnkncyBleHRlbmQKICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0IC8qLCAuLi4gKi8pIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIC8vIElFOCBkb2Vzbid0IHN1cHBvcnQgQXJyYXkuZm9yRWFjaC4KICBmdW5jdGlvbiBmb3JFYWNoKHZhbHVlcywgY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgIGlmICh2YWx1ZXMuZm9yRWFjaCkgewogICAgICB2YWx1ZXMuZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZyk7CiAgICB9IGVsc2UgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdmFsdWVzW2ldLCBpLCB2YWx1ZXMpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZXBsYWNlcyB0aGUgc3BlY2lmaWVkIG1ldGhvZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgZnVuY1NvdXJjZS4KICAvLwogIC8vIE5vdGUgdGhhdCBmdW5jU291cmNlIHNob3VsZCBub3QgQkUgdGhlIG5ldyBtZXRob2QsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uCiAgLy8gdGhhdCBSRVRVUk5TIHRoZSBuZXcgbWV0aG9kLiBmdW5jU291cmNlIHJlY2VpdmVzIGEgc2luZ2xlIGFyZ3VtZW50IHRoYXQgaXMKICAvLyB0aGUgb3ZlcnJpZGRlbiBtZXRob2QsIGl0IGNhbiBiZSBjYWxsZWQgZnJvbSB0aGUgbmV3IG1ldGhvZC4gVGhlIG92ZXJyaWRkZW4KICAvLyBtZXRob2QgY2FuIGJlIGNhbGxlZCBsaWtlIGEgcmVndWxhciBmdW5jdGlvbiwgaXQgaGFzIHRoZSB0YXJnZXQgcGVybWFuZW50bHkKICAvLyBib3VuZCB0byBpdCBzbyAidGhpcyIgd2lsbCB3b3JrIGNvcnJlY3RseS4KICBmdW5jdGlvbiBvdmVycmlkZU1ldGhvZCh0YXJnZXQsIG1ldGhvZE5hbWUsIGZ1bmNTb3VyY2UpIHsKICAgIHZhciBzdXBlckZ1bmMgPSB0YXJnZXRbbWV0aG9kTmFtZV0gfHwgZnVuY3Rpb24oKSB7fTsKICAgIHZhciBzdXBlckZ1bmNCb3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gc3VwZXJGdW5jLmFwcGx5KHRhcmdldCwgYXJndW1lbnRzKTsKICAgIH07CiAgICB0YXJnZXRbbWV0aG9kTmFtZV0gPSBmdW5jU291cmNlKHN1cGVyRnVuY0JvdW5kKTsKICB9CgogIC8vIEFkZCBhIG1ldGhvZCB0byBkZWxlZ2F0b3IgdGhhdCwgd2hlbiBpbnZva2VkLCBjYWxscwogIC8vIGRlbGVnYXRlZS5tZXRob2ROYW1lLiBJZiB0aGVyZSBpcyBubyBzdWNoIG1ldGhvZCBvbgogIC8vIHRoZSBkZWxlZ2F0ZWUsIGJ1dCB0aGVyZSB3YXMgb25lIG9uIGRlbGVnYXRvciBiZWZvcmUKICAvLyBkZWxlZ2F0ZU1ldGhvZCB3YXMgY2FsbGVkLCB0aGVuIHRoZSBvcmlnaW5hbCB2ZXJzaW9uCiAgLy8gaXMgaW52b2tlZCBpbnN0ZWFkLgogIC8vIEZvciBleGFtcGxlOgogIC8vCiAgLy8gdmFyIGEgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2ExJyk7IH0KICAvLyAgIG1ldGhvZDI6IGZ1bmN0aW9uKCkgeyBjb25zb2xlLmxvZygnYTInKTsgfQogIC8vIH07CiAgLy8gdmFyIGIgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2IxJyk7IH0KICAvLyB9OwogIC8vIGRlbGVnYXRlTWV0aG9kKGEsIGIsICJtZXRob2QxIik7CiAgLy8gZGVsZWdhdGVNZXRob2QoYSwgYiwgIm1ldGhvZDIiKTsKICAvLyBhLm1ldGhvZDEoKTsKICAvLyBhLm1ldGhvZDIoKTsKICAvLwogIC8vIFRoZSBvdXRwdXQgd291bGQgYmUgImIxIiwgImEyIi4KICBmdW5jdGlvbiBkZWxlZ2F0ZU1ldGhvZChkZWxlZ2F0b3IsIGRlbGVnYXRlZSwgbWV0aG9kTmFtZSkgewogICAgdmFyIGluaGVyaXRlZCA9IGRlbGVnYXRvclttZXRob2ROYW1lXTsKICAgIGRlbGVnYXRvclttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgdGFyZ2V0ID0gZGVsZWdhdGVlOwogICAgICB2YXIgbWV0aG9kID0gZGVsZWdhdGVlW21ldGhvZE5hbWVdOwoKICAgICAgLy8gVGhlIG1ldGhvZCBkb2Vzbid0IGV4aXN0IG9uIHRoZSBkZWxlZ2F0ZWUuIEluc3RlYWQsCiAgICAgIC8vIGNhbGwgdGhlIG1ldGhvZCBvbiB0aGUgZGVsZWdhdG9yLCBpZiBpdCBleGlzdHMuCiAgICAgIGlmICghbWV0aG9kKSB7CiAgICAgICAgdGFyZ2V0ID0gZGVsZWdhdG9yOwogICAgICAgIG1ldGhvZCA9IGluaGVyaXRlZDsKICAgICAgfQoKICAgICAgaWYgKG1ldGhvZCkgewogICAgICAgIHJldHVybiBtZXRob2QuYXBwbHkodGFyZ2V0LCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9OwogIH0KCiAgLy8gSW1wbGVtZW50IGEgdmFndWUgZmFjc2ltaWxpZSBvZiBqUXVlcnkncyBkYXRhIG1ldGhvZAogIGZ1bmN0aW9uIGVsZW1lbnREYXRhKGVsLCBuYW1lLCB2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikgewogICAgICByZXR1cm4gZWxbImh0bWx3aWRnZXRfZGF0YV8iICsgbmFtZV07CiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMykgewogICAgICBlbFsiaHRtbHdpZGdldF9kYXRhXyIgKyBuYW1lXSA9IHZhbHVlOwogICAgICByZXR1cm4gZWw7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldyb25nIG51bWJlciBvZiBhcmd1bWVudHMgZm9yIGVsZW1lbnREYXRhOiAiICsKICAgICAgICBhcmd1bWVudHMubGVuZ3RoKTsKICAgIH0KICB9CgogIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQ0NjE3MC9lc2NhcGUtc3RyaW5nLWZvci11c2UtaW4tamF2YXNjcmlwdC1yZWdleAogIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHIpIHsKICAgIHJldHVybiBzdHIucmVwbGFjZSgvW1wtXFtcXVwvXHtcfVwoXClcKlwrXD9cLlxcXF5cJFx8XS9nLCAiXFwkJiIpOwogIH0KCiAgZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkgewogICAgdmFyIHJlID0gbmV3IFJlZ0V4cCgiXFxiIiArIGVzY2FwZVJlZ0V4cChjbGFzc05hbWUpICsgIlxcYiIpOwogICAgcmV0dXJuIHJlLnRlc3QoZWwuY2xhc3NOYW1lKTsKICB9CgogIC8vIGVsZW1lbnRzIC0gYXJyYXkgKG9yIGFycmF5LWxpa2Ugb2JqZWN0KSBvZiBIVE1MIGVsZW1lbnRzCiAgLy8gY2xhc3NOYW1lIC0gY2xhc3MgbmFtZSB0byB0ZXN0IGZvcgogIC8vIGluY2x1ZGUgLSBpZiB0cnVlLCBvbmx5IHJldHVybiBlbGVtZW50cyB3aXRoIGdpdmVuIGNsYXNzTmFtZTsKICAvLyAgIGlmIGZhbHNlLCBvbmx5IHJldHVybiBlbGVtZW50cyAqd2l0aG91dCogZ2l2ZW4gY2xhc3NOYW1lCiAgZnVuY3Rpb24gZmlsdGVyQnlDbGFzcyhlbGVtZW50cywgY2xhc3NOYW1lLCBpbmNsdWRlKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoaGFzQ2xhc3MoZWxlbWVudHNbaV0sIGNsYXNzTmFtZSkgPT0gaW5jbHVkZSkKICAgICAgICByZXN1bHRzLnB1c2goZWxlbWVudHNbaV0pOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQoKICBmdW5jdGlvbiBvbihvYmosIGV2ZW50TmFtZSwgZnVuYykgewogICAgaWYgKG9iai5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZnVuYywgZmFsc2UpOwogICAgfSBlbHNlIGlmIChvYmouYXR0YWNoRXZlbnQpIHsKICAgICAgb2JqLmF0dGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBvZmYob2JqLCBldmVudE5hbWUsIGZ1bmMpIHsKICAgIGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikKICAgICAgb2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBmdW5jLCBmYWxzZSk7CiAgICBlbHNlIGlmIChvYmouZGV0YWNoRXZlbnQpIHsKICAgICAgb2JqLmRldGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICAvLyBUcmFuc2xhdGUgYXJyYXkgb2YgdmFsdWVzIHRvIHRvcC9yaWdodC9ib3R0b20vbGVmdCwgYXMgdXN1YWwgd2l0aAogIC8vIHRoZSAicGFkZGluZyIgQ1NTIHByb3BlcnR5CiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL3BhZGRpbmcKICBmdW5jdGlvbiB1bnBhY2tQYWRkaW5nKHZhbHVlKSB7CiAgICBpZiAodHlwZW9mKHZhbHVlKSA9PT0gIm51bWJlciIpCiAgICAgIHZhbHVlID0gW3ZhbHVlXTsKICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMF0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzBdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDIpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDMpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDQpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzNdfTsKICAgIH0KICB9CgogIC8vIENvbnZlcnQgYW4gdW5wYWNrZWQgcGFkZGluZyBvYmplY3QgdG8gYSBDU1MgdmFsdWUKICBmdW5jdGlvbiBwYWRkaW5nVG9Dc3MocGFkZGluZ09iaikgewogICAgcmV0dXJuIHBhZGRpbmdPYmoudG9wICsgInB4ICIgKyBwYWRkaW5nT2JqLnJpZ2h0ICsgInB4ICIgKyBwYWRkaW5nT2JqLmJvdHRvbSArICJweCAiICsgcGFkZGluZ09iai5sZWZ0ICsgInB4IjsKICB9CgogIC8vIE1ha2VzIGEgbnVtYmVyIHN1aXRhYmxlIGZvciBDU1MKICBmdW5jdGlvbiBweCh4KSB7CiAgICBpZiAodHlwZW9mKHgpID09PSAibnVtYmVyIikKICAgICAgcmV0dXJuIHggKyAicHgiOwogICAgZWxzZQogICAgICByZXR1cm4geDsKICB9CgogIC8vIFJldHJpZXZlcyBydW50aW1lIHdpZGdldCBzaXppbmcgaW5mb3JtYXRpb24gZm9yIGFuIGVsZW1lbnQuCiAgLy8gVGhlIHJldHVybiB2YWx1ZSBpcyBlaXRoZXIgbnVsbCwgb3IgYW4gb2JqZWN0IHdpdGggZmlsbCwgcGFkZGluZywKICAvLyBkZWZhdWx0V2lkdGgsIGRlZmF1bHRIZWlnaHQgZmllbGRzLgogIGZ1bmN0aW9uIHNpemluZ1BvbGljeShlbCkgewogICAgdmFyIHNpemluZ0VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcigic2NyaXB0W2RhdGEtZm9yPSciICsgZWwuaWQgKyAiJ11bdHlwZT0nYXBwbGljYXRpb24vaHRtbHdpZGdldC1zaXppbmcnXSIpOwogICAgaWYgKCFzaXppbmdFbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICB2YXIgc3AgPSBKU09OLnBhcnNlKHNpemluZ0VsLnRleHRDb250ZW50IHx8IHNpemluZ0VsLnRleHQgfHwgInt9Iik7CiAgICBpZiAodmlld2VyTW9kZSkgewogICAgICByZXR1cm4gc3Audmlld2VyOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHNwLmJyb3dzZXI7CiAgICB9CiAgfQoKICAvLyBAcGFyYW0gdGFza3MgQXJyYXkgb2Ygc3RyaW5ncyAob3IgZmFsc3kgdmFsdWUsIGluIHdoaWNoIGNhc2Ugbm8tb3ApLgogIC8vICAgRWFjaCBlbGVtZW50IG11c3QgYmUgYSB2YWxpZCBKYXZhU2NyaXB0IGV4cHJlc3Npb24gdGhhdCB5aWVsZHMgYQogIC8vICAgZnVuY3Rpb24uIE9yLCBjYW4gYmUgYW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoICJjb2RlIiBhbmQgImRhdGEiCiAgLy8gICBwcm9wZXJ0aWVzOyBpbiB0aGlzIGNhc2UsIHRoZSAiY29kZSIgcHJvcGVydHkgc2hvdWxkIGJlIGEgc3RyaW5nCiAgLy8gICBvZiBKUyB0aGF0J3MgYW4gZXhwciB0aGF0IHlpZWxkcyBhIGZ1bmN0aW9uLCBhbmQgImRhdGEiIHNob3VsZCBiZQogIC8vICAgYW4gb2JqZWN0IHRoYXQgd2lsbCBiZSBhZGRlZCBhcyBhbiBhZGRpdGlvbmFsIGFyZ3VtZW50IHdoZW4gdGhhdAogIC8vICAgZnVuY3Rpb24gaXMgY2FsbGVkLgogIC8vIEBwYXJhbSB0YXJnZXQgVGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgInRoaXMiIGZvciBlYWNoIGZ1bmN0aW9uCiAgLy8gICBleGVjdXRpb24uCiAgLy8gQHBhcmFtIGFyZ3MgQXJyYXkgb2YgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgZnVuY3Rpb25zLiAoVGhlCiAgLy8gICBzYW1lIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZCB0byBhbGwgZnVuY3Rpb25zLikKICBmdW5jdGlvbiBldmFsQW5kUnVuKHRhc2tzLCB0YXJnZXQsIGFyZ3MpIHsKICAgIGlmICh0YXNrcykgewogICAgICBmb3JFYWNoKHRhc2tzLCBmdW5jdGlvbih0YXNrKSB7CiAgICAgICAgdmFyIHRoZXNlQXJncyA9IGFyZ3M7CiAgICAgICAgaWYgKHR5cGVvZih0YXNrKSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIHRoZXNlQXJncyA9IHRoZXNlQXJncy5jb25jYXQoW3Rhc2suZGF0YV0pOwogICAgICAgICAgdGFzayA9IHRhc2suY29kZTsKICAgICAgICB9CiAgICAgICAgdmFyIHRhc2tGdW5jID0gZXZhbCgiKCIgKyB0YXNrICsgIikiKTsKICAgICAgICBpZiAodHlwZW9mKHRhc2tGdW5jKSAhPT0gImZ1bmN0aW9uIikgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJUYXNrIG11c3QgYmUgYSBmdW5jdGlvbiEgU291cmNlOlxuIiArIHRhc2spOwogICAgICAgIH0KICAgICAgICB0YXNrRnVuYy5hcHBseSh0YXJnZXQsIHRoZXNlQXJncyk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgZnVuY3Rpb24gaW5pdFNpemluZyhlbCkgewogICAgdmFyIHNpemluZyA9IHNpemluZ1BvbGljeShlbCk7CiAgICBpZiAoIXNpemluZykKICAgICAgcmV0dXJuOwoKICAgIHZhciBjZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaHRtbHdpZGdldF9jb250YWluZXIiKTsKICAgIGlmICghY2VsKQogICAgICByZXR1cm47CgogICAgaWYgKHR5cGVvZihzaXppbmcucGFkZGluZykgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUubWFyZ2luID0gIjAiOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmcgPSBwYWRkaW5nVG9Dc3ModW5wYWNrUGFkZGluZyhzaXppbmcucGFkZGluZykpOwogICAgfQoKICAgIGlmIChzaXppbmcuZmlsbCkgewogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7CiAgICAgIGlmIChjZWwpIHsKICAgICAgICBjZWwuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgICAgIHZhciBwYWQgPSB1bnBhY2tQYWRkaW5nKHNpemluZy5wYWRkaW5nKTsKICAgICAgICBjZWwuc3R5bGUudG9wID0gcGFkLnRvcCArICJweCI7CiAgICAgICAgY2VsLnN0eWxlLnJpZ2h0ID0gcGFkLnJpZ2h0ICsgInB4IjsKICAgICAgICBjZWwuc3R5bGUuYm90dG9tID0gcGFkLmJvdHRvbSArICJweCI7CiAgICAgICAgY2VsLnN0eWxlLmxlZnQgPSBwYWQubGVmdCArICJweCI7CiAgICAgICAgZWwuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHsgcmV0dXJuIGNlbC5vZmZzZXRXaWR0aDsgfSwKICAgICAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gY2VsLm9mZnNldEhlaWdodDsgfQogICAgICB9OwoKICAgIH0gZWxzZSB7CiAgICAgIGVsLnN0eWxlLndpZHRoID0gcHgoc2l6aW5nLndpZHRoKTsKICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gcHgoc2l6aW5nLmhlaWdodCk7CgogICAgICByZXR1cm4gewogICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHsgcmV0dXJuIGVsLm9mZnNldFdpZHRoOyB9LAogICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7IHJldHVybiBlbC5vZmZzZXRIZWlnaHQ7IH0KICAgICAgfTsKICAgIH0KICB9CgogIC8vIERlZmF1bHQgaW1wbGVtZW50YXRpb25zIGZvciBtZXRob2RzCiAgdmFyIGRlZmF1bHRzID0gewogICAgZmluZDogZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgcmV0dXJuIHF1ZXJ5U2VsZWN0b3JBbGwoc2NvcGUsICIuIiArIHRoaXMubmFtZSk7CiAgICB9LAogICAgcmVuZGVyRXJyb3I6IGZ1bmN0aW9uKGVsLCBlcnIpIHsKICAgICAgdmFyICRlbCA9ICQoZWwpOwoKICAgICAgdGhpcy5jbGVhckVycm9yKGVsKTsKCiAgICAgIC8vIEFkZCBhbGwgdGhlc2UgZXJyb3IgY2xhc3NlcywgYXMgU2hpbnkgZG9lcwogICAgICB2YXIgZXJyQ2xhc3MgPSAic2hpbnktb3V0cHV0LWVycm9yIjsKICAgICAgaWYgKGVyci50eXBlICE9PSBudWxsKSB7CiAgICAgICAgLy8gdXNlIHRoZSBjbGFzc2VzIG9mIHRoZSBlcnJvciBjb25kaXRpb24gYXMgQ1NTIGNsYXNzIG5hbWVzCiAgICAgICAgZXJyQ2xhc3MgPSBlcnJDbGFzcyArICIgIiArICQubWFwKGFzQXJyYXkoZXJyLnR5cGUpLCBmdW5jdGlvbih0eXBlKSB7CiAgICAgICAgICByZXR1cm4gZXJyQ2xhc3MgKyAiLSIgKyB0eXBlOwogICAgICAgIH0pLmpvaW4oIiAiKTsKICAgICAgfQogICAgICBlcnJDbGFzcyA9IGVyckNsYXNzICsgIiBodG1sd2lkZ2V0cy1lcnJvciI7CgogICAgICAvLyBJcyBlbCBpbmxpbmUgb3IgYmxvY2s/IElmIGlubGluZSBvciBpbmxpbmUtYmxvY2ssIGp1c3QgZGlzcGxheTpub25lIGl0CiAgICAgIC8vIGFuZCBhZGQgYW4gaW5saW5lIGVycm9yLgogICAgICB2YXIgZGlzcGxheSA9ICRlbC5jc3MoImRpc3BsYXkiKTsKICAgICAgJGVsLmRhdGEoInJlc3RvcmUtZGlzcGxheS1tb2RlIiwgZGlzcGxheSk7CgogICAgICBpZiAoZGlzcGxheSA9PT0gImlubGluZSIgfHwgZGlzcGxheSA9PT0gImlubGluZS1ibG9jayIpIHsKICAgICAgICAkZWwuaGlkZSgpOwogICAgICAgIGlmIChlcnIubWVzc2FnZSAhPT0gIiIpIHsKICAgICAgICAgIHZhciBlcnJvclNwYW4gPSAkKCI8c3Bhbj4iKS5hZGRDbGFzcyhlcnJDbGFzcyk7CiAgICAgICAgICBlcnJvclNwYW4udGV4dChlcnIubWVzc2FnZSk7CiAgICAgICAgICAkZWwuYWZ0ZXIoZXJyb3JTcGFuKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGlzcGxheSA9PT0gImJsb2NrIikgewogICAgICAgIC8vIElmIGJsb2NrLCBhZGQgYW4gZXJyb3IganVzdCBhZnRlciB0aGUgZWwsIHNldCB2aXNpYmlsaXR5Om5vbmUgb24gdGhlCiAgICAgICAgLy8gZWwsIGFuZCBwb3NpdGlvbiB0aGUgZXJyb3IgdG8gYmUgb24gdG9wIG9mIHRoZSBlbC4KICAgICAgICAvLyBNYXJrIGl0IHdpdGggYSB1bmlxdWUgSUQgYW5kIENTUyBjbGFzcyBzbyB3ZSBjYW4gcmVtb3ZlIGl0IGxhdGVyLgogICAgICAgICRlbC5jc3MoInZpc2liaWxpdHkiLCAiaGlkZGVuIik7CiAgICAgICAgaWYgKGVyci5tZXNzYWdlICE9PSAiIikgewogICAgICAgICAgdmFyIGVycm9yRGl2ID0gJCgiPGRpdj4iKS5hZGRDbGFzcyhlcnJDbGFzcykuY3NzKCJwb3NpdGlvbiIsICJhYnNvbHV0ZSIpCiAgICAgICAgICAgIC5jc3MoInRvcCIsIGVsLm9mZnNldFRvcCkKICAgICAgICAgICAgLmNzcygibGVmdCIsIGVsLm9mZnNldExlZnQpCiAgICAgICAgICAgIC8vIHNldHRpbmcgd2lkdGggY2FuIHB1c2ggb3V0IHRoZSBwYWdlIHNpemUsIGZvcmNpbmcgb3RoZXJ3aXNlCiAgICAgICAgICAgIC8vIHVubmVjZXNzYXJ5IHNjcm9sbGJhcnMgdG8gYXBwZWFyIGFuZCBtYWtpbmcgaXQgaW1wb3NzaWJsZSBmb3IKICAgICAgICAgICAgLy8gdGhlIGVsZW1lbnQgdG8gc2hyaW5rOyBzbyB1c2UgbWF4LXdpZHRoIGluc3RlYWQKICAgICAgICAgICAgLmNzcygibWF4V2lkdGgiLCBlbC5vZmZzZXRXaWR0aCkKICAgICAgICAgICAgLmNzcygiaGVpZ2h0IiwgZWwub2Zmc2V0SGVpZ2h0KTsKICAgICAgICAgIGVycm9yRGl2LnRleHQoZXJyLm1lc3NhZ2UpOwogICAgICAgICAgJGVsLmFmdGVyKGVycm9yRGl2KTsKCiAgICAgICAgICAvLyBSZWFsbHkgZHVtYiB3YXkgdG8ga2VlcCB0aGUgc2l6ZS9wb3NpdGlvbiBvZiB0aGUgZXJyb3IgaW4gc3luYyB3aXRoCiAgICAgICAgICAvLyB0aGUgcGFyZW50IGVsZW1lbnQgYXMgdGhlIHdpbmRvdyBpcyByZXNpemVkIG9yIHdoYXRldmVyLgogICAgICAgICAgdmFyIGludElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmICghZXJyb3JEaXZbMF0ucGFyZW50RWxlbWVudCkgewogICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50SWQpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlcnJvckRpdgogICAgICAgICAgICAgIC5jc3MoInRvcCIsIGVsLm9mZnNldFRvcCkKICAgICAgICAgICAgICAuY3NzKCJsZWZ0IiwgZWwub2Zmc2V0TGVmdCkKICAgICAgICAgICAgICAuY3NzKCJtYXhXaWR0aCIsIGVsLm9mZnNldFdpZHRoKQogICAgICAgICAgICAgIC5jc3MoImhlaWdodCIsIGVsLm9mZnNldEhlaWdodCk7CiAgICAgICAgICB9LCA1MDApOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNsZWFyRXJyb3I6IGZ1bmN0aW9uKGVsKSB7CiAgICAgIHZhciAkZWwgPSAkKGVsKTsKICAgICAgdmFyIGRpc3BsYXkgPSAkZWwuZGF0YSgicmVzdG9yZS1kaXNwbGF5LW1vZGUiKTsKICAgICAgJGVsLmRhdGEoInJlc3RvcmUtZGlzcGxheS1tb2RlIiwgbnVsbCk7CgogICAgICBpZiAoZGlzcGxheSA9PT0gImlubGluZSIgfHwgZGlzcGxheSA9PT0gImlubGluZS1ibG9jayIpIHsKICAgICAgICBpZiAoZGlzcGxheSkKICAgICAgICAgICRlbC5jc3MoImRpc3BsYXkiLCBkaXNwbGF5KTsKICAgICAgICAkKGVsLm5leHRTaWJsaW5nKS5maWx0ZXIoIi5odG1sd2lkZ2V0cy1lcnJvciIpLnJlbW92ZSgpOwogICAgICB9IGVsc2UgaWYgKGRpc3BsYXkgPT09ICJibG9jayIpewogICAgICAgICRlbC5jc3MoInZpc2liaWxpdHkiLCAiaW5oZXJpdCIpOwogICAgICAgICQoZWwubmV4dFNpYmxpbmcpLmZpbHRlcigiLmh0bWx3aWRnZXRzLWVycm9yIikucmVtb3ZlKCk7CiAgICAgIH0KICAgIH0sCiAgICBzaXppbmc6IHt9CiAgfTsKCiAgLy8gQ2FsbGVkIGJ5IHdpZGdldCBiaW5kaW5ncyB0byByZWdpc3RlciBhIG5ldyB0eXBlIG9mIHdpZGdldC4gVGhlIGRlZmluaXRpb24KICAvLyBvYmplY3QgY2FuIGNvbnRhaW4gdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOgogIC8vIC0gbmFtZSAocmVxdWlyZWQpIC0gQSBzdHJpbmcgaW5kaWNhdGluZyB0aGUgYmluZGluZyBuYW1lLCB3aGljaCB3aWxsIGJlCiAgLy8gICB1c2VkIGJ5IGRlZmF1bHQgYXMgdGhlIENTUyBjbGFzc25hbWUgdG8gbG9vayBmb3IuCiAgLy8gLSBpbml0aWFsaXplIChvcHRpb25hbCkgLSBBIGZ1bmN0aW9uKGVsKSB0aGF0IHdpbGwgYmUgY2FsbGVkIG9uY2UgcGVyCiAgLy8gICB3aWRnZXQgZWxlbWVudDsgaWYgYSB2YWx1ZSBpcyByZXR1cm5lZCwgaXQgd2lsbCBiZSBwYXNzZWQgYXMgdGhlIHRoaXJkCiAgLy8gICB2YWx1ZSB0byByZW5kZXJWYWx1ZS4KICAvLyAtIHJlbmRlclZhbHVlIChyZXF1aXJlZCkgLSBBIGZ1bmN0aW9uKGVsLCBkYXRhLCBpbml0VmFsdWUpIHRoYXQgd2lsbCBiZQogIC8vICAgY2FsbGVkIHdpdGggZGF0YS4gU3RhdGljIGNvbnRleHRzIHdpbGwgY2F1c2UgdGhpcyB0byBiZSBjYWxsZWQgb25jZSBwZXIKICAvLyAgIGVsZW1lbnQ7IFNoaW55IGFwcHMgd2lsbCBjYXVzZSB0aGlzIHRvIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBwZXIKICAvLyAgIGVsZW1lbnQsIGFzIHRoZSBkYXRhIGNoYW5nZXMuCiAgd2luZG93LkhUTUxXaWRnZXRzLndpZGdldCA9IGZ1bmN0aW9uKGRlZmluaXRpb24pIHsKICAgIGlmICghZGVmaW5pdGlvbi5uYW1lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIG5hbWUiKTsKICAgIH0KICAgIGlmICghZGVmaW5pdGlvbi50eXBlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIHR5cGUiKTsKICAgIH0KICAgIC8vIEN1cnJlbnRseSB3ZSBvbmx5IHN1cHBvcnQgb3V0cHV0IHdpZGdldHMKICAgIGlmIChkZWZpbml0aW9uLnR5cGUgIT09ICJvdXRwdXQiKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIHdpZGdldCB0eXBlICciICsgZGVmaW5pdGlvbi50eXBlICsgIiciKTsKICAgIH0KICAgIC8vIFRPRE86IFZlcmlmeSB0aGF0IC5uYW1lIGlzIGEgdmFsaWQgQ1NTIGNsYXNzbmFtZQoKICAgIC8vIFN1cHBvcnQgbmV3LXN0eWxlIGluc3RhbmNlLWJvdW5kIGRlZmluaXRpb25zLiBPbGQtc3R5bGUgY2xhc3MtYm91bmQKICAgIC8vIGRlZmluaXRpb25zIGhhdmUgb25lIHdpZGdldCAib2JqZWN0IiBwZXIgd2lkZ2V0IHBlciB0eXBlL2NsYXNzIG9mCiAgICAvLyB3aWRnZXQ7IHRoZSByZW5kZXJWYWx1ZSBhbmQgcmVzaXplIG1ldGhvZHMgb24gc3VjaCB3aWRnZXQgb2JqZWN0cwogICAgLy8gdGFrZSBlbCBhbmQgaW5zdGFuY2UgYXJndW1lbnRzLCBiZWNhdXNlIHRoZSB3aWRnZXQgb2JqZWN0IGNhbid0CiAgICAvLyBzdG9yZSB0aGVtLiBOZXctc3R5bGUgaW5zdGFuY2UtYm91bmQgZGVmaW5pdGlvbnMgaGF2ZSBvbmUgd2lkZ2V0CiAgICAvLyBvYmplY3QgcGVyIHdpZGdldCBpbnN0YW5jZTsgdGhlIGRlZmluaXRpb24gdGhhdCdzIHBhc3NlZCBpbiBkb2Vzbid0CiAgICAvLyBwcm92aWRlIHJlbmRlclZhbHVlIG9yIHJlc2l6ZSBtZXRob2RzIGF0IGFsbCwganVzdCB0aGUgc2luZ2xlIG1ldGhvZAogICAgLy8gICBmYWN0b3J5KGVsLCB3aWR0aCwgaGVpZ2h0KQogICAgLy8gd2hpY2ggcmV0dXJucyBhbiBvYmplY3QgdGhhdCBoYXMgcmVuZGVyVmFsdWUoeCkgYW5kIHJlc2l6ZSh3LCBoKS4KICAgIC8vIFRoaXMgZW5hYmxlcyBhIGZhciBtb3JlIG5hdHVyYWwgcHJvZ3JhbW1pbmcgc3R5bGUgZm9yIHRoZSB3aWRnZXQKICAgIC8vIGF1dGhvciwgd2hvIGNhbiBzdG9yZSBwZXItaW5zdGFuY2Ugc3RhdGUgdXNpbmcgZWl0aGVyIE9PLXN0eWxlCiAgICAvLyBpbnN0YW5jZSBmaWVsZHMgb3IgZnVuY3Rpb25hbC1zdHlsZSBjbG9zdXJlIHZhcmlhYmxlcyAoSSBndWVzcyB0aGlzCiAgICAvLyBpcyBpbiBjb250cmFzdCB0byB3aGF0IGNhbiBvbmx5IGJlIGNhbGxlZCBDLXN0eWxlIHBzZXVkby1PTyB3aGljaCBpcwogICAgLy8gd2hhdCB3ZSByZXF1aXJlZCBiZWZvcmUpLgogICAgaWYgKGRlZmluaXRpb24uZmFjdG9yeSkgewogICAgICBkZWZpbml0aW9uID0gY3JlYXRlTGVnYWN5RGVmaW5pdGlvbkFkYXB0ZXIoZGVmaW5pdGlvbik7CiAgICB9CgogICAgaWYgKCFkZWZpbml0aW9uLnJlbmRlclZhbHVlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIHJlbmRlclZhbHVlIGZ1bmN0aW9uIik7CiAgICB9CgogICAgLy8gRm9yIHN0YXRpYyByZW5kZXJpbmcgKG5vbi1TaGlueSksIHVzZSBhIHNpbXBsZSB3aWRnZXQgcmVnaXN0cmF0aW9uCiAgICAvLyBzY2hlbWUuIFdlIGFsc28gdXNlIHRoaXMgc2NoZW1lIGZvciBTaGlueSBhcHBzL2RvY3VtZW50cyB0aGF0IGFsc28KICAgIC8vIGNvbnRhaW4gc3RhdGljIHdpZGdldHMuCiAgICB3aW5kb3cuSFRNTFdpZGdldHMud2lkZ2V0cyA9IHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXRzIHx8IFtdOwogICAgLy8gTWVyZ2UgZGVmYXVsdHMgaW50byB0aGUgZGVmaW5pdGlvbjsgZG9uJ3QgbXV0YXRlIHRoZSBvcmlnaW5hbCBkZWZpbml0aW9uLgogICAgdmFyIHN0YXRpY0JpbmRpbmcgPSBleHRlbmQoe30sIGRlZmF1bHRzLCBkZWZpbml0aW9uKTsKICAgIG92ZXJyaWRlTWV0aG9kKHN0YXRpY0JpbmRpbmcsICJmaW5kIiwgZnVuY3Rpb24oc3VwZXJmdW5jKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSkgewogICAgICAgIHZhciByZXN1bHRzID0gc3VwZXJmdW5jKHNjb3BlKTsKICAgICAgICAvLyBGaWx0ZXIgb3V0IFNoaW55IG91dHB1dHMsIHdlIG9ubHkgd2FudCB0aGUgc3RhdGljIGtpbmQKICAgICAgICByZXR1cm4gZmlsdGVyQnlDbGFzcyhyZXN1bHRzLCAiaHRtbC13aWRnZXQtb3V0cHV0IiwgZmFsc2UpOwogICAgICB9OwogICAgfSk7CiAgICB3aW5kb3cuSFRNTFdpZGdldHMud2lkZ2V0cy5wdXNoKHN0YXRpY0JpbmRpbmcpOwoKICAgIGlmIChzaGlueU1vZGUpIHsKICAgICAgLy8gU2hpbnkgaXMgcnVubmluZy4gUmVnaXN0ZXIgdGhlIGRlZmluaXRpb24gd2l0aCBhbiBvdXRwdXQgYmluZGluZy4KICAgICAgLy8gVGhlIGRlZmluaXRpb24gaXRzZWxmIHdpbGwgbm90IGJlIHRoZSBvdXRwdXQgYmluZGluZywgaW5zdGVhZAogICAgICAvLyB3ZSB3aWxsIG1ha2UgYW4gb3V0cHV0IGJpbmRpbmcgb2JqZWN0IHRoYXQgZGVsZWdhdGVzIHRvIHRoZQogICAgICAvLyBkZWZpbml0aW9uLiBUaGlzIGlzIGJlY2F1c2Ugd2UgZm9vbGlzaGx5IHVzZWQgdGhlIHNhbWUgbWV0aG9kCiAgICAgIC8vIG5hbWUgKHJlbmRlclZhbHVlKSBmb3IgaHRtbHdpZGdldHMgZGVmaW5pdGlvbiBhbmQgU2hpbnkgYmluZGluZ3MKICAgICAgLy8gYnV0IHRoZXkgYWN0dWFsbHkgaGF2ZSBxdWl0ZSBkaWZmZXJlbnQgc2VtYW50aWNzICh0aGUgU2hpbnkKICAgICAgLy8gYmluZGluZ3MgcmVjZWl2ZSBkYXRhIHRoYXQgaW5jbHVkZXMgbG90cyBvZiBtZXRhZGF0YSB0aGF0IGl0CiAgICAgIC8vIHN0cmlwcyBvZmYgYmVmb3JlIGNhbGxpbmcgaHRtbHdpZGdldHMgcmVuZGVyVmFsdWUpLiBXZSBjYW4ndAogICAgICAvLyBqdXN0IGlnbm9yZSB0aGUgZGlmZmVyZW5jZSBiZWNhdXNlIGluIHNvbWUgd2lkZ2V0cyBpdCdzIGhlbHBmdWwKICAgICAgLy8gdG8gY2FsbCB0aGlzLnJlbmRlclZhbHVlKCkgZnJvbSBpbnNpZGUgb2YgcmVzaXplKCksIGFuZCBpZgogICAgICAvLyB3ZSdyZSBub3QgZGVsZWdhdGluZywgdGhlbiB0aGF0IGNhbGwgd2lsbCBnbyB0byB0aGUgU2hpbnkKICAgICAgLy8gdmVyc2lvbiBpbnN0ZWFkIG9mIHRoZSBodG1sd2lkZ2V0cyB2ZXJzaW9uLgoKICAgICAgLy8gTWVyZ2UgZGVmYXVsdHMgd2l0aCBkZWZpbml0aW9uLCB3aXRob3V0IG11dGF0aW5nIGVpdGhlci4KICAgICAgdmFyIGJpbmRpbmdEZWYgPSBleHRlbmQoe30sIGRlZmF1bHRzLCBkZWZpbml0aW9uKTsKCiAgICAgIC8vIFRoaXMgb2JqZWN0IHdpbGwgYmUgb3VyIGFjdHVhbCBTaGlueSBiaW5kaW5nLgogICAgICB2YXIgc2hpbnlCaW5kaW5nID0gbmV3IFNoaW55Lk91dHB1dEJpbmRpbmcoKTsKCiAgICAgIC8vIFdpdGggYSBmZXcgZXhjZXB0aW9ucywgd2UnbGwgd2FudCB0byBzaW1wbHkgdXNlIHRoZSBiaW5kaW5nRGVmJ3MKICAgICAgLy8gdmVyc2lvbiBvZiBtZXRob2RzIGlmIHRoZXkgYXJlIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGZhbGwgYmFjayB0bwogICAgICAvLyBTaGlueSdzIGRlZmF1bHRzLiBOT1RFOiBJZiBTaGlueSdzIG91dHB1dCBiaW5kaW5ncyBnYWluIGFkZGl0aW9uYWwKICAgICAgLy8gbWV0aG9kcyBpbiB0aGUgZnV0dXJlLCBhbmQgd2Ugd2FudCB0aGVtIHRvIGJlIG92ZXJyaWRlYWJsZSBieQogICAgICAvLyBIVE1MV2lkZ2V0IGJpbmRpbmcgZGVmaW5pdGlvbnMsIHRoZW4gd2UnbGwgbmVlZCB0byBhZGQgdGhlbSB0byB0aGlzCiAgICAgIC8vIGxpc3QuCiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgImdldElkIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgIm9uVmFsdWVDaGFuZ2UiKTsKICAgICAgZGVsZWdhdGVNZXRob2Qoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLCAib25WYWx1ZUVycm9yIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgInJlbmRlckVycm9yIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgImNsZWFyRXJyb3IiKTsKICAgICAgZGVsZWdhdGVNZXRob2Qoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLCAic2hvd1Byb2dyZXNzIik7CgogICAgICAvLyBUaGUgZmluZCwgcmVuZGVyVmFsdWUsIGFuZCByZXNpemUgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHksIGJlY2F1c2Ugd2UKICAgICAgLy8gd2FudCB0byBhY3R1YWxseSBkZWNvcmF0ZSB0aGUgYmVoYXZpb3Igb2YgdGhlIGJpbmRpbmdEZWYgbWV0aG9kcy4KCiAgICAgIHNoaW55QmluZGluZy5maW5kID0gZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgICB2YXIgcmVzdWx0cyA9IGJpbmRpbmdEZWYuZmluZChzY29wZSk7CgogICAgICAgIC8vIE9ubHkgcmV0dXJuIGVsZW1lbnRzIHRoYXQgYXJlIFNoaW55IG91dHB1dHMsIG5vdCBzdGF0aWMgb25lcwogICAgICAgIHZhciBkeW5hbWljUmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKCIuaHRtbC13aWRnZXQtb3V0cHV0Iik7CgogICAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aGF0ZXZlciBjYXVzZWQgU2hpbnkgdG8gdGhpbmsgdGhlcmUgbWlnaHQgYmUKICAgICAgICAvLyBuZXcgZHluYW1pYyBvdXRwdXRzLCBhbHNvIGNhdXNlZCB0aGVyZSB0byBiZSBuZXcgc3RhdGljIG91dHB1dHMuCiAgICAgICAgLy8gU2luY2UgdGhlcmUgbWlnaHQgYmUgbG90cyBvZiBkaWZmZXJlbnQgaHRtbHdpZGdldHMgYmluZGluZ3MsIHdlCiAgICAgICAgLy8gc2NoZWR1bGUgZXhlY3V0aW9uIGZvciBsYXRlci0tbm8gbmVlZCB0byBzdGF0aWNSZW5kZXIgbXVsdGlwbGUKICAgICAgICAvLyB0aW1lcy4KICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IGR5bmFtaWNSZXN1bHRzLmxlbmd0aCkKICAgICAgICAgIHNjaGVkdWxlU3RhdGljUmVuZGVyKCk7CgogICAgICAgIHJldHVybiBkeW5hbWljUmVzdWx0czsKICAgICAgfTsKCiAgICAgIC8vIFdyYXAgcmVuZGVyVmFsdWUgdG8gaGFuZGxlIGluaXRpYWxpemF0aW9uLCB3aGljaCB1bmZvcnR1bmF0ZWx5IGlzbid0CiAgICAgIC8vIHN1cHBvcnRlZCBuYXRpdmVseSBieSBTaGlueSBhdCB0aGUgdGltZSBvZiB0aGlzIHdyaXRpbmcuCgogICAgICBzaGlueUJpbmRpbmcucmVuZGVyVmFsdWUgPSBmdW5jdGlvbihlbCwgZGF0YSkgewogICAgICAgIFNoaW55LnJlbmRlckRlcGVuZGVuY2llcyhkYXRhLmRlcHMpOwogICAgICAgIC8vIFJlc29sdmUgc3RyaW5ncyBtYXJrZWQgYXMgamF2YXNjcmlwdCBsaXRlcmFscyB0byBvYmplY3RzCiAgICAgICAgaWYgKCEoZGF0YS5ldmFscyBpbnN0YW5jZW9mIEFycmF5KSkgZGF0YS5ldmFscyA9IFtkYXRhLmV2YWxzXTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgZGF0YS5ldmFscyAmJiBpIDwgZGF0YS5ldmFscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgd2luZG93LkhUTUxXaWRnZXRzLmV2YWx1YXRlU3RyaW5nTWVtYmVyKGRhdGEueCwgZGF0YS5ldmFsc1tpXSk7CiAgICAgICAgfQogICAgICAgIGlmICghYmluZGluZ0RlZi5yZW5kZXJPbk51bGxWYWx1ZSkgewogICAgICAgICAgaWYgKGRhdGEueCA9PT0gbnVsbCkgewogICAgICAgICAgICBlbC5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVsLnN0eWxlLnZpc2liaWxpdHkgPSAiaW5oZXJpdCI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghZWxlbWVudERhdGEoZWwsICJpbml0aWFsaXplZCIpKSB7CiAgICAgICAgICBpbml0U2l6aW5nKGVsKTsKCiAgICAgICAgICBlbGVtZW50RGF0YShlbCwgImluaXRpYWxpemVkIiwgdHJ1ZSk7CiAgICAgICAgICBpZiAoYmluZGluZ0RlZi5pbml0aWFsaXplKSB7CiAgICAgICAgICAgIHZhciByZXN1bHQgPSBiaW5kaW5nRGVmLmluaXRpYWxpemUoZWwsIGVsLm9mZnNldFdpZHRoLAogICAgICAgICAgICAgIGVsLm9mZnNldEhlaWdodCk7CiAgICAgICAgICAgIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiLCByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBiaW5kaW5nRGVmLnJlbmRlclZhbHVlKGVsLCBkYXRhLngsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgZXZhbEFuZFJ1bihkYXRhLmpzSG9va3MucmVuZGVyLCBlbGVtZW50RGF0YShlbCwgImluaXRfcmVzdWx0IiksIFtlbCwgZGF0YS54XSk7CiAgICAgIH07CgogICAgICAvLyBPbmx5IG92ZXJyaWRlIHJlc2l6ZSBpZiBiaW5kaW5nRGVmIGltcGxlbWVudHMgaXQKICAgICAgaWYgKGJpbmRpbmdEZWYucmVzaXplKSB7CiAgICAgICAgc2hpbnlCaW5kaW5nLnJlc2l6ZSA9IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgICAvLyBTaGlueSBjYW4gY2FsbCByZXNpemUgYmVmb3JlIGluaXRpYWxpemUvcmVuZGVyVmFsdWUgaGF2ZSBiZWVuCiAgICAgICAgICAvLyBjYWxsZWQsIHdoaWNoIGRvZXNuJ3QgbWFrZSBzZW5zZSBmb3Igd2lkZ2V0cy4KICAgICAgICAgIGlmIChlbGVtZW50RGF0YShlbCwgImluaXRpYWxpemVkIikpIHsKICAgICAgICAgICAgYmluZGluZ0RlZi5yZXNpemUoZWwsIHdpZHRoLCBoZWlnaHQsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgU2hpbnkub3V0cHV0QmluZGluZ3MucmVnaXN0ZXIoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLm5hbWUpOwogICAgfQogIH07CgogIHZhciBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogIGZ1bmN0aW9uIHNjaGVkdWxlU3RhdGljUmVuZGVyKCkgewogICAgaWYgKCFzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQpIHsKICAgICAgc2NoZWR1bGVTdGF0aWNSZW5kZXJUaW1lcklkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogICAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgICAgfSwgMSk7CiAgICB9CiAgfQoKICAvLyBSZW5kZXIgc3RhdGljIHdpZGdldHMgYWZ0ZXIgdGhlIGRvY3VtZW50IGZpbmlzaGVzIGxvYWRpbmcKICAvLyBTdGF0aWNhbGx5IHJlbmRlciBhbGwgZWxlbWVudHMgdGhhdCBhcmUgb2YgdGhpcyB3aWRnZXQncyBjbGFzcwogIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIgPSBmdW5jdGlvbigpIHsKICAgIHZhciBiaW5kaW5ncyA9IHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXRzIHx8IFtdOwogICAgZm9yRWFjaChiaW5kaW5ncywgZnVuY3Rpb24oYmluZGluZykgewogICAgICB2YXIgbWF0Y2hlcyA9IGJpbmRpbmcuZmluZChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpOwogICAgICBmb3JFYWNoKG1hdGNoZXMsIGZ1bmN0aW9uKGVsKSB7CiAgICAgICAgdmFyIHNpemVPYmogPSBpbml0U2l6aW5nKGVsLCBiaW5kaW5nKTsKCiAgICAgICAgaWYgKGhhc0NsYXNzKGVsLCAiaHRtbC13aWRnZXQtc3RhdGljLWJvdW5kIikpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lICsgIiBodG1sLXdpZGdldC1zdGF0aWMtYm91bmQiOwoKICAgICAgICB2YXIgaW5pdFJlc3VsdDsKICAgICAgICBpZiAoYmluZGluZy5pbml0aWFsaXplKSB7CiAgICAgICAgICBpbml0UmVzdWx0ID0gYmluZGluZy5pbml0aWFsaXplKGVsLAogICAgICAgICAgICBzaXplT2JqID8gc2l6ZU9iai5nZXRXaWR0aCgpIDogZWwub2Zmc2V0V2lkdGgsCiAgICAgICAgICAgIHNpemVPYmogPyBzaXplT2JqLmdldEhlaWdodCgpIDogZWwub2Zmc2V0SGVpZ2h0CiAgICAgICAgICApOwogICAgICAgICAgZWxlbWVudERhdGEoZWwsICJpbml0X3Jlc3VsdCIsIGluaXRSZXN1bHQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJpbmRpbmcucmVzaXplKSB7CiAgICAgICAgICB2YXIgbGFzdFNpemUgPSB7fTsKICAgICAgICAgIHZhciByZXNpemVIYW5kbGVyID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICB2YXIgc2l6ZSA9IHsKICAgICAgICAgICAgICB3OiBzaXplT2JqID8gc2l6ZU9iai5nZXRXaWR0aCgpIDogZWwub2Zmc2V0V2lkdGgsCiAgICAgICAgICAgICAgaDogc2l6ZU9iaiA/IHNpemVPYmouZ2V0SGVpZ2h0KCkgOiBlbC5vZmZzZXRIZWlnaHQKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKHNpemUudyA9PT0gMCAmJiBzaXplLmggPT09IDApCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoc2l6ZS53ID09PSBsYXN0U2l6ZS53ICYmIHNpemUuaCA9PT0gbGFzdFNpemUuaCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGxhc3RTaXplID0gc2l6ZTsKICAgICAgICAgICAgYmluZGluZy5yZXNpemUoZWwsIHNpemUudywgc2l6ZS5oLCBpbml0UmVzdWx0KTsKICAgICAgICAgIH07CgogICAgICAgICAgb24od2luZG93LCAicmVzaXplIiwgcmVzaXplSGFuZGxlcik7CgogICAgICAgICAgLy8gVGhpcyBpcyBuZWVkZWQgZm9yIGNhc2VzIHdoZXJlIHdlJ3JlIHJ1bm5pbmcgaW4gYSBTaGlueQogICAgICAgICAgLy8gYXBwLCBidXQgdGhlIHdpZGdldCBpdHNlbGYgaXMgbm90IGEgU2hpbnkgb3V0cHV0LCBidXQKICAgICAgICAgIC8vIHJhdGhlciBhIHNpbXBsZSBzdGF0aWMgd2lkZ2V0LiBPbmUgZXhhbXBsZSBvZiB0aGlzIGlzCiAgICAgICAgICAvLyBhbiBybWFya2Rvd24gZG9jdW1lbnQgdGhhdCBoYXMgcnVudGltZTpzaGlueSBhbmQgd2lkZ2V0CiAgICAgICAgICAvLyB0aGF0IGlzbid0IGluIGEgcmVuZGVyIGZ1bmN0aW9uLiBTaGlueSBvbmx5IGtub3dzIHRvCiAgICAgICAgICAvLyBjYWxsIHJlc2l6ZSBoYW5kbGVycyBmb3IgU2hpbnkgb3V0cHV0cywgbm90IGZvciBzdGF0aWMKICAgICAgICAgIC8vIHdpZGdldHMsIHNvIHdlIGRvIGl0IG91cnNlbHZlcy4KICAgICAgICAgIGlmICh3aW5kb3cualF1ZXJ5KSB7CiAgICAgICAgICAgIHdpbmRvdy5qUXVlcnkoZG9jdW1lbnQpLm9uKAogICAgICAgICAgICAgICJzaG93bi5odG1sd2lkZ2V0cyBzaG93bi5icy50YWIuaHRtbHdpZGdldHMgc2hvd24uYnMuY29sbGFwc2UuaHRtbHdpZGdldHMiLAogICAgICAgICAgICAgIHJlc2l6ZUhhbmRsZXIKICAgICAgICAgICAgKTsKICAgICAgICAgICAgd2luZG93LmpRdWVyeShkb2N1bWVudCkub24oCiAgICAgICAgICAgICAgImhpZGRlbi5odG1sd2lkZ2V0cyBoaWRkZW4uYnMudGFiLmh0bWx3aWRnZXRzIGhpZGRlbi5icy5jb2xsYXBzZS5odG1sd2lkZ2V0cyIsCiAgICAgICAgICAgICAgcmVzaXplSGFuZGxlcgogICAgICAgICAgICApOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFRoaXMgaXMgbmVlZGVkIGZvciB0aGUgc3BlY2lmaWMgY2FzZSBvZiBpb3NsaWRlcywgd2hpY2gKICAgICAgICAgIC8vIGZsaXBzIHNsaWRlcyBiZXR3ZWVuIGRpc3BsYXk6bm9uZSBhbmQgZGlzcGxheTpibG9jay4KICAgICAgICAgIC8vIElkZWFsbHkgd2Ugd291bGQgbm90IGhhdmUgdG8gaGF2ZSBpb3NsaWRlLXNwZWNpZmljIGNvZGUKICAgICAgICAgIC8vIGhlcmUsIGJ1dCByYXRoZXIgaGF2ZSBpb3NsaWRlcyByYWlzZSBhIGdlbmVyaWMgZXZlbnQsCiAgICAgICAgICAvLyBidXQgdGhlIHJtYXJrZG93biBwYWNrYWdlIGp1c3Qgd2VudCB0byBDUkFOIHNvIHRoZQogICAgICAgICAgLy8gd2luZG93IHRvIGdldHRpbmcgdGhhdCBmaXhlZCBtYXkgYmUgbG9uZy4KICAgICAgICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgICAgICAvLyBJdCdzIE9LIHRvIGxpbWl0IHRoaXMgdG8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIKICAgICAgICAgICAgLy8gYnJvd3NlcnMgYmVjYXVzZSBpb3NsaWRlcyBpdHNlbGYgb25seSBzdXBwb3J0cwogICAgICAgICAgICAvLyBzdWNoIGJyb3dzZXJzLgogICAgICAgICAgICBvbihkb2N1bWVudCwgInNsaWRlZW50ZXIiLCByZXNpemVIYW5kbGVyKTsKICAgICAgICAgICAgb24oZG9jdW1lbnQsICJzbGlkZWxlYXZlIiwgcmVzaXplSGFuZGxlcik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgc2NyaXB0RGF0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInNjcmlwdFtkYXRhLWZvcj0nIiArIGVsLmlkICsgIiddW3R5cGU9J2FwcGxpY2F0aW9uL2pzb24nXSIpOwogICAgICAgIGlmIChzY3JpcHREYXRhKSB7CiAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2Uoc2NyaXB0RGF0YS50ZXh0Q29udGVudCB8fCBzY3JpcHREYXRhLnRleHQpOwogICAgICAgICAgLy8gUmVzb2x2ZSBzdHJpbmdzIG1hcmtlZCBhcyBqYXZhc2NyaXB0IGxpdGVyYWxzIHRvIG9iamVjdHMKICAgICAgICAgIGlmICghKGRhdGEuZXZhbHMgaW5zdGFuY2VvZiBBcnJheSkpIGRhdGEuZXZhbHMgPSBbZGF0YS5ldmFsc107CiAgICAgICAgICBmb3IgKHZhciBrID0gMDsgZGF0YS5ldmFscyAmJiBrIDwgZGF0YS5ldmFscy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICB3aW5kb3cuSFRNTFdpZGdldHMuZXZhbHVhdGVTdHJpbmdNZW1iZXIoZGF0YS54LCBkYXRhLmV2YWxzW2tdKTsKICAgICAgICAgIH0KICAgICAgICAgIGJpbmRpbmcucmVuZGVyVmFsdWUoZWwsIGRhdGEueCwgaW5pdFJlc3VsdCk7CiAgICAgICAgICBldmFsQW5kUnVuKGRhdGEuanNIb29rcy5yZW5kZXIsIGluaXRSZXN1bHQsIFtlbCwgZGF0YS54XSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIGludm9rZVBvc3RSZW5kZXJIYW5kbGVycygpOwogIH0KCiAgLy8gV2FpdCB1bnRpbCBhZnRlciB0aGUgZG9jdW1lbnQgaGFzIGxvYWRlZCB0byByZW5kZXIgdGhlIHdpZGdldHMuCiAgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBmdW5jdGlvbigpIHsKICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGFyZ3VtZW50cy5jYWxsZWUsIGZhbHNlKTsKICAgICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpOwogICAgfSwgZmFsc2UpOwogIH0gZWxzZSBpZiAoZG9jdW1lbnQuYXR0YWNoRXZlbnQpIHsKICAgIGRvY3VtZW50LmF0dGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBmdW5jdGlvbigpIHsKICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICJjb21wbGV0ZSIpIHsKICAgICAgICBkb2N1bWVudC5kZXRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIiwgYXJndW1lbnRzLmNhbGxlZSk7CiAgICAgICAgd2luZG93LkhUTUxXaWRnZXRzLnN0YXRpY1JlbmRlcigpOwogICAgICB9CiAgICB9KTsKICB9CgoKICB3aW5kb3cuSFRNTFdpZGdldHMuZ2V0QXR0YWNobWVudFVybCA9IGZ1bmN0aW9uKGRlcG5hbWUsIGtleSkgewogICAgLy8gSWYgbm8ga2V5LCBkZWZhdWx0IHRvIHRoZSBmaXJzdCBpdGVtCiAgICBpZiAodHlwZW9mKGtleSkgPT09ICJ1bmRlZmluZWQiKQogICAgICBrZXkgPSAxOwoKICAgIHZhciBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGVwbmFtZSArICItIiArIGtleSArICItYXR0YWNobWVudCIpOwogICAgaWYgKCFsaW5rKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiQXR0YWNobWVudCAiICsgZGVwbmFtZSArICIvIiArIGtleSArICIgbm90IGZvdW5kIGluIGRvY3VtZW50Iik7CiAgICB9CiAgICByZXR1cm4gbGluay5nZXRBdHRyaWJ1dGUoImhyZWYiKTsKICB9OwoKICB3aW5kb3cuSFRNTFdpZGdldHMuZGF0YWZyYW1lVG9EMyA9IGZ1bmN0aW9uKGRmKSB7CiAgICB2YXIgbmFtZXMgPSBbXTsKICAgIHZhciBsZW5ndGg7CiAgICBmb3IgKHZhciBuYW1lIGluIGRmKSB7CiAgICAgICAgaWYgKGRmLmhhc093blByb3BlcnR5KG5hbWUpKQogICAgICAgICAgICBuYW1lcy5wdXNoKG5hbWUpOwogICAgICAgIGlmICh0eXBlb2YoZGZbbmFtZV0pICE9PSAib2JqZWN0IiB8fCB0eXBlb2YoZGZbbmFtZV0ubGVuZ3RoKSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBbGwgZmllbGRzIG11c3QgYmUgYXJyYXlzIik7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YobGVuZ3RoKSAhPT0gInVuZGVmaW5lZCIgJiYgbGVuZ3RoICE9PSBkZltuYW1lXS5sZW5ndGgpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBbGwgZmllbGRzIG11c3QgYmUgYXJyYXlzIG9mIHRoZSBzYW1lIGxlbmd0aCIpOwogICAgICAgIH0KICAgICAgICBsZW5ndGggPSBkZltuYW1lXS5sZW5ndGg7CiAgICB9CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgdmFyIGl0ZW07CiAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCBsZW5ndGg7IHJvdysrKSB7CiAgICAgICAgaXRlbSA9IHt9OwogICAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IG5hbWVzLmxlbmd0aDsgY29sKyspIHsKICAgICAgICAgICAgaXRlbVtuYW1lc1tjb2xdXSA9IGRmW25hbWVzW2NvbF1dW3Jvd107CiAgICAgICAgfQogICAgICAgIHJlc3VsdHMucHVzaChpdGVtKTsKICAgIH0KICAgIHJldHVybiByZXN1bHRzOwogIH07CgogIHdpbmRvdy5IVE1MV2lkZ2V0cy50cmFuc3Bvc2VBcnJheTJEID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkgcmV0dXJuIGFycmF5OwogICAgICB2YXIgbmV3QXJyYXkgPSBhcnJheVswXS5tYXAoZnVuY3Rpb24oY29sLCBpKSB7CiAgICAgICAgICByZXR1cm4gYXJyYXkubWFwKGZ1bmN0aW9uKHJvdykgewogICAgICAgICAgICAgIHJldHVybiByb3dbaV0KICAgICAgICAgIH0pCiAgICAgIH0pOwogICAgICByZXR1cm4gbmV3QXJyYXk7CiAgfTsKICAvLyBTcGxpdCB2YWx1ZSBhdCBzcGxpdENoYXIsIGJ1dCBhbGxvdyBzcGxpdENoYXIgdG8gYmUgZXNjYXBlZAogIC8vIHVzaW5nIGVzY2FwZUNoYXIuIEFueSBvdGhlciBjaGFyYWN0ZXJzIGVzY2FwZWQgYnkgZXNjYXBlQ2hhcgogIC8vIHdpbGwgYmUgaW5jbHVkZWQgYXMgdXN1YWwgKGluY2x1ZGluZyBlc2NhcGVDaGFyIGl0c2VsZikuCiAgZnVuY3Rpb24gc3BsaXRXaXRoRXNjYXBlKHZhbHVlLCBzcGxpdENoYXIsIGVzY2FwZUNoYXIpIHsKICAgIHZhciByZXN1bHRzID0gW107CiAgICB2YXIgZXNjYXBlTW9kZSA9IGZhbHNlOwogICAgdmFyIGN1cnJlbnRSZXN1bHQgPSAiIjsKICAgIGZvciAodmFyIHBvcyA9IDA7IHBvcyA8IHZhbHVlLmxlbmd0aDsgcG9zKyspIHsKICAgICAgaWYgKCFlc2NhcGVNb2RlKSB7CiAgICAgICAgaWYgKHZhbHVlW3Bvc10gPT09IHNwbGl0Q2hhcikgewogICAgICAgICAgcmVzdWx0cy5wdXNoKGN1cnJlbnRSZXN1bHQpOwogICAgICAgICAgY3VycmVudFJlc3VsdCA9ICIiOwogICAgICAgIH0gZWxzZSBpZiAodmFsdWVbcG9zXSA9PT0gZXNjYXBlQ2hhcikgewogICAgICAgICAgZXNjYXBlTW9kZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGN1cnJlbnRSZXN1bHQgKz0gdmFsdWVbcG9zXTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY3VycmVudFJlc3VsdCArPSB2YWx1ZVtwb3NdOwogICAgICAgIGVzY2FwZU1vZGUgPSBmYWxzZTsKICAgICAgfQogICAgfQogICAgaWYgKGN1cnJlbnRSZXN1bHQgIT09ICIiKSB7CiAgICAgIHJlc3VsdHMucHVzaChjdXJyZW50UmVzdWx0KTsKICAgIH0KICAgIHJldHVybiByZXN1bHRzOwogIH0KICAvLyBGdW5jdGlvbiBhdXRob3JlZCBieSBZaWh1aS9KSiBBbGxhaXJlCiAgd2luZG93LkhUTUxXaWRnZXRzLmV2YWx1YXRlU3RyaW5nTWVtYmVyID0gZnVuY3Rpb24obywgbWVtYmVyKSB7CiAgICB2YXIgcGFydHMgPSBzcGxpdFdpdGhFc2NhcGUobWVtYmVyLCAnLicsICdcXCcpOwogICAgZm9yICh2YXIgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmFyIHBhcnQgPSBwYXJ0c1tpXTsKICAgICAgLy8gcGFydCBtYXkgYmUgYSBjaGFyYWN0ZXIgb3IgJ251bWVyaWMnIG1lbWJlciBuYW1lCiAgICAgIGlmIChvICE9PSBudWxsICYmIHR5cGVvZiBvID09PSAib2JqZWN0IiAmJiBwYXJ0IGluIG8pIHsKICAgICAgICBpZiAoaSA9PSAobCAtIDEpKSB7IC8vIGlmIHdlIGFyZSBhdCB0aGUgZW5kIG9mIHRoZSBsaW5lIHRoZW4gZXZhbHVsYXRlCiAgICAgICAgICBpZiAodHlwZW9mIG9bcGFydF0gPT09ICJzdHJpbmciKQogICAgICAgICAgICBvW3BhcnRdID0gZXZhbCgiKCIgKyBvW3BhcnRdICsgIikiKTsKICAgICAgICB9IGVsc2UgeyAvLyBvdGhlcndpc2UgY29udGludWUgdG8gbmV4dCBlbWJlZGRlZCBvYmplY3QKICAgICAgICAgIG8gPSBvW3BhcnRdOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIC8vIFJldHJpZXZlIHRoZSBIVE1MV2lkZ2V0IGluc3RhbmNlIChpLmUuIHRoZSByZXR1cm4gdmFsdWUgb2YgYW4KICAvLyBIVE1MV2lkZ2V0IGJpbmRpbmcncyBpbml0aWFsaXplKCkgb3IgZmFjdG9yeSgpIGZ1bmN0aW9uKQogIC8vIGFzc29jaWF0ZWQgd2l0aCBhbiBlbGVtZW50LCBvciBudWxsIGlmIG5vbmUuCiAgd2luZG93LkhUTUxXaWRnZXRzLmdldEluc3RhbmNlID0gZnVuY3Rpb24oZWwpIHsKICAgIHJldHVybiBlbGVtZW50RGF0YShlbCwgImluaXRfcmVzdWx0Iik7CiAgfTsKCiAgLy8gRmluZHMgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIHNjb3BlIHRoYXQgbWF0Y2hlcyB0aGUgc2VsZWN0b3IsCiAgLy8gYW5kIHJldHVybnMgdGhlIEhUTUxXaWRnZXQgaW5zdGFuY2UgKGkuZS4gdGhlIHJldHVybiB2YWx1ZSBvZgogIC8vIGFuIEhUTUxXaWRnZXQgYmluZGluZydzIGluaXRpYWxpemUoKSBvciBmYWN0b3J5KCkgZnVuY3Rpb24pCiAgLy8gYXNzb2NpYXRlZCB3aXRoIHRoYXQgZWxlbWVudCwgaWYgYW55LiBJZiBubyBlbGVtZW50IG1hdGNoZXMgdGhlCiAgLy8gc2VsZWN0b3IsIG9yIHRoZSBmaXJzdCBtYXRjaGluZyBlbGVtZW50IGhhcyBubyBIVE1MV2lkZ2V0CiAgLy8gaW5zdGFuY2UgYXNzb2NpYXRlZCB3aXRoIGl0LCB0aGVuIG51bGwgaXMgcmV0dXJuZWQuCiAgLy8KICAvLyBUaGUgc2NvcGUgYXJndW1lbnQgaXMgb3B0aW9uYWwsIGFuZCBkZWZhdWx0cyB0byB3aW5kb3cuZG9jdW1lbnQuCiAgd2luZG93LkhUTUxXaWRnZXRzLmZpbmQgPSBmdW5jdGlvbihzY29wZSwgc2VsZWN0b3IpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgc2VsZWN0b3IgPSBzY29wZTsKICAgICAgc2NvcGUgPSBkb2N1bWVudDsKICAgIH0KCiAgICB2YXIgZWwgPSBzY29wZS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKICAgIGlmIChlbCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB3aW5kb3cuSFRNTFdpZGdldHMuZ2V0SW5zdGFuY2UoZWwpOwogICAgfQogIH07CgogIC8vIEZpbmRzIGFsbCBlbGVtZW50cyBpbiB0aGUgc2NvcGUgdGhhdCBtYXRjaCB0aGUgc2VsZWN0b3IsIGFuZAogIC8vIHJldHVybnMgdGhlIEhUTUxXaWRnZXQgaW5zdGFuY2VzIChpLmUuIHRoZSByZXR1cm4gdmFsdWVzIG9mCiAgLy8gYW4gSFRNTFdpZGdldCBiaW5kaW5nJ3MgaW5pdGlhbGl6ZSgpIG9yIGZhY3RvcnkoKSBmdW5jdGlvbikKICAvLyBhc3NvY2lhdGVkIHdpdGggdGhlIGVsZW1lbnRzLCBpbiBhbiBhcnJheS4gSWYgZWxlbWVudHMgdGhhdAogIC8vIG1hdGNoIHRoZSBzZWxlY3RvciBkb24ndCBoYXZlIGFuIGFzc29jaWF0ZWQgSFRNTFdpZGdldAogIC8vIGluc3RhbmNlLCB0aGUgcmV0dXJuZWQgYXJyYXkgd2lsbCBjb250YWluIG51bGxzLgogIC8vCiAgLy8gVGhlIHNjb3BlIGFyZ3VtZW50IGlzIG9wdGlvbmFsLCBhbmQgZGVmYXVsdHMgdG8gd2luZG93LmRvY3VtZW50LgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5maW5kQWxsID0gZnVuY3Rpb24oc2NvcGUsIHNlbGVjdG9yKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7CiAgICAgIHNlbGVjdG9yID0gc2NvcGU7CiAgICAgIHNjb3BlID0gZG9jdW1lbnQ7CiAgICB9CgogICAgdmFyIG5vZGVzID0gc2NvcGUucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykgewogICAgICByZXN1bHRzLnB1c2god2luZG93LkhUTUxXaWRnZXRzLmdldEluc3RhbmNlKG5vZGVzW2ldKSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICB2YXIgcG9zdFJlbmRlckhhbmRsZXJzID0gW107CiAgZnVuY3Rpb24gaW52b2tlUG9zdFJlbmRlckhhbmRsZXJzKCkgewogICAgd2hpbGUgKHBvc3RSZW5kZXJIYW5kbGVycy5sZW5ndGgpIHsKICAgICAgdmFyIGhhbmRsZXIgPSBwb3N0UmVuZGVySGFuZGxlcnMuc2hpZnQoKTsKICAgICAgaWYgKGhhbmRsZXIpIHsKICAgICAgICBoYW5kbGVyKCk7CiAgICAgIH0KICAgIH0KICB9CgogIC8vIFJlZ2lzdGVyIHRoZSBnaXZlbiBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSBpbnZva2VkIGFmdGVyIHRoZQogIC8vIG5leHQgdGltZSBzdGF0aWMgd2lkZ2V0cyBhcmUgcmVuZGVyZWQuCiAgd2luZG93LkhUTUxXaWRnZXRzLmFkZFBvc3RSZW5kZXJIYW5kbGVyID0gZnVuY3Rpb24oY2FsbGJhY2spIHsKICAgIHBvc3RSZW5kZXJIYW5kbGVycy5wdXNoKGNhbGxiYWNrKTsKICB9OwoKICAvLyBUYWtlcyBhIG5ldy1zdHlsZSBpbnN0YW5jZS1ib3VuZCBkZWZpbml0aW9uLCBhbmQgcmV0dXJucyBhbgogIC8vIG9sZC1zdHlsZSBjbGFzcy1ib3VuZCBkZWZpbml0aW9uLiBUaGlzIHNhdmVzIHVzIGZyb20gaGF2aW5nCiAgLy8gdG8gcmV3cml0ZSBhbGwgdGhlIGxvZ2ljIGluIHRoaXMgZmlsZSB0byBhY2NvbW9kYXRlIGJvdGgKICAvLyB0eXBlcyBvZiBkZWZpbml0aW9ucy4KICBmdW5jdGlvbiBjcmVhdGVMZWdhY3lEZWZpbml0aW9uQWRhcHRlcihkZWZuKSB7CiAgICB2YXIgcmVzdWx0ID0gewogICAgICBuYW1lOiBkZWZuLm5hbWUsCiAgICAgIHR5cGU6IGRlZm4udHlwZSwKICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oZWwsIHdpZHRoLCBoZWlnaHQpIHsKICAgICAgICByZXR1cm4gZGVmbi5mYWN0b3J5KGVsLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgfSwKICAgICAgcmVuZGVyVmFsdWU6IGZ1bmN0aW9uKGVsLCB4LCBpbnN0YW5jZSkgewogICAgICAgIHJldHVybiBpbnN0YW5jZS5yZW5kZXJWYWx1ZSh4KTsKICAgICAgfSwKICAgICAgcmVzaXplOiBmdW5jdGlvbihlbCwgd2lkdGgsIGhlaWdodCwgaW5zdGFuY2UpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2UucmVzaXplKHdpZHRoLCBoZWlnaHQpOwogICAgICB9CiAgICB9OwoKICAgIGlmIChkZWZuLmZpbmQpCiAgICAgIHJlc3VsdC5maW5kID0gZGVmbi5maW5kOwogICAgaWYgKGRlZm4ucmVuZGVyRXJyb3IpCiAgICAgIHJlc3VsdC5yZW5kZXJFcnJvciA9IGRlZm4ucmVuZGVyRXJyb3I7CiAgICBpZiAoZGVmbi5jbGVhckVycm9yKQogICAgICByZXN1bHQuY2xlYXJFcnJvciA9IGRlZm4uY2xlYXJFcnJvcjsKCiAgICByZXR1cm4gcmVzdWx0OwogIH0KfSkoKTsKCg=="></script>
<script src="data:application/x-javascript;base64,IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihuLHQpe3JldHVybiB0Pm4/LTE6bj50PzE6bj49dD8wOjAvMH1mdW5jdGlvbiB0KG4pe3JldHVybiBudWxsPT09bj8wLzA6K259ZnVuY3Rpb24gZShuKXtyZXR1cm4haXNOYU4obil9ZnVuY3Rpb24gcihuKXtyZXR1cm57bGVmdDpmdW5jdGlvbih0LGUscix1KXtmb3IoYXJndW1lbnRzLmxlbmd0aDwzJiYocj0wKSxhcmd1bWVudHMubGVuZ3RoPDQmJih1PXQubGVuZ3RoKTt1PnI7KXt2YXIgaT1yK3U+Pj4xO24odFtpXSxlKTwwP3I9aSsxOnU9aX1yZXR1cm4gcn0scmlnaHQ6ZnVuY3Rpb24odCxlLHIsdSl7Zm9yKGFyZ3VtZW50cy5sZW5ndGg8MyYmKHI9MCksYXJndW1lbnRzLmxlbmd0aDw0JiYodT10Lmxlbmd0aCk7dT5yOyl7dmFyIGk9cit1Pj4+MTtuKHRbaV0sZSk+MD91PWk6cj1pKzF9cmV0dXJuIHJ9fX1mdW5jdGlvbiB1KG4pe3JldHVybiBuLmxlbmd0aH1mdW5jdGlvbiBpKG4pe2Zvcih2YXIgdD0xO24qdCUxOyl0Kj0xMDtyZXR1cm4gdH1mdW5jdGlvbiBvKG4sdCl7Zm9yKHZhciBlIGluIHQpT2JqZWN0LmRlZmluZVByb3BlcnR5KG4ucHJvdG90eXBlLGUse3ZhbHVlOnRbZV0sZW51bWVyYWJsZTohMX0pfWZ1bmN0aW9uIGEoKXt0aGlzLl89T2JqZWN0LmNyZWF0ZShudWxsKX1mdW5jdGlvbiBjKG4pe3JldHVybihuKz0iIik9PT1kYXx8blswXT09PW1hP21hK246bn1mdW5jdGlvbiBsKG4pe3JldHVybihuKz0iIilbMF09PT1tYT9uLnNsaWNlKDEpOm59ZnVuY3Rpb24gcyhuKXtyZXR1cm4gYyhuKWluIHRoaXMuX31mdW5jdGlvbiBmKG4pe3JldHVybihuPWMobikpaW4gdGhpcy5fJiZkZWxldGUgdGhpcy5fW25dfWZ1bmN0aW9uIGgoKXt2YXIgbj1bXTtmb3IodmFyIHQgaW4gdGhpcy5fKW4ucHVzaChsKHQpKTtyZXR1cm4gbn1mdW5jdGlvbiBnKCl7dmFyIG49MDtmb3IodmFyIHQgaW4gdGhpcy5fKSsrbjtyZXR1cm4gbn1mdW5jdGlvbiBwKCl7Zm9yKHZhciBuIGluIHRoaXMuXylyZXR1cm4hMTtyZXR1cm4hMH1mdW5jdGlvbiB2KCl7dGhpcy5fPU9iamVjdC5jcmVhdGUobnVsbCl9ZnVuY3Rpb24gZChuLHQsZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHI9ZS5hcHBseSh0LGFyZ3VtZW50cyk7cmV0dXJuIHI9PT10P246cn19ZnVuY3Rpb24gbShuLHQpe2lmKHQgaW4gbilyZXR1cm4gdDt0PXQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKTtmb3IodmFyIGU9MCxyPXlhLmxlbmd0aDtyPmU7KytlKXt2YXIgdT15YVtlXSt0O2lmKHUgaW4gbilyZXR1cm4gdX19ZnVuY3Rpb24geSgpe31mdW5jdGlvbiBNKCl7fWZ1bmN0aW9uIHgobil7ZnVuY3Rpb24gdCgpe2Zvcih2YXIgdCxyPWUsdT0tMSxpPXIubGVuZ3RoOysrdTxpOykodD1yW3VdLm9uKSYmdC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIG59dmFyIGU9W10scj1uZXcgYTtyZXR1cm4gdC5vbj1mdW5jdGlvbih0LHUpe3ZhciBpLG89ci5nZXQodCk7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg8Mj9vJiZvLm9uOihvJiYoby5vbj1udWxsLGU9ZS5zbGljZSgwLGk9ZS5pbmRleE9mKG8pKS5jb25jYXQoZS5zbGljZShpKzEpKSxyLnJlbW92ZSh0KSksdSYmZS5wdXNoKHIuc2V0KHQse29uOnV9KSksbil9LHR9ZnVuY3Rpb24gYigpe3RhLmV2ZW50LnByZXZlbnREZWZhdWx0KCl9ZnVuY3Rpb24gXygpe2Zvcih2YXIgbix0PXRhLmV2ZW50O249dC5zb3VyY2VFdmVudDspdD1uO3JldHVybiB0fWZ1bmN0aW9uIHcobil7Zm9yKHZhciB0PW5ldyBNLGU9MCxyPWFyZ3VtZW50cy5sZW5ndGg7KytlPHI7KXRbYXJndW1lbnRzW2VdXT14KHQpO3JldHVybiB0Lm9mPWZ1bmN0aW9uKGUscil7cmV0dXJuIGZ1bmN0aW9uKHUpe3RyeXt2YXIgaT11LnNvdXJjZUV2ZW50PXRhLmV2ZW50O3UudGFyZ2V0PW4sdGEuZXZlbnQ9dSx0W3UudHlwZV0uYXBwbHkoZSxyKX1maW5hbGx5e3RhLmV2ZW50PWl9fX0sdH1mdW5jdGlvbiBTKG4pe3JldHVybiB4YShuLGthKSxufWZ1bmN0aW9uIGsobil7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIG4/bjpmdW5jdGlvbigpe3JldHVybiBiYShuLHRoaXMpfX1mdW5jdGlvbiBFKG4pe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBuP246ZnVuY3Rpb24oKXtyZXR1cm4gX2Eobix0aGlzKX19ZnVuY3Rpb24gQShuLHQpe2Z1bmN0aW9uIGUoKXt0aGlzLnJlbW92ZUF0dHJpYnV0ZShuKX1mdW5jdGlvbiByKCl7dGhpcy5yZW1vdmVBdHRyaWJ1dGVOUyhuLnNwYWNlLG4ubG9jYWwpfWZ1bmN0aW9uIHUoKXt0aGlzLnNldEF0dHJpYnV0ZShuLHQpfWZ1bmN0aW9uIGkoKXt0aGlzLnNldEF0dHJpYnV0ZU5TKG4uc3BhY2Usbi5sb2NhbCx0KX1mdW5jdGlvbiBvKCl7dmFyIGU9dC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7bnVsbD09ZT90aGlzLnJlbW92ZUF0dHJpYnV0ZShuKTp0aGlzLnNldEF0dHJpYnV0ZShuLGUpfWZ1bmN0aW9uIGEoKXt2YXIgZT10LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtudWxsPT1lP3RoaXMucmVtb3ZlQXR0cmlidXRlTlMobi5zcGFjZSxuLmxvY2FsKTp0aGlzLnNldEF0dHJpYnV0ZU5TKG4uc3BhY2Usbi5sb2NhbCxlKX1yZXR1cm4gbj10YS5ucy5xdWFsaWZ5KG4pLG51bGw9PXQ/bi5sb2NhbD9yOmU6ImZ1bmN0aW9uIj09dHlwZW9mIHQ/bi5sb2NhbD9hOm86bi5sb2NhbD9pOnV9ZnVuY3Rpb24gTihuKXtyZXR1cm4gbi50cmltKCkucmVwbGFjZSgvXHMrL2csIiAiKX1mdW5jdGlvbiBDKG4pe3JldHVybiBuZXcgUmVnRXhwKCIoPzpefFxccyspIit0YS5yZXF1b3RlKG4pKyIoPzpcXHMrfCQpIiwiZyIpfWZ1bmN0aW9uIHoobil7cmV0dXJuKG4rIiIpLnRyaW0oKS5zcGxpdCgvXnxccysvKX1mdW5jdGlvbiBxKG4sdCl7ZnVuY3Rpb24gZSgpe2Zvcih2YXIgZT0tMTsrK2U8dTspbltlXSh0aGlzLHQpfWZ1bmN0aW9uIHIoKXtmb3IodmFyIGU9LTEscj10LmFwcGx5KHRoaXMsYXJndW1lbnRzKTsrK2U8dTspbltlXSh0aGlzLHIpfW49eihuKS5tYXAoTCk7dmFyIHU9bi5sZW5ndGg7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQ/cjplfWZ1bmN0aW9uIEwobil7dmFyIHQ9QyhuKTtyZXR1cm4gZnVuY3Rpb24oZSxyKXtpZih1PWUuY2xhc3NMaXN0KXJldHVybiByP3UuYWRkKG4pOnUucmVtb3ZlKG4pO3ZhciB1PWUuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIjtyPyh0Lmxhc3RJbmRleD0wLHQudGVzdCh1KXx8ZS5zZXRBdHRyaWJ1dGUoImNsYXNzIixOKHUrIiAiK24pKSk6ZS5zZXRBdHRyaWJ1dGUoImNsYXNzIixOKHUucmVwbGFjZSh0LCIgIikpKX19ZnVuY3Rpb24gVChuLHQsZSl7ZnVuY3Rpb24gcigpe3RoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobil9ZnVuY3Rpb24gdSgpe3RoaXMuc3R5bGUuc2V0UHJvcGVydHkobix0LGUpfWZ1bmN0aW9uIGkoKXt2YXIgcj10LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtudWxsPT1yP3RoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobik6dGhpcy5zdHlsZS5zZXRQcm9wZXJ0eShuLHIsZSl9cmV0dXJuIG51bGw9PXQ/cjoiZnVuY3Rpb24iPT10eXBlb2YgdD9pOnV9ZnVuY3Rpb24gUihuLHQpe2Z1bmN0aW9uIGUoKXtkZWxldGUgdGhpc1tuXX1mdW5jdGlvbiByKCl7dGhpc1tuXT10fWZ1bmN0aW9uIHUoKXt2YXIgZT10LmFwcGx5KHRoaXMsYXJndW1lbnRzKTtudWxsPT1lP2RlbGV0ZSB0aGlzW25dOnRoaXNbbl09ZX1yZXR1cm4gbnVsbD09dD9lOiJmdW5jdGlvbiI9PXR5cGVvZiB0P3U6cn1mdW5jdGlvbiBEKG4pe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBuP246KG49dGEubnMucXVhbGlmeShuKSkubG9jYWw/ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuLnNwYWNlLG4ubG9jYWwpfTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHRoaXMubmFtZXNwYWNlVVJJLG4pfX1mdW5jdGlvbiBQKCl7dmFyIG49dGhpcy5wYXJlbnROb2RlO24mJm4ucmVtb3ZlQ2hpbGQodGhpcyl9ZnVuY3Rpb24gVShuKXtyZXR1cm57X19kYXRhX186bn19ZnVuY3Rpb24gaihuKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gU2EodGhpcyxuKX19ZnVuY3Rpb24gRih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aHx8KHQ9biksZnVuY3Rpb24obixlKXtyZXR1cm4gbiYmZT90KG4uX19kYXRhX18sZS5fX2RhdGFfXyk6IW4tIWV9fWZ1bmN0aW9uIEgobix0KXtmb3IodmFyIGU9MCxyPW4ubGVuZ3RoO3I+ZTtlKyspZm9yKHZhciB1LGk9bltlXSxvPTAsYT1pLmxlbmd0aDthPm87bysrKSh1PWlbb10pJiZ0KHUsbyxlKTtyZXR1cm4gbn1mdW5jdGlvbiBPKG4pe3JldHVybiB4YShuLEFhKSxufWZ1bmN0aW9uIFkobil7dmFyIHQsZTtyZXR1cm4gZnVuY3Rpb24ocix1LGkpe3ZhciBvLGE9bltpXS51cGRhdGUsYz1hLmxlbmd0aDtmb3IoaSE9ZSYmKGU9aSx0PTApLHU+PXQmJih0PXUrMSk7IShvPWFbdF0pJiYrK3Q8YzspO3JldHVybiBvfX1mdW5jdGlvbiBJKG4sdCxlKXtmdW5jdGlvbiByKCl7dmFyIHQ9dGhpc1tvXTt0JiYodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKG4sdCx0LiQpLGRlbGV0ZSB0aGlzW29dKX1mdW5jdGlvbiB1KCl7dmFyIHU9Yyh0LHJhKGFyZ3VtZW50cykpO3IuY2FsbCh0aGlzKSx0aGlzLmFkZEV2ZW50TGlzdGVuZXIobix0aGlzW29dPXUsdS4kPWUpLHUuXz10fWZ1bmN0aW9uIGkoKXt2YXIgdCxlPW5ldyBSZWdFeHAoIl5fX29uKFteLl0rKSIrdGEucmVxdW90ZShuKSsiJCIpO2Zvcih2YXIgciBpbiB0aGlzKWlmKHQ9ci5tYXRjaChlKSl7dmFyIHU9dGhpc1tyXTt0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIodFsxXSx1LHUuJCksZGVsZXRlIHRoaXNbcl19fXZhciBvPSJfX29uIituLGE9bi5pbmRleE9mKCIuIiksYz1aO2E+MCYmKG49bi5zbGljZSgwLGEpKTt2YXIgbD1DYS5nZXQobik7cmV0dXJuIGwmJihuPWwsYz1WKSxhP3Q/dTpyOnQ/eTppfWZ1bmN0aW9uIFoobix0KXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHI9dGEuZXZlbnQ7dGEuZXZlbnQ9ZSx0WzBdPXRoaXMuX19kYXRhX187dHJ5e24uYXBwbHkodGhpcyx0KX1maW5hbGx5e3RhLmV2ZW50PXJ9fX1mdW5jdGlvbiBWKG4sdCl7dmFyIGU9WihuLHQpO3JldHVybiBmdW5jdGlvbihuKXt2YXIgdD10aGlzLHI9bi5yZWxhdGVkVGFyZ2V0O3ImJihyPT09dHx8OCZyLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHQpKXx8ZS5jYWxsKHQsbil9fWZ1bmN0aW9uIFgoKXt2YXIgbj0iLmRyYWdzdXBwcmVzcy0iKyArK3FhLHQ9ImNsaWNrIituLGU9dGEuc2VsZWN0KG9hKS5vbigidG91Y2htb3ZlIituLGIpLm9uKCJkcmFnc3RhcnQiK24sYikub24oInNlbGVjdHN0YXJ0IituLGIpO2lmKHphKXt2YXIgcj1pYS5zdHlsZSx1PXJbemFdO3JbemFdPSJub25lIn1yZXR1cm4gZnVuY3Rpb24oaSl7aWYoZS5vbihuLG51bGwpLHphJiYoclt6YV09dSksaSl7dmFyIG89ZnVuY3Rpb24oKXtlLm9uKHQsbnVsbCl9O2Uub24odCxmdW5jdGlvbigpe2IoKSxvKCl9LCEwKSxzZXRUaW1lb3V0KG8sMCl9fX1mdW5jdGlvbiAkKG4sdCl7dC5jaGFuZ2VkVG91Y2hlcyYmKHQ9dC5jaGFuZ2VkVG91Y2hlc1swXSk7dmFyIGU9bi5vd25lclNWR0VsZW1lbnR8fG47aWYoZS5jcmVhdGVTVkdQb2ludCl7dmFyIHI9ZS5jcmVhdGVTVkdQb2ludCgpO2lmKDA+TGEmJihvYS5zY3JvbGxYfHxvYS5zY3JvbGxZKSl7ZT10YS5zZWxlY3QoImJvZHkiKS5hcHBlbmQoInN2ZyIpLnN0eWxlKHtwb3NpdGlvbjoiYWJzb2x1dGUiLHRvcDowLGxlZnQ6MCxtYXJnaW46MCxwYWRkaW5nOjAsYm9yZGVyOiJub25lIn0sImltcG9ydGFudCIpO3ZhciB1PWVbMF1bMF0uZ2V0U2NyZWVuQ1RNKCk7TGE9ISh1LmZ8fHUuZSksZS5yZW1vdmUoKX1yZXR1cm4gTGE/KHIueD10LnBhZ2VYLHIueT10LnBhZ2VZKTooci54PXQuY2xpZW50WCxyLnk9dC5jbGllbnRZKSxyPXIubWF0cml4VHJhbnNmb3JtKG4uZ2V0U2NyZWVuQ1RNKCkuaW52ZXJzZSgpKSxbci54LHIueV19dmFyIGk9bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm5bdC5jbGllbnRYLWkubGVmdC1uLmNsaWVudExlZnQsdC5jbGllbnRZLWkudG9wLW4uY2xpZW50VG9wXX1mdW5jdGlvbiBCKCl7cmV0dXJuIHRhLmV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmlkZW50aWZpZXJ9ZnVuY3Rpb24gVygpe3JldHVybiB0YS5ldmVudC50YXJnZXR9ZnVuY3Rpb24gSigpe3JldHVybiBvYX1mdW5jdGlvbiBHKG4pe3JldHVybiBuPjA/MTowPm4/LTE6MH1mdW5jdGlvbiBLKG4sdCxlKXtyZXR1cm4odFswXS1uWzBdKSooZVsxXS1uWzFdKS0odFsxXS1uWzFdKSooZVswXS1uWzBdKX1mdW5jdGlvbiBRKG4pe3JldHVybiBuPjE/MDotMT5uP0RhOk1hdGguYWNvcyhuKX1mdW5jdGlvbiBudChuKXtyZXR1cm4gbj4xP2phOi0xPm4/LWphOk1hdGguYXNpbihuKX1mdW5jdGlvbiB0dChuKXtyZXR1cm4oKG49TWF0aC5leHAobikpLTEvbikvMn1mdW5jdGlvbiBldChuKXtyZXR1cm4oKG49TWF0aC5leHAobikpKzEvbikvMn1mdW5jdGlvbiBydChuKXtyZXR1cm4oKG49TWF0aC5leHAoMipuKSktMSkvKG4rMSl9ZnVuY3Rpb24gdXQobil7cmV0dXJuKG49TWF0aC5zaW4obi8yKSkqbn1mdW5jdGlvbiBpdCgpe31mdW5jdGlvbiBvdChuLHQsZSl7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBvdD8odGhpcy5oPStuLHRoaXMucz0rdCx2b2lkKHRoaXMubD0rZSkpOmFyZ3VtZW50cy5sZW5ndGg8Mj9uIGluc3RhbmNlb2Ygb3Q/bmV3IG90KG4uaCxuLnMsbi5sKTp4dCgiIituLGJ0LG90KTpuZXcgb3Qobix0LGUpfWZ1bmN0aW9uIGF0KG4sdCxlKXtmdW5jdGlvbiByKG4pe3JldHVybiBuPjM2MD9uLT0zNjA6MD5uJiYobis9MzYwKSw2MD5uP2krKG8taSkqbi82MDoxODA+bj9vOjI0MD5uP2krKG8taSkqKDI0MC1uKS82MDppfWZ1bmN0aW9uIHUobil7cmV0dXJuIE1hdGgucm91bmQoMjU1KnIobikpfXZhciBpLG87cmV0dXJuIG49aXNOYU4obik/MDoobiU9MzYwKTwwP24rMzYwOm4sdD1pc05hTih0KT8wOjA+dD8wOnQ+MT8xOnQsZT0wPmU/MDplPjE/MTplLG89LjU+PWU/ZSooMSt0KTplK3QtZSp0LGk9MiplLW8sbmV3IGR0KHUobisxMjApLHUobiksdShuLTEyMCkpfWZ1bmN0aW9uIGN0KG4sdCxlKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIGN0Pyh0aGlzLmg9K24sdGhpcy5jPSt0LHZvaWQodGhpcy5sPStlKSk6YXJndW1lbnRzLmxlbmd0aDwyP24gaW5zdGFuY2VvZiBjdD9uZXcgY3Qobi5oLG4uYyxuLmwpOm4gaW5zdGFuY2VvZiBzdD9odChuLmwsbi5hLG4uYik6aHQoKG49X3QoKG49dGEucmdiKG4pKS5yLG4uZyxuLmIpKS5sLG4uYSxuLmIpOm5ldyBjdChuLHQsZSl9ZnVuY3Rpb24gbHQobix0LGUpe3JldHVybiBpc05hTihuKSYmKG49MCksaXNOYU4odCkmJih0PTApLG5ldyBzdChlLE1hdGguY29zKG4qPUZhKSp0LE1hdGguc2luKG4pKnQpfWZ1bmN0aW9uIHN0KG4sdCxlKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIHN0Pyh0aGlzLmw9K24sdGhpcy5hPSt0LHZvaWQodGhpcy5iPStlKSk6YXJndW1lbnRzLmxlbmd0aDwyP24gaW5zdGFuY2VvZiBzdD9uZXcgc3Qobi5sLG4uYSxuLmIpOm4gaW5zdGFuY2VvZiBjdD9sdChuLmgsbi5jLG4ubCk6X3QoKG49ZHQobikpLnIsbi5nLG4uYik6bmV3IHN0KG4sdCxlKX1mdW5jdGlvbiBmdChuLHQsZSl7dmFyIHI9KG4rMTYpLzExNix1PXIrdC81MDAsaT1yLWUvMjAwO3JldHVybiB1PWd0KHUpKkphLHI9Z3QocikqR2EsaT1ndChpKSpLYSxuZXcgZHQodnQoMy4yNDA0NTQyKnUtMS41MzcxMzg1KnItLjQ5ODUzMTQqaSksdnQoLS45NjkyNjYqdSsxLjg3NjAxMDgqcisuMDQxNTU2KmkpLHZ0KC4wNTU2NDM0KnUtLjIwNDAyNTkqcisxLjA1NzIyNTIqaSkpfWZ1bmN0aW9uIGh0KG4sdCxlKXtyZXR1cm4gbj4wP25ldyBjdChNYXRoLmF0YW4yKGUsdCkqSGEsTWF0aC5zcXJ0KHQqdCtlKmUpLG4pOm5ldyBjdCgwLzAsMC8wLG4pfWZ1bmN0aW9uIGd0KG4pe3JldHVybiBuPi4yMDY4OTMwMzQ/bipuKm46KG4tNC8yOSkvNy43ODcwMzd9ZnVuY3Rpb24gcHQobil7cmV0dXJuIG4+LjAwODg1Nj9NYXRoLnBvdyhuLDEvMyk6Ny43ODcwMzcqbis0LzI5fWZ1bmN0aW9uIHZ0KG4pe3JldHVybiBNYXRoLnJvdW5kKDI1NSooLjAwMzA0Pj1uPzEyLjkyKm46MS4wNTUqTWF0aC5wb3cobiwxLzIuNCktLjA1NSkpfWZ1bmN0aW9uIGR0KG4sdCxlKXtyZXR1cm4gdGhpcyBpbnN0YW5jZW9mIGR0Pyh0aGlzLnI9fn5uLHRoaXMuZz1+fnQsdm9pZCh0aGlzLmI9fn5lKSk6YXJndW1lbnRzLmxlbmd0aDwyP24gaW5zdGFuY2VvZiBkdD9uZXcgZHQobi5yLG4uZyxuLmIpOnh0KCIiK24sZHQsYXQpOm5ldyBkdChuLHQsZSl9ZnVuY3Rpb24gbXQobil7cmV0dXJuIG5ldyBkdChuPj4xNiwyNTUmbj4+OCwyNTUmbil9ZnVuY3Rpb24geXQobil7cmV0dXJuIG10KG4pKyIifWZ1bmN0aW9uIE10KG4pe3JldHVybiAxNj5uPyIwIitNYXRoLm1heCgwLG4pLnRvU3RyaW5nKDE2KTpNYXRoLm1pbigyNTUsbikudG9TdHJpbmcoMTYpfWZ1bmN0aW9uIHh0KG4sdCxlKXt2YXIgcix1LGksbz0wLGE9MCxjPTA7aWYocj0vKFthLXpdKylcKCguKilcKS9pLmV4ZWMobikpc3dpdGNoKHU9clsyXS5zcGxpdCgiLCIpLHJbMV0pe2Nhc2UiaHNsIjpyZXR1cm4gZShwYXJzZUZsb2F0KHVbMF0pLHBhcnNlRmxvYXQodVsxXSkvMTAwLHBhcnNlRmxvYXQodVsyXSkvMTAwKTtjYXNlInJnYiI6cmV0dXJuIHQoU3QodVswXSksU3QodVsxXSksU3QodVsyXSkpfXJldHVybihpPXRjLmdldChuKSk/dChpLnIsaS5nLGkuYik6KG51bGw9PW58fCIjIiE9PW4uY2hhckF0KDApfHxpc05hTihpPXBhcnNlSW50KG4uc2xpY2UoMSksMTYpKXx8KDQ9PT1uLmxlbmd0aD8obz0oMzg0MCZpKT4+NCxvPW8+PjR8byxhPTI0MCZpLGE9YT4+NHxhLGM9MTUmaSxjPWM8PDR8Yyk6Nz09PW4ubGVuZ3RoJiYobz0oMTY3MTE2ODAmaSk+PjE2LGE9KDY1MjgwJmkpPj44LGM9MjU1JmkpKSx0KG8sYSxjKSl9ZnVuY3Rpb24gYnQobix0LGUpe3ZhciByLHUsaT1NYXRoLm1pbihuLz0yNTUsdC89MjU1LGUvPTI1NSksbz1NYXRoLm1heChuLHQsZSksYT1vLWksYz0obytpKS8yO3JldHVybiBhPyh1PS41PmM/YS8obytpKTphLygyLW8taSkscj1uPT1vPyh0LWUpL2ErKGU+dD82OjApOnQ9PW8/KGUtbikvYSsyOihuLXQpL2ErNCxyKj02MCk6KHI9MC8wLHU9Yz4wJiYxPmM/MDpyKSxuZXcgb3Qocix1LGMpfWZ1bmN0aW9uIF90KG4sdCxlKXtuPXd0KG4pLHQ9d3QodCksZT13dChlKTt2YXIgcj1wdCgoLjQxMjQ1NjQqbisuMzU3NTc2MSp0Ky4xODA0Mzc1KmUpL0phKSx1PXB0KCguMjEyNjcyOSpuKy43MTUxNTIyKnQrLjA3MjE3NSplKS9HYSksaT1wdCgoLjAxOTMzMzkqbisuMTE5MTkyKnQrLjk1MDMwNDEqZSkvS2EpO3JldHVybiBzdCgxMTYqdS0xNiw1MDAqKHItdSksMjAwKih1LWkpKX1mdW5jdGlvbiB3dChuKXtyZXR1cm4obi89MjU1KTw9LjA0MDQ1P24vMTIuOTI6TWF0aC5wb3coKG4rLjA1NSkvMS4wNTUsMi40KX1mdW5jdGlvbiBTdChuKXt2YXIgdD1wYXJzZUZsb2F0KG4pO3JldHVybiIlIj09PW4uY2hhckF0KG4ubGVuZ3RoLTEpP01hdGgucm91bmQoMi41NSp0KTp0fWZ1bmN0aW9uIGt0KG4pe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBuP246ZnVuY3Rpb24oKXtyZXR1cm4gbn19ZnVuY3Rpb24gRXQobil7cmV0dXJuIG59ZnVuY3Rpb24gQXQobil7cmV0dXJuIGZ1bmN0aW9uKHQsZSxyKXtyZXR1cm4gMj09PWFyZ3VtZW50cy5sZW5ndGgmJiJmdW5jdGlvbiI9PXR5cGVvZiBlJiYocj1lLGU9bnVsbCksTnQodCxlLG4scil9fWZ1bmN0aW9uIE50KG4sdCxlLHIpe2Z1bmN0aW9uIHUoKXt2YXIgbix0PWMuc3RhdHVzO2lmKCF0JiZ6dChjKXx8dD49MjAwJiYzMDA+dHx8MzA0PT09dCl7dHJ5e249ZS5jYWxsKGksYyl9Y2F0Y2gocil7cmV0dXJuIG8uZXJyb3IuY2FsbChpLHIpLHZvaWQgMH1vLmxvYWQuY2FsbChpLG4pfWVsc2Ugby5lcnJvci5jYWxsKGksYyl9dmFyIGk9e30sbz10YS5kaXNwYXRjaCgiYmVmb3Jlc2VuZCIsInByb2dyZXNzIiwibG9hZCIsImVycm9yIiksYT17fSxjPW5ldyBYTUxIdHRwUmVxdWVzdCxsPW51bGw7cmV0dXJuIW9hLlhEb21haW5SZXF1ZXN0fHwid2l0aENyZWRlbnRpYWxzImluIGN8fCEvXihodHRwKHMpPzopP1wvXC8vLnRlc3Qobil8fChjPW5ldyBYRG9tYWluUmVxdWVzdCksIm9ubG9hZCJpbiBjP2Mub25sb2FkPWMub25lcnJvcj11OmMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7Yy5yZWFkeVN0YXRlPjMmJnUoKX0sYy5vbnByb2dyZXNzPWZ1bmN0aW9uKG4pe3ZhciB0PXRhLmV2ZW50O3RhLmV2ZW50PW47dHJ5e28ucHJvZ3Jlc3MuY2FsbChpLGMpfWZpbmFsbHl7dGEuZXZlbnQ9dH19LGkuaGVhZGVyPWZ1bmN0aW9uKG4sdCl7cmV0dXJuIG49KG4rIiIpLnRvTG93ZXJDYXNlKCksYXJndW1lbnRzLmxlbmd0aDwyP2Fbbl06KG51bGw9PXQ/ZGVsZXRlIGFbbl06YVtuXT10KyIiLGkpfSxpLm1pbWVUeXBlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0PW51bGw9PW4/bnVsbDpuKyIiLGkpOnR9LGkucmVzcG9uc2VUeXBlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhsPW4saSk6bH0saS5yZXNwb25zZT1mdW5jdGlvbihuKXtyZXR1cm4gZT1uLGl9LFsiZ2V0IiwicG9zdCJdLmZvckVhY2goZnVuY3Rpb24obil7aVtuXT1mdW5jdGlvbigpe3JldHVybiBpLnNlbmQuYXBwbHkoaSxbbl0uY29uY2F0KHJhKGFyZ3VtZW50cykpKX19KSxpLnNlbmQ9ZnVuY3Rpb24oZSxyLHUpe2lmKDI9PT1hcmd1bWVudHMubGVuZ3RoJiYiZnVuY3Rpb24iPT10eXBlb2YgciYmKHU9cixyPW51bGwpLGMub3BlbihlLG4sITApLG51bGw9PXR8fCJhY2NlcHQiaW4gYXx8KGEuYWNjZXB0PXQrIiwqLyoiKSxjLnNldFJlcXVlc3RIZWFkZXIpZm9yKHZhciBzIGluIGEpYy5zZXRSZXF1ZXN0SGVhZGVyKHMsYVtzXSk7cmV0dXJuIG51bGwhPXQmJmMub3ZlcnJpZGVNaW1lVHlwZSYmYy5vdmVycmlkZU1pbWVUeXBlKHQpLG51bGwhPWwmJihjLnJlc3BvbnNlVHlwZT1sKSxudWxsIT11JiZpLm9uKCJlcnJvciIsdSkub24oImxvYWQiLGZ1bmN0aW9uKG4pe3UobnVsbCxuKX0pLG8uYmVmb3Jlc2VuZC5jYWxsKGksYyksYy5zZW5kKG51bGw9PXI/bnVsbDpyKSxpfSxpLmFib3J0PWZ1bmN0aW9uKCl7cmV0dXJuIGMuYWJvcnQoKSxpfSx0YS5yZWJpbmQoaSxvLCJvbiIpLG51bGw9PXI/aTppLmdldChDdChyKSl9ZnVuY3Rpb24gQ3Qobil7cmV0dXJuIDE9PT1uLmxlbmd0aD9mdW5jdGlvbih0LGUpe24obnVsbD09dD9lOm51bGwpfTpufWZ1bmN0aW9uIHp0KG4pe3ZhciB0PW4ucmVzcG9uc2VUeXBlO3JldHVybiB0JiYidGV4dCIhPT10P24ucmVzcG9uc2U6bi5yZXNwb25zZVRleHR9ZnVuY3Rpb24gcXQoKXt2YXIgbj1MdCgpLHQ9VHQoKS1uO3Q+MjQ/KGlzRmluaXRlKHQpJiYoY2xlYXJUaW1lb3V0KGljKSxpYz1zZXRUaW1lb3V0KHF0LHQpKSx1Yz0wKToodWM9MSxhYyhxdCkpfWZ1bmN0aW9uIEx0KCl7dmFyIG49RGF0ZS5ub3coKTtmb3Iob2M9ZWM7b2M7KW4+PW9jLnQmJihvYy5mPW9jLmMobi1vYy50KSksb2M9b2MubjtyZXR1cm4gbn1mdW5jdGlvbiBUdCgpe2Zvcih2YXIgbix0PWVjLGU9MS8wO3Q7KXQuZj90PW4/bi5uPXQubjplYz10Lm46KHQudDxlJiYoZT10LnQpLHQ9KG49dCkubik7cmV0dXJuIHJjPW4sZX1mdW5jdGlvbiBSdChuLHQpe3JldHVybiB0LShuP01hdGguY2VpbChNYXRoLmxvZyhuKS9NYXRoLkxOMTApOjEpfWZ1bmN0aW9uIER0KG4sdCl7dmFyIGU9TWF0aC5wb3coMTAsMyp2YSg4LXQpKTtyZXR1cm57c2NhbGU6dD44P2Z1bmN0aW9uKG4pe3JldHVybiBuL2V9OmZ1bmN0aW9uKG4pe3JldHVybiBuKmV9LHN5bWJvbDpufX1mdW5jdGlvbiBQdChuKXt2YXIgdD1uLmRlY2ltYWwsZT1uLnRob3VzYW5kcyxyPW4uZ3JvdXBpbmcsdT1uLmN1cnJlbmN5LGk9ciYmZT9mdW5jdGlvbihuLHQpe2Zvcih2YXIgdT1uLmxlbmd0aCxpPVtdLG89MCxhPXJbMF0sYz0wO3U+MCYmYT4wJiYoYythKzE+dCYmKGE9TWF0aC5tYXgoMSx0LWMpKSxpLnB1c2gobi5zdWJzdHJpbmcodS09YSx1K2EpKSwhKChjKz1hKzEpPnQpKTspYT1yW289KG8rMSklci5sZW5ndGhdO3JldHVybiBpLnJldmVyc2UoKS5qb2luKGUpfTpFdDtyZXR1cm4gZnVuY3Rpb24obil7dmFyIGU9bGMuZXhlYyhuKSxyPWVbMV18fCIgIixvPWVbMl18fCI+IixhPWVbM118fCItIixjPWVbNF18fCIiLGw9ZVs1XSxzPStlWzZdLGY9ZVs3XSxoPWVbOF0sZz1lWzldLHA9MSx2PSIiLGQ9IiIsbT0hMSx5PSEwO3N3aXRjaChoJiYoaD0raC5zdWJzdHJpbmcoMSkpLChsfHwiMCI9PT1yJiYiPSI9PT1vKSYmKGw9cj0iMCIsbz0iPSIpLGcpe2Nhc2UibiI6Zj0hMCxnPSJnIjticmVhaztjYXNlIiUiOnA9MTAwLGQ9IiUiLGc9ImYiO2JyZWFrO2Nhc2UicCI6cD0xMDAsZD0iJSIsZz0iciI7YnJlYWs7Y2FzZSJiIjpjYXNlIm8iOmNhc2UieCI6Y2FzZSJYIjoiIyI9PT1jJiYodj0iMCIrZy50b0xvd2VyQ2FzZSgpKTtjYXNlImMiOnk9ITE7Y2FzZSJkIjptPSEwLGg9MDticmVhaztjYXNlInMiOnA9LTEsZz0iciJ9IiQiPT09YyYmKHY9dVswXSxkPXVbMV0pLCJyIiE9Z3x8aHx8KGc9ImciKSxudWxsIT1oJiYoImciPT1nP2g9TWF0aC5tYXgoMSxNYXRoLm1pbigyMSxoKSk6KCJlIj09Z3x8ImYiPT1nKSYmKGg9TWF0aC5tYXgoMCxNYXRoLm1pbigyMCxoKSkpKSxnPXNjLmdldChnKXx8VXQ7dmFyIE09bCYmZjtyZXR1cm4gZnVuY3Rpb24obil7dmFyIGU9ZDtpZihtJiZuJTEpcmV0dXJuIiI7dmFyIHU9MD5ufHwwPT09biYmMD4xL24/KG49LW4sIi0iKToiLSI9PT1hPyIiOmE7aWYoMD5wKXt2YXIgYz10YS5mb3JtYXRQcmVmaXgobixoKTtuPWMuc2NhbGUobiksZT1jLnN5bWJvbCtkfWVsc2Ugbio9cDtuPWcobixoKTt2YXIgeCxiLF89bi5sYXN0SW5kZXhPZigiLiIpO2lmKDA+Xyl7dmFyIHc9eT9uLmxhc3RJbmRleE9mKCJlIik6LTE7MD53Pyh4PW4sYj0iIik6KHg9bi5zdWJzdHJpbmcoMCx3KSxiPW4uc3Vic3RyaW5nKHcpKX1lbHNlIHg9bi5zdWJzdHJpbmcoMCxfKSxiPXQrbi5zdWJzdHJpbmcoXysxKTshbCYmZiYmKHg9aSh4LDEvMCkpO3ZhciBTPXYubGVuZ3RoK3gubGVuZ3RoK2IubGVuZ3RoKyhNPzA6dS5sZW5ndGgpLGs9cz5TP25ldyBBcnJheShTPXMtUysxKS5qb2luKHIpOiIiO3JldHVybiBNJiYoeD1pKGsreCxrLmxlbmd0aD9zLWIubGVuZ3RoOjEvMCkpLHUrPXYsbj14K2IsKCI8Ij09PW8/dStuK2s6Ij4iPT09bz9rK3UrbjoiXiI9PT1vP2suc3Vic3RyaW5nKDAsUz4+PTEpK3UrbitrLnN1YnN0cmluZyhTKTp1KyhNP246aytuKSkrZX19fWZ1bmN0aW9uIFV0KG4pe3JldHVybiBuKyIifWZ1bmN0aW9uIGp0KCl7dGhpcy5fPW5ldyBEYXRlKGFyZ3VtZW50cy5sZW5ndGg+MT9EYXRlLlVUQy5hcHBseSh0aGlzLGFyZ3VtZW50cyk6YXJndW1lbnRzWzBdKX1mdW5jdGlvbiBGdChuLHQsZSl7ZnVuY3Rpb24gcih0KXt2YXIgZT1uKHQpLHI9aShlLDEpO3JldHVybiByLXQ+dC1lP2U6cn1mdW5jdGlvbiB1KGUpe3JldHVybiB0KGU9bihuZXcgaGMoZS0xKSksMSksZX1mdW5jdGlvbiBpKG4sZSl7cmV0dXJuIHQobj1uZXcgaGMoK24pLGUpLG59ZnVuY3Rpb24gbyhuLHIsaSl7dmFyIG89dShuKSxhPVtdO2lmKGk+MSlmb3IoO3I+bzspZShvKSVpfHxhLnB1c2gobmV3IERhdGUoK28pKSx0KG8sMSk7ZWxzZSBmb3IoO3I+bzspYS5wdXNoKG5ldyBEYXRlKCtvKSksdChvLDEpO3JldHVybiBhfWZ1bmN0aW9uIGEobix0LGUpe3RyeXtoYz1qdDt2YXIgcj1uZXcganQ7cmV0dXJuIHIuXz1uLG8ocix0LGUpfWZpbmFsbHl7aGM9RGF0ZX19bi5mbG9vcj1uLG4ucm91bmQ9cixuLmNlaWw9dSxuLm9mZnNldD1pLG4ucmFuZ2U9bzt2YXIgYz1uLnV0Yz1IdChuKTtyZXR1cm4gYy5mbG9vcj1jLGMucm91bmQ9SHQociksYy5jZWlsPUh0KHUpLGMub2Zmc2V0PUh0KGkpLGMucmFuZ2U9YSxufWZ1bmN0aW9uIEh0KG4pe3JldHVybiBmdW5jdGlvbih0LGUpe3RyeXtoYz1qdDt2YXIgcj1uZXcganQ7cmV0dXJuIHIuXz10LG4ocixlKS5ffWZpbmFsbHl7aGM9RGF0ZX19fWZ1bmN0aW9uIE90KG4pe2Z1bmN0aW9uIHQobil7ZnVuY3Rpb24gdCh0KXtmb3IodmFyIGUsdSxpLG89W10sYT0tMSxjPTA7KythPHI7KTM3PT09bi5jaGFyQ29kZUF0KGEpJiYoby5wdXNoKG4uc2xpY2UoYyxhKSksbnVsbCE9KHU9cGNbZT1uLmNoYXJBdCgrK2EpXSkmJihlPW4uY2hhckF0KCsrYSkpLChpPU5bZV0pJiYoZT1pKHQsbnVsbD09dT8iZSI9PT1lPyIgIjoiMCI6dSkpLG8ucHVzaChlKSxjPWErMSk7cmV0dXJuIG8ucHVzaChuLnNsaWNlKGMsYSkpLG8uam9pbigiIil9dmFyIHI9bi5sZW5ndGg7cmV0dXJuIHQucGFyc2U9ZnVuY3Rpb24odCl7dmFyIHI9e3k6MTkwMCxtOjAsZDoxLEg6MCxNOjAsUzowLEw6MCxaOm51bGx9LHU9ZShyLG4sdCwwKTtpZih1IT10Lmxlbmd0aClyZXR1cm4gbnVsbDsicCJpbiByJiYoci5IPXIuSCUxMisxMipyLnApO3ZhciBpPW51bGwhPXIuWiYmaGMhPT1qdCxvPW5ldyhpP2p0OmhjKTtyZXR1cm4iaiJpbiByP28uc2V0RnVsbFllYXIoci55LDAsci5qKToidyJpbiByJiYoIlciaW4gcnx8IlUiaW4gcik/KG8uc2V0RnVsbFllYXIoci55LDAsMSksby5zZXRGdWxsWWVhcihyLnksMCwiVyJpbiByPyhyLncrNiklNys3KnIuVy0oby5nZXREYXkoKSs1KSU3OnIudys3KnIuVS0oby5nZXREYXkoKSs2KSU3KSk6by5zZXRGdWxsWWVhcihyLnksci5tLHIuZCksby5zZXRIb3VycyhyLkgrKDB8ci5aLzEwMCksci5NK3IuWiUxMDAsci5TLHIuTCksaT9vLl86b30sdC50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiBufSx0fWZ1bmN0aW9uIGUobix0LGUscil7Zm9yKHZhciB1LGksbyxhPTAsYz10Lmxlbmd0aCxsPWUubGVuZ3RoO2M+YTspe2lmKHI+PWwpcmV0dXJuLTE7aWYodT10LmNoYXJDb2RlQXQoYSsrKSwzNz09PXUpe2lmKG89dC5jaGFyQXQoYSsrKSxpPUNbbyBpbiBwYz90LmNoYXJBdChhKyspOm9dLCFpfHwocj1pKG4sZSxyKSk8MClyZXR1cm4tMX1lbHNlIGlmKHUhPWUuY2hhckNvZGVBdChyKyspKXJldHVybi0xfXJldHVybiByfWZ1bmN0aW9uIHIobix0LGUpe18ubGFzdEluZGV4PTA7dmFyIHI9Xy5leGVjKHQuc2xpY2UoZSkpO3JldHVybiByPyhuLnc9dy5nZXQoclswXS50b0xvd2VyQ2FzZSgpKSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiB1KG4sdCxlKXt4Lmxhc3RJbmRleD0wO3ZhciByPXguZXhlYyh0LnNsaWNlKGUpKTtyZXR1cm4gcj8obi53PWIuZ2V0KHJbMF0udG9Mb3dlckNhc2UoKSksZStyWzBdLmxlbmd0aCk6LTF9ZnVuY3Rpb24gaShuLHQsZSl7RS5sYXN0SW5kZXg9MDt2YXIgcj1FLmV4ZWModC5zbGljZShlKSk7cmV0dXJuIHI/KG4ubT1BLmdldChyWzBdLnRvTG93ZXJDYXNlKCkpLGUrclswXS5sZW5ndGgpOi0xfWZ1bmN0aW9uIG8obix0LGUpe1MubGFzdEluZGV4PTA7dmFyIHI9Uy5leGVjKHQuc2xpY2UoZSkpO3JldHVybiByPyhuLm09ay5nZXQoclswXS50b0xvd2VyQ2FzZSgpKSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBhKG4sdCxyKXtyZXR1cm4gZShuLE4uYy50b1N0cmluZygpLHQscil9ZnVuY3Rpb24gYyhuLHQscil7cmV0dXJuIGUobixOLngudG9TdHJpbmcoKSx0LHIpfWZ1bmN0aW9uIGwobix0LHIpe3JldHVybiBlKG4sTi5YLnRvU3RyaW5nKCksdCxyKX1mdW5jdGlvbiBzKG4sdCxlKXt2YXIgcj1NLmdldCh0LnNsaWNlKGUsZSs9MikudG9Mb3dlckNhc2UoKSk7cmV0dXJuIG51bGw9PXI/LTE6KG4ucD1yLGUpfXZhciBmPW4uZGF0ZVRpbWUsaD1uLmRhdGUsZz1uLnRpbWUscD1uLnBlcmlvZHMsdj1uLmRheXMsZD1uLnNob3J0RGF5cyxtPW4ubW9udGhzLHk9bi5zaG9ydE1vbnRoczt0LnV0Yz1mdW5jdGlvbihuKXtmdW5jdGlvbiBlKG4pe3RyeXtoYz1qdDt2YXIgdD1uZXcgaGM7cmV0dXJuIHQuXz1uLHIodCl9ZmluYWxseXtoYz1EYXRlfX12YXIgcj10KG4pO3JldHVybiBlLnBhcnNlPWZ1bmN0aW9uKG4pe3RyeXtoYz1qdDt2YXIgdD1yLnBhcnNlKG4pO3JldHVybiB0JiZ0Ll99ZmluYWxseXtoYz1EYXRlfX0sZS50b1N0cmluZz1yLnRvU3RyaW5nLGV9LHQubXVsdGk9dC51dGMubXVsdGk9YWU7dmFyIE09dGEubWFwKCkseD1JdCh2KSxiPVp0KHYpLF89SXQoZCksdz1adChkKSxTPUl0KG0pLGs9WnQobSksRT1JdCh5KSxBPVp0KHkpO3AuZm9yRWFjaChmdW5jdGlvbihuLHQpe00uc2V0KG4udG9Mb3dlckNhc2UoKSx0KX0pO3ZhciBOPXthOmZ1bmN0aW9uKG4pe3JldHVybiBkW24uZ2V0RGF5KCldfSxBOmZ1bmN0aW9uKG4pe3JldHVybiB2W24uZ2V0RGF5KCldfSxiOmZ1bmN0aW9uKG4pe3JldHVybiB5W24uZ2V0TW9udGgoKV19LEI6ZnVuY3Rpb24obil7cmV0dXJuIG1bbi5nZXRNb250aCgpXX0sYzp0KGYpLGQ6ZnVuY3Rpb24obix0KXtyZXR1cm4gWXQobi5nZXREYXRlKCksdCwyKX0sZTpmdW5jdGlvbihuLHQpe3JldHVybiBZdChuLmdldERhdGUoKSx0LDIpfSxIOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIFl0KG4uZ2V0SG91cnMoKSx0LDIpfSxJOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIFl0KG4uZ2V0SG91cnMoKSUxMnx8MTIsdCwyKX0sajpmdW5jdGlvbihuLHQpe3JldHVybiBZdCgxK2ZjLmRheU9mWWVhcihuKSx0LDMpfSxMOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIFl0KG4uZ2V0TWlsbGlzZWNvbmRzKCksdCwzKX0sbTpmdW5jdGlvbihuLHQpe3JldHVybiBZdChuLmdldE1vbnRoKCkrMSx0LDIpfSxNOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIFl0KG4uZ2V0TWludXRlcygpLHQsMil9LHA6ZnVuY3Rpb24obil7cmV0dXJuIHBbKyhuLmdldEhvdXJzKCk+PTEyKV19LFM6ZnVuY3Rpb24obix0KXtyZXR1cm4gWXQobi5nZXRTZWNvbmRzKCksdCwyKX0sVTpmdW5jdGlvbihuLHQpe3JldHVybiBZdChmYy5zdW5kYXlPZlllYXIobiksdCwyKX0sdzpmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXREYXkoKX0sVzpmdW5jdGlvbihuLHQpe3JldHVybiBZdChmYy5tb25kYXlPZlllYXIobiksdCwyKX0seDp0KGgpLFg6dChnKSx5OmZ1bmN0aW9uKG4sdCl7cmV0dXJuIFl0KG4uZ2V0RnVsbFllYXIoKSUxMDAsdCwyKX0sWTpmdW5jdGlvbihuLHQpe3JldHVybiBZdChuLmdldEZ1bGxZZWFyKCklMWU0LHQsNCl9LFo6aWUsIiUiOmZ1bmN0aW9uKCl7cmV0dXJuIiUifX0sQz17YTpyLEE6dSxiOmksQjpvLGM6YSxkOlF0LGU6UXQsSDp0ZSxJOnRlLGo6bmUsTDp1ZSxtOkt0LE06ZWUscDpzLFM6cmUsVTpYdCx3OlZ0LFc6JHQseDpjLFg6bCx5Old0LFk6QnQsWjpKdCwiJSI6b2V9O3JldHVybiB0fWZ1bmN0aW9uIFl0KG4sdCxlKXt2YXIgcj0wPm4/Ii0iOiIiLHU9KHI/LW46bikrIiIsaT11Lmxlbmd0aDtyZXR1cm4gcisoZT5pP25ldyBBcnJheShlLWkrMSkuam9pbih0KSt1OnUpfWZ1bmN0aW9uIEl0KG4pe3JldHVybiBuZXcgUmVnRXhwKCJeKD86IituLm1hcCh0YS5yZXF1b3RlKS5qb2luKCJ8IikrIikiLCJpIil9ZnVuY3Rpb24gWnQobil7Zm9yKHZhciB0PW5ldyBhLGU9LTEscj1uLmxlbmd0aDsrK2U8cjspdC5zZXQobltlXS50b0xvd2VyQ2FzZSgpLGUpO3JldHVybiB0fWZ1bmN0aW9uIFZ0KG4sdCxlKXt2Yy5sYXN0SW5kZXg9MDt2YXIgcj12Yy5leGVjKHQuc2xpY2UoZSxlKzEpKTtyZXR1cm4gcj8obi53PStyWzBdLGUrclswXS5sZW5ndGgpOi0xfWZ1bmN0aW9uIFh0KG4sdCxlKXt2Yy5sYXN0SW5kZXg9MDt2YXIgcj12Yy5leGVjKHQuc2xpY2UoZSkpO3JldHVybiByPyhuLlU9K3JbMF0sZStyWzBdLmxlbmd0aCk6LTF9ZnVuY3Rpb24gJHQobix0LGUpe3ZjLmxhc3RJbmRleD0wO3ZhciByPXZjLmV4ZWModC5zbGljZShlKSk7cmV0dXJuIHI/KG4uVz0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBCdChuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSs0KSk7cmV0dXJuIHI/KG4ueT0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBXdChuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSsyKSk7cmV0dXJuIHI/KG4ueT1HdCgrclswXSksZStyWzBdLmxlbmd0aCk6LTF9ZnVuY3Rpb24gSnQobix0LGUpe3JldHVybi9eWystXVxkezR9JC8udGVzdCh0PXQuc2xpY2UoZSxlKzUpKT8obi5aPS10LGUrNSk6LTF9ZnVuY3Rpb24gR3Qobil7cmV0dXJuIG4rKG4+Njg/MTkwMDoyZTMpfWZ1bmN0aW9uIEt0KG4sdCxlKXt2Yy5sYXN0SW5kZXg9MDt2YXIgcj12Yy5leGVjKHQuc2xpY2UoZSxlKzIpKTtyZXR1cm4gcj8obi5tPXJbMF0tMSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBRdChuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSsyKSk7cmV0dXJuIHI/KG4uZD0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBuZShuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSszKSk7cmV0dXJuIHI/KG4uaj0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiB0ZShuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSsyKSk7cmV0dXJuIHI/KG4uSD0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBlZShuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSsyKSk7cmV0dXJuIHI/KG4uTT0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiByZShuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSsyKSk7cmV0dXJuIHI/KG4uUz0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiB1ZShuLHQsZSl7dmMubGFzdEluZGV4PTA7dmFyIHI9dmMuZXhlYyh0LnNsaWNlKGUsZSszKSk7cmV0dXJuIHI/KG4uTD0rclswXSxlK3JbMF0ubGVuZ3RoKTotMX1mdW5jdGlvbiBpZShuKXt2YXIgdD1uLmdldFRpbWV6b25lT2Zmc2V0KCksZT10PjA/Ii0iOiIrIixyPTB8dmEodCkvNjAsdT12YSh0KSU2MDtyZXR1cm4gZStZdChyLCIwIiwyKStZdCh1LCIwIiwyKX1mdW5jdGlvbiBvZShuLHQsZSl7ZGMubGFzdEluZGV4PTA7dmFyIHI9ZGMuZXhlYyh0LnNsaWNlKGUsZSsxKSk7cmV0dXJuIHI/ZStyWzBdLmxlbmd0aDotMX1mdW5jdGlvbiBhZShuKXtmb3IodmFyIHQ9bi5sZW5ndGgsZT0tMTsrK2U8dDspbltlXVswXT10aGlzKG5bZV1bMF0pO3JldHVybiBmdW5jdGlvbih0KXtmb3IodmFyIGU9MCxyPW5bZV07IXJbMV0odCk7KXI9blsrK2VdO3JldHVybiByWzBdKHQpfX1mdW5jdGlvbiBjZSgpe31mdW5jdGlvbiBsZShuLHQsZSl7dmFyIHI9ZS5zPW4rdCx1PXItbixpPXItdTtlLnQ9bi1pKyh0LXUpfWZ1bmN0aW9uIHNlKG4sdCl7biYmeGMuaGFzT3duUHJvcGVydHkobi50eXBlKSYmeGNbbi50eXBlXShuLHQpfWZ1bmN0aW9uIGZlKG4sdCxlKXt2YXIgcix1PS0xLGk9bi5sZW5ndGgtZTtmb3IodC5saW5lU3RhcnQoKTsrK3U8aTspcj1uW3VdLHQucG9pbnQoclswXSxyWzFdLHJbMl0pO3QubGluZUVuZCgpfWZ1bmN0aW9uIGhlKG4sdCl7dmFyIGU9LTEscj1uLmxlbmd0aDtmb3IodC5wb2x5Z29uU3RhcnQoKTsrK2U8cjspZmUobltlXSx0LDEpO3QucG9seWdvbkVuZCgpfWZ1bmN0aW9uIGdlKCl7ZnVuY3Rpb24gbihuLHQpe24qPUZhLHQ9dCpGYS8yK0RhLzQ7dmFyIGU9bi1yLG89ZT49MD8xOi0xLGE9byplLGM9TWF0aC5jb3ModCksbD1NYXRoLnNpbih0KSxzPWkqbCxmPXUqYytzKk1hdGguY29zKGEpLGg9cypvKk1hdGguc2luKGEpO19jLmFkZChNYXRoLmF0YW4yKGgsZikpLHI9bix1PWMsaT1sfXZhciB0LGUscix1LGk7d2MucG9pbnQ9ZnVuY3Rpb24obyxhKXt3Yy5wb2ludD1uLHI9KHQ9bykqRmEsdT1NYXRoLmNvcyhhPShlPWEpKkZhLzIrRGEvNCksaT1NYXRoLnNpbihhKX0sd2MubGluZUVuZD1mdW5jdGlvbigpe24odCxlKX19ZnVuY3Rpb24gcGUobil7dmFyIHQ9blswXSxlPW5bMV0scj1NYXRoLmNvcyhlKTtyZXR1cm5bcipNYXRoLmNvcyh0KSxyKk1hdGguc2luKHQpLE1hdGguc2luKGUpXX1mdW5jdGlvbiB2ZShuLHQpe3JldHVybiBuWzBdKnRbMF0rblsxXSp0WzFdK25bMl0qdFsyXX1mdW5jdGlvbiBkZShuLHQpe3JldHVybltuWzFdKnRbMl0tblsyXSp0WzFdLG5bMl0qdFswXS1uWzBdKnRbMl0sblswXSp0WzFdLW5bMV0qdFswXV19ZnVuY3Rpb24gbWUobix0KXtuWzBdKz10WzBdLG5bMV0rPXRbMV0sblsyXSs9dFsyXX1mdW5jdGlvbiB5ZShuLHQpe3JldHVybltuWzBdKnQsblsxXSp0LG5bMl0qdF19ZnVuY3Rpb24gTWUobil7dmFyIHQ9TWF0aC5zcXJ0KG5bMF0qblswXStuWzFdKm5bMV0rblsyXSpuWzJdKTtuWzBdLz10LG5bMV0vPXQsblsyXS89dH1mdW5jdGlvbiB4ZShuKXtyZXR1cm5bTWF0aC5hdGFuMihuWzFdLG5bMF0pLG50KG5bMl0pXX1mdW5jdGlvbiBiZShuLHQpe3JldHVybiB2YShuWzBdLXRbMF0pPFRhJiZ2YShuWzFdLXRbMV0pPFRhfWZ1bmN0aW9uIF9lKG4sdCl7bio9RmE7dmFyIGU9TWF0aC5jb3ModCo9RmEpO3dlKGUqTWF0aC5jb3MobiksZSpNYXRoLnNpbihuKSxNYXRoLnNpbih0KSl9ZnVuY3Rpb24gd2Uobix0LGUpeysrU2MsRWMrPShuLUVjKS9TYyxBYys9KHQtQWMpL1NjLE5jKz0oZS1OYykvU2N9ZnVuY3Rpb24gU2UoKXtmdW5jdGlvbiBuKG4sdSl7bio9RmE7dmFyIGk9TWF0aC5jb3ModSo9RmEpLG89aSpNYXRoLmNvcyhuKSxhPWkqTWF0aC5zaW4obiksYz1NYXRoLnNpbih1KSxsPU1hdGguYXRhbjIoTWF0aC5zcXJ0KChsPWUqYy1yKmEpKmwrKGw9cipvLXQqYykqbCsobD10KmEtZSpvKSpsKSx0Km8rZSphK3IqYyk7a2MrPWwsQ2MrPWwqKHQrKHQ9bykpLHpjKz1sKihlKyhlPWEpKSxxYys9bCoocisocj1jKSksd2UodCxlLHIpfXZhciB0LGUscjtEYy5wb2ludD1mdW5jdGlvbih1LGkpe3UqPUZhO3ZhciBvPU1hdGguY29zKGkqPUZhKTt0PW8qTWF0aC5jb3ModSksZT1vKk1hdGguc2luKHUpLHI9TWF0aC5zaW4oaSksRGMucG9pbnQ9bix3ZSh0LGUscil9fWZ1bmN0aW9uIGtlKCl7RGMucG9pbnQ9X2V9ZnVuY3Rpb24gRWUoKXtmdW5jdGlvbiBuKG4sdCl7bio9RmE7dmFyIGU9TWF0aC5jb3ModCo9RmEpLG89ZSpNYXRoLmNvcyhuKSxhPWUqTWF0aC5zaW4obiksYz1NYXRoLnNpbih0KSxsPXUqYy1pKmEscz1pKm8tcipjLGY9ciphLXUqbyxoPU1hdGguc3FydChsKmwrcypzK2YqZiksZz1yKm8rdSphK2kqYyxwPWgmJi1RKGcpL2gsdj1NYXRoLmF0YW4yKGgsZyk7TGMrPXAqbCxUYys9cCpzLFJjKz1wKmYsa2MrPXYsQ2MrPXYqKHIrKHI9bykpLHpjKz12Kih1Kyh1PWEpKSxxYys9diooaSsoaT1jKSksd2Uocix1LGkpfXZhciB0LGUscix1LGk7RGMucG9pbnQ9ZnVuY3Rpb24obyxhKXt0PW8sZT1hLERjLnBvaW50PW4sbyo9RmE7dmFyIGM9TWF0aC5jb3MoYSo9RmEpO3I9YypNYXRoLmNvcyhvKSx1PWMqTWF0aC5zaW4obyksaT1NYXRoLnNpbihhKSx3ZShyLHUsaSl9LERjLmxpbmVFbmQ9ZnVuY3Rpb24oKXtuKHQsZSksRGMubGluZUVuZD1rZSxEYy5wb2ludD1fZX19ZnVuY3Rpb24gQWUobix0KXtmdW5jdGlvbiBlKGUscil7cmV0dXJuIGU9bihlLHIpLHQoZVswXSxlWzFdKX1yZXR1cm4gbi5pbnZlcnQmJnQuaW52ZXJ0JiYoZS5pbnZlcnQ9ZnVuY3Rpb24oZSxyKXtyZXR1cm4gZT10LmludmVydChlLHIpLGUmJm4uaW52ZXJ0KGVbMF0sZVsxXSl9KSxlfWZ1bmN0aW9uIE5lKCl7cmV0dXJuITB9ZnVuY3Rpb24gQ2Uobix0LGUscix1KXt2YXIgaT1bXSxvPVtdO2lmKG4uZm9yRWFjaChmdW5jdGlvbihuKXtpZighKCh0PW4ubGVuZ3RoLTEpPD0wKSl7dmFyIHQsZT1uWzBdLHI9blt0XTtpZihiZShlLHIpKXt1LmxpbmVTdGFydCgpO2Zvcih2YXIgYT0wO3Q+YTsrK2EpdS5wb2ludCgoZT1uW2FdKVswXSxlWzFdKTtyZXR1cm4gdS5saW5lRW5kKCksdm9pZCAwfXZhciBjPW5ldyBxZShlLG4sbnVsbCwhMCksbD1uZXcgcWUoZSxudWxsLGMsITEpO2Mubz1sLGkucHVzaChjKSxvLnB1c2gobCksYz1uZXcgcWUocixuLG51bGwsITEpLGw9bmV3IHFlKHIsbnVsbCxjLCEwKSxjLm89bCxpLnB1c2goYyksby5wdXNoKGwpfX0pLG8uc29ydCh0KSx6ZShpKSx6ZShvKSxpLmxlbmd0aCl7Zm9yKHZhciBhPTAsYz1lLGw9by5sZW5ndGg7bD5hOysrYSlvW2FdLmU9Yz0hYztmb3IodmFyIHMsZixoPWlbMF07Oyl7Zm9yKHZhciBnPWgscD0hMDtnLnY7KWlmKChnPWcubik9PT1oKXJldHVybjtzPWcueix1LmxpbmVTdGFydCgpO2Rve2lmKGcudj1nLm8udj0hMCxnLmUpe2lmKHApZm9yKHZhciBhPTAsbD1zLmxlbmd0aDtsPmE7KythKXUucG9pbnQoKGY9c1thXSlbMF0sZlsxXSk7ZWxzZSByKGcueCxnLm4ueCwxLHUpO2c9Zy5ufWVsc2V7aWYocCl7cz1nLnAuejtmb3IodmFyIGE9cy5sZW5ndGgtMTthPj0wOy0tYSl1LnBvaW50KChmPXNbYV0pWzBdLGZbMV0pfWVsc2UgcihnLngsZy5wLngsLTEsdSk7Zz1nLnB9Zz1nLm8scz1nLnoscD0hcH13aGlsZSghZy52KTt1LmxpbmVFbmQoKX19fWZ1bmN0aW9uIHplKG4pe2lmKHQ9bi5sZW5ndGgpe2Zvcih2YXIgdCxlLHI9MCx1PW5bMF07KytyPHQ7KXUubj1lPW5bcl0sZS5wPXUsdT1lO3Uubj1lPW5bMF0sZS5wPXV9fWZ1bmN0aW9uIHFlKG4sdCxlLHIpe3RoaXMueD1uLHRoaXMuej10LHRoaXMubz1lLHRoaXMuZT1yLHRoaXMudj0hMSx0aGlzLm49dGhpcy5wPW51bGx9ZnVuY3Rpb24gTGUobix0LGUscil7cmV0dXJuIGZ1bmN0aW9uKHUsaSl7ZnVuY3Rpb24gbyh0LGUpe3ZhciByPXUodCxlKTtuKHQ9clswXSxlPXJbMV0pJiZpLnBvaW50KHQsZSl9ZnVuY3Rpb24gYShuLHQpe3ZhciBlPXUobix0KTtkLnBvaW50KGVbMF0sZVsxXSl9ZnVuY3Rpb24gYygpe3kucG9pbnQ9YSxkLmxpbmVTdGFydCgpfWZ1bmN0aW9uIGwoKXt5LnBvaW50PW8sZC5saW5lRW5kKCl9ZnVuY3Rpb24gcyhuLHQpe3YucHVzaChbbix0XSk7dmFyIGU9dShuLHQpO3gucG9pbnQoZVswXSxlWzFdKX1mdW5jdGlvbiBmKCl7eC5saW5lU3RhcnQoKSx2PVtdfWZ1bmN0aW9uIGgoKXtzKHZbMF1bMF0sdlswXVsxXSkseC5saW5lRW5kKCk7dmFyIG4sdD14LmNsZWFuKCksZT1NLmJ1ZmZlcigpLHI9ZS5sZW5ndGg7aWYodi5wb3AoKSxwLnB1c2godiksdj1udWxsLHIpaWYoMSZ0KXtuPWVbMF07dmFyIHUscj1uLmxlbmd0aC0xLG89LTE7aWYocj4wKXtmb3IoYnx8KGkucG9seWdvblN0YXJ0KCksYj0hMCksaS5saW5lU3RhcnQoKTsrK288cjspaS5wb2ludCgodT1uW29dKVswXSx1WzFdKTtpLmxpbmVFbmQoKX19ZWxzZSByPjEmJjImdCYmZS5wdXNoKGUucG9wKCkuY29uY2F0KGUuc2hpZnQoKSkpLGcucHVzaChlLmZpbHRlcihUZSkpfXZhciBnLHAsdixkPXQoaSksbT11LmludmVydChyWzBdLHJbMV0pLHk9e3BvaW50Om8sbGluZVN0YXJ0OmMsbGluZUVuZDpsLHBvbHlnb25TdGFydDpmdW5jdGlvbigpe3kucG9pbnQ9cyx5LmxpbmVTdGFydD1mLHkubGluZUVuZD1oLGc9W10scD1bXX0scG9seWdvbkVuZDpmdW5jdGlvbigpe3kucG9pbnQ9byx5LmxpbmVTdGFydD1jLHkubGluZUVuZD1sLGc9dGEubWVyZ2UoZyk7dmFyIG49RmUobSxwKTtnLmxlbmd0aD8oYnx8KGkucG9seWdvblN0YXJ0KCksYj0hMCksQ2UoZyxEZSxuLGUsaSkpOm4mJihifHwoaS5wb2x5Z29uU3RhcnQoKSxiPSEwKSxpLmxpbmVTdGFydCgpLGUobnVsbCxudWxsLDEsaSksaS5saW5lRW5kKCkpLGImJihpLnBvbHlnb25FbmQoKSxiPSExKSxnPXA9bnVsbH0sc3BoZXJlOmZ1bmN0aW9uKCl7aS5wb2x5Z29uU3RhcnQoKSxpLmxpbmVTdGFydCgpLGUobnVsbCxudWxsLDEsaSksaS5saW5lRW5kKCksaS5wb2x5Z29uRW5kKCl9fSxNPVJlKCkseD10KE0pLGI9ITE7cmV0dXJuIHl9fWZ1bmN0aW9uIFRlKG4pe3JldHVybiBuLmxlbmd0aD4xfWZ1bmN0aW9uIFJlKCl7dmFyIG4sdD1bXTtyZXR1cm57bGluZVN0YXJ0OmZ1bmN0aW9uKCl7dC5wdXNoKG49W10pfSxwb2ludDpmdW5jdGlvbih0LGUpe24ucHVzaChbdCxlXSl9LGxpbmVFbmQ6eSxidWZmZXI6ZnVuY3Rpb24oKXt2YXIgZT10O3JldHVybiB0PVtdLG49bnVsbCxlfSxyZWpvaW46ZnVuY3Rpb24oKXt0Lmxlbmd0aD4xJiZ0LnB1c2godC5wb3AoKS5jb25jYXQodC5zaGlmdCgpKSl9fX1mdW5jdGlvbiBEZShuLHQpe3JldHVybigobj1uLngpWzBdPDA/blsxXS1qYS1UYTpqYS1uWzFdKS0oKHQ9dC54KVswXTwwP3RbMV0tamEtVGE6amEtdFsxXSl9ZnVuY3Rpb24gUGUobil7dmFyIHQsZT0wLzAscj0wLzAsdT0wLzA7cmV0dXJue2xpbmVTdGFydDpmdW5jdGlvbigpe24ubGluZVN0YXJ0KCksdD0xfSxwb2ludDpmdW5jdGlvbihpLG8pe3ZhciBhPWk+MD9EYTotRGEsYz12YShpLWUpO3ZhKGMtRGEpPFRhPyhuLnBvaW50KGUscj0ocitvKS8yPjA/amE6LWphKSxuLnBvaW50KHUsciksbi5saW5lRW5kKCksbi5saW5lU3RhcnQoKSxuLnBvaW50KGEsciksbi5wb2ludChpLHIpLHQ9MCk6dSE9PWEmJmM+PURhJiYodmEoZS11KTxUYSYmKGUtPXUqVGEpLHZhKGktYSk8VGEmJihpLT1hKlRhKSxyPVVlKGUscixpLG8pLG4ucG9pbnQodSxyKSxuLmxpbmVFbmQoKSxuLmxpbmVTdGFydCgpLG4ucG9pbnQoYSxyKSx0PTApLG4ucG9pbnQoZT1pLHI9byksdT1hfSxsaW5lRW5kOmZ1bmN0aW9uKCl7bi5saW5lRW5kKCksZT1yPTAvMH0sY2xlYW46ZnVuY3Rpb24oKXtyZXR1cm4gMi10fX19ZnVuY3Rpb24gVWUobix0LGUscil7dmFyIHUsaSxvPU1hdGguc2luKG4tZSk7cmV0dXJuIHZhKG8pPlRhP01hdGguYXRhbigoTWF0aC5zaW4odCkqKGk9TWF0aC5jb3MocikpKk1hdGguc2luKGUpLU1hdGguc2luKHIpKih1PU1hdGguY29zKHQpKSpNYXRoLnNpbihuKSkvKHUqaSpvKSk6KHQrcikvMn1mdW5jdGlvbiBqZShuLHQsZSxyKXt2YXIgdTtpZihudWxsPT1uKXU9ZSpqYSxyLnBvaW50KC1EYSx1KSxyLnBvaW50KDAsdSksci5wb2ludChEYSx1KSxyLnBvaW50KERhLDApLHIucG9pbnQoRGEsLXUpLHIucG9pbnQoMCwtdSksci5wb2ludCgtRGEsLXUpLHIucG9pbnQoLURhLDApLHIucG9pbnQoLURhLHUpO2Vsc2UgaWYodmEoblswXS10WzBdKT5UYSl7dmFyIGk9blswXTx0WzBdP0RhOi1EYTt1PWUqaS8yLHIucG9pbnQoLWksdSksci5wb2ludCgwLHUpLHIucG9pbnQoaSx1KX1lbHNlIHIucG9pbnQodFswXSx0WzFdKX1mdW5jdGlvbiBGZShuLHQpe3ZhciBlPW5bMF0scj1uWzFdLHU9W01hdGguc2luKGUpLC1NYXRoLmNvcyhlKSwwXSxpPTAsbz0wO19jLnJlc2V0KCk7Zm9yKHZhciBhPTAsYz10Lmxlbmd0aDtjPmE7KythKXt2YXIgbD10W2FdLHM9bC5sZW5ndGg7aWYocylmb3IodmFyIGY9bFswXSxoPWZbMF0sZz1mWzFdLzIrRGEvNCxwPU1hdGguc2luKGcpLHY9TWF0aC5jb3MoZyksZD0xOzspe2Q9PT1zJiYoZD0wKSxuPWxbZF07dmFyIG09blswXSx5PW5bMV0vMitEYS80LE09TWF0aC5zaW4oeSkseD1NYXRoLmNvcyh5KSxiPW0taCxfPWI+PTA/MTotMSx3PV8qYixTPXc+RGEsaz1wKk07aWYoX2MuYWRkKE1hdGguYXRhbjIoaypfKk1hdGguc2luKHcpLHYqeCtrKk1hdGguY29zKHcpKSksaSs9Uz9iK18qUGE6YixTXmg+PWVebT49ZSl7dmFyIEU9ZGUocGUoZikscGUobikpO01lKEUpO3ZhciBBPWRlKHUsRSk7TWUoQSk7dmFyIE49KFNeYj49MD8tMToxKSpudChBWzJdKTsocj5OfHxyPT09TiYmKEVbMF18fEVbMV0pKSYmKG8rPVNeYj49MD8xOi0xKX1pZighZCsrKWJyZWFrO2g9bSxwPU0sdj14LGY9bn19cmV0dXJuKC1UYT5pfHxUYT5pJiYwPl9jKV4xJm99ZnVuY3Rpb24gSGUobil7ZnVuY3Rpb24gdChuLHQpe3JldHVybiBNYXRoLmNvcyhuKSpNYXRoLmNvcyh0KT5pfWZ1bmN0aW9uIGUobil7dmFyIGUsaSxjLGwscztyZXR1cm57bGluZVN0YXJ0OmZ1bmN0aW9uKCl7bD1jPSExLHM9MX0scG9pbnQ6ZnVuY3Rpb24oZixoKXt2YXIgZyxwPVtmLGhdLHY9dChmLGgpLGQ9bz92PzA6dShmLGgpOnY/dShmKygwPmY/RGE6LURhKSxoKTowO2lmKCFlJiYobD1jPXYpJiZuLmxpbmVTdGFydCgpLHYhPT1jJiYoZz1yKGUscCksKGJlKGUsZyl8fGJlKHAsZykpJiYocFswXSs9VGEscFsxXSs9VGEsdj10KHBbMF0scFsxXSkpKSx2IT09YylzPTAsdj8obi5saW5lU3RhcnQoKSxnPXIocCxlKSxuLnBvaW50KGdbMF0sZ1sxXSkpOihnPXIoZSxwKSxuLnBvaW50KGdbMF0sZ1sxXSksbi5saW5lRW5kKCkpLGU9ZztlbHNlIGlmKGEmJmUmJm9edil7dmFyIG07ZCZpfHwhKG09cihwLGUsITApKXx8KHM9MCxvPyhuLmxpbmVTdGFydCgpLG4ucG9pbnQobVswXVswXSxtWzBdWzFdKSxuLnBvaW50KG1bMV1bMF0sbVsxXVsxXSksbi5saW5lRW5kKCkpOihuLnBvaW50KG1bMV1bMF0sbVsxXVsxXSksbi5saW5lRW5kKCksbi5saW5lU3RhcnQoKSxuLnBvaW50KG1bMF1bMF0sbVswXVsxXSkpKX0hdnx8ZSYmYmUoZSxwKXx8bi5wb2ludChwWzBdLHBbMV0pLGU9cCxjPXYsaT1kfSxsaW5lRW5kOmZ1bmN0aW9uKCl7YyYmbi5saW5lRW5kKCksZT1udWxsfSxjbGVhbjpmdW5jdGlvbigpe3JldHVybiBzfChsJiZjKTw8MX19fWZ1bmN0aW9uIHIobix0LGUpe3ZhciByPXBlKG4pLHU9cGUodCksbz1bMSwwLDBdLGE9ZGUocix1KSxjPXZlKGEsYSksbD1hWzBdLHM9Yy1sKmw7aWYoIXMpcmV0dXJuIWUmJm47dmFyIGY9aSpjL3MsaD0taSpsL3MsZz1kZShvLGEpLHA9eWUobyxmKSx2PXllKGEsaCk7bWUocCx2KTt2YXIgZD1nLG09dmUocCxkKSx5PXZlKGQsZCksTT1tKm0teSoodmUocCxwKS0xKTtpZighKDA+TSkpe3ZhciB4PU1hdGguc3FydChNKSxiPXllKGQsKC1tLXgpL3kpO2lmKG1lKGIscCksYj14ZShiKSwhZSlyZXR1cm4gYjt2YXIgXyx3PW5bMF0sUz10WzBdLGs9blsxXSxFPXRbMV07dz5TJiYoXz13LHc9UyxTPV8pO3ZhciBBPVMtdyxOPXZhKEEtRGEpPFRhLEM9Tnx8VGE+QTtpZighTiYmaz5FJiYoXz1rLGs9RSxFPV8pLEM/Tj9rK0U+MF5iWzFdPCh2YShiWzBdLXcpPFRhP2s6RSk6azw9YlsxXSYmYlsxXTw9RTpBPkRhXih3PD1iWzBdJiZiWzBdPD1TKSl7dmFyIHo9eWUoZCwoLW0reCkveSk7cmV0dXJuIG1lKHoscCksW2IseGUoeildfX19ZnVuY3Rpb24gdSh0LGUpe3ZhciByPW8/bjpEYS1uLHU9MDtyZXR1cm4tcj50P3V8PTE6dD5yJiYodXw9MiksLXI+ZT91fD00OmU+ciYmKHV8PTgpLHV9dmFyIGk9TWF0aC5jb3Mobiksbz1pPjAsYT12YShpKT5UYSxjPWdyKG4sNipGYSk7cmV0dXJuIExlKHQsZSxjLG8/WzAsLW5dOlstRGEsbi1EYV0pfWZ1bmN0aW9uIE9lKG4sdCxlLHIpe3JldHVybiBmdW5jdGlvbih1KXt2YXIgaSxvPXUuYSxhPXUuYixjPW8ueCxsPW8ueSxzPWEueCxmPWEueSxoPTAsZz0xLHA9cy1jLHY9Zi1sO2lmKGk9bi1jLHB8fCEoaT4wKSl7aWYoaS89cCwwPnApe2lmKGg+aSlyZXR1cm47Zz5pJiYoZz1pKX1lbHNlIGlmKHA+MCl7aWYoaT5nKXJldHVybjtpPmgmJihoPWkpfWlmKGk9ZS1jLHB8fCEoMD5pKSl7aWYoaS89cCwwPnApe2lmKGk+ZylyZXR1cm47aT5oJiYoaD1pKX1lbHNlIGlmKHA+MCl7aWYoaD5pKXJldHVybjtnPmkmJihnPWkpfWlmKGk9dC1sLHZ8fCEoaT4wKSl7aWYoaS89diwwPnYpe2lmKGg+aSlyZXR1cm47Zz5pJiYoZz1pKX1lbHNlIGlmKHY+MCl7aWYoaT5nKXJldHVybjtpPmgmJihoPWkpfWlmKGk9ci1sLHZ8fCEoMD5pKSl7aWYoaS89diwwPnYpe2lmKGk+ZylyZXR1cm47aT5oJiYoaD1pKX1lbHNlIGlmKHY+MCl7aWYoaD5pKXJldHVybjtnPmkmJihnPWkpfXJldHVybiBoPjAmJih1LmE9e3g6YytoKnAseTpsK2gqdn0pLDE+ZyYmKHUuYj17eDpjK2cqcCx5OmwrZyp2fSksdX19fX19fWZ1bmN0aW9uIFllKG4sdCxlLHIpe2Z1bmN0aW9uIHUocix1KXtyZXR1cm4gdmEoclswXS1uKTxUYT91PjA/MDozOnZhKHJbMF0tZSk8VGE/dT4wPzI6MTp2YShyWzFdLXQpPFRhP3U+MD8xOjA6dT4wPzM6Mn1mdW5jdGlvbiBpKG4sdCl7cmV0dXJuIG8obi54LHQueCl9ZnVuY3Rpb24gbyhuLHQpe3ZhciBlPXUobiwxKSxyPXUodCwxKTtyZXR1cm4gZSE9PXI/ZS1yOjA9PT1lP3RbMV0tblsxXToxPT09ZT9uWzBdLXRbMF06Mj09PWU/blsxXS10WzFdOnRbMF0tblswXX1yZXR1cm4gZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYyhuKXtmb3IodmFyIHQ9MCxlPWQubGVuZ3RoLHI9blsxXSx1PTA7ZT51OysrdSlmb3IodmFyIGksbz0xLGE9ZFt1XSxjPWEubGVuZ3RoLGw9YVswXTtjPm87KytvKWk9YVtvXSxsWzFdPD1yP2lbMV0+ciYmSyhsLGksbik+MCYmKyt0OmlbMV08PXImJksobCxpLG4pPDAmJi0tdCxsPWk7cmV0dXJuIDAhPT10fWZ1bmN0aW9uIGwoaSxhLGMsbCl7dmFyIHM9MCxmPTA7aWYobnVsbD09aXx8KHM9dShpLGMpKSE9PShmPXUoYSxjKSl8fG8oaSxhKTwwXmM+MCl7ZG8gbC5wb2ludCgwPT09c3x8Mz09PXM/bjplLHM+MT9yOnQpO3doaWxlKChzPShzK2MrNCklNCkhPT1mKX1lbHNlIGwucG9pbnQoYVswXSxhWzFdKX1mdW5jdGlvbiBzKHUsaSl7cmV0dXJuIHU+PW4mJmU+PXUmJmk+PXQmJnI+PWl9ZnVuY3Rpb24gZihuLHQpe3Mobix0KSYmYS5wb2ludChuLHQpfWZ1bmN0aW9uIGgoKXtDLnBvaW50PXAsZCYmZC5wdXNoKG09W10pLFM9ITAsdz0hMSxiPV89MC8wfWZ1bmN0aW9uIGcoKXt2JiYocCh5LE0pLHgmJncmJkEucmVqb2luKCksdi5wdXNoKEEuYnVmZmVyKCkpKSxDLnBvaW50PWYsdyYmYS5saW5lRW5kKCl9ZnVuY3Rpb24gcChuLHQpe249TWF0aC5tYXgoLVVjLE1hdGgubWluKFVjLG4pKSx0PU1hdGgubWF4KC1VYyxNYXRoLm1pbihVYyx0KSk7dmFyIGU9cyhuLHQpO2lmKGQmJm0ucHVzaChbbix0XSksUyl5PW4sTT10LHg9ZSxTPSExLGUmJihhLmxpbmVTdGFydCgpLGEucG9pbnQobix0KSk7ZWxzZSBpZihlJiZ3KWEucG9pbnQobix0KTtlbHNle3ZhciByPXthOnt4OmIseTpffSxiOnt4Om4seTp0fX07TihyKT8od3x8KGEubGluZVN0YXJ0KCksYS5wb2ludChyLmEueCxyLmEueSkpLGEucG9pbnQoci5iLngsci5iLnkpLGV8fGEubGluZUVuZCgpLGs9ITEpOmUmJihhLmxpbmVTdGFydCgpLGEucG9pbnQobix0KSxrPSExKX1iPW4sXz10LHc9ZX12YXIgdixkLG0seSxNLHgsYixfLHcsUyxrLEU9YSxBPVJlKCksTj1PZShuLHQsZSxyKSxDPXtwb2ludDpmLGxpbmVTdGFydDpoLGxpbmVFbmQ6Zyxwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXthPUEsdj1bXSxkPVtdLGs9ITB9LHBvbHlnb25FbmQ6ZnVuY3Rpb24oKXthPUUsdj10YS5tZXJnZSh2KTt2YXIgdD1jKFtuLHJdKSxlPWsmJnQsdT12Lmxlbmd0aDsoZXx8dSkmJihhLnBvbHlnb25TdGFydCgpLGUmJihhLmxpbmVTdGFydCgpLGwobnVsbCxudWxsLDEsYSksYS5saW5lRW5kKCkpLHUmJkNlKHYsaSx0LGwsYSksYS5wb2x5Z29uRW5kKCkpLHY9ZD1tPW51bGx9fTtyZXR1cm4gQ319ZnVuY3Rpb24gSWUobil7dmFyIHQ9MCxlPURhLzMscj1pcihuKSx1PXIodCxlKTtyZXR1cm4gdS5wYXJhbGxlbHM9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/cih0PW5bMF0qRGEvMTgwLGU9blsxXSpEYS8xODApOlsxODAqKHQvRGEpLDE4MCooZS9EYSldfSx1fWZ1bmN0aW9uIFplKG4sdCl7ZnVuY3Rpb24gZShuLHQpe3ZhciBlPU1hdGguc3FydChpLTIqdSpNYXRoLnNpbih0KSkvdTtyZXR1cm5bZSpNYXRoLnNpbihuKj11KSxvLWUqTWF0aC5jb3MobildfXZhciByPU1hdGguc2luKG4pLHU9KHIrTWF0aC5zaW4odCkpLzIsaT0xK3IqKDIqdS1yKSxvPU1hdGguc3FydChpKS91O3JldHVybiBlLmludmVydD1mdW5jdGlvbihuLHQpe3ZhciBlPW8tdDtyZXR1cm5bTWF0aC5hdGFuMihuLGUpL3UsbnQoKGktKG4qbitlKmUpKnUqdSkvKDIqdSkpXX0sZX1mdW5jdGlvbiBWZSgpe2Z1bmN0aW9uIG4obix0KXtGYys9dSpuLXIqdCxyPW4sdT10fXZhciB0LGUscix1O1pjLnBvaW50PWZ1bmN0aW9uKGksbyl7WmMucG9pbnQ9bix0PXI9aSxlPXU9b30sWmMubGluZUVuZD1mdW5jdGlvbigpe24odCxlKX19ZnVuY3Rpb24gWGUobix0KXtIYz5uJiYoSGM9biksbj5ZYyYmKFljPW4pLE9jPnQmJihPYz10KSx0PkljJiYoSWM9dCl9ZnVuY3Rpb24gJGUoKXtmdW5jdGlvbiBuKG4sdCl7by5wdXNoKCJNIixuLCIsIix0LGkpfWZ1bmN0aW9uIHQobix0KXtvLnB1c2goIk0iLG4sIiwiLHQpLGEucG9pbnQ9ZX1mdW5jdGlvbiBlKG4sdCl7by5wdXNoKCJMIixuLCIsIix0KX1mdW5jdGlvbiByKCl7YS5wb2ludD1ufWZ1bmN0aW9uIHUoKXtvLnB1c2goIloiKX12YXIgaT1CZSg0LjUpLG89W10sYT17cG9pbnQ6bixsaW5lU3RhcnQ6ZnVuY3Rpb24oKXthLnBvaW50PXR9LGxpbmVFbmQ6cixwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXthLmxpbmVFbmQ9dX0scG9seWdvbkVuZDpmdW5jdGlvbigpe2EubGluZUVuZD1yLGEucG9pbnQ9bn0scG9pbnRSYWRpdXM6ZnVuY3Rpb24obil7cmV0dXJuIGk9QmUobiksYX0scmVzdWx0OmZ1bmN0aW9uKCl7aWYoby5sZW5ndGgpe3ZhciBuPW8uam9pbigiIik7cmV0dXJuIG89W10sbn19fTtyZXR1cm4gYX1mdW5jdGlvbiBCZShuKXtyZXR1cm4ibTAsIituKyJhIituKyIsIituKyIgMCAxLDEgMCwiKy0yKm4rImEiK24rIiwiK24rIiAwIDEsMSAwLCIrMipuKyJ6In1mdW5jdGlvbiBXZShuLHQpe0VjKz1uLEFjKz10LCsrTmN9ZnVuY3Rpb24gSmUoKXtmdW5jdGlvbiBuKG4scil7dmFyIHU9bi10LGk9ci1lLG89TWF0aC5zcXJ0KHUqdStpKmkpO0NjKz1vKih0K24pLzIsemMrPW8qKGUrcikvMixxYys9byxXZSh0PW4sZT1yKX12YXIgdCxlO1hjLnBvaW50PWZ1bmN0aW9uKHIsdSl7WGMucG9pbnQ9bixXZSh0PXIsZT11KX19ZnVuY3Rpb24gR2UoKXtYYy5wb2ludD1XZX1mdW5jdGlvbiBLZSgpe2Z1bmN0aW9uIG4obix0KXt2YXIgZT1uLXIsaT10LXUsbz1NYXRoLnNxcnQoZSplK2kqaSk7Q2MrPW8qKHIrbikvMix6Yys9byoodSt0KS8yLHFjKz1vLG89dSpuLXIqdCxMYys9byoocituKSxUYys9byoodSt0KSxSYys9MypvLFdlKHI9bix1PXQpfXZhciB0LGUscix1O1hjLnBvaW50PWZ1bmN0aW9uKGksbyl7WGMucG9pbnQ9bixXZSh0PXI9aSxlPXU9byl9LFhjLmxpbmVFbmQ9ZnVuY3Rpb24oKXtuKHQsZSl9fWZ1bmN0aW9uIFFlKG4pe2Z1bmN0aW9uIHQodCxlKXtuLm1vdmVUbyh0K28sZSksbi5hcmModCxlLG8sMCxQYSl9ZnVuY3Rpb24gZSh0LGUpe24ubW92ZVRvKHQsZSksYS5wb2ludD1yfWZ1bmN0aW9uIHIodCxlKXtuLmxpbmVUbyh0LGUpfWZ1bmN0aW9uIHUoKXthLnBvaW50PXR9ZnVuY3Rpb24gaSgpe24uY2xvc2VQYXRoKCl9dmFyIG89NC41LGE9e3BvaW50OnQsbGluZVN0YXJ0OmZ1bmN0aW9uKCl7YS5wb2ludD1lfSxsaW5lRW5kOnUscG9seWdvblN0YXJ0OmZ1bmN0aW9uKCl7YS5saW5lRW5kPWl9LHBvbHlnb25FbmQ6ZnVuY3Rpb24oKXthLmxpbmVFbmQ9dSxhLnBvaW50PXR9LHBvaW50UmFkaXVzOmZ1bmN0aW9uKG4pe3JldHVybiBvPW4sYX0scmVzdWx0Onl9O3JldHVybiBhfWZ1bmN0aW9uIG5yKG4pe2Z1bmN0aW9uIHQobil7cmV0dXJuKGE/cjplKShuKX1mdW5jdGlvbiBlKHQpe3JldHVybiBycih0LGZ1bmN0aW9uKGUscil7ZT1uKGUsciksdC5wb2ludChlWzBdLGVbMV0pfSl9ZnVuY3Rpb24gcih0KXtmdW5jdGlvbiBlKGUscil7ZT1uKGUsciksdC5wb2ludChlWzBdLGVbMV0pfWZ1bmN0aW9uIHIoKXtNPTAvMCxTLnBvaW50PWksdC5saW5lU3RhcnQoKX1mdW5jdGlvbiBpKGUscil7dmFyIGk9cGUoW2Uscl0pLG89bihlLHIpO3UoTSx4LHksYixfLHcsTT1vWzBdLHg9b1sxXSx5PWUsYj1pWzBdLF89aVsxXSx3PWlbMl0sYSx0KSx0LnBvaW50KE0seCl9ZnVuY3Rpb24gbygpe1MucG9pbnQ9ZSx0LmxpbmVFbmQoKX1mdW5jdGlvbiBjKCl7cigpLFMucG9pbnQ9bCxTLmxpbmVFbmQ9c31mdW5jdGlvbiBsKG4sdCl7aShmPW4saD10KSxnPU0scD14LHY9YixkPV8sbT13LFMucG9pbnQ9aX1mdW5jdGlvbiBzKCl7dShNLHgseSxiLF8sdyxnLHAsZix2LGQsbSxhLHQpLFMubGluZUVuZD1vLG8oKX12YXIgZixoLGcscCx2LGQsbSx5LE0seCxiLF8sdyxTPXtwb2ludDplLGxpbmVTdGFydDpyLGxpbmVFbmQ6byxwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXt0LnBvbHlnb25TdGFydCgpLFMubGluZVN0YXJ0PWN9LHBvbHlnb25FbmQ6ZnVuY3Rpb24oKXt0LnBvbHlnb25FbmQoKSxTLmxpbmVTdGFydD1yfX07cmV0dXJuIFN9ZnVuY3Rpb24gdSh0LGUscixhLGMsbCxzLGYsaCxnLHAsdixkLG0pe3ZhciB5PXMtdCxNPWYtZSx4PXkqeStNKk07aWYoeD40KmkmJmQtLSl7dmFyIGI9YStnLF89YytwLHc9bCt2LFM9TWF0aC5zcXJ0KGIqYitfKl8rdyp3KSxrPU1hdGguYXNpbih3Lz1TKSxFPXZhKHZhKHcpLTEpPFRhfHx2YShyLWgpPFRhPyhyK2gpLzI6TWF0aC5hdGFuMihfLGIpLEE9bihFLGspLE49QVswXSxDPUFbMV0sej1OLXQscT1DLWUsTD1NKnoteSpxOwooTCpML3g+aXx8dmEoKHkqeitNKnEpL3gtLjUpPi4zfHxvPmEqZytjKnArbCp2KSYmKHUodCxlLHIsYSxjLGwsTixDLEUsYi89UyxfLz1TLHcsZCxtKSxtLnBvaW50KE4sQyksdShOLEMsRSxiLF8sdyxzLGYsaCxnLHAsdixkLG0pKX19dmFyIGk9LjUsbz1NYXRoLmNvcygzMCpGYSksYT0xNjtyZXR1cm4gdC5wcmVjaXNpb249ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGE9KGk9bipuKT4wJiYxNix0KTpNYXRoLnNxcnQoaSl9LHR9ZnVuY3Rpb24gdHIobil7dmFyIHQ9bnIoZnVuY3Rpb24odCxlKXtyZXR1cm4gbihbdCpIYSxlKkhhXSl9KTtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIG9yKHQobikpfX1mdW5jdGlvbiBlcihuKXt0aGlzLnN0cmVhbT1ufWZ1bmN0aW9uIHJyKG4sdCl7cmV0dXJue3BvaW50OnQsc3BoZXJlOmZ1bmN0aW9uKCl7bi5zcGhlcmUoKX0sbGluZVN0YXJ0OmZ1bmN0aW9uKCl7bi5saW5lU3RhcnQoKX0sbGluZUVuZDpmdW5jdGlvbigpe24ubGluZUVuZCgpfSxwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXtuLnBvbHlnb25TdGFydCgpfSxwb2x5Z29uRW5kOmZ1bmN0aW9uKCl7bi5wb2x5Z29uRW5kKCl9fX1mdW5jdGlvbiB1cihuKXtyZXR1cm4gaXIoZnVuY3Rpb24oKXtyZXR1cm4gbn0pKCl9ZnVuY3Rpb24gaXIobil7ZnVuY3Rpb24gdChuKXtyZXR1cm4gbj1hKG5bMF0qRmEsblsxXSpGYSksW25bMF0qaCtjLGwtblsxXSpoXX1mdW5jdGlvbiBlKG4pe3JldHVybiBuPWEuaW52ZXJ0KChuWzBdLWMpL2gsKGwtblsxXSkvaCksbiYmW25bMF0qSGEsblsxXSpIYV19ZnVuY3Rpb24gcigpe2E9QWUobz1scihtLHksTSksaSk7dmFyIG49aSh2LGQpO3JldHVybiBjPWctblswXSpoLGw9cCtuWzFdKmgsdSgpfWZ1bmN0aW9uIHUoKXtyZXR1cm4gcyYmKHMudmFsaWQ9ITEscz1udWxsKSx0fXZhciBpLG8sYSxjLGwscyxmPW5yKGZ1bmN0aW9uKG4sdCl7cmV0dXJuIG49aShuLHQpLFtuWzBdKmgrYyxsLW5bMV0qaF19KSxoPTE1MCxnPTQ4MCxwPTI1MCx2PTAsZD0wLG09MCx5PTAsTT0wLHg9UGMsYj1FdCxfPW51bGwsdz1udWxsO3JldHVybiB0LnN0cmVhbT1mdW5jdGlvbihuKXtyZXR1cm4gcyYmKHMudmFsaWQ9ITEpLHM9b3IoeChvLGYoYihuKSkpKSxzLnZhbGlkPSEwLHN9LHQuY2xpcEFuZ2xlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh4PW51bGw9PW4/KF89bixQYyk6SGUoKF89K24pKkZhKSx1KCkpOl99LHQuY2xpcEV4dGVudD1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odz1uLGI9bj9ZZShuWzBdWzBdLG5bMF1bMV0sblsxXVswXSxuWzFdWzFdKTpFdCx1KCkpOnd9LHQuc2NhbGU9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGg9K24scigpKTpofSx0LnRyYW5zbGF0ZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZz0rblswXSxwPStuWzFdLHIoKSk6W2cscF19LHQuY2VudGVyPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh2PW5bMF0lMzYwKkZhLGQ9blsxXSUzNjAqRmEscigpKTpbdipIYSxkKkhhXX0sdC5yb3RhdGU9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG09blswXSUzNjAqRmEseT1uWzFdJTM2MCpGYSxNPW4ubGVuZ3RoPjI/blsyXSUzNjAqRmE6MCxyKCkpOlttKkhhLHkqSGEsTSpIYV19LHRhLnJlYmluZCh0LGYsInByZWNpc2lvbiIpLGZ1bmN0aW9uKCl7cmV0dXJuIGk9bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdC5pbnZlcnQ9aS5pbnZlcnQmJmUscigpfX1mdW5jdGlvbiBvcihuKXtyZXR1cm4gcnIobixmdW5jdGlvbih0LGUpe24ucG9pbnQodCpGYSxlKkZhKX0pfWZ1bmN0aW9uIGFyKG4sdCl7cmV0dXJuW24sdF19ZnVuY3Rpb24gY3Iobix0KXtyZXR1cm5bbj5EYT9uLVBhOi1EYT5uP24rUGE6bix0XX1mdW5jdGlvbiBscihuLHQsZSl7cmV0dXJuIG4/dHx8ZT9BZShmcihuKSxocih0LGUpKTpmcihuKTp0fHxlP2hyKHQsZSk6Y3J9ZnVuY3Rpb24gc3Iobil7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrPW4sW3Q+RGE/dC1QYTotRGE+dD90K1BhOnQsZV19fWZ1bmN0aW9uIGZyKG4pe3ZhciB0PXNyKG4pO3JldHVybiB0LmludmVydD1zcigtbiksdH1mdW5jdGlvbiBocihuLHQpe2Z1bmN0aW9uIGUobix0KXt2YXIgZT1NYXRoLmNvcyh0KSxhPU1hdGguY29zKG4pKmUsYz1NYXRoLnNpbihuKSplLGw9TWF0aC5zaW4odCkscz1sKnIrYSp1O3JldHVybltNYXRoLmF0YW4yKGMqaS1zKm8sYSpyLWwqdSksbnQocyppK2MqbyldfXZhciByPU1hdGguY29zKG4pLHU9TWF0aC5zaW4obiksaT1NYXRoLmNvcyh0KSxvPU1hdGguc2luKHQpO3JldHVybiBlLmludmVydD1mdW5jdGlvbihuLHQpe3ZhciBlPU1hdGguY29zKHQpLGE9TWF0aC5jb3MobikqZSxjPU1hdGguc2luKG4pKmUsbD1NYXRoLnNpbih0KSxzPWwqaS1jKm87cmV0dXJuW01hdGguYXRhbjIoYyppK2wqbyxhKnIrcyp1KSxudChzKnItYSp1KV19LGV9ZnVuY3Rpb24gZ3Iobix0KXt2YXIgZT1NYXRoLmNvcyhuKSxyPU1hdGguc2luKG4pO3JldHVybiBmdW5jdGlvbih1LGksbyxhKXt2YXIgYz1vKnQ7bnVsbCE9dT8odT1wcihlLHUpLGk9cHIoZSxpKSwobz4wP2k+dTp1PmkpJiYodSs9bypQYSkpOih1PW4rbypQYSxpPW4tLjUqYyk7Zm9yKHZhciBsLHM9dTtvPjA/cz5pOmk+cztzLT1jKWEucG9pbnQoKGw9eGUoW2UsLXIqTWF0aC5jb3MocyksLXIqTWF0aC5zaW4ocyldKSlbMF0sbFsxXSl9fWZ1bmN0aW9uIHByKG4sdCl7dmFyIGU9cGUodCk7ZVswXS09bixNZShlKTt2YXIgcj1RKC1lWzFdKTtyZXR1cm4oKC1lWzJdPDA/LXI6cikrMipNYXRoLlBJLVRhKSUoMipNYXRoLlBJKX1mdW5jdGlvbiB2cihuLHQsZSl7dmFyIHI9dGEucmFuZ2Uobix0LVRhLGUpLmNvbmNhdCh0KTtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIHIubWFwKGZ1bmN0aW9uKHQpe3JldHVybltuLHRdfSl9fWZ1bmN0aW9uIGRyKG4sdCxlKXt2YXIgcj10YS5yYW5nZShuLHQtVGEsZSkuY29uY2F0KHQpO3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gci5tYXAoZnVuY3Rpb24odCl7cmV0dXJuW3Qsbl19KX19ZnVuY3Rpb24gbXIobil7cmV0dXJuIG4uc291cmNlfWZ1bmN0aW9uIHlyKG4pe3JldHVybiBuLnRhcmdldH1mdW5jdGlvbiBNcihuLHQsZSxyKXt2YXIgdT1NYXRoLmNvcyh0KSxpPU1hdGguc2luKHQpLG89TWF0aC5jb3MociksYT1NYXRoLnNpbihyKSxjPXUqTWF0aC5jb3MobiksbD11Kk1hdGguc2luKG4pLHM9bypNYXRoLmNvcyhlKSxmPW8qTWF0aC5zaW4oZSksaD0yKk1hdGguYXNpbihNYXRoLnNxcnQodXQoci10KSt1Km8qdXQoZS1uKSkpLGc9MS9NYXRoLnNpbihoKSxwPWg/ZnVuY3Rpb24obil7dmFyIHQ9TWF0aC5zaW4obio9aCkqZyxlPU1hdGguc2luKGgtbikqZyxyPWUqYyt0KnMsdT1lKmwrdCpmLG89ZSppK3QqYTtyZXR1cm5bTWF0aC5hdGFuMih1LHIpKkhhLE1hdGguYXRhbjIobyxNYXRoLnNxcnQocipyK3UqdSkpKkhhXX06ZnVuY3Rpb24oKXtyZXR1cm5bbipIYSx0KkhhXX07cmV0dXJuIHAuZGlzdGFuY2U9aCxwfWZ1bmN0aW9uIHhyKCl7ZnVuY3Rpb24gbihuLHUpe3ZhciBpPU1hdGguc2luKHUqPUZhKSxvPU1hdGguY29zKHUpLGE9dmEoKG4qPUZhKS10KSxjPU1hdGguY29zKGEpOyRjKz1NYXRoLmF0YW4yKE1hdGguc3FydCgoYT1vKk1hdGguc2luKGEpKSphKyhhPXIqaS1lKm8qYykqYSksZSppK3IqbypjKSx0PW4sZT1pLHI9b312YXIgdCxlLHI7QmMucG9pbnQ9ZnVuY3Rpb24odSxpKXt0PXUqRmEsZT1NYXRoLnNpbihpKj1GYSkscj1NYXRoLmNvcyhpKSxCYy5wb2ludD1ufSxCYy5saW5lRW5kPWZ1bmN0aW9uKCl7QmMucG9pbnQ9QmMubGluZUVuZD15fX1mdW5jdGlvbiBicihuLHQpe2Z1bmN0aW9uIGUodCxlKXt2YXIgcj1NYXRoLmNvcyh0KSx1PU1hdGguY29zKGUpLGk9bihyKnUpO3JldHVybltpKnUqTWF0aC5zaW4odCksaSpNYXRoLnNpbihlKV19cmV0dXJuIGUuaW52ZXJ0PWZ1bmN0aW9uKG4sZSl7dmFyIHI9TWF0aC5zcXJ0KG4qbitlKmUpLHU9dChyKSxpPU1hdGguc2luKHUpLG89TWF0aC5jb3ModSk7cmV0dXJuW01hdGguYXRhbjIobippLHIqbyksTWF0aC5hc2luKHImJmUqaS9yKV19LGV9ZnVuY3Rpb24gX3Iobix0KXtmdW5jdGlvbiBlKG4sdCl7bz4wPy1qYStUYT50JiYodD0tamErVGEpOnQ+amEtVGEmJih0PWphLVRhKTt2YXIgZT1vL01hdGgucG93KHUodCksaSk7cmV0dXJuW2UqTWF0aC5zaW4oaSpuKSxvLWUqTWF0aC5jb3MoaSpuKV19dmFyIHI9TWF0aC5jb3MobiksdT1mdW5jdGlvbihuKXtyZXR1cm4gTWF0aC50YW4oRGEvNCtuLzIpfSxpPW49PT10P01hdGguc2luKG4pOk1hdGgubG9nKHIvTWF0aC5jb3ModCkpL01hdGgubG9nKHUodCkvdShuKSksbz1yKk1hdGgucG93KHUobiksaSkvaTtyZXR1cm4gaT8oZS5pbnZlcnQ9ZnVuY3Rpb24obix0KXt2YXIgZT1vLXQscj1HKGkpKk1hdGguc3FydChuKm4rZSplKTtyZXR1cm5bTWF0aC5hdGFuMihuLGUpL2ksMipNYXRoLmF0YW4oTWF0aC5wb3coby9yLDEvaSkpLWphXX0sZSk6U3J9ZnVuY3Rpb24gd3Iobix0KXtmdW5jdGlvbiBlKG4sdCl7dmFyIGU9aS10O3JldHVybltlKk1hdGguc2luKHUqbiksaS1lKk1hdGguY29zKHUqbildfXZhciByPU1hdGguY29zKG4pLHU9bj09PXQ/TWF0aC5zaW4obik6KHItTWF0aC5jb3ModCkpLyh0LW4pLGk9ci91K247cmV0dXJuIHZhKHUpPFRhP2FyOihlLmludmVydD1mdW5jdGlvbihuLHQpe3ZhciBlPWktdDtyZXR1cm5bTWF0aC5hdGFuMihuLGUpL3UsaS1HKHUpKk1hdGguc3FydChuKm4rZSplKV19LGUpfWZ1bmN0aW9uIFNyKG4sdCl7cmV0dXJuW24sTWF0aC5sb2coTWF0aC50YW4oRGEvNCt0LzIpKV19ZnVuY3Rpb24ga3Iobil7dmFyIHQsZT11cihuKSxyPWUuc2NhbGUsdT1lLnRyYW5zbGF0ZSxpPWUuY2xpcEV4dGVudDtyZXR1cm4gZS5zY2FsZT1mdW5jdGlvbigpe3ZhciBuPXIuYXBwbHkoZSxhcmd1bWVudHMpO3JldHVybiBuPT09ZT90P2UuY2xpcEV4dGVudChudWxsKTplOm59LGUudHJhbnNsYXRlPWZ1bmN0aW9uKCl7dmFyIG49dS5hcHBseShlLGFyZ3VtZW50cyk7cmV0dXJuIG49PT1lP3Q/ZS5jbGlwRXh0ZW50KG51bGwpOmU6bn0sZS5jbGlwRXh0ZW50PWZ1bmN0aW9uKG4pe3ZhciBvPWkuYXBwbHkoZSxhcmd1bWVudHMpO2lmKG89PT1lKXtpZih0PW51bGw9PW4pe3ZhciBhPURhKnIoKSxjPXUoKTtpKFtbY1swXS1hLGNbMV0tYV0sW2NbMF0rYSxjWzFdK2FdXSl9fWVsc2UgdCYmKG89bnVsbCk7cmV0dXJuIG99LGUuY2xpcEV4dGVudChudWxsKX1mdW5jdGlvbiBFcihuLHQpe3JldHVybltNYXRoLmxvZyhNYXRoLnRhbihEYS80K3QvMikpLC1uXX1mdW5jdGlvbiBBcihuKXtyZXR1cm4gblswXX1mdW5jdGlvbiBOcihuKXtyZXR1cm4gblsxXX1mdW5jdGlvbiBDcihuKXtmb3IodmFyIHQ9bi5sZW5ndGgsZT1bMCwxXSxyPTIsdT0yO3Q+dTt1Kyspe2Zvcig7cj4xJiZLKG5bZVtyLTJdXSxuW2Vbci0xXV0sblt1XSk8PTA7KS0tcjtlW3IrK109dX1yZXR1cm4gZS5zbGljZSgwLHIpfWZ1bmN0aW9uIHpyKG4sdCl7cmV0dXJuIG5bMF0tdFswXXx8blsxXS10WzFdfWZ1bmN0aW9uIHFyKG4sdCxlKXtyZXR1cm4oZVswXS10WzBdKSooblsxXS10WzFdKTwoZVsxXS10WzFdKSooblswXS10WzBdKX1mdW5jdGlvbiBMcihuLHQsZSxyKXt2YXIgdT1uWzBdLGk9ZVswXSxvPXRbMF0tdSxhPXJbMF0taSxjPW5bMV0sbD1lWzFdLHM9dFsxXS1jLGY9clsxXS1sLGg9KGEqKGMtbCktZioodS1pKSkvKGYqby1hKnMpO3JldHVyblt1K2gqbyxjK2gqc119ZnVuY3Rpb24gVHIobil7dmFyIHQ9blswXSxlPW5bbi5sZW5ndGgtMV07cmV0dXJuISh0WzBdLWVbMF18fHRbMV0tZVsxXSl9ZnVuY3Rpb24gUnIoKXt0dSh0aGlzKSx0aGlzLmVkZ2U9dGhpcy5zaXRlPXRoaXMuY2lyY2xlPW51bGx9ZnVuY3Rpb24gRHIobil7dmFyIHQ9b2wucG9wKCl8fG5ldyBScjtyZXR1cm4gdC5zaXRlPW4sdH1mdW5jdGlvbiBQcihuKXtYcihuKSxybC5yZW1vdmUobiksb2wucHVzaChuKSx0dShuKX1mdW5jdGlvbiBVcihuKXt2YXIgdD1uLmNpcmNsZSxlPXQueCxyPXQuY3ksdT17eDplLHk6cn0saT1uLlAsbz1uLk4sYT1bbl07UHIobik7Zm9yKHZhciBjPWk7Yy5jaXJjbGUmJnZhKGUtYy5jaXJjbGUueCk8VGEmJnZhKHItYy5jaXJjbGUuY3kpPFRhOylpPWMuUCxhLnVuc2hpZnQoYyksUHIoYyksYz1pO2EudW5zaGlmdChjKSxYcihjKTtmb3IodmFyIGw9bztsLmNpcmNsZSYmdmEoZS1sLmNpcmNsZS54KTxUYSYmdmEoci1sLmNpcmNsZS5jeSk8VGE7KW89bC5OLGEucHVzaChsKSxQcihsKSxsPW87YS5wdXNoKGwpLFhyKGwpO3ZhciBzLGY9YS5sZW5ndGg7Zm9yKHM9MTtmPnM7KytzKWw9YVtzXSxjPWFbcy0xXSxLcihsLmVkZ2UsYy5zaXRlLGwuc2l0ZSx1KTtjPWFbMF0sbD1hW2YtMV0sbC5lZGdlPUpyKGMuc2l0ZSxsLnNpdGUsbnVsbCx1KSxWcihjKSxWcihsKX1mdW5jdGlvbiBqcihuKXtmb3IodmFyIHQsZSxyLHUsaT1uLngsbz1uLnksYT1ybC5fO2E7KWlmKHI9RnIoYSxvKS1pLHI+VGEpYT1hLkw7ZWxzZXtpZih1PWktSHIoYSxvKSwhKHU+VGEpKXtyPi1UYT8odD1hLlAsZT1hKTp1Pi1UYT8odD1hLGU9YS5OKTp0PWU9YTticmVha31pZighYS5SKXt0PWE7YnJlYWt9YT1hLlJ9dmFyIGM9RHIobik7aWYocmwuaW5zZXJ0KHQsYyksdHx8ZSl7aWYodD09PWUpcmV0dXJuIFhyKHQpLGU9RHIodC5zaXRlKSxybC5pbnNlcnQoYyxlKSxjLmVkZ2U9ZS5lZGdlPUpyKHQuc2l0ZSxjLnNpdGUpLFZyKHQpLFZyKGUpLHZvaWQgMDtpZighZSlyZXR1cm4gYy5lZGdlPUpyKHQuc2l0ZSxjLnNpdGUpLHZvaWQgMDtYcih0KSxYcihlKTt2YXIgbD10LnNpdGUscz1sLngsZj1sLnksaD1uLngtcyxnPW4ueS1mLHA9ZS5zaXRlLHY9cC54LXMsZD1wLnktZixtPTIqKGgqZC1nKnYpLHk9aCpoK2cqZyxNPXYqditkKmQseD17eDooZCp5LWcqTSkvbStzLHk6KGgqTS12KnkpL20rZn07S3IoZS5lZGdlLGwscCx4KSxjLmVkZ2U9SnIobCxuLG51bGwseCksZS5lZGdlPUpyKG4scCxudWxsLHgpLFZyKHQpLFZyKGUpfX1mdW5jdGlvbiBGcihuLHQpe3ZhciBlPW4uc2l0ZSxyPWUueCx1PWUueSxpPXUtdDtpZighaSlyZXR1cm4gcjt2YXIgbz1uLlA7aWYoIW8pcmV0dXJuLTEvMDtlPW8uc2l0ZTt2YXIgYT1lLngsYz1lLnksbD1jLXQ7aWYoIWwpcmV0dXJuIGE7dmFyIHM9YS1yLGY9MS9pLTEvbCxoPXMvbDtyZXR1cm4gZj8oLWgrTWF0aC5zcXJ0KGgqaC0yKmYqKHMqcy8oLTIqbCktYytsLzIrdS1pLzIpKSkvZityOihyK2EpLzJ9ZnVuY3Rpb24gSHIobix0KXt2YXIgZT1uLk47aWYoZSlyZXR1cm4gRnIoZSx0KTt2YXIgcj1uLnNpdGU7cmV0dXJuIHIueT09PXQ/ci54OjEvMH1mdW5jdGlvbiBPcihuKXt0aGlzLnNpdGU9bix0aGlzLmVkZ2VzPVtdfWZ1bmN0aW9uIFlyKG4pe2Zvcih2YXIgdCxlLHIsdSxpLG8sYSxjLGwscyxmPW5bMF1bMF0saD1uWzFdWzBdLGc9blswXVsxXSxwPW5bMV1bMV0sdj1lbCxkPXYubGVuZ3RoO2QtLTspaWYoaT12W2RdLGkmJmkucHJlcGFyZSgpKWZvcihhPWkuZWRnZXMsYz1hLmxlbmd0aCxvPTA7Yz5vOylzPWFbb10uZW5kKCkscj1zLngsdT1zLnksbD1hWysrbyVjXS5zdGFydCgpLHQ9bC54LGU9bC55LCh2YShyLXQpPlRhfHx2YSh1LWUpPlRhKSYmKGEuc3BsaWNlKG8sMCxuZXcgUXIoR3IoaS5zaXRlLHMsdmEoci1mKTxUYSYmcC11PlRhP3t4OmYseTp2YSh0LWYpPFRhP2U6cH06dmEodS1wKTxUYSYmaC1yPlRhP3t4OnZhKGUtcCk8VGE/dDpoLHk6cH06dmEoci1oKTxUYSYmdS1nPlRhP3t4OmgseTp2YSh0LWgpPFRhP2U6Z306dmEodS1nKTxUYSYmci1mPlRhP3t4OnZhKGUtZyk8VGE/dDpmLHk6Z306bnVsbCksaS5zaXRlLG51bGwpKSwrK2MpfWZ1bmN0aW9uIElyKG4sdCl7cmV0dXJuIHQuYW5nbGUtbi5hbmdsZX1mdW5jdGlvbiBacigpe3R1KHRoaXMpLHRoaXMueD10aGlzLnk9dGhpcy5hcmM9dGhpcy5zaXRlPXRoaXMuY3k9bnVsbH1mdW5jdGlvbiBWcihuKXt2YXIgdD1uLlAsZT1uLk47aWYodCYmZSl7dmFyIHI9dC5zaXRlLHU9bi5zaXRlLGk9ZS5zaXRlO2lmKHIhPT1pKXt2YXIgbz11LngsYT11LnksYz1yLngtbyxsPXIueS1hLHM9aS54LW8sZj1pLnktYSxoPTIqKGMqZi1sKnMpO2lmKCEoaD49LVJhKSl7dmFyIGc9YypjK2wqbCxwPXMqcytmKmYsdj0oZipnLWwqcCkvaCxkPShjKnAtcypnKS9oLGY9ZCthLG09YWwucG9wKCl8fG5ldyBacjttLmFyYz1uLG0uc2l0ZT11LG0ueD12K28sbS55PWYrTWF0aC5zcXJ0KHYqditkKmQpLG0uY3k9ZixuLmNpcmNsZT1tO2Zvcih2YXIgeT1udWxsLE09aWwuXztNOylpZihtLnk8TS55fHxtLnk9PT1NLnkmJm0ueDw9TS54KXtpZighTS5MKXt5PU0uUDticmVha31NPU0uTH1lbHNle2lmKCFNLlIpe3k9TTticmVha31NPU0uUn1pbC5pbnNlcnQoeSxtKSx5fHwodWw9bSl9fX19ZnVuY3Rpb24gWHIobil7dmFyIHQ9bi5jaXJjbGU7dCYmKHQuUHx8KHVsPXQuTiksaWwucmVtb3ZlKHQpLGFsLnB1c2godCksdHUodCksbi5jaXJjbGU9bnVsbCl9ZnVuY3Rpb24gJHIobil7Zm9yKHZhciB0LGU9dGwscj1PZShuWzBdWzBdLG5bMF1bMV0sblsxXVswXSxuWzFdWzFdKSx1PWUubGVuZ3RoO3UtLTspdD1lW3VdLCghQnIodCxuKXx8IXIodCl8fHZhKHQuYS54LXQuYi54KTxUYSYmdmEodC5hLnktdC5iLnkpPFRhKSYmKHQuYT10LmI9bnVsbCxlLnNwbGljZSh1LDEpKX1mdW5jdGlvbiBCcihuLHQpe3ZhciBlPW4uYjtpZihlKXJldHVybiEwO3ZhciByLHUsaT1uLmEsbz10WzBdWzBdLGE9dFsxXVswXSxjPXRbMF1bMV0sbD10WzFdWzFdLHM9bi5sLGY9bi5yLGg9cy54LGc9cy55LHA9Zi54LHY9Zi55LGQ9KGgrcCkvMixtPShnK3YpLzI7aWYodj09PWcpe2lmKG8+ZHx8ZD49YSlyZXR1cm47aWYoaD5wKXtpZihpKXtpZihpLnk+PWwpcmV0dXJufWVsc2UgaT17eDpkLHk6Y307ZT17eDpkLHk6bH19ZWxzZXtpZihpKXtpZihpLnk8YylyZXR1cm59ZWxzZSBpPXt4OmQseTpsfTtlPXt4OmQseTpjfX19ZWxzZSBpZihyPShoLXApLyh2LWcpLHU9bS1yKmQsLTE+cnx8cj4xKWlmKGg+cCl7aWYoaSl7aWYoaS55Pj1sKXJldHVybn1lbHNlIGk9e3g6KGMtdSkvcix5OmN9O2U9e3g6KGwtdSkvcix5Omx9fWVsc2V7aWYoaSl7aWYoaS55PGMpcmV0dXJufWVsc2UgaT17eDoobC11KS9yLHk6bH07ZT17eDooYy11KS9yLHk6Y319ZWxzZSBpZih2Pmcpe2lmKGkpe2lmKGkueD49YSlyZXR1cm59ZWxzZSBpPXt4Om8seTpyKm8rdX07ZT17eDphLHk6ciphK3V9fWVsc2V7aWYoaSl7aWYoaS54PG8pcmV0dXJufWVsc2UgaT17eDphLHk6ciphK3V9O2U9e3g6byx5OnIqbyt1fX1yZXR1cm4gbi5hPWksbi5iPWUsITB9ZnVuY3Rpb24gV3Iobix0KXt0aGlzLmw9bix0aGlzLnI9dCx0aGlzLmE9dGhpcy5iPW51bGx9ZnVuY3Rpb24gSnIobix0LGUscil7dmFyIHU9bmV3IFdyKG4sdCk7cmV0dXJuIHRsLnB1c2godSksZSYmS3IodSxuLHQsZSksciYmS3IodSx0LG4sciksZWxbbi5pXS5lZGdlcy5wdXNoKG5ldyBRcih1LG4sdCkpLGVsW3QuaV0uZWRnZXMucHVzaChuZXcgUXIodSx0LG4pKSx1fWZ1bmN0aW9uIEdyKG4sdCxlKXt2YXIgcj1uZXcgV3IobixudWxsKTtyZXR1cm4gci5hPXQsci5iPWUsdGwucHVzaChyKSxyfWZ1bmN0aW9uIEtyKG4sdCxlLHIpe24uYXx8bi5iP24ubD09PWU/bi5iPXI6bi5hPXI6KG4uYT1yLG4ubD10LG4ucj1lKX1mdW5jdGlvbiBRcihuLHQsZSl7dmFyIHI9bi5hLHU9bi5iO3RoaXMuZWRnZT1uLHRoaXMuc2l0ZT10LHRoaXMuYW5nbGU9ZT9NYXRoLmF0YW4yKGUueS10LnksZS54LXQueCk6bi5sPT09dD9NYXRoLmF0YW4yKHUueC1yLngsci55LXUueSk6TWF0aC5hdGFuMihyLngtdS54LHUueS1yLnkpfWZ1bmN0aW9uIG51KCl7dGhpcy5fPW51bGx9ZnVuY3Rpb24gdHUobil7bi5VPW4uQz1uLkw9bi5SPW4uUD1uLk49bnVsbH1mdW5jdGlvbiBldShuLHQpe3ZhciBlPXQscj10LlIsdT1lLlU7dT91Lkw9PT1lP3UuTD1yOnUuUj1yOm4uXz1yLHIuVT11LGUuVT1yLGUuUj1yLkwsZS5SJiYoZS5SLlU9ZSksci5MPWV9ZnVuY3Rpb24gcnUobix0KXt2YXIgZT10LHI9dC5MLHU9ZS5VO3U/dS5MPT09ZT91Lkw9cjp1LlI9cjpuLl89cixyLlU9dSxlLlU9cixlLkw9ci5SLGUuTCYmKGUuTC5VPWUpLHIuUj1lfWZ1bmN0aW9uIHV1KG4pe2Zvcig7bi5MOyluPW4uTDtyZXR1cm4gbn1mdW5jdGlvbiBpdShuLHQpe3ZhciBlLHIsdSxpPW4uc29ydChvdSkucG9wKCk7Zm9yKHRsPVtdLGVsPW5ldyBBcnJheShuLmxlbmd0aCkscmw9bmV3IG51LGlsPW5ldyBudTs7KWlmKHU9dWwsaSYmKCF1fHxpLnk8dS55fHxpLnk9PT11LnkmJmkueDx1LngpKShpLnghPT1lfHxpLnkhPT1yKSYmKGVsW2kuaV09bmV3IE9yKGkpLGpyKGkpLGU9aS54LHI9aS55KSxpPW4ucG9wKCk7ZWxzZXtpZighdSlicmVhaztVcih1LmFyYyl9dCYmKCRyKHQpLFlyKHQpKTt2YXIgbz17Y2VsbHM6ZWwsZWRnZXM6dGx9O3JldHVybiBybD1pbD10bD1lbD1udWxsLG99ZnVuY3Rpb24gb3Uobix0KXtyZXR1cm4gdC55LW4ueXx8dC54LW4ueH1mdW5jdGlvbiBhdShuLHQsZSl7cmV0dXJuKG4ueC1lLngpKih0Lnktbi55KS0obi54LXQueCkqKGUueS1uLnkpfWZ1bmN0aW9uIGN1KG4pe3JldHVybiBuLnh9ZnVuY3Rpb24gbHUobil7cmV0dXJuIG4ueX1mdW5jdGlvbiBzdSgpe3JldHVybntsZWFmOiEwLG5vZGVzOltdLHBvaW50Om51bGwseDpudWxsLHk6bnVsbH19ZnVuY3Rpb24gZnUobix0LGUscix1LGkpe2lmKCFuKHQsZSxyLHUsaSkpe3ZhciBvPS41KihlK3UpLGE9LjUqKHIraSksYz10Lm5vZGVzO2NbMF0mJmZ1KG4sY1swXSxlLHIsbyxhKSxjWzFdJiZmdShuLGNbMV0sbyxyLHUsYSksY1syXSYmZnUobixjWzJdLGUsYSxvLGkpLGNbM10mJmZ1KG4sY1szXSxvLGEsdSxpKX19ZnVuY3Rpb24gaHUobix0LGUscix1LGksbyl7dmFyIGEsYz0xLzA7cmV0dXJuIGZ1bmN0aW9uIGwobixzLGYsaCxnKXtpZighKHM+aXx8Zj5vfHxyPmh8fHU+Zykpe2lmKHA9bi5wb2ludCl7dmFyIHAsdj10LXBbMF0sZD1lLXBbMV0sbT12KnYrZCpkO2lmKGM+bSl7dmFyIHk9TWF0aC5zcXJ0KGM9bSk7cj10LXksdT1lLXksaT10K3ksbz1lK3ksYT1wfX1mb3IodmFyIE09bi5ub2Rlcyx4PS41KihzK2gpLGI9LjUqKGYrZyksXz10Pj14LHc9ZT49YixTPXc8PDF8XyxrPVMrNDtrPlM7KytTKWlmKG49TVszJlNdKXN3aXRjaCgzJlMpe2Nhc2UgMDpsKG4scyxmLHgsYik7YnJlYWs7Y2FzZSAxOmwobix4LGYsaCxiKTticmVhaztjYXNlIDI6bChuLHMsYix4LGcpO2JyZWFrO2Nhc2UgMzpsKG4seCxiLGgsZyl9fX0obixyLHUsaSxvKSxhfWZ1bmN0aW9uIGd1KG4sdCl7bj10YS5yZ2IobiksdD10YS5yZ2IodCk7dmFyIGU9bi5yLHI9bi5nLHU9bi5iLGk9dC5yLWUsbz10LmctcixhPXQuYi11O3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4iIyIrTXQoTWF0aC5yb3VuZChlK2kqbikpK010KE1hdGgucm91bmQocitvKm4pKStNdChNYXRoLnJvdW5kKHUrYSpuKSl9fWZ1bmN0aW9uIHB1KG4sdCl7dmFyIGUscj17fSx1PXt9O2ZvcihlIGluIG4pZSBpbiB0P3JbZV09bXUobltlXSx0W2VdKTp1W2VdPW5bZV07Zm9yKGUgaW4gdCllIGluIG58fCh1W2VdPXRbZV0pO3JldHVybiBmdW5jdGlvbihuKXtmb3IoZSBpbiByKXVbZV09cltlXShuKTtyZXR1cm4gdX19ZnVuY3Rpb24gdnUobix0KXtyZXR1cm4gbj0rbix0PSt0LGZ1bmN0aW9uKGUpe3JldHVybiBuKigxLWUpK3QqZX19ZnVuY3Rpb24gZHUobix0KXt2YXIgZSxyLHUsaT1sbC5sYXN0SW5kZXg9c2wubGFzdEluZGV4PTAsbz0tMSxhPVtdLGM9W107Zm9yKG4rPSIiLHQrPSIiOyhlPWxsLmV4ZWMobikpJiYocj1zbC5leGVjKHQpKTspKHU9ci5pbmRleCk+aSYmKHU9dC5zbGljZShpLHUpLGFbb10/YVtvXSs9dTphWysrb109dSksKGU9ZVswXSk9PT0ocj1yWzBdKT9hW29dP2Fbb10rPXI6YVsrK29dPXI6KGFbKytvXT1udWxsLGMucHVzaCh7aTpvLHg6dnUoZSxyKX0pKSxpPXNsLmxhc3RJbmRleDtyZXR1cm4gaTx0Lmxlbmd0aCYmKHU9dC5zbGljZShpKSxhW29dP2Fbb10rPXU6YVsrK29dPXUpLGEubGVuZ3RoPDI/Y1swXT8odD1jWzBdLngsZnVuY3Rpb24obil7cmV0dXJuIHQobikrIiJ9KTpmdW5jdGlvbigpe3JldHVybiB0fToodD1jLmxlbmd0aCxmdW5jdGlvbihuKXtmb3IodmFyIGUscj0wO3Q+cjsrK3IpYVsoZT1jW3JdKS5pXT1lLngobik7cmV0dXJuIGEuam9pbigiIil9KX1mdW5jdGlvbiBtdShuLHQpe2Zvcih2YXIgZSxyPXRhLmludGVycG9sYXRvcnMubGVuZ3RoOy0tcj49MCYmIShlPXRhLmludGVycG9sYXRvcnNbcl0obix0KSk7KTtyZXR1cm4gZX1mdW5jdGlvbiB5dShuLHQpe3ZhciBlLHI9W10sdT1bXSxpPW4ubGVuZ3RoLG89dC5sZW5ndGgsYT1NYXRoLm1pbihuLmxlbmd0aCx0Lmxlbmd0aCk7Zm9yKGU9MDthPmU7KytlKXIucHVzaChtdShuW2VdLHRbZV0pKTtmb3IoO2k+ZTsrK2UpdVtlXT1uW2VdO2Zvcig7bz5lOysrZSl1W2VdPXRbZV07cmV0dXJuIGZ1bmN0aW9uKG4pe2ZvcihlPTA7YT5lOysrZSl1W2VdPXJbZV0obik7cmV0dXJuIHV9fWZ1bmN0aW9uIE11KG4pe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gMD49dD8wOnQ+PTE/MTpuKHQpfX1mdW5jdGlvbiB4dShuKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuIDEtbigxLXQpfX1mdW5jdGlvbiBidShuKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuLjUqKC41PnQ/bigyKnQpOjItbigyLTIqdCkpfX1mdW5jdGlvbiBfdShuKXtyZXR1cm4gbipufWZ1bmN0aW9uIHd1KG4pe3JldHVybiBuKm4qbn1mdW5jdGlvbiBTdShuKXtpZigwPj1uKXJldHVybiAwO2lmKG4+PTEpcmV0dXJuIDE7dmFyIHQ9bipuLGU9dCpuO3JldHVybiA0KiguNT5uP2U6Myoobi10KStlLS43NSl9ZnVuY3Rpb24ga3Uobil7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnBvdyh0LG4pfX1mdW5jdGlvbiBFdShuKXtyZXR1cm4gMS1NYXRoLmNvcyhuKmphKX1mdW5jdGlvbiBBdShuKXtyZXR1cm4gTWF0aC5wb3coMiwxMCoobi0xKSl9ZnVuY3Rpb24gTnUobil7cmV0dXJuIDEtTWF0aC5zcXJ0KDEtbipuKX1mdW5jdGlvbiBDdShuLHQpe3ZhciBlO3JldHVybiBhcmd1bWVudHMubGVuZ3RoPDImJih0PS40NSksYXJndW1lbnRzLmxlbmd0aD9lPXQvUGEqTWF0aC5hc2luKDEvbik6KG49MSxlPXQvNCksZnVuY3Rpb24ocil7cmV0dXJuIDErbipNYXRoLnBvdygyLC0xMCpyKSpNYXRoLnNpbigoci1lKSpQYS90KX19ZnVuY3Rpb24genUobil7cmV0dXJuIG58fChuPTEuNzAxNTgpLGZ1bmN0aW9uKHQpe3JldHVybiB0KnQqKChuKzEpKnQtbil9fWZ1bmN0aW9uIHF1KG4pe3JldHVybiAxLzIuNzU+bj83LjU2MjUqbipuOjIvMi43NT5uPzcuNTYyNSoobi09MS41LzIuNzUpKm4rLjc1OjIuNS8yLjc1Pm4/Ny41NjI1KihuLT0yLjI1LzIuNzUpKm4rLjkzNzU6Ny41NjI1KihuLT0yLjYyNS8yLjc1KSpuKy45ODQzNzV9ZnVuY3Rpb24gTHUobix0KXtuPXRhLmhjbChuKSx0PXRhLmhjbCh0KTt2YXIgZT1uLmgscj1uLmMsdT1uLmwsaT10LmgtZSxvPXQuYy1yLGE9dC5sLXU7cmV0dXJuIGlzTmFOKG8pJiYobz0wLHI9aXNOYU4ocik/dC5jOnIpLGlzTmFOKGkpPyhpPTAsZT1pc05hTihlKT90Lmg6ZSk6aT4xODA/aS09MzYwOi0xODA+aSYmKGkrPTM2MCksZnVuY3Rpb24obil7cmV0dXJuIGx0KGUraSpuLHIrbypuLHUrYSpuKSsiIn19ZnVuY3Rpb24gVHUobix0KXtuPXRhLmhzbChuKSx0PXRhLmhzbCh0KTt2YXIgZT1uLmgscj1uLnMsdT1uLmwsaT10LmgtZSxvPXQucy1yLGE9dC5sLXU7cmV0dXJuIGlzTmFOKG8pJiYobz0wLHI9aXNOYU4ocik/dC5zOnIpLGlzTmFOKGkpPyhpPTAsZT1pc05hTihlKT90Lmg6ZSk6aT4xODA/aS09MzYwOi0xODA+aSYmKGkrPTM2MCksZnVuY3Rpb24obil7cmV0dXJuIGF0KGUraSpuLHIrbypuLHUrYSpuKSsiIn19ZnVuY3Rpb24gUnUobix0KXtuPXRhLmxhYihuKSx0PXRhLmxhYih0KTt2YXIgZT1uLmwscj1uLmEsdT1uLmIsaT10LmwtZSxvPXQuYS1yLGE9dC5iLXU7cmV0dXJuIGZ1bmN0aW9uKG4pe3JldHVybiBmdChlK2kqbixyK28qbix1K2EqbikrIiJ9fWZ1bmN0aW9uIER1KG4sdCl7cmV0dXJuIHQtPW4sZnVuY3Rpb24oZSl7cmV0dXJuIE1hdGgucm91bmQobit0KmUpfX1mdW5jdGlvbiBQdShuKXt2YXIgdD1bbi5hLG4uYl0sZT1bbi5jLG4uZF0scj1qdSh0KSx1PVV1KHQsZSksaT1qdShGdShlLHQsLXUpKXx8MDt0WzBdKmVbMV08ZVswXSp0WzFdJiYodFswXSo9LTEsdFsxXSo9LTEscio9LTEsdSo9LTEpLHRoaXMucm90YXRlPShyP01hdGguYXRhbjIodFsxXSx0WzBdKTpNYXRoLmF0YW4yKC1lWzBdLGVbMV0pKSpIYSx0aGlzLnRyYW5zbGF0ZT1bbi5lLG4uZl0sdGhpcy5zY2FsZT1bcixpXSx0aGlzLnNrZXc9aT9NYXRoLmF0YW4yKHUsaSkqSGE6MH1mdW5jdGlvbiBVdShuLHQpe3JldHVybiBuWzBdKnRbMF0rblsxXSp0WzFdfWZ1bmN0aW9uIGp1KG4pe3ZhciB0PU1hdGguc3FydChVdShuLG4pKTtyZXR1cm4gdCYmKG5bMF0vPXQsblsxXS89dCksdH1mdW5jdGlvbiBGdShuLHQsZSl7cmV0dXJuIG5bMF0rPWUqdFswXSxuWzFdKz1lKnRbMV0sbn1mdW5jdGlvbiBIdShuLHQpe3ZhciBlLHI9W10sdT1bXSxpPXRhLnRyYW5zZm9ybShuKSxvPXRhLnRyYW5zZm9ybSh0KSxhPWkudHJhbnNsYXRlLGM9by50cmFuc2xhdGUsbD1pLnJvdGF0ZSxzPW8ucm90YXRlLGY9aS5za2V3LGg9by5za2V3LGc9aS5zY2FsZSxwPW8uc2NhbGU7cmV0dXJuIGFbMF0hPWNbMF18fGFbMV0hPWNbMV0/KHIucHVzaCgidHJhbnNsYXRlKCIsbnVsbCwiLCIsbnVsbCwiKSIpLHUucHVzaCh7aToxLHg6dnUoYVswXSxjWzBdKX0se2k6Myx4OnZ1KGFbMV0sY1sxXSl9KSk6Y1swXXx8Y1sxXT9yLnB1c2goInRyYW5zbGF0ZSgiK2MrIikiKTpyLnB1c2goIiIpLGwhPXM/KGwtcz4xODA/cys9MzYwOnMtbD4xODAmJihsKz0zNjApLHUucHVzaCh7aTpyLnB1c2goci5wb3AoKSsicm90YXRlKCIsbnVsbCwiKSIpLTIseDp2dShsLHMpfSkpOnMmJnIucHVzaChyLnBvcCgpKyJyb3RhdGUoIitzKyIpIiksZiE9aD91LnB1c2goe2k6ci5wdXNoKHIucG9wKCkrInNrZXdYKCIsbnVsbCwiKSIpLTIseDp2dShmLGgpfSk6aCYmci5wdXNoKHIucG9wKCkrInNrZXdYKCIraCsiKSIpLGdbMF0hPXBbMF18fGdbMV0hPXBbMV0/KGU9ci5wdXNoKHIucG9wKCkrInNjYWxlKCIsbnVsbCwiLCIsbnVsbCwiKSIpLHUucHVzaCh7aTplLTQseDp2dShnWzBdLHBbMF0pfSx7aTplLTIseDp2dShnWzFdLHBbMV0pfSkpOigxIT1wWzBdfHwxIT1wWzFdKSYmci5wdXNoKHIucG9wKCkrInNjYWxlKCIrcCsiKSIpLGU9dS5sZW5ndGgsZnVuY3Rpb24obil7Zm9yKHZhciB0LGk9LTE7KytpPGU7KXJbKHQ9dVtpXSkuaV09dC54KG4pO3JldHVybiByLmpvaW4oIiIpfX1mdW5jdGlvbiBPdShuLHQpe3JldHVybiB0PSh0LT1uPStuKXx8MS90LGZ1bmN0aW9uKGUpe3JldHVybihlLW4pL3R9fWZ1bmN0aW9uIFl1KG4sdCl7cmV0dXJuIHQ9KHQtPW49K24pfHwxL3QsZnVuY3Rpb24oZSl7cmV0dXJuIE1hdGgubWF4KDAsTWF0aC5taW4oMSwoZS1uKS90KSl9fWZ1bmN0aW9uIEl1KG4pe2Zvcih2YXIgdD1uLnNvdXJjZSxlPW4udGFyZ2V0LHI9VnUodCxlKSx1PVt0XTt0IT09cjspdD10LnBhcmVudCx1LnB1c2godCk7Zm9yKHZhciBpPXUubGVuZ3RoO2UhPT1yOyl1LnNwbGljZShpLDAsZSksZT1lLnBhcmVudDtyZXR1cm4gdX1mdW5jdGlvbiBadShuKXtmb3IodmFyIHQ9W10sZT1uLnBhcmVudDtudWxsIT1lOyl0LnB1c2gobiksbj1lLGU9ZS5wYXJlbnQ7cmV0dXJuIHQucHVzaChuKSx0fWZ1bmN0aW9uIFZ1KG4sdCl7aWYobj09PXQpcmV0dXJuIG47Zm9yKHZhciBlPVp1KG4pLHI9WnUodCksdT1lLnBvcCgpLGk9ci5wb3AoKSxvPW51bGw7dT09PWk7KW89dSx1PWUucG9wKCksaT1yLnBvcCgpO3JldHVybiBvfWZ1bmN0aW9uIFh1KG4pe24uZml4ZWR8PTJ9ZnVuY3Rpb24gJHUobil7bi5maXhlZCY9LTd9ZnVuY3Rpb24gQnUobil7bi5maXhlZHw9NCxuLnB4PW4ueCxuLnB5PW4ueX1mdW5jdGlvbiBXdShuKXtuLmZpeGVkJj0tNX1mdW5jdGlvbiBKdShuLHQsZSl7dmFyIHI9MCx1PTA7aWYobi5jaGFyZ2U9MCwhbi5sZWFmKWZvcih2YXIgaSxvPW4ubm9kZXMsYT1vLmxlbmd0aCxjPS0xOysrYzxhOylpPW9bY10sbnVsbCE9aSYmKEp1KGksdCxlKSxuLmNoYXJnZSs9aS5jaGFyZ2Uscis9aS5jaGFyZ2UqaS5jeCx1Kz1pLmNoYXJnZSppLmN5KTtpZihuLnBvaW50KXtuLmxlYWZ8fChuLnBvaW50LngrPU1hdGgucmFuZG9tKCktLjUsbi5wb2ludC55Kz1NYXRoLnJhbmRvbSgpLS41KTt2YXIgbD10KmVbbi5wb2ludC5pbmRleF07bi5jaGFyZ2UrPW4ucG9pbnRDaGFyZ2U9bCxyKz1sKm4ucG9pbnQueCx1Kz1sKm4ucG9pbnQueX1uLmN4PXIvbi5jaGFyZ2Usbi5jeT11L24uY2hhcmdlfWZ1bmN0aW9uIEd1KG4sdCl7cmV0dXJuIHRhLnJlYmluZChuLHQsInNvcnQiLCJjaGlsZHJlbiIsInZhbHVlIiksbi5ub2Rlcz1uLG4ubGlua3M9cmksbn1mdW5jdGlvbiBLdShuLHQpe2Zvcih2YXIgZT1bbl07bnVsbCE9KG49ZS5wb3AoKSk7KWlmKHQobiksKHU9bi5jaGlsZHJlbikmJihyPXUubGVuZ3RoKSlmb3IodmFyIHIsdTstLXI+PTA7KWUucHVzaCh1W3JdKX1mdW5jdGlvbiBRdShuLHQpe2Zvcih2YXIgZT1bbl0scj1bXTtudWxsIT0obj1lLnBvcCgpKTspaWYoci5wdXNoKG4pLChpPW4uY2hpbGRyZW4pJiYodT1pLmxlbmd0aCkpZm9yKHZhciB1LGksbz0tMTsrK288dTspZS5wdXNoKGlbb10pO2Zvcig7bnVsbCE9KG49ci5wb3AoKSk7KXQobil9ZnVuY3Rpb24gbmkobil7cmV0dXJuIG4uY2hpbGRyZW59ZnVuY3Rpb24gdGkobil7cmV0dXJuIG4udmFsdWV9ZnVuY3Rpb24gZWkobix0KXtyZXR1cm4gdC52YWx1ZS1uLnZhbHVlfWZ1bmN0aW9uIHJpKG4pe3JldHVybiB0YS5tZXJnZShuLm1hcChmdW5jdGlvbihuKXtyZXR1cm4obi5jaGlsZHJlbnx8W10pLm1hcChmdW5jdGlvbih0KXtyZXR1cm57c291cmNlOm4sdGFyZ2V0OnR9fSl9KSl9ZnVuY3Rpb24gdWkobil7cmV0dXJuIG4ueH1mdW5jdGlvbiBpaShuKXtyZXR1cm4gbi55fWZ1bmN0aW9uIG9pKG4sdCxlKXtuLnkwPXQsbi55PWV9ZnVuY3Rpb24gYWkobil7cmV0dXJuIHRhLnJhbmdlKG4ubGVuZ3RoKX1mdW5jdGlvbiBjaShuKXtmb3IodmFyIHQ9LTEsZT1uWzBdLmxlbmd0aCxyPVtdOysrdDxlOylyW3RdPTA7cmV0dXJuIHJ9ZnVuY3Rpb24gbGkobil7Zm9yKHZhciB0LGU9MSxyPTAsdT1uWzBdWzFdLGk9bi5sZW5ndGg7aT5lOysrZSkodD1uW2VdWzFdKT51JiYocj1lLHU9dCk7cmV0dXJuIHJ9ZnVuY3Rpb24gc2kobil7cmV0dXJuIG4ucmVkdWNlKGZpLDApfWZ1bmN0aW9uIGZpKG4sdCl7cmV0dXJuIG4rdFsxXX1mdW5jdGlvbiBoaShuLHQpe3JldHVybiBnaShuLE1hdGguY2VpbChNYXRoLmxvZyh0Lmxlbmd0aCkvTWF0aC5MTjIrMSkpfWZ1bmN0aW9uIGdpKG4sdCl7Zm9yKHZhciBlPS0xLHI9K25bMF0sdT0oblsxXS1yKS90LGk9W107KytlPD10OylpW2VdPXUqZStyO3JldHVybiBpfWZ1bmN0aW9uIHBpKG4pe3JldHVyblt0YS5taW4obiksdGEubWF4KG4pXX1mdW5jdGlvbiB2aShuLHQpe3JldHVybiBuLnZhbHVlLXQudmFsdWV9ZnVuY3Rpb24gZGkobix0KXt2YXIgZT1uLl9wYWNrX25leHQ7bi5fcGFja19uZXh0PXQsdC5fcGFja19wcmV2PW4sdC5fcGFja19uZXh0PWUsZS5fcGFja19wcmV2PXR9ZnVuY3Rpb24gbWkobix0KXtuLl9wYWNrX25leHQ9dCx0Ll9wYWNrX3ByZXY9bn1mdW5jdGlvbiB5aShuLHQpe3ZhciBlPXQueC1uLngscj10Lnktbi55LHU9bi5yK3QucjtyZXR1cm4uOTk5KnUqdT5lKmUrcipyfWZ1bmN0aW9uIE1pKG4pe2Z1bmN0aW9uIHQobil7cz1NYXRoLm1pbihuLngtbi5yLHMpLGY9TWF0aC5tYXgobi54K24ucixmKSxoPU1hdGgubWluKG4ueS1uLnIsaCksZz1NYXRoLm1heChuLnkrbi5yLGcpfWlmKChlPW4uY2hpbGRyZW4pJiYobD1lLmxlbmd0aCkpe3ZhciBlLHIsdSxpLG8sYSxjLGwscz0xLzAsZj0tMS8wLGg9MS8wLGc9LTEvMDtpZihlLmZvckVhY2goeGkpLHI9ZVswXSxyLng9LXIucixyLnk9MCx0KHIpLGw+MSYmKHU9ZVsxXSx1Lng9dS5yLHUueT0wLHQodSksbD4yKSlmb3IoaT1lWzJdLHdpKHIsdSxpKSx0KGkpLGRpKHIsaSksci5fcGFja19wcmV2PWksZGkoaSx1KSx1PXIuX3BhY2tfbmV4dCxvPTM7bD5vO28rKyl7d2kocix1LGk9ZVtvXSk7dmFyIHA9MCx2PTEsZD0xO2ZvcihhPXUuX3BhY2tfbmV4dDthIT09dTthPWEuX3BhY2tfbmV4dCx2KyspaWYoeWkoYSxpKSl7cD0xO2JyZWFrfWlmKDE9PXApZm9yKGM9ci5fcGFja19wcmV2O2MhPT1hLl9wYWNrX3ByZXYmJiF5aShjLGkpO2M9Yy5fcGFja19wcmV2LGQrKyk7cD8oZD52fHx2PT1kJiZ1LnI8ci5yP21pKHIsdT1hKTptaShyPWMsdSksby0tKTooZGkocixpKSx1PWksdChpKSl9dmFyIG09KHMrZikvMix5PShoK2cpLzIsTT0wO2ZvcihvPTA7bD5vO28rKylpPWVbb10saS54LT1tLGkueS09eSxNPU1hdGgubWF4KE0saS5yK01hdGguc3FydChpLngqaS54K2kueSppLnkpKTtuLnI9TSxlLmZvckVhY2goYmkpfX1mdW5jdGlvbiB4aShuKXtuLl9wYWNrX25leHQ9bi5fcGFja19wcmV2PW59ZnVuY3Rpb24gYmkobil7ZGVsZXRlIG4uX3BhY2tfbmV4dCxkZWxldGUgbi5fcGFja19wcmV2fWZ1bmN0aW9uIF9pKG4sdCxlLHIpe3ZhciB1PW4uY2hpbGRyZW47aWYobi54PXQrPXIqbi54LG4ueT1lKz1yKm4ueSxuLnIqPXIsdSlmb3IodmFyIGk9LTEsbz11Lmxlbmd0aDsrK2k8bzspX2kodVtpXSx0LGUscil9ZnVuY3Rpb24gd2kobix0LGUpe3ZhciByPW4ucitlLnIsdT10Lngtbi54LGk9dC55LW4ueTtpZihyJiYodXx8aSkpe3ZhciBvPXQucitlLnIsYT11KnUraSppO28qPW8scio9cjt2YXIgYz0uNSsoci1vKS8oMiphKSxsPU1hdGguc3FydChNYXRoLm1heCgwLDIqbyoocithKS0oci09YSkqci1vKm8pKS8oMiphKTtlLng9bi54K2MqdStsKmksZS55PW4ueStjKmktbCp1fWVsc2UgZS54PW4ueCtyLGUueT1uLnl9ZnVuY3Rpb24gU2kobix0KXtyZXR1cm4gbi5wYXJlbnQ9PXQucGFyZW50PzE6Mn1mdW5jdGlvbiBraShuKXt2YXIgdD1uLmNoaWxkcmVuO3JldHVybiB0Lmxlbmd0aD90WzBdOm4udH1mdW5jdGlvbiBFaShuKXt2YXIgdCxlPW4uY2hpbGRyZW47cmV0dXJuKHQ9ZS5sZW5ndGgpP2VbdC0xXTpuLnR9ZnVuY3Rpb24gQWkobix0LGUpe3ZhciByPWUvKHQuaS1uLmkpO3QuYy09cix0LnMrPWUsbi5jKz1yLHQueis9ZSx0Lm0rPWV9ZnVuY3Rpb24gTmkobil7Zm9yKHZhciB0LGU9MCxyPTAsdT1uLmNoaWxkcmVuLGk9dS5sZW5ndGg7LS1pPj0wOyl0PXVbaV0sdC56Kz1lLHQubSs9ZSxlKz10LnMrKHIrPXQuYyl9ZnVuY3Rpb24gQ2kobix0LGUpe3JldHVybiBuLmEucGFyZW50PT09dC5wYXJlbnQ/bi5hOmV9ZnVuY3Rpb24gemkobil7cmV0dXJuIDErdGEubWF4KG4sZnVuY3Rpb24obil7cmV0dXJuIG4ueX0pfWZ1bmN0aW9uIHFpKG4pe3JldHVybiBuLnJlZHVjZShmdW5jdGlvbihuLHQpe3JldHVybiBuK3QueH0sMCkvbi5sZW5ndGh9ZnVuY3Rpb24gTGkobil7dmFyIHQ9bi5jaGlsZHJlbjtyZXR1cm4gdCYmdC5sZW5ndGg/TGkodFswXSk6bn1mdW5jdGlvbiBUaShuKXt2YXIgdCxlPW4uY2hpbGRyZW47cmV0dXJuIGUmJih0PWUubGVuZ3RoKT9UaShlW3QtMV0pOm59ZnVuY3Rpb24gUmkobil7cmV0dXJue3g6bi54LHk6bi55LGR4Om4uZHgsZHk6bi5keX19ZnVuY3Rpb24gRGkobix0KXt2YXIgZT1uLngrdFszXSxyPW4ueSt0WzBdLHU9bi5keC10WzFdLXRbM10saT1uLmR5LXRbMF0tdFsyXTtyZXR1cm4gMD51JiYoZSs9dS8yLHU9MCksMD5pJiYocis9aS8yLGk9MCkse3g6ZSx5OnIsZHg6dSxkeTppfX1mdW5jdGlvbiBQaShuKXt2YXIgdD1uWzBdLGU9bltuLmxlbmd0aC0xXTtyZXR1cm4gZT50P1t0LGVdOltlLHRdfWZ1bmN0aW9uIFVpKG4pe3JldHVybiBuLnJhbmdlRXh0ZW50P24ucmFuZ2VFeHRlbnQoKTpQaShuLnJhbmdlKCkpfWZ1bmN0aW9uIGppKG4sdCxlLHIpe3ZhciB1PWUoblswXSxuWzFdKSxpPXIodFswXSx0WzFdKTtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIGkodShuKSl9fWZ1bmN0aW9uIEZpKG4sdCl7dmFyIGUscj0wLHU9bi5sZW5ndGgtMSxpPW5bcl0sbz1uW3VdO3JldHVybiBpPm8mJihlPXIscj11LHU9ZSxlPWksaT1vLG89ZSksbltyXT10LmZsb29yKGkpLG5bdV09dC5jZWlsKG8pLG59ZnVuY3Rpb24gSGkobil7cmV0dXJuIG4/e2Zsb29yOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmZsb29yKHQvbikqbn0sY2VpbDpmdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5jZWlsKHQvbikqbn19OmJsfWZ1bmN0aW9uIE9pKG4sdCxlLHIpe3ZhciB1PVtdLGk9W10sbz0wLGE9TWF0aC5taW4obi5sZW5ndGgsdC5sZW5ndGgpLTE7Zm9yKG5bYV08blswXSYmKG49bi5zbGljZSgpLnJldmVyc2UoKSx0PXQuc2xpY2UoKS5yZXZlcnNlKCkpOysrbzw9YTspdS5wdXNoKGUobltvLTFdLG5bb10pKSxpLnB1c2gocih0W28tMV0sdFtvXSkpO3JldHVybiBmdW5jdGlvbih0KXt2YXIgZT10YS5iaXNlY3Qobix0LDEsYSktMTtyZXR1cm4gaVtlXSh1W2VdKHQpKX19ZnVuY3Rpb24gWWkobix0LGUscil7ZnVuY3Rpb24gdSgpe3ZhciB1PU1hdGgubWluKG4ubGVuZ3RoLHQubGVuZ3RoKT4yP09pOmppLGM9cj9ZdTpPdTtyZXR1cm4gbz11KG4sdCxjLGUpLGE9dSh0LG4sYyxtdSksaX1mdW5jdGlvbiBpKG4pe3JldHVybiBvKG4pfXZhciBvLGE7cmV0dXJuIGkuaW52ZXJ0PWZ1bmN0aW9uKG4pe3JldHVybiBhKG4pfSxpLmRvbWFpbj1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obj10Lm1hcChOdW1iZXIpLHUoKSk6bn0saS5yYW5nZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD1uLHUoKSk6dH0saS5yYW5nZVJvdW5kPWZ1bmN0aW9uKG4pe3JldHVybiBpLnJhbmdlKG4pLmludGVycG9sYXRlKER1KX0saS5jbGFtcD1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocj1uLHUoKSk6cn0saS5pbnRlcnBvbGF0ZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZT1uLHUoKSk6ZX0saS50aWNrcz1mdW5jdGlvbih0KXtyZXR1cm4gWGkobix0KX0saS50aWNrRm9ybWF0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuICRpKG4sdCxlKX0saS5uaWNlPWZ1bmN0aW9uKHQpe3JldHVybiBaaShuLHQpLHUoKX0saS5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIFlpKG4sdCxlLHIpfSx1KCl9ZnVuY3Rpb24gSWkobix0KXtyZXR1cm4gdGEucmViaW5kKG4sdCwicmFuZ2UiLCJyYW5nZVJvdW5kIiwiaW50ZXJwb2xhdGUiLCJjbGFtcCIpfWZ1bmN0aW9uIFppKG4sdCl7cmV0dXJuIEZpKG4sSGkoVmkobix0KVsyXSkpfWZ1bmN0aW9uIFZpKG4sdCl7bnVsbD09dCYmKHQ9MTApO3ZhciBlPVBpKG4pLHI9ZVsxXS1lWzBdLHU9TWF0aC5wb3coMTAsTWF0aC5mbG9vcihNYXRoLmxvZyhyL3QpL01hdGguTE4xMCkpLGk9dC9yKnU7cmV0dXJuLjE1Pj1pP3UqPTEwOi4zNT49aT91Kj01Oi43NT49aSYmKHUqPTIpLGVbMF09TWF0aC5jZWlsKGVbMF0vdSkqdSxlWzFdPU1hdGguZmxvb3IoZVsxXS91KSp1Ky41KnUsZVsyXT11LGV9ZnVuY3Rpb24gWGkobix0KXtyZXR1cm4gdGEucmFuZ2UuYXBwbHkodGEsVmkobix0KSl9ZnVuY3Rpb24gJGkobix0LGUpe3ZhciByPVZpKG4sdCk7aWYoZSl7dmFyIHU9bGMuZXhlYyhlKTtpZih1LnNoaWZ0KCksInMiPT09dVs4XSl7dmFyIGk9dGEuZm9ybWF0UHJlZml4KE1hdGgubWF4KHZhKHJbMF0pLHZhKHJbMV0pKSk7cmV0dXJuIHVbN118fCh1WzddPSIuIitCaShpLnNjYWxlKHJbMl0pKSksdVs4XT0iZiIsZT10YS5mb3JtYXQodS5qb2luKCIiKSksZnVuY3Rpb24obil7cmV0dXJuIGUoaS5zY2FsZShuKSkraS5zeW1ib2x9fXVbN118fCh1WzddPSIuIitXaSh1WzhdLHIpKSxlPXUuam9pbigiIil9ZWxzZSBlPSIsLiIrQmkoclsyXSkrImYiO3JldHVybiB0YS5mb3JtYXQoZSl9ZnVuY3Rpb24gQmkobil7cmV0dXJuLU1hdGguZmxvb3IoTWF0aC5sb2cobikvTWF0aC5MTjEwKy4wMSl9ZnVuY3Rpb24gV2kobix0KXt2YXIgZT1CaSh0WzJdKTtyZXR1cm4gbiBpbiBfbD9NYXRoLmFicyhlLUJpKE1hdGgubWF4KHZhKHRbMF0pLHZhKHRbMV0pKSkpKyArKCJlIiE9PW4pOmUtMiooIiUiPT09bil9ZnVuY3Rpb24gSmkobix0LGUscil7ZnVuY3Rpb24gdShuKXtyZXR1cm4oZT9NYXRoLmxvZygwPm4/MDpuKTotTWF0aC5sb2cobj4wPzA6LW4pKS9NYXRoLmxvZyh0KX1mdW5jdGlvbiBpKG4pe3JldHVybiBlP01hdGgucG93KHQsbik6LU1hdGgucG93KHQsLW4pfWZ1bmN0aW9uIG8odCl7cmV0dXJuIG4odSh0KSl9cmV0dXJuIG8uaW52ZXJ0PWZ1bmN0aW9uKHQpe3JldHVybiBpKG4uaW52ZXJ0KHQpKX0sby5kb21haW49ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGU9dFswXT49MCxuLmRvbWFpbigocj10Lm1hcChOdW1iZXIpKS5tYXAodSkpLG8pOnJ9LG8uYmFzZT1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD0rZSxuLmRvbWFpbihyLm1hcCh1KSksbyk6dH0sby5uaWNlPWZ1bmN0aW9uKCl7dmFyIHQ9Rmkoci5tYXAodSksZT9NYXRoOlNsKTtyZXR1cm4gbi5kb21haW4odCkscj10Lm1hcChpKSxvfSxvLnRpY2tzPWZ1bmN0aW9uKCl7dmFyIG49UGkociksbz1bXSxhPW5bMF0sYz1uWzFdLGw9TWF0aC5mbG9vcih1KGEpKSxzPU1hdGguY2VpbCh1KGMpKSxmPXQlMT8yOnQ7aWYoaXNGaW5pdGUocy1sKSl7aWYoZSl7Zm9yKDtzPmw7bCsrKWZvcih2YXIgaD0xO2Y+aDtoKyspby5wdXNoKGkobCkqaCk7by5wdXNoKGkobCkpfWVsc2UgZm9yKG8ucHVzaChpKGwpKTtsKys8czspZm9yKHZhciBoPWYtMTtoPjA7aC0tKW8ucHVzaChpKGwpKmgpO2ZvcihsPTA7b1tsXTxhO2wrKyk7Zm9yKHM9by5sZW5ndGg7b1tzLTFdPmM7cy0tKTtvPW8uc2xpY2UobCxzKX1yZXR1cm4gb30sby50aWNrRm9ybWF0PWZ1bmN0aW9uKG4sdCl7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHdsO2FyZ3VtZW50cy5sZW5ndGg8Mj90PXdsOiJmdW5jdGlvbiIhPXR5cGVvZiB0JiYodD10YS5mb3JtYXQodCkpO3ZhciByLGE9TWF0aC5tYXgoLjEsbi9vLnRpY2tzKCkubGVuZ3RoKSxjPWU/KHI9MWUtMTIsTWF0aC5jZWlsKToocj0tMWUtMTIsTWF0aC5mbG9vcik7cmV0dXJuIGZ1bmN0aW9uKG4pe3JldHVybiBuL2koYyh1KG4pK3IpKTw9YT90KG4pOiIifX0sby5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIEppKG4uY29weSgpLHQsZSxyKX0sSWkobyxuKX1mdW5jdGlvbiBHaShuLHQsZSl7ZnVuY3Rpb24gcih0KXtyZXR1cm4gbih1KHQpKX12YXIgdT1LaSh0KSxpPUtpKDEvdCk7cmV0dXJuIHIuaW52ZXJ0PWZ1bmN0aW9uKHQpe3JldHVybiBpKG4uaW52ZXJ0KHQpKX0sci5kb21haW49ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG4uZG9tYWluKChlPXQubWFwKE51bWJlcikpLm1hcCh1KSkscik6ZX0sci50aWNrcz1mdW5jdGlvbihuKXtyZXR1cm4gWGkoZSxuKX0sci50aWNrRm9ybWF0PWZ1bmN0aW9uKG4sdCl7cmV0dXJuICRpKGUsbix0KX0sci5uaWNlPWZ1bmN0aW9uKG4pe3JldHVybiByLmRvbWFpbihaaShlLG4pKX0sci5leHBvbmVudD1mdW5jdGlvbihvKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT1LaSh0PW8pLGk9S2koMS90KSxuLmRvbWFpbihlLm1hcCh1KSkscik6dH0sci5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIEdpKG4uY29weSgpLHQsZSl9LElpKHIsbil9ZnVuY3Rpb24gS2kobil7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiAwPnQ/LU1hdGgucG93KC10LG4pOk1hdGgucG93KHQsbil9fWZ1bmN0aW9uIFFpKG4sdCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4gaVsoKHUuZ2V0KGUpfHwoInJhbmdlIj09PXQudD91LnNldChlLG4ucHVzaChlKSk6MC8wKSktMSklaS5sZW5ndGhdfWZ1bmN0aW9uIHIodCxlKXtyZXR1cm4gdGEucmFuZ2Uobi5sZW5ndGgpLm1hcChmdW5jdGlvbihuKXtyZXR1cm4gdCtlKm59KX12YXIgdSxpLG87cmV0dXJuIGUuZG9tYWluPWZ1bmN0aW9uKHIpe2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiBuO249W10sdT1uZXcgYTtmb3IodmFyIGksbz0tMSxjPXIubGVuZ3RoOysrbzxjOyl1LmhhcyhpPXJbb10pfHx1LnNldChpLG4ucHVzaChpKSk7cmV0dXJuIGVbdC50XS5hcHBseShlLHQuYSl9LGUucmFuZ2U9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGk9bixvPTAsdD17dDoicmFuZ2UiLGE6YXJndW1lbnRzfSxlKTppfSxlLnJhbmdlUG9pbnRzPWZ1bmN0aW9uKHUsYSl7YXJndW1lbnRzLmxlbmd0aDwyJiYoYT0wKTt2YXIgYz11WzBdLGw9dVsxXSxzPW4ubGVuZ3RoPDI/KGM9KGMrbCkvMiwwKToobC1jKS8obi5sZW5ndGgtMSthKTtyZXR1cm4gaT1yKGMrcyphLzIscyksbz0wLHQ9e3Q6InJhbmdlUG9pbnRzIixhOmFyZ3VtZW50c30sZX0sZS5yYW5nZVJvdW5kUG9pbnRzPWZ1bmN0aW9uKHUsYSl7YXJndW1lbnRzLmxlbmd0aDwyJiYoYT0wKTt2YXIgYz11WzBdLGw9dVsxXSxzPW4ubGVuZ3RoPDI/KGM9bD1NYXRoLnJvdW5kKChjK2wpLzIpLDApOjB8KGwtYykvKG4ubGVuZ3RoLTErYSk7cmV0dXJuIGk9cihjK01hdGgucm91bmQocyphLzIrKGwtYy0obi5sZW5ndGgtMSthKSpzKS8yKSxzKSxvPTAsdD17dDoicmFuZ2VSb3VuZFBvaW50cyIsYTphcmd1bWVudHN9LGV9LGUucmFuZ2VCYW5kcz1mdW5jdGlvbih1LGEsYyl7YXJndW1lbnRzLmxlbmd0aDwyJiYoYT0wKSxhcmd1bWVudHMubGVuZ3RoPDMmJihjPWEpO3ZhciBsPXVbMV08dVswXSxzPXVbbC0wXSxmPXVbMS1sXSxoPShmLXMpLyhuLmxlbmd0aC1hKzIqYyk7cmV0dXJuIGk9cihzK2gqYyxoKSxsJiZpLnJldmVyc2UoKSxvPWgqKDEtYSksdD17dDoicmFuZ2VCYW5kcyIsYTphcmd1bWVudHN9LGV9LGUucmFuZ2VSb3VuZEJhbmRzPWZ1bmN0aW9uKHUsYSxjKXthcmd1bWVudHMubGVuZ3RoPDImJihhPTApLGFyZ3VtZW50cy5sZW5ndGg8MyYmKGM9YSk7dmFyIGw9dVsxXTx1WzBdLHM9dVtsLTBdLGY9dVsxLWxdLGg9TWF0aC5mbG9vcigoZi1zKS8obi5sZW5ndGgtYSsyKmMpKTtyZXR1cm4gaT1yKHMrTWF0aC5yb3VuZCgoZi1zLShuLmxlbmd0aC1hKSpoKS8yKSxoKSxsJiZpLnJldmVyc2UoKSxvPU1hdGgucm91bmQoaCooMS1hKSksdD17dDoicmFuZ2VSb3VuZEJhbmRzIixhOmFyZ3VtZW50c30sZX0sZS5yYW5nZUJhbmQ9ZnVuY3Rpb24oKXtyZXR1cm4gb30sZS5yYW5nZUV4dGVudD1mdW5jdGlvbigpe3JldHVybiBQaSh0LmFbMF0pfSxlLmNvcHk9ZnVuY3Rpb24oKXtyZXR1cm4gUWkobix0KX0sZS5kb21haW4obil9ZnVuY3Rpb24gbm8ocix1KXtmdW5jdGlvbiBpKCl7dmFyIG49MCx0PXUubGVuZ3RoO2ZvcihhPVtdOysrbjx0OylhW24tMV09dGEucXVhbnRpbGUocixuL3QpO3JldHVybiBvfWZ1bmN0aW9uIG8obil7cmV0dXJuIGlzTmFOKG49K24pP3ZvaWQgMDp1W3RhLmJpc2VjdChhLG4pXX12YXIgYTtyZXR1cm4gby5kb21haW49ZnVuY3Rpb24odSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9dS5tYXAodCkuZmlsdGVyKGUpLnNvcnQobiksaSgpKTpyfSxvLnJhbmdlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh1PW4saSgpKTp1fSxvLnF1YW50aWxlcz1mdW5jdGlvbigpe3JldHVybiBhfSxvLmludmVydEV4dGVudD1mdW5jdGlvbihuKXtyZXR1cm4gbj11LmluZGV4T2YobiksMD5uP1swLzAsMC8wXTpbbj4wP2Fbbi0xXTpyWzBdLG48YS5sZW5ndGg/YVtuXTpyW3IubGVuZ3RoLTFdXX0sby5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIG5vKHIsdSl9LGkoKX1mdW5jdGlvbiB0byhuLHQsZSl7ZnVuY3Rpb24gcih0KXtyZXR1cm4gZVtNYXRoLm1heCgwLE1hdGgubWluKG8sTWF0aC5mbG9vcihpKih0LW4pKSkpXX1mdW5jdGlvbiB1KCl7cmV0dXJuIGk9ZS5sZW5ndGgvKHQtbiksbz1lLmxlbmd0aC0xLHJ9dmFyIGksbztyZXR1cm4gci5kb21haW49ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG49K2VbMF0sdD0rZVtlLmxlbmd0aC0xXSx1KCkpOltuLHRdfSxyLnJhbmdlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPW4sdSgpKTplfSxyLmludmVydEV4dGVudD1mdW5jdGlvbih0KXtyZXR1cm4gdD1lLmluZGV4T2YodCksdD0wPnQ/MC8wOnQvaStuLFt0LHQrMS9pXX0sci5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIHRvKG4sdCxlKX0sdSgpfWZ1bmN0aW9uIGVvKG4sdCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4gZT49ZT90W3RhLmJpc2VjdChuLGUpXTp2b2lkIDB9cmV0dXJuIGUuZG9tYWluPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhuPXQsZSk6bn0sZS5yYW5nZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD1uLGUpOnR9LGUuaW52ZXJ0RXh0ZW50PWZ1bmN0aW9uKGUpe3JldHVybiBlPXQuaW5kZXhPZihlKSxbbltlLTFdLG5bZV1dfSxlLmNvcHk9ZnVuY3Rpb24oKXtyZXR1cm4gZW8obix0KX0sZX1mdW5jdGlvbiBybyhuKXtmdW5jdGlvbiB0KG4pe3JldHVybitufXJldHVybiB0LmludmVydD10LHQuZG9tYWluPXQucmFuZ2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG49ZS5tYXAodCksdCk6bn0sdC50aWNrcz1mdW5jdGlvbih0KXtyZXR1cm4gWGkobix0KX0sdC50aWNrRm9ybWF0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuICRpKG4sdCxlKX0sdC5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIHJvKG4pfSx0fWZ1bmN0aW9uIHVvKCl7cmV0dXJuIDB9ZnVuY3Rpb24gaW8obil7cmV0dXJuIG4uaW5uZXJSYWRpdXN9ZnVuY3Rpb24gb28obil7cmV0dXJuIG4ub3V0ZXJSYWRpdXN9ZnVuY3Rpb24gYW8obil7cmV0dXJuIG4uc3RhcnRBbmdsZX1mdW5jdGlvbiBjbyhuKXtyZXR1cm4gbi5lbmRBbmdsZX1mdW5jdGlvbiBsbyhuKXtyZXR1cm4gbiYmbi5wYWRBbmdsZX1mdW5jdGlvbiBzbyhuLHQsZSxyKXtyZXR1cm4obi1lKSp0LSh0LXIpKm4+MD8wOjF9ZnVuY3Rpb24gZm8obix0LGUscix1KXt2YXIgaT1uWzBdLXRbMF0sbz1uWzFdLXRbMV0sYT0odT9yOi1yKS9NYXRoLnNxcnQoaSppK28qbyksYz1hKm8sbD0tYSppLHM9blswXStjLGY9blsxXStsLGg9dFswXStjLGc9dFsxXStsLHA9KHMraCkvMix2PShmK2cpLzIsZD1oLXMsbT1nLWYseT1kKmQrbSptLE09ZS1yLHg9cypnLWgqZixiPSgwPm0/LTE6MSkqTWF0aC5zcXJ0KE0qTSp5LXgqeCksXz0oeCptLWQqYikveSx3PSgteCpkLW0qYikveSxTPSh4Km0rZCpiKS95LGs9KC14KmQrbSpiKS95LEU9Xy1wLEE9dy12LE49Uy1wLEM9ay12O3JldHVybiBFKkUrQSpBPk4qTitDKkMmJihfPVMsdz1rKSxbW18tYyx3LWxdLFtfKmUvTSx3KmUvTV1dfWZ1bmN0aW9uIGhvKG4pe2Z1bmN0aW9uIHQodCl7ZnVuY3Rpb24gbygpe2wucHVzaCgiTSIsaShuKHMpLGEpKX1mb3IodmFyIGMsbD1bXSxzPVtdLGY9LTEsaD10Lmxlbmd0aCxnPWt0KGUpLHA9a3Qocik7KytmPGg7KXUuY2FsbCh0aGlzLGM9dFtmXSxmKT9zLnB1c2goWytnLmNhbGwodGhpcyxjLGYpLCtwLmNhbGwodGhpcyxjLGYpXSk6cy5sZW5ndGgmJihvKCkscz1bXSk7cmV0dXJuIHMubGVuZ3RoJiZvKCksbC5sZW5ndGg/bC5qb2luKCIiKTpudWxsfXZhciBlPUFyLHI9TnIsdT1OZSxpPWdvLG89aS5rZXksYT0uNztyZXR1cm4gdC54PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPW4sdCk6ZX0sdC55PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPW4sdCk6cn0sdC5kZWZpbmVkPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh1PW4sdCk6dX0sdC5pbnRlcnBvbGF0ZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obz0iZnVuY3Rpb24iPT10eXBlb2Ygbj9pPW46KGk9emwuZ2V0KG4pfHxnbykua2V5LHQpOm99LHQudGVuc2lvbj1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oYT1uLHQpOmF9LHR9ZnVuY3Rpb24gZ28obil7cmV0dXJuIG4uam9pbigiTCIpfWZ1bmN0aW9uIHBvKG4pe3JldHVybiBnbyhuKSsiWiJ9ZnVuY3Rpb24gdm8obil7Zm9yKHZhciB0PTAsZT1uLmxlbmd0aCxyPW5bMF0sdT1bclswXSwiLCIsclsxXV07Kyt0PGU7KXUucHVzaCgiSCIsKHJbMF0rKHI9blt0XSlbMF0pLzIsIlYiLHJbMV0pO3JldHVybiBlPjEmJnUucHVzaCgiSCIsclswXSksdS5qb2luKCIiKX1mdW5jdGlvbiBtbyhuKXtmb3IodmFyIHQ9MCxlPW4ubGVuZ3RoLHI9blswXSx1PVtyWzBdLCIsIixyWzFdXTsrK3Q8ZTspdS5wdXNoKCJWIiwocj1uW3RdKVsxXSwiSCIsclswXSk7cmV0dXJuIHUuam9pbigiIil9ZnVuY3Rpb24geW8obil7Zm9yKHZhciB0PTAsZT1uLmxlbmd0aCxyPW5bMF0sdT1bclswXSwiLCIsclsxXV07Kyt0PGU7KXUucHVzaCgiSCIsKHI9blt0XSlbMF0sIlYiLHJbMV0pO3JldHVybiB1LmpvaW4oIiIpfWZ1bmN0aW9uIE1vKG4sdCl7cmV0dXJuIG4ubGVuZ3RoPDQ/Z28obik6blsxXStfbyhuLnNsaWNlKDEsLTEpLHdvKG4sdCkpfWZ1bmN0aW9uIHhvKG4sdCl7cmV0dXJuIG4ubGVuZ3RoPDM/Z28obik6blswXStfbygobi5wdXNoKG5bMF0pLG4pLHdvKFtuW24ubGVuZ3RoLTJdXS5jb25jYXQobixbblsxXV0pLHQpKX1mdW5jdGlvbiBibyhuLHQpe3JldHVybiBuLmxlbmd0aDwzP2dvKG4pOm5bMF0rX28obix3byhuLHQpKX1mdW5jdGlvbiBfbyhuLHQpe2lmKHQubGVuZ3RoPDF8fG4ubGVuZ3RoIT10Lmxlbmd0aCYmbi5sZW5ndGghPXQubGVuZ3RoKzIpcmV0dXJuIGdvKG4pO3ZhciBlPW4ubGVuZ3RoIT10Lmxlbmd0aCxyPSIiLHU9blswXSxpPW5bMV0sbz10WzBdLGE9byxjPTE7aWYoZSYmKHIrPSJRIisoaVswXS0yKm9bMF0vMykrIiwiKyhpWzFdLTIqb1sxXS8zKSsiLCIraVswXSsiLCIraVsxXSx1PW5bMV0sYz0yKSx0Lmxlbmd0aD4xKXthPXRbMV0saT1uW2NdLGMrKyxyKz0iQyIrKHVbMF0rb1swXSkrIiwiKyh1WzFdK29bMV0pKyIsIisoaVswXS1hWzBdKSsiLCIrKGlbMV0tYVsxXSkrIiwiK2lbMF0rIiwiK2lbMV07Zm9yKHZhciBsPTI7bDx0Lmxlbmd0aDtsKyssYysrKWk9bltjXSxhPXRbbF0scis9IlMiKyhpWzBdLWFbMF0pKyIsIisoaVsxXS1hWzFdKSsiLCIraVswXSsiLCIraVsxXX1pZihlKXt2YXIgcz1uW2NdO3IrPSJRIisoaVswXSsyKmFbMF0vMykrIiwiKyhpWzFdKzIqYVsxXS8zKSsiLCIrc1swXSsiLCIrc1sxXX1yZXR1cm4gcn1mdW5jdGlvbiB3byhuLHQpe2Zvcih2YXIgZSxyPVtdLHU9KDEtdCkvMixpPW5bMF0sbz1uWzFdLGE9MSxjPW4ubGVuZ3RoOysrYTxjOyllPWksaT1vLG89blthXSxyLnB1c2goW3UqKG9bMF0tZVswXSksdSoob1sxXS1lWzFdKV0pO3JldHVybiByfWZ1bmN0aW9uIFNvKG4pe2lmKG4ubGVuZ3RoPDMpcmV0dXJuIGdvKG4pO3ZhciB0PTEsZT1uLmxlbmd0aCxyPW5bMF0sdT1yWzBdLGk9clsxXSxvPVt1LHUsdSwocj1uWzFdKVswXV0sYT1baSxpLGksclsxXV0sYz1bdSwiLCIsaSwiTCIsTm8oVGwsbyksIiwiLE5vKFRsLGEpXTtmb3Iobi5wdXNoKG5bZS0xXSk7Kyt0PD1lOylyPW5bdF0sby5zaGlmdCgpLG8ucHVzaChyWzBdKSxhLnNoaWZ0KCksYS5wdXNoKHJbMV0pLENvKGMsbyxhKTtyZXR1cm4gbi5wb3AoKSxjLnB1c2goIkwiLHIpLGMuam9pbigiIil9ZnVuY3Rpb24ga28obil7aWYobi5sZW5ndGg8NClyZXR1cm4gZ28obik7Zm9yKHZhciB0LGU9W10scj0tMSx1PW4ubGVuZ3RoLGk9WzBdLG89WzBdOysrcjwzOyl0PW5bcl0saS5wdXNoKHRbMF0pLG8ucHVzaCh0WzFdKTtmb3IoZS5wdXNoKE5vKFRsLGkpKyIsIitObyhUbCxvKSksLS1yOysrcjx1Oyl0PW5bcl0saS5zaGlmdCgpLGkucHVzaCh0WzBdKSxvLnNoaWZ0KCksby5wdXNoKHRbMV0pLENvKGUsaSxvKTtyZXR1cm4gZS5qb2luKCIiKX1mdW5jdGlvbiBFbyhuKXtmb3IodmFyIHQsZSxyPS0xLHU9bi5sZW5ndGgsaT11KzQsbz1bXSxhPVtdOysrcjw0OyllPW5bciV1XSxvLnB1c2goZVswXSksYS5wdXNoKGVbMV0pO2Zvcih0PVtObyhUbCxvKSwiLCIsTm8oVGwsYSldLC0tcjsrK3I8aTspZT1uW3IldV0sby5zaGlmdCgpLG8ucHVzaChlWzBdKSxhLnNoaWZ0KCksYS5wdXNoKGVbMV0pLENvKHQsbyxhKTtyZXR1cm4gdC5qb2luKCIiKX1mdW5jdGlvbiBBbyhuLHQpe3ZhciBlPW4ubGVuZ3RoLTE7aWYoZSlmb3IodmFyIHIsdSxpPW5bMF1bMF0sbz1uWzBdWzFdLGE9bltlXVswXS1pLGM9bltlXVsxXS1vLGw9LTE7KytsPD1lOylyPW5bbF0sdT1sL2UsclswXT10KnJbMF0rKDEtdCkqKGkrdSphKSxyWzFdPXQqclsxXSsoMS10KSoobyt1KmMpO3JldHVybiBTbyhuKX1mdW5jdGlvbiBObyhuLHQpe3JldHVybiBuWzBdKnRbMF0rblsxXSp0WzFdK25bMl0qdFsyXStuWzNdKnRbM119ZnVuY3Rpb24gQ28obix0LGUpe24ucHVzaCgiQyIsTm8ocWwsdCksIiwiLE5vKHFsLGUpLCIsIixObyhMbCx0KSwiLCIsTm8oTGwsZSksIiwiLE5vKFRsLHQpLCIsIixObyhUbCxlKSl9ZnVuY3Rpb24gem8obix0KXtyZXR1cm4odFsxXS1uWzFdKS8odFswXS1uWzBdKX1mdW5jdGlvbiBxbyhuKXtmb3IodmFyIHQ9MCxlPW4ubGVuZ3RoLTEscj1bXSx1PW5bMF0saT1uWzFdLG89clswXT16byh1LGkpOysrdDxlOylyW3RdPShvKyhvPXpvKHU9aSxpPW5bdCsxXSkpKS8yO3JldHVybiByW3RdPW8scn1mdW5jdGlvbiBMbyhuKXtmb3IodmFyIHQsZSxyLHUsaT1bXSxvPXFvKG4pLGE9LTEsYz1uLmxlbmd0aC0xOysrYTxjOyl0PXpvKG5bYV0sblthKzFdKSx2YSh0KTxUYT9vW2FdPW9bYSsxXT0wOihlPW9bYV0vdCxyPW9bYSsxXS90LHU9ZSplK3Iqcix1PjkmJih1PTMqdC9NYXRoLnNxcnQodSksb1thXT11KmUsb1thKzFdPXUqcikpO2ZvcihhPS0xOysrYTw9YzspdT0obltNYXRoLm1pbihjLGErMSldWzBdLW5bTWF0aC5tYXgoMCxhLTEpXVswXSkvKDYqKDErb1thXSpvW2FdKSksaS5wdXNoKFt1fHwwLG9bYV0qdXx8MF0pO3JldHVybiBpfWZ1bmN0aW9uIFRvKG4pe3JldHVybiBuLmxlbmd0aDwzP2dvKG4pOm5bMF0rX28obixMbyhuKSl9ZnVuY3Rpb24gUm8obil7Zm9yKHZhciB0LGUscix1PS0xLGk9bi5sZW5ndGg7Kyt1PGk7KXQ9blt1XSxlPXRbMF0scj10WzFdLWphLHRbMF09ZSpNYXRoLmNvcyhyKSx0WzFdPWUqTWF0aC5zaW4ocik7cmV0dXJuIG59ZnVuY3Rpb24gRG8obil7ZnVuY3Rpb24gdCh0KXtmdW5jdGlvbiBjKCl7di5wdXNoKCJNIixhKG4obSksZikscyxsKG4oZC5yZXZlcnNlKCkpLGYpLCJaIil9Zm9yKHZhciBoLGcscCx2PVtdLGQ9W10sbT1bXSx5PS0xLE09dC5sZW5ndGgseD1rdChlKSxiPWt0KHUpLF89ZT09PXI/ZnVuY3Rpb24oKXtyZXR1cm4gZ306a3Qociksdz11PT09aT9mdW5jdGlvbigpe3JldHVybiBwfTprdChpKTsrK3k8TTspby5jYWxsKHRoaXMsaD10W3ldLHkpPyhkLnB1c2goW2c9K3guY2FsbCh0aGlzLGgseSkscD0rYi5jYWxsKHRoaXMsaCx5KV0pLG0ucHVzaChbK18uY2FsbCh0aGlzLGgseSksK3cuY2FsbCh0aGlzLGgseSldKSk6ZC5sZW5ndGgmJihjKCksZD1bXSxtPVtdKTtyZXR1cm4gZC5sZW5ndGgmJmMoKSx2Lmxlbmd0aD92LmpvaW4oIiIpOm51bGx9dmFyIGU9QXIscj1Bcix1PTAsaT1OcixvPU5lLGE9Z28sYz1hLmtleSxsPWEscz0iTCIsZj0uNztyZXR1cm4gdC54PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPXI9bix0KTpyfSx0LngwPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPW4sdCk6ZX0sdC54MT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocj1uLHQpOnJ9LHQueT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT1pPW4sdCk6aX0sdC55MD1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT1uLHQpOnV9LHQueTE9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGk9bix0KTppfSx0LmRlZmluZWQ9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG89bix0KTpvfSx0LmludGVycG9sYXRlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhjPSJmdW5jdGlvbiI9PXR5cGVvZiBuP2E9bjooYT16bC5nZXQobil8fGdvKS5rZXksbD1hLnJldmVyc2V8fGEscz1hLmNsb3NlZD8iTSI6IkwiLHQpOmMKfSx0LnRlbnNpb249ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGY9bix0KTpmfSx0fWZ1bmN0aW9uIFBvKG4pe3JldHVybiBuLnJhZGl1c31mdW5jdGlvbiBVbyhuKXtyZXR1cm5bbi54LG4ueV19ZnVuY3Rpb24gam8obil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9bi5hcHBseSh0aGlzLGFyZ3VtZW50cyksZT10WzBdLHI9dFsxXS1qYTtyZXR1cm5bZSpNYXRoLmNvcyhyKSxlKk1hdGguc2luKHIpXX19ZnVuY3Rpb24gRm8oKXtyZXR1cm4gNjR9ZnVuY3Rpb24gSG8oKXtyZXR1cm4iY2lyY2xlIn1mdW5jdGlvbiBPbyhuKXt2YXIgdD1NYXRoLnNxcnQobi9EYSk7cmV0dXJuIk0wLCIrdCsiQSIrdCsiLCIrdCsiIDAgMSwxIDAsIistdCsiQSIrdCsiLCIrdCsiIDAgMSwxIDAsIit0KyJaIn1mdW5jdGlvbiBZbyhuKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdCxlOyh0PXRoaXNbbl0pJiYoZT10W3QuYWN0aXZlXSkmJigtLXQuY291bnQ/ZGVsZXRlIHRbdC5hY3RpdmVdOmRlbGV0ZSB0aGlzW25dLHQuYWN0aXZlKz0uNSxlLmV2ZW50JiZlLmV2ZW50LmludGVycnVwdC5jYWxsKHRoaXMsdGhpcy5fX2RhdGFfXyxlLmluZGV4KSl9fWZ1bmN0aW9uIElvKG4sdCxlKXtyZXR1cm4geGEobixIbCksbi5uYW1lc3BhY2U9dCxuLmlkPWUsbn1mdW5jdGlvbiBabyhuLHQsZSxyKXt2YXIgdT1uLmlkLGk9bi5uYW1lc3BhY2U7cmV0dXJuIEgobiwiZnVuY3Rpb24iPT10eXBlb2YgZT9mdW5jdGlvbihuLG8sYSl7bltpXVt1XS50d2Vlbi5zZXQodCxyKGUuY2FsbChuLG4uX19kYXRhX18sbyxhKSkpfTooZT1yKGUpLGZ1bmN0aW9uKG4pe25baV1bdV0udHdlZW4uc2V0KHQsZSl9KSl9ZnVuY3Rpb24gVm8obil7cmV0dXJuIG51bGw9PW4mJihuPSIiKSxmdW5jdGlvbigpe3RoaXMudGV4dENvbnRlbnQ9bn19ZnVuY3Rpb24gWG8obil7cmV0dXJuIG51bGw9PW4/Il9fdHJhbnNpdGlvbl9fIjoiX190cmFuc2l0aW9uXyIrbisiX18ifWZ1bmN0aW9uICRvKG4sdCxlLHIsdSl7dmFyIGk9bltlXXx8KG5bZV09e2FjdGl2ZTowLGNvdW50OjB9KSxvPWlbcl07aWYoIW8pe3ZhciBjPXUudGltZTtvPWlbcl09e3R3ZWVuOm5ldyBhLHRpbWU6YyxkZWxheTp1LmRlbGF5LGR1cmF0aW9uOnUuZHVyYXRpb24sZWFzZTp1LmVhc2UsaW5kZXg6dH0sdT1udWxsLCsraS5jb3VudCx0YS50aW1lcihmdW5jdGlvbih1KXtmdW5jdGlvbiBhKGUpe2lmKGkuYWN0aXZlPnIpcmV0dXJuIHMoKTt2YXIgdT1pW2kuYWN0aXZlXTt1JiYoLS1pLmNvdW50LGRlbGV0ZSBpW2kuYWN0aXZlXSx1LmV2ZW50JiZ1LmV2ZW50LmludGVycnVwdC5jYWxsKG4sbi5fX2RhdGFfXyx1LmluZGV4KSksaS5hY3RpdmU9cixvLmV2ZW50JiZvLmV2ZW50LnN0YXJ0LmNhbGwobixuLl9fZGF0YV9fLHQpLG8udHdlZW4uZm9yRWFjaChmdW5jdGlvbihlLHIpeyhyPXIuY2FsbChuLG4uX19kYXRhX18sdCkpJiZ2LnB1c2gocil9KSxoPW8uZWFzZSxmPW8uZHVyYXRpb24sdGEudGltZXIoZnVuY3Rpb24oKXtyZXR1cm4gcC5jPWwoZXx8MSk/TmU6bCwxfSwwLGMpfWZ1bmN0aW9uIGwoZSl7aWYoaS5hY3RpdmUhPT1yKXJldHVybiAxO2Zvcih2YXIgdT1lL2YsYT1oKHUpLGM9di5sZW5ndGg7Yz4wOyl2Wy0tY10uY2FsbChuLGEpO3JldHVybiB1Pj0xPyhvLmV2ZW50JiZvLmV2ZW50LmVuZC5jYWxsKG4sbi5fX2RhdGFfXyx0KSxzKCkpOnZvaWQgMH1mdW5jdGlvbiBzKCl7cmV0dXJuLS1pLmNvdW50P2RlbGV0ZSBpW3JdOmRlbGV0ZSBuW2VdLDF9dmFyIGYsaCxnPW8uZGVsYXkscD1vYyx2PVtdO3JldHVybiBwLnQ9ZytjLHU+PWc/YSh1LWcpOihwLmM9YSx2b2lkIDApfSwwLGMpfX1mdW5jdGlvbiBCbyhuLHQsZSl7bi5hdHRyKCJ0cmFuc2Zvcm0iLGZ1bmN0aW9uKG4pe3ZhciByPXQobik7cmV0dXJuInRyYW5zbGF0ZSgiKyhpc0Zpbml0ZShyKT9yOmUobikpKyIsMCkifSl9ZnVuY3Rpb24gV28obix0LGUpe24uYXR0cigidHJhbnNmb3JtIixmdW5jdGlvbihuKXt2YXIgcj10KG4pO3JldHVybiJ0cmFuc2xhdGUoMCwiKyhpc0Zpbml0ZShyKT9yOmUobikpKyIpIn0pfWZ1bmN0aW9uIEpvKG4pe3JldHVybiBuLnRvSVNPU3RyaW5nKCl9ZnVuY3Rpb24gR28obix0LGUpe2Z1bmN0aW9uIHIodCl7cmV0dXJuIG4odCl9ZnVuY3Rpb24gdShuLGUpe3ZhciByPW5bMV0tblswXSx1PXIvZSxpPXRhLmJpc2VjdChXbCx1KTtyZXR1cm4gaT09V2wubGVuZ3RoP1t0LnllYXIsVmkobi5tYXAoZnVuY3Rpb24obil7cmV0dXJuIG4vMzE1MzZlNn0pLGUpWzJdXTppP3RbdS9XbFtpLTFdPFdsW2ldL3U/aS0xOmldOltLbCxWaShuLGUpWzJdXX1yZXR1cm4gci5pbnZlcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIEtvKG4uaW52ZXJ0KHQpKX0sci5kb21haW49ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG4uZG9tYWluKHQpLHIpOm4uZG9tYWluKCkubWFwKEtvKX0sci5uaWNlPWZ1bmN0aW9uKG4sdCl7ZnVuY3Rpb24gZShlKXtyZXR1cm4haXNOYU4oZSkmJiFuLnJhbmdlKGUsS28oK2UrMSksdCkubGVuZ3RofXZhciBpPXIuZG9tYWluKCksbz1QaShpKSxhPW51bGw9PW4/dShvLDEwKToibnVtYmVyIj09dHlwZW9mIG4mJnUobyxuKTtyZXR1cm4gYSYmKG49YVswXSx0PWFbMV0pLHIuZG9tYWluKEZpKGksdD4xP3tmbG9vcjpmdW5jdGlvbih0KXtmb3IoO2UodD1uLmZsb29yKHQpKTspdD1Lbyh0LTEpO3JldHVybiB0fSxjZWlsOmZ1bmN0aW9uKHQpe2Zvcig7ZSh0PW4uY2VpbCh0KSk7KXQ9S28oK3QrMSk7cmV0dXJuIHR9fTpuKSl9LHIudGlja3M9ZnVuY3Rpb24obix0KXt2YXIgZT1QaShyLmRvbWFpbigpKSxpPW51bGw9PW4/dShlLDEwKToibnVtYmVyIj09dHlwZW9mIG4/dShlLG4pOiFuLnJhbmdlJiZbe3JhbmdlOm59LHRdO3JldHVybiBpJiYobj1pWzBdLHQ9aVsxXSksbi5yYW5nZShlWzBdLEtvKCtlWzFdKzEpLDE+dD8xOnQpfSxyLnRpY2tGb3JtYXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZX0sci5jb3B5PWZ1bmN0aW9uKCl7cmV0dXJuIEdvKG4uY29weSgpLHQsZSl9LElpKHIsbil9ZnVuY3Rpb24gS28obil7cmV0dXJuIG5ldyBEYXRlKG4pfWZ1bmN0aW9uIFFvKG4pe3JldHVybiBKU09OLnBhcnNlKG4ucmVzcG9uc2VUZXh0KX1mdW5jdGlvbiBuYShuKXt2YXIgdD11YS5jcmVhdGVSYW5nZSgpO3JldHVybiB0LnNlbGVjdE5vZGUodWEuYm9keSksdC5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQobi5yZXNwb25zZVRleHQpfXZhciB0YT17dmVyc2lvbjoiMy41LjMifTtEYXRlLm5vd3x8KERhdGUubm93PWZ1bmN0aW9uKCl7cmV0dXJuK25ldyBEYXRlfSk7dmFyIGVhPVtdLnNsaWNlLHJhPWZ1bmN0aW9uKG4pe3JldHVybiBlYS5jYWxsKG4pfSx1YT1kb2N1bWVudCxpYT11YS5kb2N1bWVudEVsZW1lbnQsb2E9d2luZG93O3RyeXtyYShpYS5jaGlsZE5vZGVzKVswXS5ub2RlVHlwZX1jYXRjaChhYSl7cmE9ZnVuY3Rpb24obil7Zm9yKHZhciB0PW4ubGVuZ3RoLGU9bmV3IEFycmF5KHQpO3QtLTspZVt0XT1uW3RdO3JldHVybiBlfX10cnl7dWEuY3JlYXRlRWxlbWVudCgiZGl2Iikuc3R5bGUuc2V0UHJvcGVydHkoIm9wYWNpdHkiLDAsIiIpfWNhdGNoKGNhKXt2YXIgbGE9b2EuRWxlbWVudC5wcm90b3R5cGUsc2E9bGEuc2V0QXR0cmlidXRlLGZhPWxhLnNldEF0dHJpYnV0ZU5TLGhhPW9hLkNTU1N0eWxlRGVjbGFyYXRpb24ucHJvdG90eXBlLGdhPWhhLnNldFByb3BlcnR5O2xhLnNldEF0dHJpYnV0ZT1mdW5jdGlvbihuLHQpe3NhLmNhbGwodGhpcyxuLHQrIiIpfSxsYS5zZXRBdHRyaWJ1dGVOUz1mdW5jdGlvbihuLHQsZSl7ZmEuY2FsbCh0aGlzLG4sdCxlKyIiKX0saGEuc2V0UHJvcGVydHk9ZnVuY3Rpb24obix0LGUpe2dhLmNhbGwodGhpcyxuLHQrIiIsZSl9fXRhLmFzY2VuZGluZz1uLHRhLmRlc2NlbmRpbmc9ZnVuY3Rpb24obix0KXtyZXR1cm4gbj50Py0xOnQ+bj8xOnQ+PW4/MDowLzB9LHRhLm1pbj1mdW5jdGlvbihuLHQpe3ZhciBlLHIsdT0tMSxpPW4ubGVuZ3RoO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKXtmb3IoOysrdTxpOylpZihudWxsIT0ocj1uW3VdKSYmcj49cil7ZT1yO2JyZWFrfWZvcig7Kyt1PGk7KW51bGwhPShyPW5bdV0pJiZlPnImJihlPXIpfWVsc2V7Zm9yKDsrK3U8aTspaWYobnVsbCE9KHI9dC5jYWxsKG4sblt1XSx1KSkmJnI+PXIpe2U9cjticmVha31mb3IoOysrdTxpOyludWxsIT0ocj10LmNhbGwobixuW3VdLHUpKSYmZT5yJiYoZT1yKX1yZXR1cm4gZX0sdGEubWF4PWZ1bmN0aW9uKG4sdCl7dmFyIGUscix1PS0xLGk9bi5sZW5ndGg7aWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpe2Zvcig7Kyt1PGk7KWlmKG51bGwhPShyPW5bdV0pJiZyPj1yKXtlPXI7YnJlYWt9Zm9yKDsrK3U8aTspbnVsbCE9KHI9blt1XSkmJnI+ZSYmKGU9cil9ZWxzZXtmb3IoOysrdTxpOylpZihudWxsIT0ocj10LmNhbGwobixuW3VdLHUpKSYmcj49cil7ZT1yO2JyZWFrfWZvcig7Kyt1PGk7KW51bGwhPShyPXQuY2FsbChuLG5bdV0sdSkpJiZyPmUmJihlPXIpfXJldHVybiBlfSx0YS5leHRlbnQ9ZnVuY3Rpb24obix0KXt2YXIgZSxyLHUsaT0tMSxvPW4ubGVuZ3RoO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKXtmb3IoOysraTxvOylpZihudWxsIT0ocj1uW2ldKSYmcj49cil7ZT11PXI7YnJlYWt9Zm9yKDsrK2k8bzspbnVsbCE9KHI9bltpXSkmJihlPnImJihlPXIpLHI+dSYmKHU9cikpfWVsc2V7Zm9yKDsrK2k8bzspaWYobnVsbCE9KHI9dC5jYWxsKG4sbltpXSxpKSkmJnI+PXIpe2U9dT1yO2JyZWFrfWZvcig7KytpPG87KW51bGwhPShyPXQuY2FsbChuLG5baV0saSkpJiYoZT5yJiYoZT1yKSxyPnUmJih1PXIpKX1yZXR1cm5bZSx1XX0sdGEuc3VtPWZ1bmN0aW9uKG4sdCl7dmFyIHIsdT0wLGk9bi5sZW5ndGgsbz0tMTtpZigxPT09YXJndW1lbnRzLmxlbmd0aClmb3IoOysrbzxpOyllKHI9K25bb10pJiYodSs9cik7ZWxzZSBmb3IoOysrbzxpOyllKHI9K3QuY2FsbChuLG5bb10sbykpJiYodSs9cik7cmV0dXJuIHV9LHRhLm1lYW49ZnVuY3Rpb24obixyKXt2YXIgdSxpPTAsbz1uLmxlbmd0aCxhPS0xLGM9bztpZigxPT09YXJndW1lbnRzLmxlbmd0aClmb3IoOysrYTxvOyllKHU9dChuW2FdKSk/aSs9dTotLWM7ZWxzZSBmb3IoOysrYTxvOyllKHU9dChyLmNhbGwobixuW2FdLGEpKSk/aSs9dTotLWM7cmV0dXJuIGM/aS9jOnZvaWQgMH0sdGEucXVhbnRpbGU9ZnVuY3Rpb24obix0KXt2YXIgZT0obi5sZW5ndGgtMSkqdCsxLHI9TWF0aC5mbG9vcihlKSx1PStuW3ItMV0saT1lLXI7cmV0dXJuIGk/dStpKihuW3JdLXUpOnV9LHRhLm1lZGlhbj1mdW5jdGlvbihyLHUpe3ZhciBpLG89W10sYT1yLmxlbmd0aCxjPS0xO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcig7KytjPGE7KWUoaT10KHJbY10pKSYmby5wdXNoKGkpO2Vsc2UgZm9yKDsrK2M8YTspZShpPXQodS5jYWxsKHIscltjXSxjKSkpJiZvLnB1c2goaSk7cmV0dXJuIG8ubGVuZ3RoP3RhLnF1YW50aWxlKG8uc29ydChuKSwuNSk6dm9pZCAwfSx0YS52YXJpYW5jZT1mdW5jdGlvbihuLHIpe3ZhciB1LGksbz1uLmxlbmd0aCxhPTAsYz0wLGw9LTEscz0wO2lmKDE9PT1hcmd1bWVudHMubGVuZ3RoKWZvcig7KytsPG87KWUodT10KG5bbF0pKSYmKGk9dS1hLGErPWkvKytzLGMrPWkqKHUtYSkpO2Vsc2UgZm9yKDsrK2w8bzspZSh1PXQoci5jYWxsKG4sbltsXSxsKSkpJiYoaT11LWEsYSs9aS8rK3MsYys9aSoodS1hKSk7cmV0dXJuIHM+MT9jLyhzLTEpOnZvaWQgMH0sdGEuZGV2aWF0aW9uPWZ1bmN0aW9uKCl7dmFyIG49dGEudmFyaWFuY2UuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBuP01hdGguc3FydChuKTpufTt2YXIgcGE9cihuKTt0YS5iaXNlY3RMZWZ0PXBhLmxlZnQsdGEuYmlzZWN0PXRhLmJpc2VjdFJpZ2h0PXBhLnJpZ2h0LHRhLmJpc2VjdG9yPWZ1bmN0aW9uKHQpe3JldHVybiByKDE9PT10Lmxlbmd0aD9mdW5jdGlvbihlLHIpe3JldHVybiBuKHQoZSkscil9OnQpfSx0YS5zaHVmZmxlPWZ1bmN0aW9uKG4sdCxlKXsoaT1hcmd1bWVudHMubGVuZ3RoKTwzJiYoZT1uLmxlbmd0aCwyPmkmJih0PTApKTtmb3IodmFyIHIsdSxpPWUtdDtpOyl1PTB8TWF0aC5yYW5kb20oKSppLS0scj1uW2krdF0sbltpK3RdPW5bdSt0XSxuW3UrdF09cjtyZXR1cm4gbn0sdGEucGVybXV0ZT1mdW5jdGlvbihuLHQpe2Zvcih2YXIgZT10Lmxlbmd0aCxyPW5ldyBBcnJheShlKTtlLS07KXJbZV09blt0W2VdXTtyZXR1cm4gcn0sdGEucGFpcnM9ZnVuY3Rpb24obil7Zm9yKHZhciB0LGU9MCxyPW4ubGVuZ3RoLTEsdT1uWzBdLGk9bmV3IEFycmF5KDA+cj8wOnIpO3I+ZTspaVtlXT1bdD11LHU9blsrK2VdXTtyZXR1cm4gaX0sdGEuemlwPWZ1bmN0aW9uKCl7aWYoIShyPWFyZ3VtZW50cy5sZW5ndGgpKXJldHVybltdO2Zvcih2YXIgbj0tMSx0PXRhLm1pbihhcmd1bWVudHMsdSksZT1uZXcgQXJyYXkodCk7KytuPHQ7KWZvcih2YXIgcixpPS0xLG89ZVtuXT1uZXcgQXJyYXkocik7KytpPHI7KW9baV09YXJndW1lbnRzW2ldW25dO3JldHVybiBlfSx0YS50cmFuc3Bvc2U9ZnVuY3Rpb24obil7cmV0dXJuIHRhLnppcC5hcHBseSh0YSxuKX0sdGEua2V5cz1mdW5jdGlvbihuKXt2YXIgdD1bXTtmb3IodmFyIGUgaW4gbil0LnB1c2goZSk7cmV0dXJuIHR9LHRhLnZhbHVlcz1mdW5jdGlvbihuKXt2YXIgdD1bXTtmb3IodmFyIGUgaW4gbil0LnB1c2gobltlXSk7cmV0dXJuIHR9LHRhLmVudHJpZXM9ZnVuY3Rpb24obil7dmFyIHQ9W107Zm9yKHZhciBlIGluIG4pdC5wdXNoKHtrZXk6ZSx2YWx1ZTpuW2VdfSk7cmV0dXJuIHR9LHRhLm1lcmdlPWZ1bmN0aW9uKG4pe2Zvcih2YXIgdCxlLHIsdT1uLmxlbmd0aCxpPS0xLG89MDsrK2k8dTspbys9bltpXS5sZW5ndGg7Zm9yKGU9bmV3IEFycmF5KG8pOy0tdT49MDspZm9yKHI9blt1XSx0PXIubGVuZ3RoOy0tdD49MDspZVstLW9dPXJbdF07cmV0dXJuIGV9O3ZhciB2YT1NYXRoLmFiczt0YS5yYW5nZT1mdW5jdGlvbihuLHQsZSl7aWYoYXJndW1lbnRzLmxlbmd0aDwzJiYoZT0xLGFyZ3VtZW50cy5sZW5ndGg8MiYmKHQ9bixuPTApKSwxLzA9PT0odC1uKS9lKXRocm93IG5ldyBFcnJvcigiaW5maW5pdGUgcmFuZ2UiKTt2YXIgcix1PVtdLG89aSh2YShlKSksYT0tMTtpZihuKj1vLHQqPW8sZSo9bywwPmUpZm9yKDsocj1uK2UqKythKT50Oyl1LnB1c2goci9vKTtlbHNlIGZvcig7KHI9bitlKisrYSk8dDspdS5wdXNoKHIvbyk7cmV0dXJuIHV9LHRhLm1hcD1mdW5jdGlvbihuLHQpe3ZhciBlPW5ldyBhO2lmKG4gaW5zdGFuY2VvZiBhKW4uZm9yRWFjaChmdW5jdGlvbihuLHQpe2Uuc2V0KG4sdCl9KTtlbHNlIGlmKEFycmF5LmlzQXJyYXkobikpe3ZhciByLHU9LTEsaT1uLmxlbmd0aDtpZigxPT09YXJndW1lbnRzLmxlbmd0aClmb3IoOysrdTxpOyllLnNldCh1LG5bdV0pO2Vsc2UgZm9yKDsrK3U8aTspZS5zZXQodC5jYWxsKG4scj1uW3VdLHUpLHIpfWVsc2UgZm9yKHZhciBvIGluIG4pZS5zZXQobyxuW29dKTtyZXR1cm4gZX07dmFyIGRhPSJfX3Byb3RvX18iLG1hPSJceDAwIjtvKGEse2hhczpzLGdldDpmdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5fW2MobildfSxzZXQ6ZnVuY3Rpb24obix0KXtyZXR1cm4gdGhpcy5fW2MobildPXR9LHJlbW92ZTpmLGtleXM6aCx2YWx1ZXM6ZnVuY3Rpb24oKXt2YXIgbj1bXTtmb3IodmFyIHQgaW4gdGhpcy5fKW4ucHVzaCh0aGlzLl9bdF0pO3JldHVybiBufSxlbnRyaWVzOmZ1bmN0aW9uKCl7dmFyIG49W107Zm9yKHZhciB0IGluIHRoaXMuXyluLnB1c2goe2tleTpsKHQpLHZhbHVlOnRoaXMuX1t0XX0pO3JldHVybiBufSxzaXplOmcsZW1wdHk6cCxmb3JFYWNoOmZ1bmN0aW9uKG4pe2Zvcih2YXIgdCBpbiB0aGlzLl8pbi5jYWxsKHRoaXMsbCh0KSx0aGlzLl9bdF0pfX0pLHRhLm5lc3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsbyxjKXtpZihjPj1pLmxlbmd0aClyZXR1cm4gcj9yLmNhbGwodSxvKTplP28uc29ydChlKTpvO2Zvcih2YXIgbCxzLGYsaCxnPS0xLHA9by5sZW5ndGgsdj1pW2MrK10sZD1uZXcgYTsrK2c8cDspKGg9ZC5nZXQobD12KHM9b1tnXSkpKT9oLnB1c2gocyk6ZC5zZXQobCxbc10pO3JldHVybiB0PyhzPXQoKSxmPWZ1bmN0aW9uKGUscil7cy5zZXQoZSxuKHQscixjKSl9KToocz17fSxmPWZ1bmN0aW9uKGUscil7c1tlXT1uKHQscixjKX0pLGQuZm9yRWFjaChmKSxzfWZ1bmN0aW9uIHQobixlKXtpZihlPj1pLmxlbmd0aClyZXR1cm4gbjt2YXIgcj1bXSx1PW9bZSsrXTtyZXR1cm4gbi5mb3JFYWNoKGZ1bmN0aW9uKG4sdSl7ci5wdXNoKHtrZXk6bix2YWx1ZXM6dCh1LGUpfSl9KSx1P3Iuc29ydChmdW5jdGlvbihuLHQpe3JldHVybiB1KG4ua2V5LHQua2V5KX0pOnJ9dmFyIGUscix1PXt9LGk9W10sbz1bXTtyZXR1cm4gdS5tYXA9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbihlLHQsMCl9LHUuZW50cmllcz1mdW5jdGlvbihlKXtyZXR1cm4gdChuKHRhLm1hcCxlLDApLDApfSx1LmtleT1mdW5jdGlvbihuKXtyZXR1cm4gaS5wdXNoKG4pLHV9LHUuc29ydEtleXM9ZnVuY3Rpb24obil7cmV0dXJuIG9baS5sZW5ndGgtMV09bix1fSx1LnNvcnRWYWx1ZXM9ZnVuY3Rpb24obil7cmV0dXJuIGU9bix1fSx1LnJvbGx1cD1mdW5jdGlvbihuKXtyZXR1cm4gcj1uLHV9LHV9LHRhLnNldD1mdW5jdGlvbihuKXt2YXIgdD1uZXcgdjtpZihuKWZvcih2YXIgZT0wLHI9bi5sZW5ndGg7cj5lOysrZSl0LmFkZChuW2VdKTtyZXR1cm4gdH0sbyh2LHtoYXM6cyxhZGQ6ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMuX1tjKG4rPSIiKV09ITAsbn0scmVtb3ZlOmYsdmFsdWVzOmgsc2l6ZTpnLGVtcHR5OnAsZm9yRWFjaDpmdW5jdGlvbihuKXtmb3IodmFyIHQgaW4gdGhpcy5fKW4uY2FsbCh0aGlzLGwodCkpfX0pLHRhLmJlaGF2aW9yPXt9LHRhLnJlYmluZD1mdW5jdGlvbihuLHQpe2Zvcih2YXIgZSxyPTEsdT1hcmd1bWVudHMubGVuZ3RoOysrcjx1OyluW2U9YXJndW1lbnRzW3JdXT1kKG4sdCx0W2VdKTtyZXR1cm4gbn07dmFyIHlhPVsid2Via2l0IiwibXMiLCJtb3oiLCJNb3oiLCJvIiwiTyJdO3RhLmRpc3BhdGNoPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPW5ldyBNLHQ9LTEsZT1hcmd1bWVudHMubGVuZ3RoOysrdDxlOyluW2FyZ3VtZW50c1t0XV09eChuKTtyZXR1cm4gbn0sTS5wcm90b3R5cGUub249ZnVuY3Rpb24obix0KXt2YXIgZT1uLmluZGV4T2YoIi4iKSxyPSIiO2lmKGU+PTAmJihyPW4uc2xpY2UoZSsxKSxuPW4uc2xpY2UoMCxlKSksbilyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwyP3RoaXNbbl0ub24ocik6dGhpc1tuXS5vbihyLHQpO2lmKDI9PT1hcmd1bWVudHMubGVuZ3RoKXtpZihudWxsPT10KWZvcihuIGluIHRoaXMpdGhpcy5oYXNPd25Qcm9wZXJ0eShuKSYmdGhpc1tuXS5vbihyLG51bGwpO3JldHVybiB0aGlzfX0sdGEuZXZlbnQ9bnVsbCx0YS5yZXF1b3RlPWZ1bmN0aW9uKG4pe3JldHVybiBuLnJlcGxhY2UoTWEsIlxcJCYiKX07dmFyIE1hPS9bXFxcXlwkXCpcK1w/XHxcW1xdXChcKVwuXHtcfV0vZyx4YT17fS5fX3Byb3RvX18/ZnVuY3Rpb24obix0KXtuLl9fcHJvdG9fXz10fTpmdW5jdGlvbihuLHQpe2Zvcih2YXIgZSBpbiB0KW5bZV09dFtlXX0sYmE9ZnVuY3Rpb24obix0KXtyZXR1cm4gdC5xdWVyeVNlbGVjdG9yKG4pfSxfYT1mdW5jdGlvbihuLHQpe3JldHVybiB0LnF1ZXJ5U2VsZWN0b3JBbGwobil9LHdhPWlhLm1hdGNoZXN8fGlhW20oaWEsIm1hdGNoZXNTZWxlY3RvciIpXSxTYT1mdW5jdGlvbihuLHQpe3JldHVybiB3YS5jYWxsKG4sdCl9OyJmdW5jdGlvbiI9PXR5cGVvZiBTaXp6bGUmJihiYT1mdW5jdGlvbihuLHQpe3JldHVybiBTaXp6bGUobix0KVswXXx8bnVsbH0sX2E9U2l6emxlLFNhPVNpenpsZS5tYXRjaGVzU2VsZWN0b3IpLHRhLnNlbGVjdGlvbj1mdW5jdGlvbigpe3JldHVybiBOYX07dmFyIGthPXRhLnNlbGVjdGlvbi5wcm90b3R5cGU9W107a2Euc2VsZWN0PWZ1bmN0aW9uKG4pe3ZhciB0LGUscix1LGk9W107bj1rKG4pO2Zvcih2YXIgbz0tMSxhPXRoaXMubGVuZ3RoOysrbzxhOyl7aS5wdXNoKHQ9W10pLHQucGFyZW50Tm9kZT0ocj10aGlzW29dKS5wYXJlbnROb2RlO2Zvcih2YXIgYz0tMSxsPXIubGVuZ3RoOysrYzxsOykodT1yW2NdKT8odC5wdXNoKGU9bi5jYWxsKHUsdS5fX2RhdGFfXyxjLG8pKSxlJiYiX19kYXRhX18iaW4gdSYmKGUuX19kYXRhX189dS5fX2RhdGFfXykpOnQucHVzaChudWxsKX1yZXR1cm4gUyhpKX0sa2Euc2VsZWN0QWxsPWZ1bmN0aW9uKG4pe3ZhciB0LGUscj1bXTtuPUUobik7Zm9yKHZhciB1PS0xLGk9dGhpcy5sZW5ndGg7Kyt1PGk7KWZvcih2YXIgbz10aGlzW3VdLGE9LTEsYz1vLmxlbmd0aDsrK2E8YzspKGU9b1thXSkmJihyLnB1c2godD1yYShuLmNhbGwoZSxlLl9fZGF0YV9fLGEsdSkpKSx0LnBhcmVudE5vZGU9ZSk7cmV0dXJuIFMocil9O3ZhciBFYT17c3ZnOiJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIseGh0bWw6Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiLHhsaW5rOiJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIix4bWw6Imh0dHA6Ly93d3cudzMub3JnL1hNTC8xOTk4L25hbWVzcGFjZSIseG1sbnM6Imh0dHA6Ly93d3cudzMub3JnLzIwMDAveG1sbnMvIn07dGEubnM9e3ByZWZpeDpFYSxxdWFsaWZ5OmZ1bmN0aW9uKG4pe3ZhciB0PW4uaW5kZXhPZigiOiIpLGU9bjtyZXR1cm4gdD49MCYmKGU9bi5zbGljZSgwLHQpLG49bi5zbGljZSh0KzEpKSxFYS5oYXNPd25Qcm9wZXJ0eShlKT97c3BhY2U6RWFbZV0sbG9jYWw6bn06bn19LGthLmF0dHI9ZnVuY3Rpb24obix0KXtpZihhcmd1bWVudHMubGVuZ3RoPDIpe2lmKCJzdHJpbmciPT10eXBlb2Ygbil7dmFyIGU9dGhpcy5ub2RlKCk7cmV0dXJuIG49dGEubnMucXVhbGlmeShuKSxuLmxvY2FsP2UuZ2V0QXR0cmlidXRlTlMobi5zcGFjZSxuLmxvY2FsKTplLmdldEF0dHJpYnV0ZShuKX1mb3IodCBpbiBuKXRoaXMuZWFjaChBKHQsblt0XSkpO3JldHVybiB0aGlzfXJldHVybiB0aGlzLmVhY2goQShuLHQpKX0sa2EuY2xhc3NlZD1mdW5jdGlvbihuLHQpe2lmKGFyZ3VtZW50cy5sZW5ndGg8Mil7aWYoInN0cmluZyI9PXR5cGVvZiBuKXt2YXIgZT10aGlzLm5vZGUoKSxyPShuPXoobikpLmxlbmd0aCx1PS0xO2lmKHQ9ZS5jbGFzc0xpc3Qpe2Zvcig7Kyt1PHI7KWlmKCF0LmNvbnRhaW5zKG5bdV0pKXJldHVybiExfWVsc2UgZm9yKHQ9ZS5nZXRBdHRyaWJ1dGUoImNsYXNzIik7Kyt1PHI7KWlmKCFDKG5bdV0pLnRlc3QodCkpcmV0dXJuITE7cmV0dXJuITB9Zm9yKHQgaW4gbil0aGlzLmVhY2gocSh0LG5bdF0pKTtyZXR1cm4gdGhpc31yZXR1cm4gdGhpcy5lYWNoKHEobix0KSl9LGthLnN0eWxlPWZ1bmN0aW9uKG4sdCxlKXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoO2lmKDM+cil7aWYoInN0cmluZyIhPXR5cGVvZiBuKXsyPnImJih0PSIiKTtmb3IoZSBpbiBuKXRoaXMuZWFjaChUKGUsbltlXSx0KSk7cmV0dXJuIHRoaXN9aWYoMj5yKXJldHVybiBvYS5nZXRDb21wdXRlZFN0eWxlKHRoaXMubm9kZSgpLG51bGwpLmdldFByb3BlcnR5VmFsdWUobik7ZT0iIn1yZXR1cm4gdGhpcy5lYWNoKFQobix0LGUpKX0sa2EucHJvcGVydHk9ZnVuY3Rpb24obix0KXtpZihhcmd1bWVudHMubGVuZ3RoPDIpe2lmKCJzdHJpbmciPT10eXBlb2YgbilyZXR1cm4gdGhpcy5ub2RlKClbbl07Zm9yKHQgaW4gbil0aGlzLmVhY2goUih0LG5bdF0pKTtyZXR1cm4gdGhpc31yZXR1cm4gdGhpcy5lYWNoKFIobix0KSl9LGthLnRleHQ9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/dGhpcy5lYWNoKCJmdW5jdGlvbiI9PXR5cGVvZiBuP2Z1bmN0aW9uKCl7dmFyIHQ9bi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7dGhpcy50ZXh0Q29udGVudD1udWxsPT10PyIiOnR9Om51bGw9PW4/ZnVuY3Rpb24oKXt0aGlzLnRleHRDb250ZW50PSIifTpmdW5jdGlvbigpe3RoaXMudGV4dENvbnRlbnQ9bn0pOnRoaXMubm9kZSgpLnRleHRDb250ZW50fSxrYS5odG1sPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP3RoaXMuZWFjaCgiZnVuY3Rpb24iPT10eXBlb2Ygbj9mdW5jdGlvbigpe3ZhciB0PW4uYXBwbHkodGhpcyxhcmd1bWVudHMpO3RoaXMuaW5uZXJIVE1MPW51bGw9PXQ/IiI6dH06bnVsbD09bj9mdW5jdGlvbigpe3RoaXMuaW5uZXJIVE1MPSIifTpmdW5jdGlvbigpe3RoaXMuaW5uZXJIVE1MPW59KTp0aGlzLm5vZGUoKS5pbm5lckhUTUx9LGthLmFwcGVuZD1mdW5jdGlvbihuKXtyZXR1cm4gbj1EKG4pLHRoaXMuc2VsZWN0KGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXBwZW5kQ2hpbGQobi5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSl9LGthLmluc2VydD1mdW5jdGlvbihuLHQpe3JldHVybiBuPUQobiksdD1rKHQpLHRoaXMuc2VsZWN0KGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5zZXJ0QmVmb3JlKG4uYXBwbHkodGhpcyxhcmd1bWVudHMpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfHxudWxsKX0pfSxrYS5yZW1vdmU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYWNoKFApfSxrYS5kYXRhPWZ1bmN0aW9uKG4sdCl7ZnVuY3Rpb24gZShuLGUpe3ZhciByLHUsaSxvPW4ubGVuZ3RoLGY9ZS5sZW5ndGgsaD1NYXRoLm1pbihvLGYpLGc9bmV3IEFycmF5KGYpLHA9bmV3IEFycmF5KGYpLHY9bmV3IEFycmF5KG8pO2lmKHQpe3ZhciBkLG09bmV3IGEseT1uZXcgQXJyYXkobyk7Zm9yKHI9LTE7KytyPG87KW0uaGFzKGQ9dC5jYWxsKHU9bltyXSx1Ll9fZGF0YV9fLHIpKT92W3JdPXU6bS5zZXQoZCx1KSx5W3JdPWQ7Zm9yKHI9LTE7KytyPGY7KSh1PW0uZ2V0KGQ9dC5jYWxsKGUsaT1lW3JdLHIpKSk/dSE9PSEwJiYoZ1tyXT11LHUuX19kYXRhX189aSk6cFtyXT1VKGkpLG0uc2V0KGQsITApO2ZvcihyPS0xOysrcjxvOyltLmdldCh5W3JdKSE9PSEwJiYodltyXT1uW3JdKX1lbHNle2ZvcihyPS0xOysrcjxoOyl1PW5bcl0saT1lW3JdLHU/KHUuX19kYXRhX189aSxnW3JdPXUpOnBbcl09VShpKTtmb3IoO2Y+cjsrK3IpcFtyXT1VKGVbcl0pO2Zvcig7bz5yOysrcil2W3JdPW5bcl19cC51cGRhdGU9ZyxwLnBhcmVudE5vZGU9Zy5wYXJlbnROb2RlPXYucGFyZW50Tm9kZT1uLnBhcmVudE5vZGUsYy5wdXNoKHApLGwucHVzaChnKSxzLnB1c2godil9dmFyIHIsdSxpPS0xLG89dGhpcy5sZW5ndGg7aWYoIWFyZ3VtZW50cy5sZW5ndGgpe2ZvcihuPW5ldyBBcnJheShvPShyPXRoaXNbMF0pLmxlbmd0aCk7KytpPG87KSh1PXJbaV0pJiYobltpXT11Ll9fZGF0YV9fKTtyZXR1cm4gbn12YXIgYz1PKFtdKSxsPVMoW10pLHM9UyhbXSk7aWYoImZ1bmN0aW9uIj09dHlwZW9mIG4pZm9yKDsrK2k8bzspZShyPXRoaXNbaV0sbi5jYWxsKHIsci5wYXJlbnROb2RlLl9fZGF0YV9fLGkpKTtlbHNlIGZvcig7KytpPG87KWUocj10aGlzW2ldLG4pO3JldHVybiBsLmVudGVyPWZ1bmN0aW9uKCl7cmV0dXJuIGN9LGwuZXhpdD1mdW5jdGlvbigpe3JldHVybiBzfSxsfSxrYS5kYXR1bT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD90aGlzLnByb3BlcnR5KCJfX2RhdGFfXyIsbik6dGhpcy5wcm9wZXJ0eSgiX19kYXRhX18iKX0sa2EuZmlsdGVyPWZ1bmN0aW9uKG4pe3ZhciB0LGUscix1PVtdOyJmdW5jdGlvbiIhPXR5cGVvZiBuJiYobj1qKG4pKTtmb3IodmFyIGk9MCxvPXRoaXMubGVuZ3RoO28+aTtpKyspe3UucHVzaCh0PVtdKSx0LnBhcmVudE5vZGU9KGU9dGhpc1tpXSkucGFyZW50Tm9kZTtmb3IodmFyIGE9MCxjPWUubGVuZ3RoO2M+YTthKyspKHI9ZVthXSkmJm4uY2FsbChyLHIuX19kYXRhX18sYSxpKSYmdC5wdXNoKHIpfXJldHVybiBTKHUpfSxrYS5vcmRlcj1mdW5jdGlvbigpe2Zvcih2YXIgbj0tMSx0PXRoaXMubGVuZ3RoOysrbjx0Oylmb3IodmFyIGUscj10aGlzW25dLHU9ci5sZW5ndGgtMSxpPXJbdV07LS11Pj0wOykoZT1yW3VdKSYmKGkmJmkhPT1lLm5leHRTaWJsaW5nJiZpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsaSksaT1lKTtyZXR1cm4gdGhpc30sa2Euc29ydD1mdW5jdGlvbihuKXtuPUYuYXBwbHkodGhpcyxhcmd1bWVudHMpO2Zvcih2YXIgdD0tMSxlPXRoaXMubGVuZ3RoOysrdDxlOyl0aGlzW3RdLnNvcnQobik7cmV0dXJuIHRoaXMub3JkZXIoKX0sa2EuZWFjaD1mdW5jdGlvbihuKXtyZXR1cm4gSCh0aGlzLGZ1bmN0aW9uKHQsZSxyKXtuLmNhbGwodCx0Ll9fZGF0YV9fLGUscil9KX0sa2EuY2FsbD1mdW5jdGlvbihuKXt2YXIgdD1yYShhcmd1bWVudHMpO3JldHVybiBuLmFwcGx5KHRbMF09dGhpcyx0KSx0aGlzfSxrYS5lbXB0eT1mdW5jdGlvbigpe3JldHVybiF0aGlzLm5vZGUoKX0sa2Eubm9kZT1mdW5jdGlvbigpe2Zvcih2YXIgbj0wLHQ9dGhpcy5sZW5ndGg7dD5uO24rKylmb3IodmFyIGU9dGhpc1tuXSxyPTAsdT1lLmxlbmd0aDt1PnI7cisrKXt2YXIgaT1lW3JdO2lmKGkpcmV0dXJuIGl9cmV0dXJuIG51bGx9LGthLnNpemU9ZnVuY3Rpb24oKXt2YXIgbj0wO3JldHVybiBIKHRoaXMsZnVuY3Rpb24oKXsrK259KSxufTt2YXIgQWE9W107dGEuc2VsZWN0aW9uLmVudGVyPU8sdGEuc2VsZWN0aW9uLmVudGVyLnByb3RvdHlwZT1BYSxBYS5hcHBlbmQ9a2EuYXBwZW5kLEFhLmVtcHR5PWthLmVtcHR5LEFhLm5vZGU9a2Eubm9kZSxBYS5jYWxsPWthLmNhbGwsQWEuc2l6ZT1rYS5zaXplLEFhLnNlbGVjdD1mdW5jdGlvbihuKXtmb3IodmFyIHQsZSxyLHUsaSxvPVtdLGE9LTEsYz10aGlzLmxlbmd0aDsrK2E8Yzspe3I9KHU9dGhpc1thXSkudXBkYXRlLG8ucHVzaCh0PVtdKSx0LnBhcmVudE5vZGU9dS5wYXJlbnROb2RlO2Zvcih2YXIgbD0tMSxzPXUubGVuZ3RoOysrbDxzOykoaT11W2xdKT8odC5wdXNoKHJbbF09ZT1uLmNhbGwodS5wYXJlbnROb2RlLGkuX19kYXRhX18sbCxhKSksZS5fX2RhdGFfXz1pLl9fZGF0YV9fKTp0LnB1c2gobnVsbCl9cmV0dXJuIFMobyl9LEFhLmluc2VydD1mdW5jdGlvbihuLHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPDImJih0PVkodGhpcykpLGthLmluc2VydC5jYWxsKHRoaXMsbix0KX0sdGEuc2VsZWN0PWZ1bmN0aW9uKG4pe3ZhciB0PVsic3RyaW5nIj09dHlwZW9mIG4/YmEobix1YSk6bl07cmV0dXJuIHQucGFyZW50Tm9kZT1pYSxTKFt0XSl9LHRhLnNlbGVjdEFsbD1mdW5jdGlvbihuKXt2YXIgdD1yYSgic3RyaW5nIj09dHlwZW9mIG4/X2Eobix1YSk6bik7cmV0dXJuIHQucGFyZW50Tm9kZT1pYSxTKFt0XSl9O3ZhciBOYT10YS5zZWxlY3QoaWEpO2thLm9uPWZ1bmN0aW9uKG4sdCxlKXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoO2lmKDM+cil7aWYoInN0cmluZyIhPXR5cGVvZiBuKXsyPnImJih0PSExKTtmb3IoZSBpbiBuKXRoaXMuZWFjaChJKGUsbltlXSx0KSk7cmV0dXJuIHRoaXN9aWYoMj5yKXJldHVybihyPXRoaXMubm9kZSgpWyJfX29uIituXSkmJnIuXztlPSExfXJldHVybiB0aGlzLmVhY2goSShuLHQsZSkpfTt2YXIgQ2E9dGEubWFwKHttb3VzZWVudGVyOiJtb3VzZW92ZXIiLG1vdXNlbGVhdmU6Im1vdXNlb3V0In0pO0NhLmZvckVhY2goZnVuY3Rpb24obil7Im9uIituIGluIHVhJiZDYS5yZW1vdmUobil9KTt2YXIgemE9Im9uc2VsZWN0c3RhcnQiaW4gdWE/bnVsbDptKGlhLnN0eWxlLCJ1c2VyU2VsZWN0IikscWE9MDt0YS5tb3VzZT1mdW5jdGlvbihuKXtyZXR1cm4gJChuLF8oKSl9O3ZhciBMYT0vV2ViS2l0Ly50ZXN0KG9hLm5hdmlnYXRvci51c2VyQWdlbnQpPy0xOjA7dGEudG91Y2g9ZnVuY3Rpb24obix0LGUpe2lmKGFyZ3VtZW50cy5sZW5ndGg8MyYmKGU9dCx0PV8oKS5jaGFuZ2VkVG91Y2hlcyksdClmb3IodmFyIHIsdT0wLGk9dC5sZW5ndGg7aT51OysrdSlpZigocj10W3VdKS5pZGVudGlmaWVyPT09ZSlyZXR1cm4gJChuLHIpfSx0YS5iZWhhdmlvci5kcmFnPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbigpe3RoaXMub24oIm1vdXNlZG93bi5kcmFnIix1KS5vbigidG91Y2hzdGFydC5kcmFnIixpKX1mdW5jdGlvbiB0KG4sdCx1LGksbyl7cmV0dXJuIGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3ZhciBuLGUscj10KGgsdik7ciYmKG49clswXS1NWzBdLGU9clsxXS1NWzFdLHB8PW58ZSxNPXIsZyh7dHlwZToiZHJhZyIseDpyWzBdK2xbMF0seTpyWzFdK2xbMV0sZHg6bixkeTplfSkpfWZ1bmN0aW9uIGMoKXt0KGgsdikmJihtLm9uKGkrZCxudWxsKS5vbihvK2QsbnVsbCkseShwJiZ0YS5ldmVudC50YXJnZXQ9PT1mKSxnKHt0eXBlOiJkcmFnZW5kIn0pKX12YXIgbCxzPXRoaXMsZj10YS5ldmVudC50YXJnZXQsaD1zLnBhcmVudE5vZGUsZz1lLm9mKHMsYXJndW1lbnRzKSxwPTAsdj1uKCksZD0iLmRyYWciKyhudWxsPT12PyIiOiItIit2KSxtPXRhLnNlbGVjdCh1KCkpLm9uKGkrZCxhKS5vbihvK2QsYykseT1YKCksTT10KGgsdik7cj8obD1yLmFwcGx5KHMsYXJndW1lbnRzKSxsPVtsLngtTVswXSxsLnktTVsxXV0pOmw9WzAsMF0sZyh7dHlwZToiZHJhZ3N0YXJ0In0pfX12YXIgZT13KG4sImRyYWciLCJkcmFnc3RhcnQiLCJkcmFnZW5kIikscj1udWxsLHU9dCh5LHRhLm1vdXNlLEosIm1vdXNlbW92ZSIsIm1vdXNldXAiKSxpPXQoQix0YS50b3VjaCxXLCJ0b3VjaG1vdmUiLCJ0b3VjaGVuZCIpO3JldHVybiBuLm9yaWdpbj1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocj10LG4pOnJ9LHRhLnJlYmluZChuLGUsIm9uIil9LHRhLnRvdWNoZXM9ZnVuY3Rpb24obix0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwyJiYodD1fKCkudG91Y2hlcyksdD9yYSh0KS5tYXAoZnVuY3Rpb24odCl7dmFyIGU9JChuLHQpO3JldHVybiBlLmlkZW50aWZpZXI9dC5pZGVudGlmaWVyLGV9KTpbXX07dmFyIFRhPTFlLTYsUmE9VGEqVGEsRGE9TWF0aC5QSSxQYT0yKkRhLFVhPVBhLVRhLGphPURhLzIsRmE9RGEvMTgwLEhhPTE4MC9EYSxPYT1NYXRoLlNRUlQyLFlhPTIsSWE9NDt0YS5pbnRlcnBvbGF0ZVpvb209ZnVuY3Rpb24obix0KXtmdW5jdGlvbiBlKG4pe3ZhciB0PW4qeTtpZihtKXt2YXIgZT1ldCh2KSxvPWkvKFlhKmgpKihlKnJ0KE9hKnQrdiktdHQodikpO3JldHVybltyK28qbCx1K28qcyxpKmUvZXQoT2EqdCt2KV19cmV0dXJuW3IrbipsLHUrbipzLGkqTWF0aC5leHAoT2EqdCldfXZhciByPW5bMF0sdT1uWzFdLGk9blsyXSxvPXRbMF0sYT10WzFdLGM9dFsyXSxsPW8tcixzPWEtdSxmPWwqbCtzKnMsaD1NYXRoLnNxcnQoZiksZz0oYypjLWkqaStJYSpmKS8oMippKllhKmgpLHA9KGMqYy1pKmktSWEqZikvKDIqYypZYSpoKSx2PU1hdGgubG9nKE1hdGguc3FydChnKmcrMSktZyksZD1NYXRoLmxvZyhNYXRoLnNxcnQocCpwKzEpLXApLG09ZC12LHk9KG18fE1hdGgubG9nKGMvaSkpL09hO3JldHVybiBlLmR1cmF0aW9uPTFlMyp5LGV9LHRhLmJlaGF2aW9yLnpvb209ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKG4pe24ub24oeixzKS5vbihYYSsiLnpvb20iLGgpLm9uKCJkYmxjbGljay56b29tIixnKS5vbihULGYpfWZ1bmN0aW9uIHQobil7cmV0dXJuWyhuWzBdLWsueCkvay5rLChuWzFdLWsueSkvay5rXX1mdW5jdGlvbiBlKG4pe3JldHVybltuWzBdKmsuaytrLngsblsxXSprLmsray55XX1mdW5jdGlvbiByKG4pe2suaz1NYXRoLm1heChBWzBdLE1hdGgubWluKEFbMV0sbikpfWZ1bmN0aW9uIHUobix0KXt0PWUodCksay54Kz1uWzBdLXRbMF0say55Kz1uWzFdLXRbMV19ZnVuY3Rpb24gaSh0LGUsaSxvKXt0Ll9fY2hhcnRfXz17eDprLngseTprLnksazprLmt9LHIoTWF0aC5wb3coMixvKSksdSh2PWUsaSksdD10YS5zZWxlY3QodCksTj4wJiYodD10LnRyYW5zaXRpb24oKS5kdXJhdGlvbihOKSksdC5jYWxsKG4uZXZlbnQpfWZ1bmN0aW9uIG8oKXt4JiZ4LmRvbWFpbihNLnJhbmdlKCkubWFwKGZ1bmN0aW9uKG4pe3JldHVybihuLWsueCkvay5rfSkubWFwKE0uaW52ZXJ0KSksUyYmUy5kb21haW4oXy5yYW5nZSgpLm1hcChmdW5jdGlvbihuKXtyZXR1cm4obi1rLnkpL2sua30pLm1hcChfLmludmVydCkpfWZ1bmN0aW9uIGEobil7QysrfHxuKHt0eXBlOiJ6b29tc3RhcnQifSl9ZnVuY3Rpb24gYyhuKXtvKCksbih7dHlwZToiem9vbSIsc2NhbGU6ay5rLHRyYW5zbGF0ZTpbay54LGsueV19KX1mdW5jdGlvbiBsKG4pey0tQ3x8bih7dHlwZToiem9vbWVuZCJ9KSx2PW51bGx9ZnVuY3Rpb24gcygpe2Z1bmN0aW9uIG4oKXtzPTEsdSh0YS5tb3VzZShyKSxoKSxjKG8pfWZ1bmN0aW9uIGUoKXtmLm9uKHEsbnVsbCkub24oTCxudWxsKSxnKHMmJnRhLmV2ZW50LnRhcmdldD09PWkpLGwobyl9dmFyIHI9dGhpcyxpPXRhLmV2ZW50LnRhcmdldCxvPVIub2Yocixhcmd1bWVudHMpLHM9MCxmPXRhLnNlbGVjdChvYSkub24ocSxuKS5vbihMLGUpLGg9dCh0YS5tb3VzZShyKSksZz1YKCk7RmwuY2FsbChyKSxhKG8pfWZ1bmN0aW9uIGYoKXtmdW5jdGlvbiBuKCl7dmFyIG49dGEudG91Y2hlcyhwKTtyZXR1cm4gZz1rLmssbi5mb3JFYWNoKGZ1bmN0aW9uKG4pe24uaWRlbnRpZmllciBpbiBkJiYoZFtuLmlkZW50aWZpZXJdPXQobikpfSksbn1mdW5jdGlvbiBlKCl7dmFyIHQ9dGEuZXZlbnQudGFyZ2V0O3RhLnNlbGVjdCh0KS5vbih4LG8pLm9uKF8saCksdy5wdXNoKHQpO2Zvcih2YXIgZT10YS5ldmVudC5jaGFuZ2VkVG91Y2hlcyxyPTAsdT1lLmxlbmd0aDt1PnI7KytyKWRbZVtyXS5pZGVudGlmaWVyXT1udWxsO3ZhciBhPW4oKSxjPURhdGUubm93KCk7aWYoMT09PWEubGVuZ3RoKXtpZig1MDA+Yy15KXt2YXIgbD1hWzBdO2kocCxsLGRbbC5pZGVudGlmaWVyXSxNYXRoLmZsb29yKE1hdGgubG9nKGsuaykvTWF0aC5MTjIpKzEpLGIoKX15PWN9ZWxzZSBpZihhLmxlbmd0aD4xKXt2YXIgbD1hWzBdLHM9YVsxXSxmPWxbMF0tc1swXSxnPWxbMV0tc1sxXTttPWYqZitnKmd9fWZ1bmN0aW9uIG8oKXt2YXIgbix0LGUsaSxvPXRhLnRvdWNoZXMocCk7RmwuY2FsbChwKTtmb3IodmFyIGE9MCxsPW8ubGVuZ3RoO2w+YTsrK2EsaT1udWxsKWlmKGU9b1thXSxpPWRbZS5pZGVudGlmaWVyXSl7aWYodClicmVhaztuPWUsdD1pfWlmKGkpe3ZhciBzPShzPWVbMF0tblswXSkqcysocz1lWzFdLW5bMV0pKnMsZj1tJiZNYXRoLnNxcnQocy9tKTtuPVsoblswXStlWzBdKS8yLChuWzFdK2VbMV0pLzJdLHQ9Wyh0WzBdK2lbMF0pLzIsKHRbMV0raVsxXSkvMl0scihmKmcpfXk9bnVsbCx1KG4sdCksYyh2KX1mdW5jdGlvbiBoKCl7aWYodGEuZXZlbnQudG91Y2hlcy5sZW5ndGgpe2Zvcih2YXIgdD10YS5ldmVudC5jaGFuZ2VkVG91Y2hlcyxlPTAscj10Lmxlbmd0aDtyPmU7KytlKWRlbGV0ZSBkW3RbZV0uaWRlbnRpZmllcl07Zm9yKHZhciB1IGluIGQpcmV0dXJuIHZvaWQgbigpfXRhLnNlbGVjdEFsbCh3KS5vbihNLG51bGwpLFMub24oeixzKS5vbihULGYpLEUoKSxsKHYpfXZhciBnLHA9dGhpcyx2PVIub2YocCxhcmd1bWVudHMpLGQ9e30sbT0wLE09Ii56b29tLSIrdGEuZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uaWRlbnRpZmllcix4PSJ0b3VjaG1vdmUiK00sXz0idG91Y2hlbmQiK00sdz1bXSxTPXRhLnNlbGVjdChwKSxFPVgoKTtlKCksYSh2KSxTLm9uKHosbnVsbCkub24oVCxlKX1mdW5jdGlvbiBoKCl7dmFyIG49Ui5vZih0aGlzLGFyZ3VtZW50cyk7bT9jbGVhclRpbWVvdXQobSk6KHA9dCh2PWR8fHRhLm1vdXNlKHRoaXMpKSxGbC5jYWxsKHRoaXMpLGEobikpLG09c2V0VGltZW91dChmdW5jdGlvbigpe209bnVsbCxsKG4pfSw1MCksYigpLHIoTWF0aC5wb3coMiwuMDAyKlphKCkpKmsuayksdSh2LHApLGMobil9ZnVuY3Rpb24gZygpe3ZhciBuPXRhLm1vdXNlKHRoaXMpLGU9TWF0aC5sb2coay5rKS9NYXRoLkxOMjtpKHRoaXMsbix0KG4pLHRhLmV2ZW50LnNoaWZ0S2V5P01hdGguY2VpbChlKS0xOk1hdGguZmxvb3IoZSkrMSl9dmFyIHAsdixkLG0seSxNLHgsXyxTLGs9e3g6MCx5OjAsazoxfSxFPVs5NjAsNTAwXSxBPVZhLE49MjUwLEM9MCx6PSJtb3VzZWRvd24uem9vbSIscT0ibW91c2Vtb3ZlLnpvb20iLEw9Im1vdXNldXAuem9vbSIsVD0idG91Y2hzdGFydC56b29tIixSPXcobiwiem9vbXN0YXJ0Iiwiem9vbSIsInpvb21lbmQiKTtyZXR1cm4gbi5ldmVudD1mdW5jdGlvbihuKXtuLmVhY2goZnVuY3Rpb24oKXt2YXIgbj1SLm9mKHRoaXMsYXJndW1lbnRzKSx0PWs7VWw/dGEuc2VsZWN0KHRoaXMpLnRyYW5zaXRpb24oKS5lYWNoKCJzdGFydC56b29tIixmdW5jdGlvbigpe2s9dGhpcy5fX2NoYXJ0X198fHt4OjAseTowLGs6MX0sYShuKX0pLnR3ZWVuKCJ6b29tOnpvb20iLGZ1bmN0aW9uKCl7dmFyIGU9RVswXSxyPUVbMV0sdT12P3ZbMF06ZS8yLGk9dj92WzFdOnIvMixvPXRhLmludGVycG9sYXRlWm9vbShbKHUtay54KS9rLmssKGktay55KS9rLmssZS9rLmtdLFsodS10LngpL3QuaywoaS10LnkpL3QuayxlL3Qua10pO3JldHVybiBmdW5jdGlvbih0KXt2YXIgcj1vKHQpLGE9ZS9yWzJdO3RoaXMuX19jaGFydF9fPWs9e3g6dS1yWzBdKmEseTppLXJbMV0qYSxrOmF9LGMobil9fSkuZWFjaCgiaW50ZXJydXB0Lnpvb20iLGZ1bmN0aW9uKCl7bChuKX0pLmVhY2goImVuZC56b29tIixmdW5jdGlvbigpe2wobil9KToodGhpcy5fX2NoYXJ0X189ayxhKG4pLGMobiksbChuKSl9KX0sbi50cmFuc2xhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGs9e3g6K3RbMF0seTordFsxXSxrOmsua30sbygpLG4pOltrLngsay55XX0sbi5zY2FsZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oaz17eDprLngseTprLnksazordH0sbygpLG4pOmsua30sbi5zY2FsZUV4dGVudD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oQT1udWxsPT10P1ZhOlsrdFswXSwrdFsxXV0sbik6QX0sbi5jZW50ZXI9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGQ9dCYmWyt0WzBdLCt0WzFdXSxuKTpkfSxuLnNpemU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KEU9dCYmWyt0WzBdLCt0WzFdXSxuKTpFfSxuLmR1cmF0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhOPSt0LG4pOk59LG4ueD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oeD10LE09dC5jb3B5KCksaz17eDowLHk6MCxrOjF9LG4pOnh9LG4ueT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oUz10LF89dC5jb3B5KCksaz17eDowLHk6MCxrOjF9LG4pOlN9LHRhLnJlYmluZChuLFIsIm9uIil9O3ZhciBaYSxWYT1bMCwxLzBdLFhhPSJvbndoZWVsImluIHVhPyhaYT1mdW5jdGlvbigpe3JldHVybi10YS5ldmVudC5kZWx0YVkqKHRhLmV2ZW50LmRlbHRhTW9kZT8xMjA6MSl9LCJ3aGVlbCIpOiJvbm1vdXNld2hlZWwiaW4gdWE/KFphPWZ1bmN0aW9uKCl7cmV0dXJuIHRhLmV2ZW50LndoZWVsRGVsdGF9LCJtb3VzZXdoZWVsIik6KFphPWZ1bmN0aW9uKCl7cmV0dXJuLXRhLmV2ZW50LmRldGFpbH0sIk1vek1vdXNlUGl4ZWxTY3JvbGwiKTt0YS5jb2xvcj1pdCxpdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZ2IoKSsiIn0sdGEuaHNsPW90O3ZhciAkYT1vdC5wcm90b3R5cGU9bmV3IGl0OyRhLmJyaWdodGVyPWZ1bmN0aW9uKG4pe3JldHVybiBuPU1hdGgucG93KC43LGFyZ3VtZW50cy5sZW5ndGg/bjoxKSxuZXcgb3QodGhpcy5oLHRoaXMucyx0aGlzLmwvbil9LCRhLmRhcmtlcj1mdW5jdGlvbihuKXtyZXR1cm4gbj1NYXRoLnBvdyguNyxhcmd1bWVudHMubGVuZ3RoP246MSksbmV3IG90KHRoaXMuaCx0aGlzLnMsbip0aGlzLmwpfSwkYS5yZ2I9ZnVuY3Rpb24oKXtyZXR1cm4gYXQodGhpcy5oLHRoaXMucyx0aGlzLmwpfSx0YS5oY2w9Y3Q7dmFyIEJhPWN0LnByb3RvdHlwZT1uZXcgaXQ7QmEuYnJpZ2h0ZXI9ZnVuY3Rpb24obil7cmV0dXJuIG5ldyBjdCh0aGlzLmgsdGhpcy5jLE1hdGgubWluKDEwMCx0aGlzLmwrV2EqKGFyZ3VtZW50cy5sZW5ndGg/bjoxKSkpfSxCYS5kYXJrZXI9ZnVuY3Rpb24obil7cmV0dXJuIG5ldyBjdCh0aGlzLmgsdGhpcy5jLE1hdGgubWF4KDAsdGhpcy5sLVdhKihhcmd1bWVudHMubGVuZ3RoP246MSkpKX0sQmEucmdiPWZ1bmN0aW9uKCl7cmV0dXJuIGx0KHRoaXMuaCx0aGlzLmMsdGhpcy5sKS5yZ2IoKX0sdGEubGFiPXN0O3ZhciBXYT0xOCxKYT0uOTUwNDcsR2E9MSxLYT0xLjA4ODgzLFFhPXN0LnByb3RvdHlwZT1uZXcgaXQ7UWEuYnJpZ2h0ZXI9ZnVuY3Rpb24obil7cmV0dXJuIG5ldyBzdChNYXRoLm1pbigxMDAsdGhpcy5sK1dhKihhcmd1bWVudHMubGVuZ3RoP246MSkpLHRoaXMuYSx0aGlzLmIpfSxRYS5kYXJrZXI9ZnVuY3Rpb24obil7cmV0dXJuIG5ldyBzdChNYXRoLm1heCgwLHRoaXMubC1XYSooYXJndW1lbnRzLmxlbmd0aD9uOjEpKSx0aGlzLmEsdGhpcy5iKX0sUWEucmdiPWZ1bmN0aW9uKCl7cmV0dXJuIGZ0KHRoaXMubCx0aGlzLmEsdGhpcy5iKX0sdGEucmdiPWR0O3ZhciBuYz1kdC5wcm90b3R5cGU9bmV3IGl0O25jLmJyaWdodGVyPWZ1bmN0aW9uKG4pe249TWF0aC5wb3coLjcsYXJndW1lbnRzLmxlbmd0aD9uOjEpO3ZhciB0PXRoaXMucixlPXRoaXMuZyxyPXRoaXMuYix1PTMwO3JldHVybiB0fHxlfHxyPyh0JiZ1PnQmJih0PXUpLGUmJnU+ZSYmKGU9dSksciYmdT5yJiYocj11KSxuZXcgZHQoTWF0aC5taW4oMjU1LHQvbiksTWF0aC5taW4oMjU1LGUvbiksTWF0aC5taW4oMjU1LHIvbikpKTpuZXcgZHQodSx1LHUpfSxuYy5kYXJrZXI9ZnVuY3Rpb24obil7cmV0dXJuIG49TWF0aC5wb3coLjcsYXJndW1lbnRzLmxlbmd0aD9uOjEpLG5ldyBkdChuKnRoaXMucixuKnRoaXMuZyxuKnRoaXMuYil9LG5jLmhzbD1mdW5jdGlvbigpe3JldHVybiBidCh0aGlzLnIsdGhpcy5nLHRoaXMuYil9LG5jLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIiMiK010KHRoaXMucikrTXQodGhpcy5nKStNdCh0aGlzLmIpfTt2YXIgdGM9dGEubWFwKHthbGljZWJsdWU6MTU3OTIzODMsYW50aXF1ZXdoaXRlOjE2NDQ0Mzc1LGFxdWE6NjU1MzUsYXF1YW1hcmluZTo4Mzg4NTY0LGF6dXJlOjE1Nzk0MTc1LGJlaWdlOjE2MTE5MjYwLGJpc3F1ZToxNjc3MDI0NCxibGFjazowLGJsYW5jaGVkYWxtb25kOjE2NzcyMDQ1LGJsdWU6MjU1LGJsdWV2aW9sZXQ6OTA1NTIwMixicm93bjoxMDgyNDIzNCxidXJseXdvb2Q6MTQ1OTYyMzEsY2FkZXRibHVlOjYyNjY1MjgsY2hhcnRyZXVzZTo4Mzg4MzUyLGNob2NvbGF0ZToxMzc4OTQ3MCxjb3JhbDoxNjc0NDI3Mixjb3JuZmxvd2VyYmx1ZTo2NTkxOTgxLGNvcm5zaWxrOjE2Nzc1Mzg4LGNyaW1zb246MTQ0MjMxMDAsY3lhbjo2NTUzNSxkYXJrYmx1ZToxMzksZGFya2N5YW46MzU3MjMsZGFya2dvbGRlbnJvZDoxMjA5MjkzOSxkYXJrZ3JheToxMTExOTAxNyxkYXJrZ3JlZW46MjU2MDAsZGFya2dyZXk6MTExMTkwMTcsZGFya2toYWtpOjEyNDMzMjU5LGRhcmttYWdlbnRhOjkxMDk2NDMsZGFya29saXZlZ3JlZW46NTU5Nzk5OSxkYXJrb3JhbmdlOjE2NzQ3NTIwLGRhcmtvcmNoaWQ6MTAwNDAwMTIsZGFya3JlZDo5MTA5NTA0LGRhcmtzYWxtb246MTUzMDg0MTAsZGFya3NlYWdyZWVuOjk0MTk5MTksZGFya3NsYXRlYmx1ZTo0NzM0MzQ3LGRhcmtzbGF0ZWdyYXk6MzEwMDQ5NSxkYXJrc2xhdGVncmV5OjMxMDA0OTUsZGFya3R1cnF1b2lzZTo1Mjk0NSxkYXJrdmlvbGV0Ojk2OTk1MzksZGVlcHBpbms6MTY3MTY5NDcsZGVlcHNreWJsdWU6NDkxNTEsZGltZ3JheTo2OTA4MjY1LGRpbWdyZXk6NjkwODI2NSxkb2RnZXJibHVlOjIwMDMxOTksZmlyZWJyaWNrOjExNjc0MTQ2LGZsb3JhbHdoaXRlOjE2Nzc1OTIwLGZvcmVzdGdyZWVuOjIyNjM4NDIsZnVjaHNpYToxNjcxMTkzNSxnYWluc2Jvcm86MTQ0NzQ0NjAsZ2hvc3R3aGl0ZToxNjMxNjY3MSxnb2xkOjE2NzY2NzIwLGdvbGRlbnJvZDoxNDMyOTEyMCxncmF5Ojg0MjE1MDQsZ3JlZW46MzI3NjgsZ3JlZW55ZWxsb3c6MTE0MDMwNTUsZ3JleTo4NDIxNTA0LGhvbmV5ZGV3OjE1Nzk0MTYwLGhvdHBpbms6MTY3Mzg3NDAsaW5kaWFucmVkOjEzNDU4NTI0LGluZGlnbzo0OTE1MzMwLGl2b3J5OjE2Nzc3MjAwLGtoYWtpOjE1Nzg3NjYwLGxhdmVuZGVyOjE1MTMyNDEwLGxhdmVuZGVyYmx1c2g6MTY3NzMzNjUsbGF3bmdyZWVuOjgxOTA5NzYsbGVtb25jaGlmZm9uOjE2Nzc1ODg1LGxpZ2h0Ymx1ZToxMTM5MzI1NCxsaWdodGNvcmFsOjE1NzYxNTM2LGxpZ2h0Y3lhbjoxNDc0NTU5OSxsaWdodGdvbGRlbnJvZHllbGxvdzoxNjQ0ODIxMCxsaWdodGdyYXk6MTM4ODIzMjMsbGlnaHRncmVlbjo5NDk4MjU2LGxpZ2h0Z3JleToxMzg4MjMyMyxsaWdodHBpbms6MTY3NTg0NjUsbGlnaHRzYWxtb246MTY3NTI3NjIsbGlnaHRzZWFncmVlbjoyMTQyODkwLGxpZ2h0c2t5Ymx1ZTo4OTAwMzQ2LGxpZ2h0c2xhdGVncmF5Ojc4MzM3NTMsbGlnaHRzbGF0ZWdyZXk6NzgzMzc1MyxsaWdodHN0ZWVsYmx1ZToxMTU4NDczNCxsaWdodHllbGxvdzoxNjc3NzE4NCxsaW1lOjY1MjgwLGxpbWVncmVlbjozMzI5MzMwLGxpbmVuOjE2NDQ1NjcwLG1hZ2VudGE6MTY3MTE5MzUsbWFyb29uOjgzODg2MDgsbWVkaXVtYXF1YW1hcmluZTo2NzM3MzIyLG1lZGl1bWJsdWU6MjA1LG1lZGl1bW9yY2hpZDoxMjIxMTY2NyxtZWRpdW1wdXJwbGU6OTY2MjY4MyxtZWRpdW1zZWFncmVlbjozOTc4MDk3LG1lZGl1bXNsYXRlYmx1ZTo4MDg3NzkwLG1lZGl1bXNwcmluZ2dyZWVuOjY0MTU0LG1lZGl1bXR1cnF1b2lzZTo0NzcyMzAwLG1lZGl1bXZpb2xldHJlZDoxMzA0NzE3MyxtaWRuaWdodGJsdWU6MTY0NDkxMixtaW50Y3JlYW06MTYxMjE4NTAsbWlzdHlyb3NlOjE2NzcwMjczLG1vY2Nhc2luOjE2NzcwMjI5LG5hdmFqb3doaXRlOjE2NzY4Njg1LG5hdnk6MTI4LG9sZGxhY2U6MTY2NDM1NTgsb2xpdmU6ODQyMTM3NixvbGl2ZWRyYWI6NzA0ODczOSxvcmFuZ2U6MTY3NTM5MjAsb3JhbmdlcmVkOjE2NzI5MzQ0LG9yY2hpZDoxNDMxNTczNCxwYWxlZ29sZGVucm9kOjE1NjU3MTMwLHBhbGVncmVlbjoxMDAyNTg4MCxwYWxldHVycXVvaXNlOjExNTI5OTY2LHBhbGV2aW9sZXRyZWQ6MTQzODEyMDMscGFwYXlhd2hpcDoxNjc3MzA3NyxwZWFjaHB1ZmY6MTY3Njc2NzMscGVydToxMzQ2ODk5MSxwaW5rOjE2NzYxMDM1LHBsdW06MTQ1MjQ2MzcscG93ZGVyYmx1ZToxMTU5MTkxMCxwdXJwbGU6ODM4ODczNixyZWQ6MTY3MTE2ODAscm9zeWJyb3duOjEyMzU3NTE5LHJveWFsYmx1ZTo0Mjg2OTQ1LHNhZGRsZWJyb3duOjkxMjcxODcsc2FsbW9uOjE2NDE2ODgyLHNhbmR5YnJvd246MTYwMzI4NjQsc2VhZ3JlZW46MzA1MDMyNyxzZWFzaGVsbDoxNjc3NDYzOCxzaWVubmE6MTA1MDY3OTcsc2lsdmVyOjEyNjMyMjU2LHNreWJsdWU6ODkwMDMzMSxzbGF0ZWJsdWU6Njk3MDA2MSxzbGF0ZWdyYXk6NzM3Mjk0NCxzbGF0ZWdyZXk6NzM3Mjk0NCxzbm93OjE2Nzc1OTMwLHNwcmluZ2dyZWVuOjY1NDA3LHN0ZWVsYmx1ZTo0NjIwOTgwLHRhbjoxMzgwODc4MCx0ZWFsOjMyODk2LHRoaXN0bGU6MTQyMDQ4ODgsdG9tYXRvOjE2NzM3MDk1LHR1cnF1b2lzZTo0MjUxODU2LHZpb2xldDoxNTYzMTA4Nix3aGVhdDoxNjExMzMzMSx3aGl0ZToxNjc3NzIxNSx3aGl0ZXNtb2tlOjE2MTE5Mjg1LHllbGxvdzoxNjc3Njk2MCx5ZWxsb3dncmVlbjoxMDE0NTA3NH0pO3RjLmZvckVhY2goZnVuY3Rpb24obix0KXt0Yy5zZXQobixtdCh0KSl9KSx0YS5mdW5jdG9yPWt0LHRhLnhocj1BdChFdCksdGEuZHN2PWZ1bmN0aW9uKG4sdCl7ZnVuY3Rpb24gZShuLGUsaSl7YXJndW1lbnRzLmxlbmd0aDwzJiYoaT1lLGU9bnVsbCk7dmFyIG89TnQobix0LG51bGw9PWU/cjp1KGUpLGkpO3JldHVybiBvLnJvdz1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD9vLnJlc3BvbnNlKG51bGw9PShlPW4pP3I6dShuKSk6ZX0sb31mdW5jdGlvbiByKG4pe3JldHVybiBlLnBhcnNlKG4ucmVzcG9uc2VUZXh0KX1mdW5jdGlvbiB1KG4pe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZS5wYXJzZSh0LnJlc3BvbnNlVGV4dCxuKX19ZnVuY3Rpb24gaSh0KXtyZXR1cm4gdC5tYXAobykuam9pbihuKX1mdW5jdGlvbiBvKG4pe3JldHVybiBhLnRlc3Qobik/JyInK24ucmVwbGFjZSgvXCIvZywnIiInKSsnIic6bn12YXIgYT1uZXcgUmVnRXhwKCdbIicrbisiXG5dIiksYz1uLmNoYXJDb2RlQXQoMCk7cmV0dXJuIGUucGFyc2U9ZnVuY3Rpb24obix0KXt2YXIgcjtyZXR1cm4gZS5wYXJzZVJvd3MobixmdW5jdGlvbihuLGUpe2lmKHIpcmV0dXJuIHIobixlLTEpO3ZhciB1PW5ldyBGdW5jdGlvbigiZCIsInJldHVybiB7IituLm1hcChmdW5jdGlvbihuLHQpe3JldHVybiBKU09OLnN0cmluZ2lmeShuKSsiOiBkWyIrdCsiXSJ9KS5qb2luKCIsIikrIn0iKTtyPXQ/ZnVuY3Rpb24obixlKXtyZXR1cm4gdCh1KG4pLGUpfTp1fSl9LGUucGFyc2VSb3dzPWZ1bmN0aW9uKG4sdCl7ZnVuY3Rpb24gZSgpe2lmKHM+PWwpcmV0dXJuIG87aWYodSlyZXR1cm4gdT0hMSxpO3ZhciB0PXM7aWYoMzQ9PT1uLmNoYXJDb2RlQXQodCkpe2Zvcih2YXIgZT10O2UrKzxsOylpZigzND09PW4uY2hhckNvZGVBdChlKSl7aWYoMzQhPT1uLmNoYXJDb2RlQXQoZSsxKSlicmVhazsrK2V9cz1lKzI7dmFyIHI9bi5jaGFyQ29kZUF0KGUrMSk7cmV0dXJuIDEzPT09cj8odT0hMCwxMD09PW4uY2hhckNvZGVBdChlKzIpJiYrK3MpOjEwPT09ciYmKHU9ITApLG4uc2xpY2UodCsxLGUpLnJlcGxhY2UoLyIiL2csJyInKX1mb3IoO2w+czspe3ZhciByPW4uY2hhckNvZGVBdChzKyspLGE9MTtpZigxMD09PXIpdT0hMDtlbHNlIGlmKDEzPT09cil1PSEwLDEwPT09bi5jaGFyQ29kZUF0KHMpJiYoKytzLCsrYSk7ZWxzZSBpZihyIT09Yyljb250aW51ZTtyZXR1cm4gbi5zbGljZSh0LHMtYSl9cmV0dXJuIG4uc2xpY2UodCl9Zm9yKHZhciByLHUsaT17fSxvPXt9LGE9W10sbD1uLmxlbmd0aCxzPTAsZj0wOyhyPWUoKSkhPT1vOyl7Zm9yKHZhciBoPVtdO3IhPT1pJiZyIT09bzspaC5wdXNoKHIpLHI9ZSgpO3QmJm51bGw9PShoPXQoaCxmKyspKXx8YS5wdXNoKGgpfXJldHVybiBhfSxlLmZvcm1hdD1mdW5jdGlvbih0KXtpZihBcnJheS5pc0FycmF5KHRbMF0pKXJldHVybiBlLmZvcm1hdFJvd3ModCk7dmFyIHI9bmV3IHYsdT1bXTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKG4pe2Zvcih2YXIgdCBpbiBuKXIuaGFzKHQpfHx1LnB1c2goci5hZGQodCkpfSksW3UubWFwKG8pLmpvaW4obildLmNvbmNhdCh0Lm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdS5tYXAoZnVuY3Rpb24obil7cmV0dXJuIG8odFtuXSl9KS5qb2luKG4pfSkpLmpvaW4oIlxuIil9LGUuZm9ybWF0Um93cz1mdW5jdGlvbihuKXtyZXR1cm4gbi5tYXAoaSkuam9pbigiXG4iKX0sZX0sdGEuY3N2PXRhLmRzdigiLCIsInRleHQvY3N2IiksdGEudHN2PXRhLmRzdigiCSIsInRleHQvdGFiLXNlcGFyYXRlZC12YWx1ZXMiKTt2YXIgZWMscmMsdWMsaWMsb2MsYWM9b2FbbShvYSwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIildfHxmdW5jdGlvbihuKXtzZXRUaW1lb3V0KG4sMTcpfTt0YS50aW1lcj1mdW5jdGlvbihuLHQsZSl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aDsyPnImJih0PTApLDM+ciYmKGU9RGF0ZS5ub3coKSk7dmFyIHU9ZSt0LGk9e2M6bix0OnUsZjohMSxuOm51bGx9O3JjP3JjLm49aTplYz1pLHJjPWksdWN8fChpYz1jbGVhclRpbWVvdXQoaWMpLHVjPTEsYWMocXQpKX0sdGEudGltZXIuZmx1c2g9ZnVuY3Rpb24oKXtMdCgpLFR0KCl9LHRhLnJvdW5kPWZ1bmN0aW9uKG4sdCl7cmV0dXJuIHQ/TWF0aC5yb3VuZChuKih0PU1hdGgucG93KDEwLHQpKSkvdDpNYXRoLnJvdW5kKG4pfTt2YXIgY2M9WyJ5IiwieiIsImEiLCJmIiwicCIsIm4iLCJceGI1IiwibSIsIiIsImsiLCJNIiwiRyIsIlQiLCJQIiwiRSIsIloiLCJZIl0ubWFwKER0KTt0YS5mb3JtYXRQcmVmaXg9ZnVuY3Rpb24obix0KXt2YXIgZT0wO3JldHVybiBuJiYoMD5uJiYobio9LTEpLHQmJihuPXRhLnJvdW5kKG4sUnQobix0KSkpLGU9MStNYXRoLmZsb29yKDFlLTEyK01hdGgubG9nKG4pL01hdGguTE4xMCksZT1NYXRoLm1heCgtMjQsTWF0aC5taW4oMjQsMypNYXRoLmZsb29yKChlLTEpLzMpKSkpLGNjWzgrZS8zXX07dmFyIGxjPS8oPzooW157XSk/KFs8Pj1eXSkpPyhbK1wtIF0pPyhbJCNdKT8oMCk/KFxkKyk/KCwpPyhcLi0/XGQrKT8oW2EteiVdKT8vaSxzYz10YS5tYXAoe2I6ZnVuY3Rpb24obil7cmV0dXJuIG4udG9TdHJpbmcoMil9LGM6ZnVuY3Rpb24obil7cmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUobil9LG86ZnVuY3Rpb24obil7cmV0dXJuIG4udG9TdHJpbmcoOCl9LHg6ZnVuY3Rpb24obil7cmV0dXJuIG4udG9TdHJpbmcoMTYpfSxYOmZ1bmN0aW9uKG4pe3JldHVybiBuLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpfSxnOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIG4udG9QcmVjaXNpb24odCl9LGU6ZnVuY3Rpb24obix0KXtyZXR1cm4gbi50b0V4cG9uZW50aWFsKHQpfSxmOmZ1bmN0aW9uKG4sdCl7cmV0dXJuIG4udG9GaXhlZCh0KX0scjpmdW5jdGlvbihuLHQpe3JldHVybihuPXRhLnJvdW5kKG4sUnQobix0KSkpLnRvRml4ZWQoTWF0aC5tYXgoMCxNYXRoLm1pbigyMCxSdChuKigxKzFlLTE1KSx0KSkpKX19KSxmYz10YS50aW1lPXt9LGhjPURhdGU7anQucHJvdG90eXBlPXtnZXREYXRlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuXy5nZXRVVENEYXRlKCl9LGdldERheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VVRDRGF5KCl9LGdldEZ1bGxZZWFyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuXy5nZXRVVENGdWxsWWVhcigpfSxnZXRIb3VyczpmdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VVRDSG91cnMoKX0sZ2V0TWlsbGlzZWNvbmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuXy5nZXRVVENNaWxsaXNlY29uZHMoKX0sZ2V0TWludXRlczpmdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VVRDTWludXRlcygpfSxnZXRNb250aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VVRDTW9udGgoKX0sZ2V0U2Vjb25kczpmdW5jdGlvbigpe3JldHVybiB0aGlzLl8uZ2V0VVRDU2Vjb25kcygpfSxnZXRUaW1lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuXy5nZXRUaW1lKCl9LGdldFRpbWV6b25lT2Zmc2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDB9LHZhbHVlT2Y6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fLnZhbHVlT2YoKX0sc2V0RGF0ZTpmdW5jdGlvbigpe2djLnNldFVUQ0RhdGUuYXBwbHkodGhpcy5fLGFyZ3VtZW50cyl9LHNldERheTpmdW5jdGlvbigpe2djLnNldFVUQ0RheS5hcHBseSh0aGlzLl8sYXJndW1lbnRzKX0sc2V0RnVsbFllYXI6ZnVuY3Rpb24oKXtnYy5zZXRVVENGdWxsWWVhci5hcHBseSh0aGlzLl8sYXJndW1lbnRzKX0sc2V0SG91cnM6ZnVuY3Rpb24oKXtnYy5zZXRVVENIb3Vycy5hcHBseSh0aGlzLl8sYXJndW1lbnRzKX0sc2V0TWlsbGlzZWNvbmRzOmZ1bmN0aW9uKCl7Z2Muc2V0VVRDTWlsbGlzZWNvbmRzLmFwcGx5KHRoaXMuXyxhcmd1bWVudHMpfSxzZXRNaW51dGVzOmZ1bmN0aW9uKCl7Z2Muc2V0VVRDTWludXRlcy5hcHBseSh0aGlzLl8sYXJndW1lbnRzKX0sc2V0TW9udGg6ZnVuY3Rpb24oKXtnYy5zZXRVVENNb250aC5hcHBseSh0aGlzLl8sYXJndW1lbnRzKX0sc2V0U2Vjb25kczpmdW5jdGlvbigpe2djLnNldFVUQ1NlY29uZHMuYXBwbHkodGhpcy5fLGFyZ3VtZW50cyl9LHNldFRpbWU6ZnVuY3Rpb24oKXtnYy5zZXRUaW1lLmFwcGx5KHRoaXMuXyxhcmd1bWVudHMpfX07dmFyIGdjPURhdGUucHJvdG90eXBlO2ZjLnllYXI9RnQoZnVuY3Rpb24obil7cmV0dXJuIG49ZmMuZGF5KG4pLG4uc2V0TW9udGgoMCwxKSxufSxmdW5jdGlvbihuLHQpe24uc2V0RnVsbFllYXIobi5nZXRGdWxsWWVhcigpK3QpfSxmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRGdWxsWWVhcigpfSksZmMueWVhcnM9ZmMueWVhci5yYW5nZSxmYy55ZWFycy51dGM9ZmMueWVhci51dGMucmFuZ2UsZmMuZGF5PUZ0KGZ1bmN0aW9uKG4pe3ZhciB0PW5ldyBoYygyZTMsMCk7cmV0dXJuIHQuc2V0RnVsbFllYXIobi5nZXRGdWxsWWVhcigpLG4uZ2V0TW9udGgoKSxuLmdldERhdGUoKSksdH0sZnVuY3Rpb24obix0KXtuLnNldERhdGUobi5nZXREYXRlKCkrdCl9LGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldERhdGUoKS0xfSksZmMuZGF5cz1mYy5kYXkucmFuZ2UsZmMuZGF5cy51dGM9ZmMuZGF5LnV0Yy5yYW5nZSxmYy5kYXlPZlllYXI9ZnVuY3Rpb24obil7dmFyIHQ9ZmMueWVhcihuKTtyZXR1cm4gTWF0aC5mbG9vcigobi10LTZlNCoobi5nZXRUaW1lem9uZU9mZnNldCgpLXQuZ2V0VGltZXpvbmVPZmZzZXQoKSkpLzg2NGU1KX0sWyJzdW5kYXkiLCJtb25kYXkiLCJ0dWVzZGF5Iiwid2VkbmVzZGF5IiwidGh1cnNkYXkiLCJmcmlkYXkiLCJzYXR1cmRheSJdLmZvckVhY2goZnVuY3Rpb24obix0KXt0PTctdDt2YXIgZT1mY1tuXT1GdChmdW5jdGlvbihuKXtyZXR1cm4obj1mYy5kYXkobikpLnNldERhdGUobi5nZXREYXRlKCktKG4uZ2V0RGF5KCkrdCklNyksbn0sZnVuY3Rpb24obix0KXtuLnNldERhdGUobi5nZXREYXRlKCkrNypNYXRoLmZsb29yKHQpKX0sZnVuY3Rpb24obil7dmFyIGU9ZmMueWVhcihuKS5nZXREYXkoKTtyZXR1cm4gTWF0aC5mbG9vcigoZmMuZGF5T2ZZZWFyKG4pKyhlK3QpJTcpLzcpLShlIT09dCl9KTtmY1tuKyJzIl09ZS5yYW5nZSxmY1tuKyJzIl0udXRjPWUudXRjLnJhbmdlLGZjW24rIk9mWWVhciJdPWZ1bmN0aW9uKG4pe3ZhciBlPWZjLnllYXIobikuZ2V0RGF5KCk7cmV0dXJuIE1hdGguZmxvb3IoKGZjLmRheU9mWWVhcihuKSsoZSt0KSU3KS83KX19KSxmYy53ZWVrPWZjLnN1bmRheSxmYy53ZWVrcz1mYy5zdW5kYXkucmFuZ2UsZmMud2Vla3MudXRjPWZjLnN1bmRheS51dGMucmFuZ2UsZmMud2Vla09mWWVhcj1mYy5zdW5kYXlPZlllYXI7dmFyIHBjPXsiLSI6IiIsXzoiICIsMDoiMCJ9LHZjPS9eXHMqXGQrLyxkYz0vXiUvO3RhLmxvY2FsZT1mdW5jdGlvbihuKXtyZXR1cm57bnVtYmVyRm9ybWF0OlB0KG4pLHRpbWVGb3JtYXQ6T3Qobil9fTt2YXIgbWM9dGEubG9jYWxlKHtkZWNpbWFsOiIuIix0aG91c2FuZHM6IiwiLGdyb3VwaW5nOlszXSxjdXJyZW5jeTpbIiQiLCIiXSxkYXRlVGltZToiJWEgJWIgJWUgJVggJVkiLGRhdGU6IiVtLyVkLyVZIix0aW1lOiIlSDolTTolUyIscGVyaW9kczpbIkFNIiwiUE0iXSxkYXlzOlsiU3VuZGF5IiwiTW9uZGF5IiwiVHVlc2RheSIsIldlZG5lc2RheSIsIlRodXJzZGF5IiwiRnJpZGF5IiwiU2F0dXJkYXkiXSxzaG9ydERheXM6WyJTdW4iLCJNb24iLCJUdWUiLCJXZWQiLCJUaHUiLCJGcmkiLCJTYXQiXSxtb250aHM6WyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWd1c3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdLHNob3J0TW9udGhzOlsiSmFuIiwiRmViIiwiTWFyIiwiQXByIiwiTWF5IiwiSnVuIiwiSnVsIiwiQXVnIiwiU2VwIiwiT2N0IiwiTm92IiwiRGVjIl19KTt0YS5mb3JtYXQ9bWMubnVtYmVyRm9ybWF0LHRhLmdlbz17fSxjZS5wcm90b3R5cGU9e3M6MCx0OjAsYWRkOmZ1bmN0aW9uKG4pe2xlKG4sdGhpcy50LHljKSxsZSh5Yy5zLHRoaXMucyx0aGlzKSx0aGlzLnM/dGhpcy50Kz15Yy50OnRoaXMucz15Yy50fSxyZXNldDpmdW5jdGlvbigpe3RoaXMucz10aGlzLnQ9MH0sdmFsdWVPZjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnN9fTt2YXIgeWM9bmV3IGNlO3RhLmdlby5zdHJlYW09ZnVuY3Rpb24obix0KXtuJiZNYy5oYXNPd25Qcm9wZXJ0eShuLnR5cGUpP01jW24udHlwZV0obix0KTpzZShuLHQpfTt2YXIgTWM9e0ZlYXR1cmU6ZnVuY3Rpb24obix0KXtzZShuLmdlb21ldHJ5LHQpfSxGZWF0dXJlQ29sbGVjdGlvbjpmdW5jdGlvbihuLHQpe2Zvcih2YXIgZT1uLmZlYXR1cmVzLHI9LTEsdT1lLmxlbmd0aDsrK3I8dTspc2UoZVtyXS5nZW9tZXRyeSx0KX19LHhjPXtTcGhlcmU6ZnVuY3Rpb24obix0KXt0LnNwaGVyZSgpfSxQb2ludDpmdW5jdGlvbihuLHQpe249bi5jb29yZGluYXRlcyx0LnBvaW50KG5bMF0sblsxXSxuWzJdKX0sTXVsdGlQb2ludDpmdW5jdGlvbihuLHQpe2Zvcih2YXIgZT1uLmNvb3JkaW5hdGVzLHI9LTEsdT1lLmxlbmd0aDsrK3I8dTspbj1lW3JdLHQucG9pbnQoblswXSxuWzFdLG5bMl0pCn0sTGluZVN0cmluZzpmdW5jdGlvbihuLHQpe2ZlKG4uY29vcmRpbmF0ZXMsdCwwKX0sTXVsdGlMaW5lU3RyaW5nOmZ1bmN0aW9uKG4sdCl7Zm9yKHZhciBlPW4uY29vcmRpbmF0ZXMscj0tMSx1PWUubGVuZ3RoOysrcjx1OylmZShlW3JdLHQsMCl9LFBvbHlnb246ZnVuY3Rpb24obix0KXtoZShuLmNvb3JkaW5hdGVzLHQpfSxNdWx0aVBvbHlnb246ZnVuY3Rpb24obix0KXtmb3IodmFyIGU9bi5jb29yZGluYXRlcyxyPS0xLHU9ZS5sZW5ndGg7KytyPHU7KWhlKGVbcl0sdCl9LEdlb21ldHJ5Q29sbGVjdGlvbjpmdW5jdGlvbihuLHQpe2Zvcih2YXIgZT1uLmdlb21ldHJpZXMscj0tMSx1PWUubGVuZ3RoOysrcjx1OylzZShlW3JdLHQpfX07dGEuZ2VvLmFyZWE9ZnVuY3Rpb24obil7cmV0dXJuIGJjPTAsdGEuZ2VvLnN0cmVhbShuLHdjKSxiY307dmFyIGJjLF9jPW5ldyBjZSx3Yz17c3BoZXJlOmZ1bmN0aW9uKCl7YmMrPTQqRGF9LHBvaW50OnksbGluZVN0YXJ0OnksbGluZUVuZDp5LHBvbHlnb25TdGFydDpmdW5jdGlvbigpe19jLnJlc2V0KCksd2MubGluZVN0YXJ0PWdlfSxwb2x5Z29uRW5kOmZ1bmN0aW9uKCl7dmFyIG49MipfYztiYys9MD5uPzQqRGErbjpuLHdjLmxpbmVTdGFydD13Yy5saW5lRW5kPXdjLnBvaW50PXl9fTt0YS5nZW8uYm91bmRzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihuLHQpe00ucHVzaCh4PVtzPW4saD1uXSksZj50JiYoZj10KSx0PmcmJihnPXQpfWZ1bmN0aW9uIHQodCxlKXt2YXIgcj1wZShbdCpGYSxlKkZhXSk7aWYobSl7dmFyIHU9ZGUobSxyKSxpPVt1WzFdLC11WzBdLDBdLG89ZGUoaSx1KTtNZShvKSxvPXhlKG8pO3ZhciBjPXQtcCxsPWM+MD8xOi0xLHY9b1swXSpIYSpsLGQ9dmEoYyk+MTgwO2lmKGReKHY+bCpwJiZsKnQ+dikpe3ZhciB5PW9bMV0qSGE7eT5nJiYoZz15KX1lbHNlIGlmKHY9KHYrMzYwKSUzNjAtMTgwLGReKHY+bCpwJiZsKnQ+dikpe3ZhciB5PS1vWzFdKkhhO2Y+eSYmKGY9eSl9ZWxzZSBmPmUmJihmPWUpLGU+ZyYmKGc9ZSk7ZD9wPnQ/YShzLHQpPmEocyxoKSYmKGg9dCk6YSh0LGgpPmEocyxoKSYmKHM9dCk6aD49cz8ocz50JiYocz10KSx0PmgmJihoPXQpKTp0PnA/YShzLHQpPmEocyxoKSYmKGg9dCk6YSh0LGgpPmEocyxoKSYmKHM9dCl9ZWxzZSBuKHQsZSk7bT1yLHA9dH1mdW5jdGlvbiBlKCl7Yi5wb2ludD10fWZ1bmN0aW9uIHIoKXt4WzBdPXMseFsxXT1oLGIucG9pbnQ9bixtPW51bGx9ZnVuY3Rpb24gdShuLGUpe2lmKG0pe3ZhciByPW4tcDt5Kz12YShyKT4xODA/cisocj4wPzM2MDotMzYwKTpyfWVsc2Ugdj1uLGQ9ZTt3Yy5wb2ludChuLGUpLHQobixlKX1mdW5jdGlvbiBpKCl7d2MubGluZVN0YXJ0KCl9ZnVuY3Rpb24gbygpe3UodixkKSx3Yy5saW5lRW5kKCksdmEoeSk+VGEmJihzPS0oaD0xODApKSx4WzBdPXMseFsxXT1oLG09bnVsbH1mdW5jdGlvbiBhKG4sdCl7cmV0dXJuKHQtPW4pPDA/dCszNjA6dH1mdW5jdGlvbiBjKG4sdCl7cmV0dXJuIG5bMF0tdFswXX1mdW5jdGlvbiBsKG4sdCl7cmV0dXJuIHRbMF08PXRbMV0/dFswXTw9biYmbjw9dFsxXTpuPHRbMF18fHRbMV08bn12YXIgcyxmLGgsZyxwLHYsZCxtLHksTSx4LGI9e3BvaW50Om4sbGluZVN0YXJ0OmUsbGluZUVuZDpyLHBvbHlnb25TdGFydDpmdW5jdGlvbigpe2IucG9pbnQ9dSxiLmxpbmVTdGFydD1pLGIubGluZUVuZD1vLHk9MCx3Yy5wb2x5Z29uU3RhcnQoKX0scG9seWdvbkVuZDpmdW5jdGlvbigpe3djLnBvbHlnb25FbmQoKSxiLnBvaW50PW4sYi5saW5lU3RhcnQ9ZSxiLmxpbmVFbmQ9ciwwPl9jPyhzPS0oaD0xODApLGY9LShnPTkwKSk6eT5UYT9nPTkwOi1UYT55JiYoZj0tOTApLHhbMF09cyx4WzFdPWh9fTtyZXR1cm4gZnVuY3Rpb24obil7Zz1oPS0ocz1mPTEvMCksTT1bXSx0YS5nZW8uc3RyZWFtKG4sYik7dmFyIHQ9TS5sZW5ndGg7aWYodCl7TS5zb3J0KGMpO2Zvcih2YXIgZSxyPTEsdT1NWzBdLGk9W3VdO3Q+cjsrK3IpZT1NW3JdLGwoZVswXSx1KXx8bChlWzFdLHUpPyhhKHVbMF0sZVsxXSk+YSh1WzBdLHVbMV0pJiYodVsxXT1lWzFdKSxhKGVbMF0sdVsxXSk+YSh1WzBdLHVbMV0pJiYodVswXT1lWzBdKSk6aS5wdXNoKHU9ZSk7Zm9yKHZhciBvLGUscD0tMS8wLHQ9aS5sZW5ndGgtMSxyPTAsdT1pW3RdO3Q+PXI7dT1lLCsrcillPWlbcl0sKG89YSh1WzFdLGVbMF0pKT5wJiYocD1vLHM9ZVswXSxoPXVbMV0pfXJldHVybiBNPXg9bnVsbCwxLzA9PT1zfHwxLzA9PT1mP1tbMC8wLDAvMF0sWzAvMCwwLzBdXTpbW3MsZl0sW2gsZ11dfX0oKSx0YS5nZW8uY2VudHJvaWQ9ZnVuY3Rpb24obil7U2M9a2M9RWM9QWM9TmM9Q2M9emM9cWM9TGM9VGM9UmM9MCx0YS5nZW8uc3RyZWFtKG4sRGMpO3ZhciB0PUxjLGU9VGMscj1SYyx1PXQqdCtlKmUrcipyO3JldHVybiBSYT51JiYodD1DYyxlPXpjLHI9cWMsVGE+a2MmJih0PUVjLGU9QWMscj1OYyksdT10KnQrZSplK3IqcixSYT51KT9bMC8wLDAvMF06W01hdGguYXRhbjIoZSx0KSpIYSxudChyL01hdGguc3FydCh1KSkqSGFdfTt2YXIgU2Msa2MsRWMsQWMsTmMsQ2MsemMscWMsTGMsVGMsUmMsRGM9e3NwaGVyZTp5LHBvaW50Ol9lLGxpbmVTdGFydDpTZSxsaW5lRW5kOmtlLHBvbHlnb25TdGFydDpmdW5jdGlvbigpe0RjLmxpbmVTdGFydD1FZX0scG9seWdvbkVuZDpmdW5jdGlvbigpe0RjLmxpbmVTdGFydD1TZX19LFBjPUxlKE5lLFBlLGplLFstRGEsLURhLzJdKSxVYz0xZTk7dGEuZ2VvLmNsaXBFeHRlbnQ9ZnVuY3Rpb24oKXt2YXIgbix0LGUscix1LGksbz17c3RyZWFtOmZ1bmN0aW9uKG4pe3JldHVybiB1JiYodS52YWxpZD0hMSksdT1pKG4pLHUudmFsaWQ9ITAsdX0sZXh0ZW50OmZ1bmN0aW9uKGEpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPVllKG49K2FbMF1bMF0sdD0rYVswXVsxXSxlPSthWzFdWzBdLHI9K2FbMV1bMV0pLHUmJih1LnZhbGlkPSExLHU9bnVsbCksbyk6W1tuLHRdLFtlLHJdXX19O3JldHVybiBvLmV4dGVudChbWzAsMF0sWzk2MCw1MDBdXSl9LCh0YS5nZW8uY29uaWNFcXVhbEFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gSWUoWmUpfSkucmF3PVplLHRhLmdlby5hbGJlcnM9ZnVuY3Rpb24oKXtyZXR1cm4gdGEuZ2VvLmNvbmljRXF1YWxBcmVhKCkucm90YXRlKFs5NiwwXSkuY2VudGVyKFstLjYsMzguN10pLnBhcmFsbGVscyhbMjkuNSw0NS41XSkuc2NhbGUoMTA3MCl9LHRhLmdlby5hbGJlcnNVc2E9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKG4pe3ZhciBpPW5bMF0sbz1uWzFdO3JldHVybiB0PW51bGwsZShpLG8pLHR8fChyKGksbyksdCl8fHUoaSxvKSx0fXZhciB0LGUscix1LGk9dGEuZ2VvLmFsYmVycygpLG89dGEuZ2VvLmNvbmljRXF1YWxBcmVhKCkucm90YXRlKFsxNTQsMF0pLmNlbnRlcihbLTIsNTguNV0pLnBhcmFsbGVscyhbNTUsNjVdKSxhPXRhLmdlby5jb25pY0VxdWFsQXJlYSgpLnJvdGF0ZShbMTU3LDBdKS5jZW50ZXIoWy0zLDE5LjldKS5wYXJhbGxlbHMoWzgsMThdKSxjPXtwb2ludDpmdW5jdGlvbihuLGUpe3Q9W24sZV19fTtyZXR1cm4gbi5pbnZlcnQ9ZnVuY3Rpb24obil7dmFyIHQ9aS5zY2FsZSgpLGU9aS50cmFuc2xhdGUoKSxyPShuWzBdLWVbMF0pL3QsdT0oblsxXS1lWzFdKS90O3JldHVybih1Pj0uMTImJi4yMzQ+dSYmcj49LS40MjUmJi0uMjE0PnI/bzp1Pj0uMTY2JiYuMjM0PnUmJnI+PS0uMjE0JiYtLjExNT5yP2E6aSkuaW52ZXJ0KG4pfSxuLnN0cmVhbT1mdW5jdGlvbihuKXt2YXIgdD1pLnN0cmVhbShuKSxlPW8uc3RyZWFtKG4pLHI9YS5zdHJlYW0obik7cmV0dXJue3BvaW50OmZ1bmN0aW9uKG4sdSl7dC5wb2ludChuLHUpLGUucG9pbnQobix1KSxyLnBvaW50KG4sdSl9LHNwaGVyZTpmdW5jdGlvbigpe3Quc3BoZXJlKCksZS5zcGhlcmUoKSxyLnNwaGVyZSgpfSxsaW5lU3RhcnQ6ZnVuY3Rpb24oKXt0LmxpbmVTdGFydCgpLGUubGluZVN0YXJ0KCksci5saW5lU3RhcnQoKX0sbGluZUVuZDpmdW5jdGlvbigpe3QubGluZUVuZCgpLGUubGluZUVuZCgpLHIubGluZUVuZCgpfSxwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXt0LnBvbHlnb25TdGFydCgpLGUucG9seWdvblN0YXJ0KCksci5wb2x5Z29uU3RhcnQoKX0scG9seWdvbkVuZDpmdW5jdGlvbigpe3QucG9seWdvbkVuZCgpLGUucG9seWdvbkVuZCgpLHIucG9seWdvbkVuZCgpfX19LG4ucHJlY2lzaW9uPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpLnByZWNpc2lvbih0KSxvLnByZWNpc2lvbih0KSxhLnByZWNpc2lvbih0KSxuKTppLnByZWNpc2lvbigpfSxuLnNjYWxlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpLnNjYWxlKHQpLG8uc2NhbGUoLjM1KnQpLGEuc2NhbGUodCksbi50cmFuc2xhdGUoaS50cmFuc2xhdGUoKSkpOmkuc2NhbGUoKX0sbi50cmFuc2xhdGU9ZnVuY3Rpb24odCl7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGkudHJhbnNsYXRlKCk7dmFyIGw9aS5zY2FsZSgpLHM9K3RbMF0sZj0rdFsxXTtyZXR1cm4gZT1pLnRyYW5zbGF0ZSh0KS5jbGlwRXh0ZW50KFtbcy0uNDU1KmwsZi0uMjM4KmxdLFtzKy40NTUqbCxmKy4yMzgqbF1dKS5zdHJlYW0oYykucG9pbnQscj1vLnRyYW5zbGF0ZShbcy0uMzA3KmwsZisuMjAxKmxdKS5jbGlwRXh0ZW50KFtbcy0uNDI1KmwrVGEsZisuMTIqbCtUYV0sW3MtLjIxNCpsLVRhLGYrLjIzNCpsLVRhXV0pLnN0cmVhbShjKS5wb2ludCx1PWEudHJhbnNsYXRlKFtzLS4yMDUqbCxmKy4yMTIqbF0pLmNsaXBFeHRlbnQoW1tzLS4yMTQqbCtUYSxmKy4xNjYqbCtUYV0sW3MtLjExNSpsLVRhLGYrLjIzNCpsLVRhXV0pLnN0cmVhbShjKS5wb2ludCxufSxuLnNjYWxlKDEwNzApfTt2YXIgamMsRmMsSGMsT2MsWWMsSWMsWmM9e3BvaW50OnksbGluZVN0YXJ0OnksbGluZUVuZDp5LHBvbHlnb25TdGFydDpmdW5jdGlvbigpe0ZjPTAsWmMubGluZVN0YXJ0PVZlfSxwb2x5Z29uRW5kOmZ1bmN0aW9uKCl7WmMubGluZVN0YXJ0PVpjLmxpbmVFbmQ9WmMucG9pbnQ9eSxqYys9dmEoRmMvMil9fSxWYz17cG9pbnQ6WGUsbGluZVN0YXJ0OnksbGluZUVuZDp5LHBvbHlnb25TdGFydDp5LHBvbHlnb25FbmQ6eX0sWGM9e3BvaW50OldlLGxpbmVTdGFydDpKZSxsaW5lRW5kOkdlLHBvbHlnb25TdGFydDpmdW5jdGlvbigpe1hjLmxpbmVTdGFydD1LZX0scG9seWdvbkVuZDpmdW5jdGlvbigpe1hjLnBvaW50PVdlLFhjLmxpbmVTdGFydD1KZSxYYy5saW5lRW5kPUdlfX07dGEuZ2VvLnBhdGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKG4pe3JldHVybiBuJiYoImZ1bmN0aW9uIj09dHlwZW9mIGEmJmkucG9pbnRSYWRpdXMoK2EuYXBwbHkodGhpcyxhcmd1bWVudHMpKSxvJiZvLnZhbGlkfHwobz11KGkpKSx0YS5nZW8uc3RyZWFtKG4sbykpLGkucmVzdWx0KCl9ZnVuY3Rpb24gdCgpe3JldHVybiBvPW51bGwsbn12YXIgZSxyLHUsaSxvLGE9NC41O3JldHVybiBuLmFyZWE9ZnVuY3Rpb24obil7cmV0dXJuIGpjPTAsdGEuZ2VvLnN0cmVhbShuLHUoWmMpKSxqY30sbi5jZW50cm9pZD1mdW5jdGlvbihuKXtyZXR1cm4gRWM9QWM9TmM9Q2M9emM9cWM9TGM9VGM9UmM9MCx0YS5nZW8uc3RyZWFtKG4sdShYYykpLFJjP1tMYy9SYyxUYy9SY106cWM/W0NjL3FjLHpjL3FjXTpOYz9bRWMvTmMsQWMvTmNdOlswLzAsMC8wXX0sbi5ib3VuZHM9ZnVuY3Rpb24obil7cmV0dXJuIFljPUljPS0oSGM9T2M9MS8wKSx0YS5nZW8uc3RyZWFtKG4sdShWYykpLFtbSGMsT2NdLFtZYyxJY11dfSxuLnByb2plY3Rpb249ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHU9KGU9bik/bi5zdHJlYW18fHRyKG4pOkV0LHQoKSk6ZX0sbi5jb250ZXh0PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPW51bGw9PShyPW4pP25ldyAkZTpuZXcgUWUobiksImZ1bmN0aW9uIiE9dHlwZW9mIGEmJmkucG9pbnRSYWRpdXMoYSksdCgpKTpyfSxuLnBvaW50UmFkaXVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPSJmdW5jdGlvbiI9PXR5cGVvZiB0P3Q6KGkucG9pbnRSYWRpdXMoK3QpLCt0KSxuKTphfSxuLnByb2plY3Rpb24odGEuZ2VvLmFsYmVyc1VzYSgpKS5jb250ZXh0KG51bGwpfSx0YS5nZW8udHJhbnNmb3JtPWZ1bmN0aW9uKG4pe3JldHVybntzdHJlYW06ZnVuY3Rpb24odCl7dmFyIGU9bmV3IGVyKHQpO2Zvcih2YXIgciBpbiBuKWVbcl09bltyXTtyZXR1cm4gZX19fSxlci5wcm90b3R5cGU9e3BvaW50OmZ1bmN0aW9uKG4sdCl7dGhpcy5zdHJlYW0ucG9pbnQobix0KX0sc3BoZXJlOmZ1bmN0aW9uKCl7dGhpcy5zdHJlYW0uc3BoZXJlKCl9LGxpbmVTdGFydDpmdW5jdGlvbigpe3RoaXMuc3RyZWFtLmxpbmVTdGFydCgpfSxsaW5lRW5kOmZ1bmN0aW9uKCl7dGhpcy5zdHJlYW0ubGluZUVuZCgpfSxwb2x5Z29uU3RhcnQ6ZnVuY3Rpb24oKXt0aGlzLnN0cmVhbS5wb2x5Z29uU3RhcnQoKX0scG9seWdvbkVuZDpmdW5jdGlvbigpe3RoaXMuc3RyZWFtLnBvbHlnb25FbmQoKX19LHRhLmdlby5wcm9qZWN0aW9uPXVyLHRhLmdlby5wcm9qZWN0aW9uTXV0YXRvcj1pciwodGEuZ2VvLmVxdWlyZWN0YW5ndWxhcj1mdW5jdGlvbigpe3JldHVybiB1cihhcil9KS5yYXc9YXIuaW52ZXJ0PWFyLHRhLmdlby5yb3RhdGlvbj1mdW5jdGlvbihuKXtmdW5jdGlvbiB0KHQpe3JldHVybiB0PW4odFswXSpGYSx0WzFdKkZhKSx0WzBdKj1IYSx0WzFdKj1IYSx0fXJldHVybiBuPWxyKG5bMF0lMzYwKkZhLG5bMV0qRmEsbi5sZW5ndGg+Mj9uWzJdKkZhOjApLHQuaW52ZXJ0PWZ1bmN0aW9uKHQpe3JldHVybiB0PW4uaW52ZXJ0KHRbMF0qRmEsdFsxXSpGYSksdFswXSo9SGEsdFsxXSo9SGEsdH0sdH0sY3IuaW52ZXJ0PWFyLHRhLmdlby5jaXJjbGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKCl7dmFyIG49ImZ1bmN0aW9uIj09dHlwZW9mIHI/ci5hcHBseSh0aGlzLGFyZ3VtZW50cyk6cix0PWxyKC1uWzBdKkZhLC1uWzFdKkZhLDApLmludmVydCx1PVtdO3JldHVybiBlKG51bGwsbnVsbCwxLHtwb2ludDpmdW5jdGlvbihuLGUpe3UucHVzaChuPXQobixlKSksblswXSo9SGEsblsxXSo9SGF9fSkse3R5cGU6IlBvbHlnb24iLGNvb3JkaW5hdGVzOlt1XX19dmFyIHQsZSxyPVswLDBdLHU9NjtyZXR1cm4gbi5vcmlnaW49ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9dCxuKTpyfSxuLmFuZ2xlPWZ1bmN0aW9uKHIpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPWdyKCh0PStyKSpGYSx1KkZhKSxuKTp0fSxuLnByZWNpc2lvbj1mdW5jdGlvbihyKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZT1ncih0KkZhLCh1PStyKSpGYSksbik6dX0sbi5hbmdsZSg5MCl9LHRhLmdlby5kaXN0YW5jZT1mdW5jdGlvbihuLHQpe3ZhciBlLHI9KHRbMF0tblswXSkqRmEsdT1uWzFdKkZhLGk9dFsxXSpGYSxvPU1hdGguc2luKHIpLGE9TWF0aC5jb3MociksYz1NYXRoLnNpbih1KSxsPU1hdGguY29zKHUpLHM9TWF0aC5zaW4oaSksZj1NYXRoLmNvcyhpKTtyZXR1cm4gTWF0aC5hdGFuMihNYXRoLnNxcnQoKGU9ZipvKSplKyhlPWwqcy1jKmYqYSkqZSksYypzK2wqZiphKX0sdGEuZ2VvLmdyYXRpY3VsZT1mdW5jdGlvbigpe2Z1bmN0aW9uIG4oKXtyZXR1cm57dHlwZToiTXVsdGlMaW5lU3RyaW5nIixjb29yZGluYXRlczp0KCl9fWZ1bmN0aW9uIHQoKXtyZXR1cm4gdGEucmFuZ2UoTWF0aC5jZWlsKGkvZCkqZCx1LGQpLm1hcChoKS5jb25jYXQodGEucmFuZ2UoTWF0aC5jZWlsKGwvbSkqbSxjLG0pLm1hcChnKSkuY29uY2F0KHRhLnJhbmdlKE1hdGguY2VpbChyL3ApKnAsZSxwKS5maWx0ZXIoZnVuY3Rpb24obil7cmV0dXJuIHZhKG4lZCk+VGF9KS5tYXAocykpLmNvbmNhdCh0YS5yYW5nZShNYXRoLmNlaWwoYS92KSp2LG8sdikuZmlsdGVyKGZ1bmN0aW9uKG4pe3JldHVybiB2YShuJW0pPlRhfSkubWFwKGYpKX12YXIgZSxyLHUsaSxvLGEsYyxsLHMsZixoLGcscD0xMCx2PXAsZD05MCxtPTM2MCx5PTIuNTtyZXR1cm4gbi5saW5lcz1mdW5jdGlvbigpe3JldHVybiB0KCkubWFwKGZ1bmN0aW9uKG4pe3JldHVybnt0eXBlOiJMaW5lU3RyaW5nIixjb29yZGluYXRlczpufX0pfSxuLm91dGxpbmU9ZnVuY3Rpb24oKXtyZXR1cm57dHlwZToiUG9seWdvbiIsY29vcmRpbmF0ZXM6W2goaSkuY29uY2F0KGcoYykuc2xpY2UoMSksaCh1KS5yZXZlcnNlKCkuc2xpY2UoMSksZyhsKS5yZXZlcnNlKCkuc2xpY2UoMSkpXX19LG4uZXh0ZW50PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP24ubWFqb3JFeHRlbnQodCkubWlub3JFeHRlbnQodCk6bi5taW5vckV4dGVudCgpfSxuLm1ham9yRXh0ZW50PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPSt0WzBdWzBdLHU9K3RbMV1bMF0sbD0rdFswXVsxXSxjPSt0WzFdWzFdLGk+dSYmKHQ9aSxpPXUsdT10KSxsPmMmJih0PWwsbD1jLGM9dCksbi5wcmVjaXNpb24oeSkpOltbaSxsXSxbdSxjXV19LG4ubWlub3JFeHRlbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9K3RbMF1bMF0sZT0rdFsxXVswXSxhPSt0WzBdWzFdLG89K3RbMV1bMV0scj5lJiYodD1yLHI9ZSxlPXQpLGE+byYmKHQ9YSxhPW8sbz10KSxuLnByZWNpc2lvbih5KSk6W1tyLGFdLFtlLG9dXX0sbi5zdGVwPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP24ubWFqb3JTdGVwKHQpLm1pbm9yU3RlcCh0KTpuLm1pbm9yU3RlcCgpfSxuLm1ham9yU3RlcD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZD0rdFswXSxtPSt0WzFdLG4pOltkLG1dfSxuLm1pbm9yU3RlcD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocD0rdFswXSx2PSt0WzFdLG4pOltwLHZdfSxuLnByZWNpc2lvbj1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oeT0rdCxzPXZyKGEsbyw5MCksZj1kcihyLGUseSksaD12cihsLGMsOTApLGc9ZHIoaSx1LHkpLG4pOnl9LG4ubWFqb3JFeHRlbnQoW1stMTgwLC05MCtUYV0sWzE4MCw5MC1UYV1dKS5taW5vckV4dGVudChbWy0xODAsLTgwLVRhXSxbMTgwLDgwK1RhXV0pfSx0YS5nZW8uZ3JlYXRBcmM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKCl7cmV0dXJue3R5cGU6IkxpbmVTdHJpbmciLGNvb3JkaW5hdGVzOlt0fHxyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxlfHx1LmFwcGx5KHRoaXMsYXJndW1lbnRzKV19fXZhciB0LGUscj1tcix1PXlyO3JldHVybiBuLmRpc3RhbmNlPWZ1bmN0aW9uKCl7cmV0dXJuIHRhLmdlby5kaXN0YW5jZSh0fHxyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxlfHx1LmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9LG4uc291cmNlPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPWUsdD0iZnVuY3Rpb24iPT10eXBlb2YgZT9udWxsOmUsbik6cn0sbi50YXJnZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHU9dCxlPSJmdW5jdGlvbiI9PXR5cGVvZiB0P251bGw6dCxuKTp1fSxuLnByZWNpc2lvbj1mdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP246MH0sbn0sdGEuZ2VvLmludGVycG9sYXRlPWZ1bmN0aW9uKG4sdCl7cmV0dXJuIE1yKG5bMF0qRmEsblsxXSpGYSx0WzBdKkZhLHRbMV0qRmEpfSx0YS5nZW8ubGVuZ3RoPWZ1bmN0aW9uKG4pe3JldHVybiAkYz0wLHRhLmdlby5zdHJlYW0obixCYyksJGN9O3ZhciAkYyxCYz17c3BoZXJlOnkscG9pbnQ6eSxsaW5lU3RhcnQ6eHIsbGluZUVuZDp5LHBvbHlnb25TdGFydDp5LHBvbHlnb25FbmQ6eX0sV2M9YnIoZnVuY3Rpb24obil7cmV0dXJuIE1hdGguc3FydCgyLygxK24pKX0sZnVuY3Rpb24obil7cmV0dXJuIDIqTWF0aC5hc2luKG4vMil9KTsodGEuZ2VvLmF6aW11dGhhbEVxdWFsQXJlYT1mdW5jdGlvbigpe3JldHVybiB1cihXYyl9KS5yYXc9V2M7dmFyIEpjPWJyKGZ1bmN0aW9uKG4pe3ZhciB0PU1hdGguYWNvcyhuKTtyZXR1cm4gdCYmdC9NYXRoLnNpbih0KX0sRXQpOyh0YS5nZW8uYXppbXV0aGFsRXF1aWRpc3RhbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdXIoSmMpfSkucmF3PUpjLCh0YS5nZW8uY29uaWNDb25mb3JtYWw9ZnVuY3Rpb24oKXtyZXR1cm4gSWUoX3IpfSkucmF3PV9yLCh0YS5nZW8uY29uaWNFcXVpZGlzdGFudD1mdW5jdGlvbigpe3JldHVybiBJZSh3cil9KS5yYXc9d3I7dmFyIEdjPWJyKGZ1bmN0aW9uKG4pe3JldHVybiAxL259LE1hdGguYXRhbik7KHRhLmdlby5nbm9tb25pYz1mdW5jdGlvbigpe3JldHVybiB1cihHYyl9KS5yYXc9R2MsU3IuaW52ZXJ0PWZ1bmN0aW9uKG4sdCl7cmV0dXJuW24sMipNYXRoLmF0YW4oTWF0aC5leHAodCkpLWphXX0sKHRhLmdlby5tZXJjYXRvcj1mdW5jdGlvbigpe3JldHVybiBrcihTcil9KS5yYXc9U3I7dmFyIEtjPWJyKGZ1bmN0aW9uKCl7cmV0dXJuIDF9LE1hdGguYXNpbik7KHRhLmdlby5vcnRob2dyYXBoaWM9ZnVuY3Rpb24oKXtyZXR1cm4gdXIoS2MpfSkucmF3PUtjO3ZhciBRYz1icihmdW5jdGlvbihuKXtyZXR1cm4gMS8oMStuKX0sZnVuY3Rpb24obil7cmV0dXJuIDIqTWF0aC5hdGFuKG4pfSk7KHRhLmdlby5zdGVyZW9ncmFwaGljPWZ1bmN0aW9uKCl7cmV0dXJuIHVyKFFjKX0pLnJhdz1RYyxFci5pbnZlcnQ9ZnVuY3Rpb24obix0KXtyZXR1cm5bLXQsMipNYXRoLmF0YW4oTWF0aC5leHAobikpLWphXX0sKHRhLmdlby50cmFuc3ZlcnNlTWVyY2F0b3I9ZnVuY3Rpb24oKXt2YXIgbj1rcihFciksdD1uLmNlbnRlcixlPW4ucm90YXRlO3JldHVybiBuLmNlbnRlcj1mdW5jdGlvbihuKXtyZXR1cm4gbj90KFstblsxXSxuWzBdXSk6KG49dCgpLFtuWzFdLC1uWzBdXSl9LG4ucm90YXRlPWZ1bmN0aW9uKG4pe3JldHVybiBuP2UoW25bMF0sblsxXSxuLmxlbmd0aD4yP25bMl0rOTA6OTBdKToobj1lKCksW25bMF0sblsxXSxuWzJdLTkwXSl9LGUoWzAsMCw5MF0pfSkucmF3PUVyLHRhLmdlb209e30sdGEuZ2VvbS5odWxsPWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHQobil7aWYobi5sZW5ndGg8MylyZXR1cm5bXTt2YXIgdCx1PWt0KGUpLGk9a3Qociksbz1uLmxlbmd0aCxhPVtdLGM9W107Zm9yKHQ9MDtvPnQ7dCsrKWEucHVzaChbK3UuY2FsbCh0aGlzLG5bdF0sdCksK2kuY2FsbCh0aGlzLG5bdF0sdCksdF0pO2ZvcihhLnNvcnQoenIpLHQ9MDtvPnQ7dCsrKWMucHVzaChbYVt0XVswXSwtYVt0XVsxXV0pO3ZhciBsPUNyKGEpLHM9Q3IoYyksZj1zWzBdPT09bFswXSxoPXNbcy5sZW5ndGgtMV09PT1sW2wubGVuZ3RoLTFdLGc9W107Zm9yKHQ9bC5sZW5ndGgtMTt0Pj0wOy0tdClnLnB1c2goblthW2xbdF1dWzJdXSk7Zm9yKHQ9K2Y7dDxzLmxlbmd0aC1oOysrdClnLnB1c2goblthW3NbdF1dWzJdXSk7cmV0dXJuIGd9dmFyIGU9QXIscj1OcjtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD90KG4pOih0Lng9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGU9bix0KTplfSx0Lnk9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9bix0KTpyfSx0KX0sdGEuZ2VvbS5wb2x5Z29uPWZ1bmN0aW9uKG4pe3JldHVybiB4YShuLG5sKSxufTt2YXIgbmw9dGEuZ2VvbS5wb2x5Z29uLnByb3RvdHlwZT1bXTtubC5hcmVhPWZ1bmN0aW9uKCl7Zm9yKHZhciBuLHQ9LTEsZT10aGlzLmxlbmd0aCxyPXRoaXNbZS0xXSx1PTA7Kyt0PGU7KW49cixyPXRoaXNbdF0sdSs9blsxXSpyWzBdLW5bMF0qclsxXTtyZXR1cm4uNSp1fSxubC5jZW50cm9pZD1mdW5jdGlvbihuKXt2YXIgdCxlLHI9LTEsdT10aGlzLmxlbmd0aCxpPTAsbz0wLGE9dGhpc1t1LTFdO2Zvcihhcmd1bWVudHMubGVuZ3RofHwobj0tMS8oNip0aGlzLmFyZWEoKSkpOysrcjx1Oyl0PWEsYT10aGlzW3JdLGU9dFswXSphWzFdLWFbMF0qdFsxXSxpKz0odFswXSthWzBdKSplLG8rPSh0WzFdK2FbMV0pKmU7cmV0dXJuW2kqbixvKm5dfSxubC5jbGlwPWZ1bmN0aW9uKG4pe2Zvcih2YXIgdCxlLHIsdSxpLG8sYT1UcihuKSxjPS0xLGw9dGhpcy5sZW5ndGgtVHIodGhpcykscz10aGlzW2wtMV07KytjPGw7KXtmb3IodD1uLnNsaWNlKCksbi5sZW5ndGg9MCx1PXRoaXNbY10saT10WyhyPXQubGVuZ3RoLWEpLTFdLGU9LTE7KytlPHI7KW89dFtlXSxxcihvLHMsdSk/KHFyKGkscyx1KXx8bi5wdXNoKExyKGksbyxzLHUpKSxuLnB1c2gobykpOnFyKGkscyx1KSYmbi5wdXNoKExyKGksbyxzLHUpKSxpPW87YSYmbi5wdXNoKG5bMF0pLHM9dX1yZXR1cm4gbn07dmFyIHRsLGVsLHJsLHVsLGlsLG9sPVtdLGFsPVtdO09yLnByb3RvdHlwZS5wcmVwYXJlPWZ1bmN0aW9uKCl7Zm9yKHZhciBuLHQ9dGhpcy5lZGdlcyxlPXQubGVuZ3RoO2UtLTspbj10W2VdLmVkZ2Usbi5iJiZuLmF8fHQuc3BsaWNlKGUsMSk7cmV0dXJuIHQuc29ydChJciksdC5sZW5ndGh9LFFyLnByb3RvdHlwZT17c3RhcnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lZGdlLmw9PT10aGlzLnNpdGU/dGhpcy5lZGdlLmE6dGhpcy5lZGdlLmJ9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVkZ2UubD09PXRoaXMuc2l0ZT90aGlzLmVkZ2UuYjp0aGlzLmVkZ2UuYX19LG51LnByb3RvdHlwZT17aW5zZXJ0OmZ1bmN0aW9uKG4sdCl7dmFyIGUscix1O2lmKG4pe2lmKHQuUD1uLHQuTj1uLk4sbi5OJiYobi5OLlA9dCksbi5OPXQsbi5SKXtmb3Iobj1uLlI7bi5MOyluPW4uTDtuLkw9dH1lbHNlIG4uUj10O2U9bn1lbHNlIHRoaXMuXz8obj11dSh0aGlzLl8pLHQuUD1udWxsLHQuTj1uLG4uUD1uLkw9dCxlPW4pOih0LlA9dC5OPW51bGwsdGhpcy5fPXQsZT1udWxsKTtmb3IodC5MPXQuUj1udWxsLHQuVT1lLHQuQz0hMCxuPXQ7ZSYmZS5DOylyPWUuVSxlPT09ci5MPyh1PXIuUix1JiZ1LkM/KGUuQz11LkM9ITEsci5DPSEwLG49cik6KG49PT1lLlImJihldSh0aGlzLGUpLG49ZSxlPW4uVSksZS5DPSExLHIuQz0hMCxydSh0aGlzLHIpKSk6KHU9ci5MLHUmJnUuQz8oZS5DPXUuQz0hMSxyLkM9ITAsbj1yKToobj09PWUuTCYmKHJ1KHRoaXMsZSksbj1lLGU9bi5VKSxlLkM9ITEsci5DPSEwLGV1KHRoaXMscikpKSxlPW4uVTt0aGlzLl8uQz0hMX0scmVtb3ZlOmZ1bmN0aW9uKG4pe24uTiYmKG4uTi5QPW4uUCksbi5QJiYobi5QLk49bi5OKSxuLk49bi5QPW51bGw7dmFyIHQsZSxyLHU9bi5VLGk9bi5MLG89bi5SO2lmKGU9aT9vP3V1KG8pOmk6byx1P3UuTD09PW4/dS5MPWU6dS5SPWU6dGhpcy5fPWUsaSYmbz8ocj1lLkMsZS5DPW4uQyxlLkw9aSxpLlU9ZSxlIT09bz8odT1lLlUsZS5VPW4uVSxuPWUuUix1Lkw9bixlLlI9byxvLlU9ZSk6KGUuVT11LHU9ZSxuPWUuUikpOihyPW4uQyxuPWUpLG4mJihuLlU9dSksIXIpe2lmKG4mJm4uQylyZXR1cm4gbi5DPSExLHZvaWQgMDtkb3tpZihuPT09dGhpcy5fKWJyZWFrO2lmKG49PT11Lkwpe2lmKHQ9dS5SLHQuQyYmKHQuQz0hMSx1LkM9ITAsZXUodGhpcyx1KSx0PXUuUiksdC5MJiZ0LkwuQ3x8dC5SJiZ0LlIuQyl7dC5SJiZ0LlIuQ3x8KHQuTC5DPSExLHQuQz0hMCxydSh0aGlzLHQpLHQ9dS5SKSx0LkM9dS5DLHUuQz10LlIuQz0hMSxldSh0aGlzLHUpLG49dGhpcy5fO2JyZWFrfX1lbHNlIGlmKHQ9dS5MLHQuQyYmKHQuQz0hMSx1LkM9ITAscnUodGhpcyx1KSx0PXUuTCksdC5MJiZ0LkwuQ3x8dC5SJiZ0LlIuQyl7dC5MJiZ0LkwuQ3x8KHQuUi5DPSExLHQuQz0hMCxldSh0aGlzLHQpLHQ9dS5MKSx0LkM9dS5DLHUuQz10LkwuQz0hMSxydSh0aGlzLHUpLG49dGhpcy5fO2JyZWFrfXQuQz0hMCxuPXUsdT11LlV9d2hpbGUoIW4uQyk7biYmKG4uQz0hMSl9fX0sdGEuZ2VvbS52b3Jvbm9pPWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHQobil7dmFyIHQ9bmV3IEFycmF5KG4ubGVuZ3RoKSxyPWFbMF1bMF0sdT1hWzBdWzFdLGk9YVsxXVswXSxvPWFbMV1bMV07cmV0dXJuIGl1KGUobiksYSkuY2VsbHMuZm9yRWFjaChmdW5jdGlvbihlLGEpe3ZhciBjPWUuZWRnZXMsbD1lLnNpdGUscz10W2FdPWMubGVuZ3RoP2MubWFwKGZ1bmN0aW9uKG4pe3ZhciB0PW4uc3RhcnQoKTtyZXR1cm5bdC54LHQueV19KTpsLng+PXImJmwueDw9aSYmbC55Pj11JiZsLnk8PW8/W1tyLG9dLFtpLG9dLFtpLHVdLFtyLHVdXTpbXTtzLnBvaW50PW5bYV19KSx0fWZ1bmN0aW9uIGUobil7cmV0dXJuIG4ubWFwKGZ1bmN0aW9uKG4sdCl7cmV0dXJue3g6TWF0aC5yb3VuZChpKG4sdCkvVGEpKlRhLHk6TWF0aC5yb3VuZChvKG4sdCkvVGEpKlRhLGk6dH19KX12YXIgcj1Bcix1PU5yLGk9cixvPXUsYT1jbDtyZXR1cm4gbj90KG4pOih0LmxpbmtzPWZ1bmN0aW9uKG4pe3JldHVybiBpdShlKG4pKS5lZGdlcy5maWx0ZXIoZnVuY3Rpb24obil7cmV0dXJuIG4ubCYmbi5yfSkubWFwKGZ1bmN0aW9uKHQpe3JldHVybntzb3VyY2U6blt0LmwuaV0sdGFyZ2V0Om5bdC5yLmldfX0pfSx0LnRyaWFuZ2xlcz1mdW5jdGlvbihuKXt2YXIgdD1bXTtyZXR1cm4gaXUoZShuKSkuY2VsbHMuZm9yRWFjaChmdW5jdGlvbihlLHIpe2Zvcih2YXIgdSxpLG89ZS5zaXRlLGE9ZS5lZGdlcy5zb3J0KElyKSxjPS0xLGw9YS5sZW5ndGgscz1hW2wtMV0uZWRnZSxmPXMubD09PW8/cy5yOnMubDsrK2M8bDspdT1zLGk9ZixzPWFbY10uZWRnZSxmPXMubD09PW8/cy5yOnMubCxyPGkuaSYmcjxmLmkmJmF1KG8saSxmKTwwJiZ0LnB1c2goW25bcl0sbltpLmldLG5bZi5pXV0pfSksdH0sdC54PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPWt0KHI9biksdCk6cn0sdC55PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhvPWt0KHU9biksdCk6dX0sdC5jbGlwRXh0ZW50PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPW51bGw9PW4/Y2w6bix0KTphPT09Y2w/bnVsbDphfSx0LnNpemU9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/dC5jbGlwRXh0ZW50KG4mJltbMCwwXSxuXSk6YT09PWNsP251bGw6YSYmYVsxXX0sdCl9O3ZhciBjbD1bWy0xZTYsLTFlNl0sWzFlNiwxZTZdXTt0YS5nZW9tLmRlbGF1bmF5PWZ1bmN0aW9uKG4pe3JldHVybiB0YS5nZW9tLnZvcm9ub2koKS50cmlhbmdsZXMobil9LHRhLmdlb20ucXVhZHRyZWU9ZnVuY3Rpb24obix0LGUscix1KXtmdW5jdGlvbiBpKG4pe2Z1bmN0aW9uIGkobix0LGUscix1LGksbyxhKXtpZighaXNOYU4oZSkmJiFpc05hTihyKSlpZihuLmxlYWYpe3ZhciBjPW4ueCxzPW4ueTtpZihudWxsIT1jKWlmKHZhKGMtZSkrdmEocy1yKTwuMDEpbChuLHQsZSxyLHUsaSxvLGEpO2Vsc2V7dmFyIGY9bi5wb2ludDtuLng9bi55PW4ucG9pbnQ9bnVsbCxsKG4sZixjLHMsdSxpLG8sYSksbChuLHQsZSxyLHUsaSxvLGEpfWVsc2Ugbi54PWUsbi55PXIsbi5wb2ludD10fWVsc2UgbChuLHQsZSxyLHUsaSxvLGEpfWZ1bmN0aW9uIGwobix0LGUscix1LG8sYSxjKXt2YXIgbD0uNSoodSthKSxzPS41KihvK2MpLGY9ZT49bCxoPXI+PXMsZz1oPDwxfGY7bi5sZWFmPSExLG49bi5ub2Rlc1tnXXx8KG4ubm9kZXNbZ109c3UoKSksZj91PWw6YT1sLGg/bz1zOmM9cyxpKG4sdCxlLHIsdSxvLGEsYyl9dmFyIHMsZixoLGcscCx2LGQsbSx5LE09a3QoYSkseD1rdChjKTtpZihudWxsIT10KXY9dCxkPWUsbT1yLHk9dTtlbHNlIGlmKG09eT0tKHY9ZD0xLzApLGY9W10saD1bXSxwPW4ubGVuZ3RoLG8pZm9yKGc9MDtwPmc7KytnKXM9bltnXSxzLng8diYmKHY9cy54KSxzLnk8ZCYmKGQ9cy55KSxzLng+bSYmKG09cy54KSxzLnk+eSYmKHk9cy55KSxmLnB1c2gocy54KSxoLnB1c2gocy55KTtlbHNlIGZvcihnPTA7cD5nOysrZyl7dmFyIGI9K00ocz1uW2ddLGcpLF89K3gocyxnKTt2PmImJih2PWIpLGQ+XyYmKGQ9XyksYj5tJiYobT1iKSxfPnkmJih5PV8pLGYucHVzaChiKSxoLnB1c2goXyl9dmFyIHc9bS12LFM9eS1kO3c+Uz95PWQrdzptPXYrUzt2YXIgaz1zdSgpO2lmKGsuYWRkPWZ1bmN0aW9uKG4pe2koayxuLCtNKG4sKytnKSwreChuLGcpLHYsZCxtLHkpfSxrLnZpc2l0PWZ1bmN0aW9uKG4pe2Z1KG4sayx2LGQsbSx5KX0say5maW5kPWZ1bmN0aW9uKG4pe3JldHVybiBodShrLG5bMF0sblsxXSx2LGQsbSx5KX0sZz0tMSxudWxsPT10KXtmb3IoOysrZzxwOylpKGssbltnXSxmW2ddLGhbZ10sdixkLG0seSk7LS1nfWVsc2Ugbi5mb3JFYWNoKGsuYWRkKTtyZXR1cm4gZj1oPW49cz1udWxsLGt9dmFyIG8sYT1BcixjPU5yO3JldHVybihvPWFyZ3VtZW50cy5sZW5ndGgpPyhhPWN1LGM9bHUsMz09PW8mJih1PWUscj10LGU9dD0wKSxpKG4pKTooaS54PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPW4saSk6YX0saS55PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhjPW4saSk6Y30saS5leHRlbnQ9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KG51bGw9PW4/dD1lPXI9dT1udWxsOih0PStuWzBdWzBdLGU9K25bMF1bMV0scj0rblsxXVswXSx1PStuWzFdWzFdKSxpKTpudWxsPT10P251bGw6W1t0LGVdLFtyLHVdXX0saS5zaXplPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhudWxsPT1uP3Q9ZT1yPXU9bnVsbDoodD1lPTAscj0rblswXSx1PStuWzFdKSxpKTpudWxsPT10P251bGw6W3ItdCx1LWVdfSxpKX0sdGEuaW50ZXJwb2xhdGVSZ2I9Z3UsdGEuaW50ZXJwb2xhdGVPYmplY3Q9cHUsdGEuaW50ZXJwb2xhdGVOdW1iZXI9dnUsdGEuaW50ZXJwb2xhdGVTdHJpbmc9ZHU7dmFyIGxsPS9bLStdPyg/OlxkK1wuP1xkKnxcLj9cZCspKD86W2VFXVstK10/XGQrKT8vZyxzbD1uZXcgUmVnRXhwKGxsLnNvdXJjZSwiZyIpO3RhLmludGVycG9sYXRlPW11LHRhLmludGVycG9sYXRvcnM9W2Z1bmN0aW9uKG4sdCl7dmFyIGU9dHlwZW9mIHQ7cmV0dXJuKCJzdHJpbmciPT09ZT90Yy5oYXModCl8fC9eKCN8cmdiXCh8aHNsXCgpLy50ZXN0KHQpP2d1OmR1OnQgaW5zdGFuY2VvZiBpdD9ndTpBcnJheS5pc0FycmF5KHQpP3l1OiJvYmplY3QiPT09ZSYmaXNOYU4odCk/cHU6dnUpKG4sdCl9XSx0YS5pbnRlcnBvbGF0ZUFycmF5PXl1O3ZhciBmbD1mdW5jdGlvbigpe3JldHVybiBFdH0saGw9dGEubWFwKHtsaW5lYXI6ZmwscG9seTprdSxxdWFkOmZ1bmN0aW9uKCl7cmV0dXJuIF91fSxjdWJpYzpmdW5jdGlvbigpe3JldHVybiB3dX0sc2luOmZ1bmN0aW9uKCl7cmV0dXJuIEV1fSxleHA6ZnVuY3Rpb24oKXtyZXR1cm4gQXV9LGNpcmNsZTpmdW5jdGlvbigpe3JldHVybiBOdX0sZWxhc3RpYzpDdSxiYWNrOnp1LGJvdW5jZTpmdW5jdGlvbigpe3JldHVybiBxdX19KSxnbD10YS5tYXAoeyJpbiI6RXQsb3V0Onh1LCJpbi1vdXQiOmJ1LCJvdXQtaW4iOmZ1bmN0aW9uKG4pe3JldHVybiBidSh4dShuKSl9fSk7dGEuZWFzZT1mdW5jdGlvbihuKXt2YXIgdD1uLmluZGV4T2YoIi0iKSxlPXQ+PTA/bi5zbGljZSgwLHQpOm4scj10Pj0wP24uc2xpY2UodCsxKToiaW4iO3JldHVybiBlPWhsLmdldChlKXx8Zmwscj1nbC5nZXQocil8fEV0LE11KHIoZS5hcHBseShudWxsLGVhLmNhbGwoYXJndW1lbnRzLDEpKSkpfSx0YS5pbnRlcnBvbGF0ZUhjbD1MdSx0YS5pbnRlcnBvbGF0ZUhzbD1UdSx0YS5pbnRlcnBvbGF0ZUxhYj1SdSx0YS5pbnRlcnBvbGF0ZVJvdW5kPUR1LHRhLnRyYW5zZm9ybT1mdW5jdGlvbihuKXt2YXIgdD11YS5jcmVhdGVFbGVtZW50TlModGEubnMucHJlZml4LnN2ZywiZyIpO3JldHVybih0YS50cmFuc2Zvcm09ZnVuY3Rpb24obil7aWYobnVsbCE9bil7dC5zZXRBdHRyaWJ1dGUoInRyYW5zZm9ybSIsbik7dmFyIGU9dC50cmFuc2Zvcm0uYmFzZVZhbC5jb25zb2xpZGF0ZSgpfXJldHVybiBuZXcgUHUoZT9lLm1hdHJpeDpwbCl9KShuKX0sUHUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuInRyYW5zbGF0ZSgiK3RoaXMudHJhbnNsYXRlKyIpcm90YXRlKCIrdGhpcy5yb3RhdGUrIilza2V3WCgiK3RoaXMuc2tldysiKXNjYWxlKCIrdGhpcy5zY2FsZSsiKSJ9O3ZhciBwbD17YToxLGI6MCxjOjAsZDoxLGU6MCxmOjB9O3RhLmludGVycG9sYXRlVHJhbnNmb3JtPUh1LHRhLmxheW91dD17fSx0YS5sYXlvdXQuYnVuZGxlPWZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKG4pe2Zvcih2YXIgdD1bXSxlPS0xLHI9bi5sZW5ndGg7KytlPHI7KXQucHVzaChJdShuW2VdKSk7cmV0dXJuIHR9fSx0YS5sYXlvdXQuY2hvcmQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKCl7dmFyIG4sbCxmLGgsZyxwPXt9LHY9W10sZD10YS5yYW5nZShpKSxtPVtdO2ZvcihlPVtdLHI9W10sbj0wLGg9LTE7KytoPGk7KXtmb3IobD0wLGc9LTE7KytnPGk7KWwrPXVbaF1bZ107di5wdXNoKGwpLG0ucHVzaCh0YS5yYW5nZShpKSksbis9bH1mb3IobyYmZC5zb3J0KGZ1bmN0aW9uKG4sdCl7cmV0dXJuIG8odltuXSx2W3RdKX0pLGEmJm0uZm9yRWFjaChmdW5jdGlvbihuLHQpe24uc29ydChmdW5jdGlvbihuLGUpe3JldHVybiBhKHVbdF1bbl0sdVt0XVtlXSl9KX0pLG49KFBhLXMqaSkvbixsPTAsaD0tMTsrK2g8aTspe2ZvcihmPWwsZz0tMTsrK2c8aTspe3ZhciB5PWRbaF0sTT1tW3ldW2ddLHg9dVt5XVtNXSxiPWwsXz1sKz14Km47cFt5KyItIitNXT17aW5kZXg6eSxzdWJpbmRleDpNLHN0YXJ0QW5nbGU6YixlbmRBbmdsZTpfLHZhbHVlOnh9fXJbeV09e2luZGV4Onksc3RhcnRBbmdsZTpmLGVuZEFuZ2xlOmwsdmFsdWU6KGwtZikvbn0sbCs9c31mb3IoaD0tMTsrK2g8aTspZm9yKGc9aC0xOysrZzxpOyl7dmFyIHc9cFtoKyItIitnXSxTPXBbZysiLSIraF07KHcudmFsdWV8fFMudmFsdWUpJiZlLnB1c2gody52YWx1ZTxTLnZhbHVlP3tzb3VyY2U6Uyx0YXJnZXQ6d306e3NvdXJjZTp3LHRhcmdldDpTfSl9YyYmdCgpfWZ1bmN0aW9uIHQoKXtlLnNvcnQoZnVuY3Rpb24obix0KXtyZXR1cm4gYygobi5zb3VyY2UudmFsdWUrbi50YXJnZXQudmFsdWUpLzIsKHQuc291cmNlLnZhbHVlK3QudGFyZ2V0LnZhbHVlKS8yKX0pfXZhciBlLHIsdSxpLG8sYSxjLGw9e30scz0wO3JldHVybiBsLm1hdHJpeD1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oaT0odT1uKSYmdS5sZW5ndGgsZT1yPW51bGwsbCk6dX0sbC5wYWRkaW5nPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhzPW4sZT1yPW51bGwsbCk6c30sbC5zb3J0R3JvdXBzPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhvPW4sZT1yPW51bGwsbCk6b30sbC5zb3J0U3ViZ3JvdXBzPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPW4sZT1udWxsLGwpOmF9LGwuc29ydENob3Jkcz1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oYz1uLGUmJnQoKSxsKTpjfSxsLmNob3Jkcz1mdW5jdGlvbigpe3JldHVybiBlfHxuKCksZX0sbC5ncm91cHM9ZnVuY3Rpb24oKXtyZXR1cm4gcnx8bigpLHJ9LGx9LHRhLmxheW91dC5mb3JjZT1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obil7cmV0dXJuIGZ1bmN0aW9uKHQsZSxyLHUpe2lmKHQucG9pbnQhPT1uKXt2YXIgaT10LmN4LW4ueCxvPXQuY3ktbi55LGE9dS1lLGM9aSppK28qbztpZihjPmEqYS9kKXtpZihwPmMpe3ZhciBsPXQuY2hhcmdlL2M7bi5weC09aSpsLG4ucHktPW8qbH1yZXR1cm4hMH1pZih0LnBvaW50JiZjJiZwPmMpe3ZhciBsPXQucG9pbnRDaGFyZ2UvYztuLnB4LT1pKmwsbi5weS09bypsfX1yZXR1cm4hdC5jaGFyZ2V9fWZ1bmN0aW9uIHQobil7bi5weD10YS5ldmVudC54LG4ucHk9dGEuZXZlbnQueSxhLnJlc3VtZSgpfXZhciBlLHIsdSxpLG8sYT17fSxjPXRhLmRpc3BhdGNoKCJzdGFydCIsInRpY2siLCJlbmQiKSxsPVsxLDFdLHM9LjksZj12bCxoPWRsLGc9LTMwLHA9bWwsdj0uMSxkPS42NCxtPVtdLHk9W107cmV0dXJuIGEudGljaz1mdW5jdGlvbigpe2lmKChyKj0uOTkpPC4wMDUpcmV0dXJuIGMuZW5kKHt0eXBlOiJlbmQiLGFscGhhOnI9MH0pLCEwO3ZhciB0LGUsYSxmLGgscCxkLE0seCxiPW0ubGVuZ3RoLF89eS5sZW5ndGg7Zm9yKGU9MDtfPmU7KytlKWE9eVtlXSxmPWEuc291cmNlLGg9YS50YXJnZXQsTT1oLngtZi54LHg9aC55LWYueSwocD1NKk0reCp4KSYmKHA9cippW2VdKigocD1NYXRoLnNxcnQocCkpLXVbZV0pL3AsTSo9cCx4Kj1wLGgueC09TSooZD1mLndlaWdodC8oaC53ZWlnaHQrZi53ZWlnaHQpKSxoLnktPXgqZCxmLngrPU0qKGQ9MS1kKSxmLnkrPXgqZCk7aWYoKGQ9cip2KSYmKE09bFswXS8yLHg9bFsxXS8yLGU9LTEsZCkpZm9yKDsrK2U8YjspYT1tW2VdLGEueCs9KE0tYS54KSpkLGEueSs9KHgtYS55KSpkO2lmKGcpZm9yKEp1KHQ9dGEuZ2VvbS5xdWFkdHJlZShtKSxyLG8pLGU9LTE7KytlPGI7KShhPW1bZV0pLmZpeGVkfHx0LnZpc2l0KG4oYSkpO2ZvcihlPS0xOysrZTxiOylhPW1bZV0sYS5maXhlZD8oYS54PWEucHgsYS55PWEucHkpOihhLngtPShhLnB4LShhLnB4PWEueCkpKnMsYS55LT0oYS5weS0oYS5weT1hLnkpKSpzKTtjLnRpY2soe3R5cGU6InRpY2siLGFscGhhOnJ9KX0sYS5ub2Rlcz1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obT1uLGEpOm19LGEubGlua3M9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHk9bixhKTp5fSxhLnNpemU9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGw9bixhKTpsfSxhLmxpbmtEaXN0YW5jZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZj0iZnVuY3Rpb24iPT10eXBlb2Ygbj9uOituLGEpOmZ9LGEuZGlzdGFuY2U9YS5saW5rRGlzdGFuY2UsYS5saW5rU3RyZW5ndGg9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGg9ImZ1bmN0aW9uIj09dHlwZW9mIG4/bjorbixhKTpofSxhLmZyaWN0aW9uPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhzPStuLGEpOnN9LGEuY2hhcmdlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhnPSJmdW5jdGlvbiI9PXR5cGVvZiBuP246K24sYSk6Z30sYS5jaGFyZ2VEaXN0YW5jZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocD1uKm4sYSk6TWF0aC5zcXJ0KHApfSxhLmdyYXZpdHk9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHY9K24sYSk6dn0sYS50aGV0YT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZD1uKm4sYSk6TWF0aC5zcXJ0KGQpfSxhLmFscGhhPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhuPStuLHI/cj1uPjA/bjowOm4+MCYmKGMuc3RhcnQoe3R5cGU6InN0YXJ0IixhbHBoYTpyPW59KSx0YS50aW1lcihhLnRpY2spKSxhKTpyfSxhLnN0YXJ0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihuLHIpe2lmKCFlKXtmb3IoZT1uZXcgQXJyYXkoYyksYT0wO2M+YTsrK2EpZVthXT1bXTtmb3IoYT0wO2w+YTsrK2Epe3ZhciB1PXlbYV07ZVt1LnNvdXJjZS5pbmRleF0ucHVzaCh1LnRhcmdldCksZVt1LnRhcmdldC5pbmRleF0ucHVzaCh1LnNvdXJjZSl9fWZvcih2YXIgaSxvPWVbdF0sYT0tMSxsPW8ubGVuZ3RoOysrYTxsOylpZighaXNOYU4oaT1vW2FdW25dKSlyZXR1cm4gaTtyZXR1cm4gTWF0aC5yYW5kb20oKSpyfXZhciB0LGUscixjPW0ubGVuZ3RoLHM9eS5sZW5ndGgscD1sWzBdLHY9bFsxXTtmb3IodD0wO2M+dDsrK3QpKHI9bVt0XSkuaW5kZXg9dCxyLndlaWdodD0wO2Zvcih0PTA7cz50OysrdClyPXlbdF0sIm51bWJlciI9PXR5cGVvZiByLnNvdXJjZSYmKHIuc291cmNlPW1bci5zb3VyY2VdKSwibnVtYmVyIj09dHlwZW9mIHIudGFyZ2V0JiYoci50YXJnZXQ9bVtyLnRhcmdldF0pLCsrci5zb3VyY2Uud2VpZ2h0LCsrci50YXJnZXQud2VpZ2h0O2Zvcih0PTA7Yz50OysrdClyPW1bdF0saXNOYU4oci54KSYmKHIueD1uKCJ4IixwKSksaXNOYU4oci55KSYmKHIueT1uKCJ5Iix2KSksaXNOYU4oci5weCkmJihyLnB4PXIueCksaXNOYU4oci5weSkmJihyLnB5PXIueSk7aWYodT1bXSwiZnVuY3Rpb24iPT10eXBlb2YgZilmb3IodD0wO3M+dDsrK3QpdVt0XT0rZi5jYWxsKHRoaXMseVt0XSx0KTtlbHNlIGZvcih0PTA7cz50OysrdCl1W3RdPWY7aWYoaT1bXSwiZnVuY3Rpb24iPT10eXBlb2YgaClmb3IodD0wO3M+dDsrK3QpaVt0XT0raC5jYWxsKHRoaXMseVt0XSx0KTtlbHNlIGZvcih0PTA7cz50OysrdClpW3RdPWg7aWYobz1bXSwiZnVuY3Rpb24iPT10eXBlb2YgZylmb3IodD0wO2M+dDsrK3Qpb1t0XT0rZy5jYWxsKHRoaXMsbVt0XSx0KTtlbHNlIGZvcih0PTA7Yz50OysrdClvW3RdPWc7cmV0dXJuIGEucmVzdW1lKCl9LGEucmVzdW1lPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYWxwaGEoLjEpfSxhLnN0b3A9ZnVuY3Rpb24oKXtyZXR1cm4gYS5hbHBoYSgwKX0sYS5kcmFnPWZ1bmN0aW9uKCl7cmV0dXJuIGV8fChlPXRhLmJlaGF2aW9yLmRyYWcoKS5vcmlnaW4oRXQpLm9uKCJkcmFnc3RhcnQuZm9yY2UiLFh1KS5vbigiZHJhZy5mb3JjZSIsdCkub24oImRyYWdlbmQuZm9yY2UiLCR1KSksYXJndW1lbnRzLmxlbmd0aD8odGhpcy5vbigibW91c2VvdmVyLmZvcmNlIixCdSkub24oIm1vdXNlb3V0LmZvcmNlIixXdSkuY2FsbChlKSx2b2lkIDApOmV9LHRhLnJlYmluZChhLGMsIm9uIil9O3ZhciB2bD0yMCxkbD0xLG1sPTEvMDt0YS5sYXlvdXQuaGllcmFyY2h5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbih1KXt2YXIgaSxvPVt1XSxhPVtdO2Zvcih1LmRlcHRoPTA7bnVsbCE9KGk9by5wb3AoKSk7KWlmKGEucHVzaChpKSwobD1lLmNhbGwobixpLGkuZGVwdGgpKSYmKGM9bC5sZW5ndGgpKXtmb3IodmFyIGMsbCxzOy0tYz49MDspby5wdXNoKHM9bFtjXSkscy5wYXJlbnQ9aSxzLmRlcHRoPWkuZGVwdGgrMTtyJiYoaS52YWx1ZT0wKSxpLmNoaWxkcmVuPWx9ZWxzZSByJiYoaS52YWx1ZT0rci5jYWxsKG4saSxpLmRlcHRoKXx8MCksZGVsZXRlIGkuY2hpbGRyZW47cmV0dXJuIFF1KHUsZnVuY3Rpb24obil7dmFyIGUsdTt0JiYoZT1uLmNoaWxkcmVuKSYmZS5zb3J0KHQpLHImJih1PW4ucGFyZW50KSYmKHUudmFsdWUrPW4udmFsdWUpfSksYX12YXIgdD1laSxlPW5pLHI9dGk7cmV0dXJuIG4uc29ydD1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD1lLG4pOnR9LG4uY2hpbGRyZW49ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGU9dCxuKTplfSxuLnZhbHVlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPXQsbik6cn0sbi5yZXZhbHVlPWZ1bmN0aW9uKHQpe3JldHVybiByJiYoS3UodCxmdW5jdGlvbihuKXtuLmNoaWxkcmVuJiYobi52YWx1ZT0wKX0pLFF1KHQsZnVuY3Rpb24odCl7dmFyIGU7dC5jaGlsZHJlbnx8KHQudmFsdWU9K3IuY2FsbChuLHQsdC5kZXB0aCl8fDApLChlPXQucGFyZW50KSYmKGUudmFsdWUrPXQudmFsdWUpfSkpLHR9LG59LHRhLmxheW91dC5wYXJ0aXRpb249ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsZSxyLHUpe3ZhciBpPXQuY2hpbGRyZW47aWYodC54PWUsdC55PXQuZGVwdGgqdSx0LmR4PXIsdC5keT11LGkmJihvPWkubGVuZ3RoKSl7dmFyIG8sYSxjLGw9LTE7Zm9yKHI9dC52YWx1ZT9yL3QudmFsdWU6MDsrK2w8bzspbihhPWlbbF0sZSxjPWEudmFsdWUqcix1KSxlKz1jfX1mdW5jdGlvbiB0KG4pe3ZhciBlPW4uY2hpbGRyZW4scj0wO2lmKGUmJih1PWUubGVuZ3RoKSlmb3IodmFyIHUsaT0tMTsrK2k8dTspcj1NYXRoLm1heChyLHQoZVtpXSkpO3JldHVybiAxK3J9ZnVuY3Rpb24gZShlLGkpe3ZhciBvPXIuY2FsbCh0aGlzLGUsaSk7cmV0dXJuIG4ob1swXSwwLHVbMF0sdVsxXS90KG9bMF0pKSxvfXZhciByPXRhLmxheW91dC5oaWVyYXJjaHkoKSx1PVsxLDFdO3JldHVybiBlLnNpemU9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHU9bixlKTp1fSxHdShlLHIpfSx0YS5sYXlvdXQucGllPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihvKXt2YXIgYSxjPW8ubGVuZ3RoLGw9by5tYXAoZnVuY3Rpb24oZSxyKXtyZXR1cm4rdC5jYWxsKG4sZSxyKX0pLHM9KygiZnVuY3Rpb24iPT10eXBlb2Ygcj9yLmFwcGx5KHRoaXMsYXJndW1lbnRzKTpyKSxmPSgiZnVuY3Rpb24iPT10eXBlb2YgdT91LmFwcGx5KHRoaXMsYXJndW1lbnRzKTp1KS1zLGg9TWF0aC5taW4oTWF0aC5hYnMoZikvYywrKCJmdW5jdGlvbiI9PXR5cGVvZiBpP2kuYXBwbHkodGhpcyxhcmd1bWVudHMpOmkpKSxnPWgqKDA+Zj8tMToxKSxwPShmLWMqZykvdGEuc3VtKGwpLHY9dGEucmFuZ2UoYyksZD1bXTtyZXR1cm4gbnVsbCE9ZSYmdi5zb3J0KGU9PT15bD9mdW5jdGlvbihuLHQpe3JldHVybiBsW3RdLWxbbl19OmZ1bmN0aW9uKG4sdCl7cmV0dXJuIGUob1tuXSxvW3RdKX0pLHYuZm9yRWFjaChmdW5jdGlvbihuKXtkW25dPXtkYXRhOm9bbl0sdmFsdWU6YT1sW25dLHN0YXJ0QW5nbGU6cyxlbmRBbmdsZTpzKz1hKnArZyxwYWRBbmdsZTpofX0pLGR9dmFyIHQ9TnVtYmVyLGU9eWwscj0wLHU9UGEsaT0wO3JldHVybiBuLnZhbHVlPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0PWUsbik6dH0sbi5zb3J0PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPXQsbik6ZX0sbi5zdGFydEFuZ2xlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPXQsbik6cn0sbi5lbmRBbmdsZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT10LG4pOnV9LG4ucGFkQW5nbGU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGk9dCxuKTppfSxufTt2YXIgeWw9e307dGEubGF5b3V0LnN0YWNrPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihhLGMpe2lmKCEoaD1hLmxlbmd0aCkpcmV0dXJuIGE7dmFyIGw9YS5tYXAoZnVuY3Rpb24oZSxyKXtyZXR1cm4gdC5jYWxsKG4sZSxyKX0pLHM9bC5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQubWFwKGZ1bmN0aW9uKHQsZSl7cmV0dXJuW2kuY2FsbChuLHQsZSksby5jYWxsKG4sdCxlKV19KX0pLGY9ZS5jYWxsKG4scyxjKTtsPXRhLnBlcm11dGUobCxmKSxzPXRhLnBlcm11dGUocyxmKTt2YXIgaCxnLHAsdixkPXIuY2FsbChuLHMsYyksbT1sWzBdLmxlbmd0aDtmb3IocD0wO20+cDsrK3ApZm9yKHUuY2FsbChuLGxbMF1bcF0sdj1kW3BdLHNbMF1bcF1bMV0pLGc9MTtoPmc7KytnKXUuY2FsbChuLGxbZ11bcF0sdis9c1tnLTFdW3BdWzFdLHNbZ11bcF1bMV0pO3JldHVybiBhfXZhciB0PUV0LGU9YWkscj1jaSx1PW9pLGk9dWksbz1paTtyZXR1cm4gbi52YWx1ZXM9ZnVuY3Rpb24oZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHQ9ZSxuKTp0fSxuLm9yZGVyPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPSJmdW5jdGlvbiI9PXR5cGVvZiB0P3Q6TWwuZ2V0KHQpfHxhaSxuKTplfSxuLm9mZnNldD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocj0iZnVuY3Rpb24iPT10eXBlb2YgdD90OnhsLmdldCh0KXx8Y2ksbik6cn0sbi54PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPXQsbik6aX0sbi55PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhvPXQsbik6b30sbi5vdXQ9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHU9dCxuKTp1fSxufTt2YXIgTWw9dGEubWFwKHsiaW5zaWRlLW91dCI6ZnVuY3Rpb24obil7dmFyIHQsZSxyPW4ubGVuZ3RoLHU9bi5tYXAobGkpLGk9bi5tYXAoc2kpLG89dGEucmFuZ2Uocikuc29ydChmdW5jdGlvbihuLHQpe3JldHVybiB1W25dLXVbdF19KSxhPTAsYz0wLGw9W10scz1bXTtmb3IodD0wO3I+dDsrK3QpZT1vW3RdLGM+YT8oYSs9aVtlXSxsLnB1c2goZSkpOihjKz1pW2VdLHMucHVzaChlKSk7cmV0dXJuIHMucmV2ZXJzZSgpLmNvbmNhdChsKX0scmV2ZXJzZTpmdW5jdGlvbihuKXtyZXR1cm4gdGEucmFuZ2Uobi5sZW5ndGgpLnJldmVyc2UoKX0sImRlZmF1bHQiOmFpfSkseGw9dGEubWFwKHtzaWxob3VldHRlOmZ1bmN0aW9uKG4pe3ZhciB0LGUscix1PW4ubGVuZ3RoLGk9blswXS5sZW5ndGgsbz1bXSxhPTAsYz1bXTtmb3IoZT0wO2k+ZTsrK2Upe2Zvcih0PTAscj0wO3U+dDt0Kyspcis9blt0XVtlXVsxXTtyPmEmJihhPXIpLG8ucHVzaChyKX1mb3IoZT0wO2k+ZTsrK2UpY1tlXT0oYS1vW2VdKS8yO3JldHVybiBjfSx3aWdnbGU6ZnVuY3Rpb24obil7dmFyIHQsZSxyLHUsaSxvLGEsYyxsLHM9bi5sZW5ndGgsZj1uWzBdLGg9Zi5sZW5ndGgsZz1bXTtmb3IoZ1swXT1jPWw9MCxlPTE7aD5lOysrZSl7Zm9yKHQ9MCx1PTA7cz50OysrdCl1Kz1uW3RdW2VdWzFdO2Zvcih0PTAsaT0wLGE9ZltlXVswXS1mW2UtMV1bMF07cz50OysrdCl7Zm9yKHI9MCxvPShuW3RdW2VdWzFdLW5bdF1bZS0xXVsxXSkvKDIqYSk7dD5yOysrcilvKz0obltyXVtlXVsxXS1uW3JdW2UtMV1bMV0pL2E7aSs9bypuW3RdW2VdWzFdfWdbZV09Yy09dT9pL3UqYTowLGw+YyYmKGw9Yyl9Zm9yKGU9MDtoPmU7KytlKWdbZV0tPWw7cmV0dXJuIGd9LGV4cGFuZDpmdW5jdGlvbihuKXt2YXIgdCxlLHIsdT1uLmxlbmd0aCxpPW5bMF0ubGVuZ3RoLG89MS91LGE9W107Zm9yKGU9MDtpPmU7KytlKXtmb3IodD0wLHI9MDt1PnQ7dCsrKXIrPW5bdF1bZV1bMV07aWYocilmb3IodD0wO3U+dDt0Kyspblt0XVtlXVsxXS89cjtlbHNlIGZvcih0PTA7dT50O3QrKyluW3RdW2VdWzFdPW99Zm9yKGU9MDtpPmU7KytlKWFbZV09MDtyZXR1cm4gYX0semVybzpjaX0pO3RhLmxheW91dC5oaXN0b2dyYW09ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKG4saSl7Zm9yKHZhciBvLGEsYz1bXSxsPW4ubWFwKGUsdGhpcykscz1yLmNhbGwodGhpcyxsLGkpLGY9dS5jYWxsKHRoaXMscyxsLGkpLGk9LTEsaD1sLmxlbmd0aCxnPWYubGVuZ3RoLTEscD10PzE6MS9oOysraTxnOylvPWNbaV09W10sby5keD1mW2krMV0tKG8ueD1mW2ldKSxvLnk9MDtpZihnPjApZm9yKGk9LTE7KytpPGg7KWE9bFtpXSxhPj1zWzBdJiZhPD1zWzFdJiYobz1jW3RhLmJpc2VjdChmLGEsMSxnKS0xXSxvLnkrPXAsby5wdXNoKG5baV0pKTtyZXR1cm4gY312YXIgdD0hMCxlPU51bWJlcixyPXBpLHU9aGk7cmV0dXJuIG4udmFsdWU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGU9dCxuKTplfSxuLnJhbmdlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPWt0KHQpLG4pOnJ9LG4uYmlucz1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT0ibnVtYmVyIj09dHlwZW9mIHQ/ZnVuY3Rpb24obil7cmV0dXJuIGdpKG4sdCl9Omt0KHQpLG4pOnV9LG4uZnJlcXVlbmN5PWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0PSEhZSxuKTp0fSxufSx0YS5sYXlvdXQucGFjaz1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obixpKXt2YXIgbz1lLmNhbGwodGhpcyxuLGkpLGE9b1swXSxjPXVbMF0sbD11WzFdLHM9bnVsbD09dD9NYXRoLnNxcnQ6ImZ1bmN0aW9uIj09dHlwZW9mIHQ/dDpmdW5jdGlvbigpe3JldHVybiB0fTtpZihhLng9YS55PTAsUXUoYSxmdW5jdGlvbihuKXtuLnI9K3Mobi52YWx1ZSl9KSxRdShhLE1pKSxyKXt2YXIgZj1yKih0PzE6TWF0aC5tYXgoMiphLnIvYywyKmEuci9sKSkvMjtRdShhLGZ1bmN0aW9uKG4pe24ucis9Zn0pLFF1KGEsTWkpLFF1KGEsZnVuY3Rpb24obil7bi5yLT1mfSl9cmV0dXJuIF9pKGEsYy8yLGwvMix0PzE6MS9NYXRoLm1heCgyKmEuci9jLDIqYS5yL2wpKSxvfXZhciB0LGU9dGEubGF5b3V0LmhpZXJhcmNoeSgpLnNvcnQodmkpLHI9MCx1PVsxLDFdO3JldHVybiBuLnNpemU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHU9dCxuKTp1fSxuLnJhZGl1cz1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD1udWxsPT1lfHwiZnVuY3Rpb24iPT10eXBlb2YgZT9lOitlLG4pOnR9LG4ucGFkZGluZz1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocj0rdCxuKTpyfSxHdShuLGUpfSx0YS5sYXlvdXQudHJlZT1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obix1KXt2YXIgcz1vLmNhbGwodGhpcyxuLHUpLGY9c1swXSxoPXQoZik7aWYoUXUoaCxlKSxoLnBhcmVudC5tPS1oLnosS3UoaCxyKSxsKUt1KGYsaSk7ZWxzZXt2YXIgZz1mLHA9Zix2PWY7S3UoZixmdW5jdGlvbihuKXtuLng8Zy54JiYoZz1uKSxuLng+cC54JiYocD1uKSxuLmRlcHRoPnYuZGVwdGgmJih2PW4pfSk7dmFyIGQ9YShnLHApLzItZy54LG09Y1swXS8ocC54K2EocCxnKS8yK2QpLHk9Y1sxXS8odi5kZXB0aHx8MSk7S3UoZixmdW5jdGlvbihuKXtuLng9KG4ueCtkKSptLG4ueT1uLmRlcHRoKnl9KX1yZXR1cm4gc31mdW5jdGlvbiB0KG4pe2Zvcih2YXIgdCxlPXtBOm51bGwsY2hpbGRyZW46W25dfSxyPVtlXTtudWxsIT0odD1yLnBvcCgpKTspZm9yKHZhciB1LGk9dC5jaGlsZHJlbixvPTAsYT1pLmxlbmd0aDthPm87KytvKXIucHVzaCgoaVtvXT11PXtfOmlbb10scGFyZW50OnQsY2hpbGRyZW46KHU9aVtvXS5jaGlsZHJlbikmJnUuc2xpY2UoKXx8W10sQTpudWxsLGE6bnVsbCx6OjAsbTowLGM6MCxzOjAsdDpudWxsLGk6b30pLmE9dSk7cmV0dXJuIGUuY2hpbGRyZW5bMF19ZnVuY3Rpb24gZShuKXt2YXIgdD1uLmNoaWxkcmVuLGU9bi5wYXJlbnQuY2hpbGRyZW4scj1uLmk/ZVtuLmktMV06bnVsbDtpZih0Lmxlbmd0aCl7Tmkobik7dmFyIGk9KHRbMF0ueit0W3QubGVuZ3RoLTFdLnopLzI7cj8obi56PXIueithKG4uXyxyLl8pLG4ubT1uLnotaSk6bi56PWl9ZWxzZSByJiYobi56PXIueithKG4uXyxyLl8pKTtuLnBhcmVudC5BPXUobixyLG4ucGFyZW50LkF8fGVbMF0pfWZ1bmN0aW9uIHIobil7bi5fLng9bi56K24ucGFyZW50Lm0sbi5tKz1uLnBhcmVudC5tfWZ1bmN0aW9uIHUobix0LGUpe2lmKHQpe2Zvcih2YXIgcix1PW4saT1uLG89dCxjPXUucGFyZW50LmNoaWxkcmVuWzBdLGw9dS5tLHM9aS5tLGY9by5tLGg9Yy5tO289RWkobyksdT1raSh1KSxvJiZ1OyljPWtpKGMpLGk9RWkoaSksaS5hPW4scj1vLnorZi11LnotbCthKG8uXyx1Ll8pLHI+MCYmKEFpKENpKG8sbixlKSxuLHIpLGwrPXIscys9ciksZis9by5tLGwrPXUubSxoKz1jLm0scys9aS5tO28mJiFFaShpKSYmKGkudD1vLGkubSs9Zi1zKSx1JiYha2koYykmJihjLnQ9dSxjLm0rPWwtaCxlPW4pfXJldHVybiBlfWZ1bmN0aW9uIGkobil7bi54Kj1jWzBdLG4ueT1uLmRlcHRoKmNbMV19dmFyIG89dGEubGF5b3V0LmhpZXJhcmNoeSgpLnNvcnQobnVsbCkudmFsdWUobnVsbCksYT1TaSxjPVsxLDFdLGw9bnVsbDtyZXR1cm4gbi5zZXBhcmF0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPXQsbik6YX0sbi5zaXplPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhsPW51bGw9PShjPXQpP2k6bnVsbCxuKTpsP251bGw6Y30sbi5ub2RlU2l6ZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obD1udWxsPT0oYz10KT9udWxsOmksbik6bD9jOm51bGx9LEd1KG4sbyl9LHRhLmxheW91dC5jbHVzdGVyPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihuLGkpe3ZhciBvLGE9dC5jYWxsKHRoaXMsbixpKSxjPWFbMF0sbD0wO1F1KGMsZnVuY3Rpb24obil7dmFyIHQ9bi5jaGlsZHJlbjt0JiZ0Lmxlbmd0aD8obi54PXFpKHQpLG4ueT16aSh0KSk6KG4ueD1vP2wrPWUobixvKTowLG4ueT0wLG89bil9KTt2YXIgcz1MaShjKSxmPVRpKGMpLGg9cy54LWUocyxmKS8yLGc9Zi54K2UoZixzKS8yO3JldHVybiBRdShjLHU/ZnVuY3Rpb24obil7bi54PShuLngtYy54KSpyWzBdLG4ueT0oYy55LW4ueSkqclsxXX06ZnVuY3Rpb24obil7bi54PShuLngtaCkvKGctaCkqclswXSxuLnk9KDEtKGMueT9uLnkvYy55OjEpKSpyWzFdfSksYX12YXIgdD10YS5sYXlvdXQuaGllcmFyY2h5KCkuc29ydChudWxsKS52YWx1ZShudWxsKSxlPVNpLHI9WzEsMV0sdT0hMTtyZXR1cm4gbi5zZXBhcmF0aW9uPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPXQsbik6ZX0sbi5zaXplPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh1PW51bGw9PShyPXQpLG4pOnU/bnVsbDpyfSxuLm5vZGVTaXplPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh1PW51bGwhPShyPXQpLG4pOnU/cjpudWxsfSxHdShuLHQpfSx0YS5sYXlvdXQudHJlZW1hcD1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obix0KXtmb3IodmFyIGUscix1PS0xLGk9bi5sZW5ndGg7Kyt1PGk7KXI9KGU9blt1XSkudmFsdWUqKDA+dD8wOnQpLGUuYXJlYT1pc05hTihyKXx8MD49cj8wOnJ9ZnVuY3Rpb24gdChlKXt2YXIgaT1lLmNoaWxkcmVuO2lmKGkmJmkubGVuZ3RoKXt2YXIgbyxhLGMsbD1mKGUpLHM9W10saD1pLnNsaWNlKCkscD0xLzAsdj0ic2xpY2UiPT09Zz9sLmR4OiJkaWNlIj09PWc/bC5keToic2xpY2UtZGljZSI9PT1nPzEmZS5kZXB0aD9sLmR5OmwuZHg6TWF0aC5taW4obC5keCxsLmR5KTtmb3IobihoLGwuZHgqbC5keS9lLnZhbHVlKSxzLmFyZWE9MDsoYz1oLmxlbmd0aCk+MDspcy5wdXNoKG89aFtjLTFdKSxzLmFyZWErPW8uYXJlYSwic3F1YXJpZnkiIT09Z3x8KGE9cihzLHYpKTw9cD8oaC5wb3AoKSxwPWEpOihzLmFyZWEtPXMucG9wKCkuYXJlYSx1KHMsdixsLCExKSx2PU1hdGgubWluKGwuZHgsbC5keSkscy5sZW5ndGg9cy5hcmVhPTAscD0xLzApO3MubGVuZ3RoJiYodShzLHYsbCwhMCkscy5sZW5ndGg9cy5hcmVhPTApLGkuZm9yRWFjaCh0KX19ZnVuY3Rpb24gZSh0KXt2YXIgcj10LmNoaWxkcmVuO2lmKHImJnIubGVuZ3RoKXt2YXIgaSxvPWYodCksYT1yLnNsaWNlKCksYz1bXTtmb3IobihhLG8uZHgqby5keS90LnZhbHVlKSxjLmFyZWE9MDtpPWEucG9wKCk7KWMucHVzaChpKSxjLmFyZWErPWkuYXJlYSxudWxsIT1pLnomJih1KGMsaS56P28uZHg6by5keSxvLCFhLmxlbmd0aCksYy5sZW5ndGg9Yy5hcmVhPTApO3IuZm9yRWFjaChlKX19ZnVuY3Rpb24gcihuLHQpe2Zvcih2YXIgZSxyPW4uYXJlYSx1PTAsaT0xLzAsbz0tMSxhPW4ubGVuZ3RoOysrbzxhOykoZT1uW29dLmFyZWEpJiYoaT5lJiYoaT1lKSxlPnUmJih1PWUpKTtyZXR1cm4gcio9cix0Kj10LHI/TWF0aC5tYXgodCp1KnAvcixyLyh0KmkqcCkpOjEvMH1mdW5jdGlvbiB1KG4sdCxlLHIpe3ZhciB1LGk9LTEsbz1uLmxlbmd0aCxhPWUueCxsPWUueSxzPXQ/YyhuLmFyZWEvdCk6MDtpZih0PT1lLmR4KXtmb3IoKHJ8fHM+ZS5keSkmJihzPWUuZHkpOysraTxvOyl1PW5baV0sdS54PWEsdS55PWwsdS5keT1zLGErPXUuZHg9TWF0aC5taW4oZS54K2UuZHgtYSxzP2ModS5hcmVhL3MpOjApO3Uuej0hMCx1LmR4Kz1lLngrZS5keC1hLGUueSs9cyxlLmR5LT1zfWVsc2V7Zm9yKChyfHxzPmUuZHgpJiYocz1lLmR4KTsrK2k8bzspdT1uW2ldLHUueD1hLHUueT1sLHUuZHg9cyxsKz11LmR5PU1hdGgubWluKGUueStlLmR5LWwscz9jKHUuYXJlYS9zKTowKTt1Lno9ITEsdS5keSs9ZS55K2UuZHktbCxlLngrPXMsZS5keC09c319ZnVuY3Rpb24gaShyKXt2YXIgdT1vfHxhKHIpLGk9dVswXTtyZXR1cm4gaS54PTAsaS55PTAsaS5keD1sWzBdLGkuZHk9bFsxXSxvJiZhLnJldmFsdWUoaSksbihbaV0saS5keCppLmR5L2kudmFsdWUpLChvP2U6dCkoaSksaCYmKG89dSksdX12YXIgbyxhPXRhLmxheW91dC5oaWVyYXJjaHkoKSxjPU1hdGgucm91bmQsbD1bMSwxXSxzPW51bGwsZj1SaSxoPSExLGc9InNxdWFyaWZ5IixwPS41KigxK01hdGguc3FydCg1KSk7cmV0dXJuIGkuc2l6ZT1mdW5jdGlvbihuKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obD1uLGkpOmx9LGkucGFkZGluZz1mdW5jdGlvbihuKXtmdW5jdGlvbiB0KHQpe3ZhciBlPW4uY2FsbChpLHQsdC5kZXB0aCk7cmV0dXJuIG51bGw9PWU/UmkodCk6RGkodCwibnVtYmVyIj09dHlwZW9mIGU/W2UsZSxlLGVdOmUpfWZ1bmN0aW9uIGUodCl7cmV0dXJuIERpKHQsbil9aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHM7dmFyIHI7cmV0dXJuIGY9bnVsbD09KHM9bik/Umk6ImZ1bmN0aW9uIj09KHI9dHlwZW9mIG4pP3Q6Im51bWJlciI9PT1yPyhuPVtuLG4sbixuXSxlKTplLGl9LGkucm91bmQ9ZnVuY3Rpb24obil7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGM9bj9NYXRoLnJvdW5kOk51bWJlcixpKTpjIT1OdW1iZXJ9LGkuc3RpY2t5PWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhoPW4sbz1udWxsLGkpOmgKfSxpLnJhdGlvPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhwPW4saSk6cH0saS5tb2RlPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhnPW4rIiIsaSk6Z30sR3UoaSxhKX0sdGEucmFuZG9tPXtub3JtYWw6ZnVuY3Rpb24obix0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoO3JldHVybiAyPmUmJih0PTEpLDE+ZSYmKG49MCksZnVuY3Rpb24oKXt2YXIgZSxyLHU7ZG8gZT0yKk1hdGgucmFuZG9tKCktMSxyPTIqTWF0aC5yYW5kb20oKS0xLHU9ZSplK3Iqcjt3aGlsZSghdXx8dT4xKTtyZXR1cm4gbit0KmUqTWF0aC5zcXJ0KC0yKk1hdGgubG9nKHUpL3UpfX0sbG9nTm9ybWFsOmZ1bmN0aW9uKCl7dmFyIG49dGEucmFuZG9tLm5vcm1hbC5hcHBseSh0YSxhcmd1bWVudHMpO3JldHVybiBmdW5jdGlvbigpe3JldHVybiBNYXRoLmV4cChuKCkpfX0sYmF0ZXM6ZnVuY3Rpb24obil7dmFyIHQ9dGEucmFuZG9tLmlyd2luSGFsbChuKTtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdCgpL259fSxpcndpbkhhbGw6ZnVuY3Rpb24obil7cmV0dXJuIGZ1bmN0aW9uKCl7Zm9yKHZhciB0PTAsZT0wO24+ZTtlKyspdCs9TWF0aC5yYW5kb20oKTtyZXR1cm4gdH19fSx0YS5zY2FsZT17fTt2YXIgYmw9e2Zsb29yOkV0LGNlaWw6RXR9O3RhLnNjYWxlLmxpbmVhcj1mdW5jdGlvbigpe3JldHVybiBZaShbMCwxXSxbMCwxXSxtdSwhMSl9O3ZhciBfbD17czoxLGc6MSxwOjEscjoxLGU6MX07dGEuc2NhbGUubG9nPWZ1bmN0aW9uKCl7cmV0dXJuIEppKHRhLnNjYWxlLmxpbmVhcigpLmRvbWFpbihbMCwxXSksMTAsITAsWzEsMTBdKX07dmFyIHdsPXRhLmZvcm1hdCgiLjBlIiksU2w9e2Zsb29yOmZ1bmN0aW9uKG4pe3JldHVybi1NYXRoLmNlaWwoLW4pfSxjZWlsOmZ1bmN0aW9uKG4pe3JldHVybi1NYXRoLmZsb29yKC1uKX19O3RhLnNjYWxlLnBvdz1mdW5jdGlvbigpe3JldHVybiBHaSh0YS5zY2FsZS5saW5lYXIoKSwxLFswLDFdKX0sdGEuc2NhbGUuc3FydD1mdW5jdGlvbigpe3JldHVybiB0YS5zY2FsZS5wb3coKS5leHBvbmVudCguNSl9LHRhLnNjYWxlLm9yZGluYWw9ZnVuY3Rpb24oKXtyZXR1cm4gUWkoW10se3Q6InJhbmdlIixhOltbXV19KX0sdGEuc2NhbGUuY2F0ZWdvcnkxMD1mdW5jdGlvbigpe3JldHVybiB0YS5zY2FsZS5vcmRpbmFsKCkucmFuZ2Uoa2wpfSx0YS5zY2FsZS5jYXRlZ29yeTIwPWZ1bmN0aW9uKCl7cmV0dXJuIHRhLnNjYWxlLm9yZGluYWwoKS5yYW5nZShFbCl9LHRhLnNjYWxlLmNhdGVnb3J5MjBiPWZ1bmN0aW9uKCl7cmV0dXJuIHRhLnNjYWxlLm9yZGluYWwoKS5yYW5nZShBbCl9LHRhLnNjYWxlLmNhdGVnb3J5MjBjPWZ1bmN0aW9uKCl7cmV0dXJuIHRhLnNjYWxlLm9yZGluYWwoKS5yYW5nZShObCl9O3ZhciBrbD1bMjA2MjI2MCwxNjc0NDIwNiwyOTI0NTg4LDE0MDM0NzI4LDk3MjU4ODUsOTE5NzEzMSwxNDkwNzMzMCw4MzU1NzExLDEyMzY5MTg2LDE1NTYxNzVdLm1hcCh5dCksRWw9WzIwNjIyNjAsMTE0NTQ0NDAsMTY3NDQyMDYsMTY3NTk2NzIsMjkyNDU4OCwxMDAxODY5OCwxNDAzNDcyOCwxNjc1MDc0Miw5NzI1ODg1LDEyOTU1ODYxLDkxOTcxMzEsMTI4ODUxNDAsMTQ5MDczMzAsMTYyMzQxOTQsODM1NTcxMSwxMzA5MjgwNywxMjM2OTE4NiwxNDQwODU4OSwxNTU2MTc1LDEwNDEwNzI1XS5tYXAoeXQpLEFsPVszNzUwNzc3LDUzOTU2MTksNzA0MDcxOSwxMDI2NDI4Niw2NTE5MDk3LDkyMTY1OTQsMTE5MTUxMTUsMTM1NTY2MzYsOTIwMjk5MywxMjQyNjgwOSwxNTE4NjUxNCwxNTE5MDkzMiw4NjY2MTY5LDExMzU2NDkwLDE0MDQ5NjQzLDE1MTc3MzcyLDgwNzc2ODMsMTA4MzQzMjQsMTM1Mjg1MDksMTQ1ODk2NTRdLm1hcCh5dCksTmw9WzMyNDQ3MzMsNzA1NzExMCwxMDQwNjYyNSwxMzAzMjQzMSwxNTA5NTA1MywxNjYxNjc2NCwxNjYyNTI1OSwxNjYzNDAxOCwzMjUzMDc2LDc2NTI0NzAsMTA2MDcwMDMsMTMxMDE1MDQsNzY5NTI4MSwxMDM5NDMxMiwxMjM2OTM3MiwxNDM0Mjg5MSw2NTEzNTA3LDk4Njg5NTAsMTI0MzQ4NzcsMTQyNzcwODFdLm1hcCh5dCk7dGEuc2NhbGUucXVhbnRpbGU9ZnVuY3Rpb24oKXtyZXR1cm4gbm8oW10sW10pfSx0YS5zY2FsZS5xdWFudGl6ZT1mdW5jdGlvbigpe3JldHVybiB0bygwLDEsWzAsMV0pfSx0YS5zY2FsZS50aHJlc2hvbGQ9ZnVuY3Rpb24oKXtyZXR1cm4gZW8oWy41XSxbMCwxXSl9LHRhLnNjYWxlLmlkZW50aXR5PWZ1bmN0aW9uKCl7cmV0dXJuIHJvKFswLDFdKX0sdGEuc3ZnPXt9LHRhLnN2Zy5hcmM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKCl7dmFyIG49TWF0aC5tYXgoMCwrZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpLGw9TWF0aC5tYXgoMCwrci5hcHBseSh0aGlzLGFyZ3VtZW50cykpLHM9by5hcHBseSh0aGlzLGFyZ3VtZW50cyktamEsZj1hLmFwcGx5KHRoaXMsYXJndW1lbnRzKS1qYSxoPU1hdGguYWJzKGYtcyksZz1zPmY/MDoxO2lmKG4+bCYmKHA9bCxsPW4sbj1wKSxoPj1VYSlyZXR1cm4gdChsLGcpKyhuP3QobiwxLWcpOiIiKSsiWiI7dmFyIHAsdixkLG0seSxNLHgsYixfLHcsUyxrLEU9MCxBPTAsTj1bXTtpZigobT0oK2MuYXBwbHkodGhpcyxhcmd1bWVudHMpfHwwKS8yKSYmKGQ9aT09PUNsP01hdGguc3FydChuKm4rbCpsKToraS5hcHBseSh0aGlzLGFyZ3VtZW50cyksZ3x8KEEqPS0xKSxsJiYoQT1udChkL2wqTWF0aC5zaW4obSkpKSxuJiYoRT1udChkL24qTWF0aC5zaW4obSkpKSksbCl7eT1sKk1hdGguY29zKHMrQSksTT1sKk1hdGguc2luKHMrQSkseD1sKk1hdGguY29zKGYtQSksYj1sKk1hdGguc2luKGYtQSk7dmFyIEM9TWF0aC5hYnMoZi1zLTIqQSk8PURhPzA6MTtpZihBJiZzbyh5LE0seCxiKT09PWdeQyl7dmFyIHo9KHMrZikvMjt5PWwqTWF0aC5jb3MoeiksTT1sKk1hdGguc2luKHopLHg9Yj1udWxsfX1lbHNlIHk9TT0wO2lmKG4pe189bipNYXRoLmNvcyhmLUUpLHc9bipNYXRoLnNpbihmLUUpLFM9bipNYXRoLmNvcyhzK0UpLGs9bipNYXRoLnNpbihzK0UpO3ZhciBxPU1hdGguYWJzKHMtZisyKkUpPD1EYT8wOjE7aWYoRSYmc28oXyx3LFMsayk9PT0xLWdecSl7dmFyIEw9KHMrZikvMjtfPW4qTWF0aC5jb3MoTCksdz1uKk1hdGguc2luKEwpLFM9az1udWxsfX1lbHNlIF89dz0wO2lmKChwPU1hdGgubWluKE1hdGguYWJzKGwtbikvMiwrdS5hcHBseSh0aGlzLGFyZ3VtZW50cykpKT4uMDAxKXt2PWw+bl5nPzA6MTt2YXIgVD1udWxsPT1TP1tfLHddOm51bGw9PXg/W3ksTV06THIoW3ksTV0sW1Msa10sW3gsYl0sW18sd10pLFI9eS1UWzBdLEQ9TS1UWzFdLFA9eC1UWzBdLFU9Yi1UWzFdLGo9MS9NYXRoLnNpbihNYXRoLmFjb3MoKFIqUCtEKlUpLyhNYXRoLnNxcnQoUipSK0QqRCkqTWF0aC5zcXJ0KFAqUCtVKlUpKSkvMiksRj1NYXRoLnNxcnQoVFswXSpUWzBdK1RbMV0qVFsxXSk7aWYobnVsbCE9eCl7dmFyIEg9TWF0aC5taW4ocCwobC1GKS8oaisxKSksTz1mbyhudWxsPT1TP1tfLHddOltTLGtdLFt5LE1dLGwsSCxnKSxZPWZvKFt4LGJdLFtfLHddLGwsSCxnKTtwPT09SD9OLnB1c2goIk0iLE9bMF0sIkEiLEgsIiwiLEgsIiAwIDAsIix2LCIgIixPWzFdLCJBIixsLCIsIixsLCIgMCAiLDEtZ15zbyhPWzFdWzBdLE9bMV1bMV0sWVsxXVswXSxZWzFdWzFdKSwiLCIsZywiICIsWVsxXSwiQSIsSCwiLCIsSCwiIDAgMCwiLHYsIiAiLFlbMF0pOk4ucHVzaCgiTSIsT1swXSwiQSIsSCwiLCIsSCwiIDAgMSwiLHYsIiAiLFlbMF0pfWVsc2UgTi5wdXNoKCJNIix5LCIsIixNKTtpZihudWxsIT1TKXt2YXIgST1NYXRoLm1pbihwLChuLUYpLyhqLTEpKSxaPWZvKFt5LE1dLFtTLGtdLG4sLUksZyksVj1mbyhbXyx3XSxudWxsPT14P1t5LE1dOlt4LGJdLG4sLUksZyk7cD09PUk/Ti5wdXNoKCJMIixWWzBdLCJBIixJLCIsIixJLCIgMCAwLCIsdiwiICIsVlsxXSwiQSIsbiwiLCIsbiwiIDAgIixnXnNvKFZbMV1bMF0sVlsxXVsxXSxaWzFdWzBdLFpbMV1bMV0pLCIsIiwxLWcsIiAiLFpbMV0sIkEiLEksIiwiLEksIiAwIDAsIix2LCIgIixaWzBdKTpOLnB1c2goIkwiLFZbMF0sIkEiLEksIiwiLEksIiAwIDAsIix2LCIgIixaWzBdKX1lbHNlIE4ucHVzaCgiTCIsXywiLCIsdyl9ZWxzZSBOLnB1c2goIk0iLHksIiwiLE0pLG51bGwhPXgmJk4ucHVzaCgiQSIsbCwiLCIsbCwiIDAgIixDLCIsIixnLCIgIix4LCIsIixiKSxOLnB1c2goIkwiLF8sIiwiLHcpLG51bGwhPVMmJk4ucHVzaCgiQSIsbiwiLCIsbiwiIDAgIixxLCIsIiwxLWcsIiAiLFMsIiwiLGspO3JldHVybiBOLnB1c2goIloiKSxOLmpvaW4oIiIpfWZ1bmN0aW9uIHQobix0KXtyZXR1cm4iTTAsIituKyJBIituKyIsIituKyIgMCAxLCIrdCsiIDAsIistbisiQSIrbisiLCIrbisiIDAgMSwiK3QrIiAwLCIrbn12YXIgZT1pbyxyPW9vLHU9dW8saT1DbCxvPWFvLGE9Y28sYz1sbztyZXR1cm4gbi5pbm5lclJhZGl1cz1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZT1rdCh0KSxuKTplfSxuLm91dGVyUmFkaXVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhyPWt0KHQpLG4pOnJ9LG4uY29ybmVyUmFkaXVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh1PWt0KHQpLG4pOnV9LG4ucGFkUmFkaXVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPXQ9PUNsP0NsOmt0KHQpLG4pOml9LG4uc3RhcnRBbmdsZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obz1rdCh0KSxuKTpvfSxuLmVuZEFuZ2xlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPWt0KHQpLG4pOmF9LG4ucGFkQW5nbGU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGM9a3QodCksbik6Y30sbi5jZW50cm9pZD1mdW5jdGlvbigpe3ZhciBuPSgrZS5hcHBseSh0aGlzLGFyZ3VtZW50cykrICtyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSkvMix0PSgrby5hcHBseSh0aGlzLGFyZ3VtZW50cykrICthLmFwcGx5KHRoaXMsYXJndW1lbnRzKSkvMi1qYTtyZXR1cm5bTWF0aC5jb3ModCkqbixNYXRoLnNpbih0KSpuXX0sbn07dmFyIENsPSJhdXRvIjt0YS5zdmcubGluZT1mdW5jdGlvbigpe3JldHVybiBobyhFdCl9O3ZhciB6bD10YS5tYXAoe2xpbmVhcjpnbywibGluZWFyLWNsb3NlZCI6cG8sc3RlcDp2bywic3RlcC1iZWZvcmUiOm1vLCJzdGVwLWFmdGVyIjp5byxiYXNpczpTbywiYmFzaXMtb3BlbiI6a28sImJhc2lzLWNsb3NlZCI6RW8sYnVuZGxlOkFvLGNhcmRpbmFsOmJvLCJjYXJkaW5hbC1vcGVuIjpNbywiY2FyZGluYWwtY2xvc2VkIjp4byxtb25vdG9uZTpUb30pO3psLmZvckVhY2goZnVuY3Rpb24obix0KXt0LmtleT1uLHQuY2xvc2VkPS8tY2xvc2VkJC8udGVzdChuKX0pO3ZhciBxbD1bMCwyLzMsMS8zLDBdLExsPVswLDEvMywyLzMsMF0sVGw9WzAsMS82LDIvMywxLzZdO3RhLnN2Zy5saW5lLnJhZGlhbD1mdW5jdGlvbigpe3ZhciBuPWhvKFJvKTtyZXR1cm4gbi5yYWRpdXM9bi54LGRlbGV0ZSBuLngsbi5hbmdsZT1uLnksZGVsZXRlIG4ueSxufSxtby5yZXZlcnNlPXlvLHlvLnJldmVyc2U9bW8sdGEuc3ZnLmFyZWE9ZnVuY3Rpb24oKXtyZXR1cm4gRG8oRXQpfSx0YS5zdmcuYXJlYS5yYWRpYWw9ZnVuY3Rpb24oKXt2YXIgbj1EbyhSbyk7cmV0dXJuIG4ucmFkaXVzPW4ueCxkZWxldGUgbi54LG4uaW5uZXJSYWRpdXM9bi54MCxkZWxldGUgbi54MCxuLm91dGVyUmFkaXVzPW4ueDEsZGVsZXRlIG4ueDEsbi5hbmdsZT1uLnksZGVsZXRlIG4ueSxuLnN0YXJ0QW5nbGU9bi55MCxkZWxldGUgbi55MCxuLmVuZEFuZ2xlPW4ueTEsZGVsZXRlIG4ueTEsbn0sdGEuc3ZnLmNob3JkPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihuLGEpe3ZhciBjPXQodGhpcyxpLG4sYSksbD10KHRoaXMsbyxuLGEpO3JldHVybiJNIitjLnAwK3IoYy5yLGMucDEsYy5hMS1jLmEwKSsoZShjLGwpP3UoYy5yLGMucDEsYy5yLGMucDApOnUoYy5yLGMucDEsbC5yLGwucDApK3IobC5yLGwucDEsbC5hMS1sLmEwKSt1KGwucixsLnAxLGMucixjLnAwKSkrIloifWZ1bmN0aW9uIHQobix0LGUscil7dmFyIHU9dC5jYWxsKG4sZSxyKSxpPWEuY2FsbChuLHUsciksbz1jLmNhbGwobix1LHIpLWphLHM9bC5jYWxsKG4sdSxyKS1qYTtyZXR1cm57cjppLGEwOm8sYTE6cyxwMDpbaSpNYXRoLmNvcyhvKSxpKk1hdGguc2luKG8pXSxwMTpbaSpNYXRoLmNvcyhzKSxpKk1hdGguc2luKHMpXX19ZnVuY3Rpb24gZShuLHQpe3JldHVybiBuLmEwPT10LmEwJiZuLmExPT10LmExfWZ1bmN0aW9uIHIobix0LGUpe3JldHVybiJBIituKyIsIituKyIgMCAiKyArKGU+RGEpKyIsMSAiK3R9ZnVuY3Rpb24gdShuLHQsZSxyKXtyZXR1cm4iUSAwLDAgIityfXZhciBpPW1yLG89eXIsYT1QbyxjPWFvLGw9Y287cmV0dXJuIG4ucmFkaXVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhhPWt0KHQpLG4pOmF9LG4uc291cmNlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhpPWt0KHQpLG4pOml9LG4udGFyZ2V0PWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhvPWt0KHQpLG4pOm99LG4uc3RhcnRBbmdsZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oYz1rdCh0KSxuKTpjfSxuLmVuZEFuZ2xlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhsPWt0KHQpLG4pOmx9LG59LHRhLnN2Zy5kaWFnb25hbD1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obix1KXt2YXIgaT10LmNhbGwodGhpcyxuLHUpLG89ZS5jYWxsKHRoaXMsbix1KSxhPShpLnkrby55KS8yLGM9W2kse3g6aS54LHk6YX0se3g6by54LHk6YX0sb107cmV0dXJuIGM9Yy5tYXAociksIk0iK2NbMF0rIkMiK2NbMV0rIiAiK2NbMl0rIiAiK2NbM119dmFyIHQ9bXIsZT15cixyPVVvO3JldHVybiBuLnNvdXJjZT1mdW5jdGlvbihlKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odD1rdChlKSxuKTp0fSxuLnRhcmdldD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZT1rdCh0KSxuKTplfSxuLnByb2plY3Rpb249ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9dCxuKTpyfSxufSx0YS5zdmcuZGlhZ29uYWwucmFkaWFsPWZ1bmN0aW9uKCl7dmFyIG49dGEuc3ZnLmRpYWdvbmFsKCksdD1VbyxlPW4ucHJvamVjdGlvbjtyZXR1cm4gbi5wcm9qZWN0aW9uPWZ1bmN0aW9uKG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoP2Uoam8odD1uKSk6dH0sbn0sdGEuc3ZnLnN5bWJvbD1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obixyKXtyZXR1cm4oUmwuZ2V0KHQuY2FsbCh0aGlzLG4scikpfHxPbykoZS5jYWxsKHRoaXMsbixyKSl9dmFyIHQ9SG8sZT1GbztyZXR1cm4gbi50eXBlPWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0PWt0KGUpLG4pOnR9LG4uc2l6ZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oZT1rdCh0KSxuKTplfSxufTt2YXIgUmw9dGEubWFwKHtjaXJjbGU6T28sY3Jvc3M6ZnVuY3Rpb24obil7dmFyIHQ9TWF0aC5zcXJ0KG4vNSkvMjtyZXR1cm4iTSIrLTMqdCsiLCIrLXQrIkgiKy10KyJWIistMyp0KyJIIit0KyJWIistdCsiSCIrMyp0KyJWIit0KyJIIit0KyJWIiszKnQrIkgiKy10KyJWIit0KyJIIistMyp0KyJaIn0sZGlhbW9uZDpmdW5jdGlvbihuKXt2YXIgdD1NYXRoLnNxcnQobi8oMipQbCkpLGU9dCpQbDtyZXR1cm4iTTAsIistdCsiTCIrZSsiLDAiKyIgMCwiK3QrIiAiKy1lKyIsMCIrIloifSxzcXVhcmU6ZnVuY3Rpb24obil7dmFyIHQ9TWF0aC5zcXJ0KG4pLzI7cmV0dXJuIk0iKy10KyIsIistdCsiTCIrdCsiLCIrLXQrIiAiK3QrIiwiK3QrIiAiKy10KyIsIit0KyJaIn0sInRyaWFuZ2xlLWRvd24iOmZ1bmN0aW9uKG4pe3ZhciB0PU1hdGguc3FydChuL0RsKSxlPXQqRGwvMjtyZXR1cm4iTTAsIitlKyJMIit0KyIsIistZSsiICIrLXQrIiwiKy1lKyJaIn0sInRyaWFuZ2xlLXVwIjpmdW5jdGlvbihuKXt2YXIgdD1NYXRoLnNxcnQobi9EbCksZT10KkRsLzI7cmV0dXJuIk0wLCIrLWUrIkwiK3QrIiwiK2UrIiAiKy10KyIsIitlKyJaIn19KTt0YS5zdmcuc3ltYm9sVHlwZXM9Umwua2V5cygpO3ZhciBEbD1NYXRoLnNxcnQoMyksUGw9TWF0aC50YW4oMzAqRmEpO2thLnRyYW5zaXRpb249ZnVuY3Rpb24obil7Zm9yKHZhciB0LGUscj1VbHx8KytPbCx1PVhvKG4pLGk9W10sbz1qbHx8e3RpbWU6RGF0ZS5ub3coKSxlYXNlOlN1LGRlbGF5OjAsZHVyYXRpb246MjUwfSxhPS0xLGM9dGhpcy5sZW5ndGg7KythPGM7KXtpLnB1c2godD1bXSk7Zm9yKHZhciBsPXRoaXNbYV0scz0tMSxmPWwubGVuZ3RoOysrczxmOykoZT1sW3NdKSYmJG8oZSxzLHUscixvKSx0LnB1c2goZSl9cmV0dXJuIElvKGksdSxyKX0sa2EuaW50ZXJydXB0PWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmVhY2gobnVsbD09bj9GbDpZbyhYbyhuKSkpfTt2YXIgVWwsamwsRmw9WW8oWG8oKSksSGw9W10sT2w9MDtIbC5jYWxsPWthLmNhbGwsSGwuZW1wdHk9a2EuZW1wdHksSGwubm9kZT1rYS5ub2RlLEhsLnNpemU9a2Euc2l6ZSx0YS50cmFuc2l0aW9uPWZ1bmN0aW9uKG4sdCl7cmV0dXJuIG4mJm4udHJhbnNpdGlvbj9VbD9uLnRyYW5zaXRpb24odCk6bjpOYS50cmFuc2l0aW9uKG4pfSx0YS50cmFuc2l0aW9uLnByb3RvdHlwZT1IbCxIbC5zZWxlY3Q9ZnVuY3Rpb24obil7dmFyIHQsZSxyLHU9dGhpcy5pZCxpPXRoaXMubmFtZXNwYWNlLG89W107bj1rKG4pO2Zvcih2YXIgYT0tMSxjPXRoaXMubGVuZ3RoOysrYTxjOyl7by5wdXNoKHQ9W10pO2Zvcih2YXIgbD10aGlzW2FdLHM9LTEsZj1sLmxlbmd0aDsrK3M8ZjspKHI9bFtzXSkmJihlPW4uY2FsbChyLHIuX19kYXRhX18scyxhKSk/KCJfX2RhdGFfXyJpbiByJiYoZS5fX2RhdGFfXz1yLl9fZGF0YV9fKSwkbyhlLHMsaSx1LHJbaV1bdV0pLHQucHVzaChlKSk6dC5wdXNoKG51bGwpfXJldHVybiBJbyhvLGksdSl9LEhsLnNlbGVjdEFsbD1mdW5jdGlvbihuKXt2YXIgdCxlLHIsdSxpLG89dGhpcy5pZCxhPXRoaXMubmFtZXNwYWNlLGM9W107bj1FKG4pO2Zvcih2YXIgbD0tMSxzPXRoaXMubGVuZ3RoOysrbDxzOylmb3IodmFyIGY9dGhpc1tsXSxoPS0xLGc9Zi5sZW5ndGg7KytoPGc7KWlmKHI9ZltoXSl7aT1yW2FdW29dLGU9bi5jYWxsKHIsci5fX2RhdGFfXyxoLGwpLGMucHVzaCh0PVtdKTtmb3IodmFyIHA9LTEsdj1lLmxlbmd0aDsrK3A8djspKHU9ZVtwXSkmJiRvKHUscCxhLG8saSksdC5wdXNoKHUpfXJldHVybiBJbyhjLGEsbyl9LEhsLmZpbHRlcj1mdW5jdGlvbihuKXt2YXIgdCxlLHIsdT1bXTsiZnVuY3Rpb24iIT10eXBlb2YgbiYmKG49aihuKSk7Zm9yKHZhciBpPTAsbz10aGlzLmxlbmd0aDtvPmk7aSsrKXt1LnB1c2godD1bXSk7Zm9yKHZhciBlPXRoaXNbaV0sYT0wLGM9ZS5sZW5ndGg7Yz5hO2ErKykocj1lW2FdKSYmbi5jYWxsKHIsci5fX2RhdGFfXyxhLGkpJiZ0LnB1c2gocil9cmV0dXJuIElvKHUsdGhpcy5uYW1lc3BhY2UsdGhpcy5pZCl9LEhsLnR3ZWVuPWZ1bmN0aW9uKG4sdCl7dmFyIGU9dGhpcy5pZCxyPXRoaXMubmFtZXNwYWNlO3JldHVybiBhcmd1bWVudHMubGVuZ3RoPDI/dGhpcy5ub2RlKClbcl1bZV0udHdlZW4uZ2V0KG4pOkgodGhpcyxudWxsPT10P2Z1bmN0aW9uKHQpe3Rbcl1bZV0udHdlZW4ucmVtb3ZlKG4pfTpmdW5jdGlvbih1KXt1W3JdW2VdLnR3ZWVuLnNldChuLHQpfSl9LEhsLmF0dHI9ZnVuY3Rpb24obix0KXtmdW5jdGlvbiBlKCl7dGhpcy5yZW1vdmVBdHRyaWJ1dGUoYSl9ZnVuY3Rpb24gcigpe3RoaXMucmVtb3ZlQXR0cmlidXRlTlMoYS5zcGFjZSxhLmxvY2FsKX1mdW5jdGlvbiB1KG4pe3JldHVybiBudWxsPT1uP2U6KG4rPSIiLGZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLmdldEF0dHJpYnV0ZShhKTtyZXR1cm4gZSE9PW4mJih0PW8oZSxuKSxmdW5jdGlvbihuKXt0aGlzLnNldEF0dHJpYnV0ZShhLHQobikpfSl9KX1mdW5jdGlvbiBpKG4pe3JldHVybiBudWxsPT1uP3I6KG4rPSIiLGZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLmdldEF0dHJpYnV0ZU5TKGEuc3BhY2UsYS5sb2NhbCk7cmV0dXJuIGUhPT1uJiYodD1vKGUsbiksZnVuY3Rpb24obil7dGhpcy5zZXRBdHRyaWJ1dGVOUyhhLnNwYWNlLGEubG9jYWwsdChuKSl9KX0pfWlmKGFyZ3VtZW50cy5sZW5ndGg8Mil7Zm9yKHQgaW4gbil0aGlzLmF0dHIodCxuW3RdKTtyZXR1cm4gdGhpc312YXIgbz0idHJhbnNmb3JtIj09bj9IdTptdSxhPXRhLm5zLnF1YWxpZnkobik7cmV0dXJuIFpvKHRoaXMsImF0dHIuIituLHQsYS5sb2NhbD9pOnUpfSxIbC5hdHRyVHdlZW49ZnVuY3Rpb24obix0KXtmdW5jdGlvbiBlKG4sZSl7dmFyIHI9dC5jYWxsKHRoaXMsbixlLHRoaXMuZ2V0QXR0cmlidXRlKHUpKTtyZXR1cm4gciYmZnVuY3Rpb24obil7dGhpcy5zZXRBdHRyaWJ1dGUodSxyKG4pKX19ZnVuY3Rpb24gcihuLGUpe3ZhciByPXQuY2FsbCh0aGlzLG4sZSx0aGlzLmdldEF0dHJpYnV0ZU5TKHUuc3BhY2UsdS5sb2NhbCkpO3JldHVybiByJiZmdW5jdGlvbihuKXt0aGlzLnNldEF0dHJpYnV0ZU5TKHUuc3BhY2UsdS5sb2NhbCxyKG4pKX19dmFyIHU9dGEubnMucXVhbGlmeShuKTtyZXR1cm4gdGhpcy50d2VlbigiYXR0ci4iK24sdS5sb2NhbD9yOmUpfSxIbC5zdHlsZT1mdW5jdGlvbihuLHQsZSl7ZnVuY3Rpb24gcigpe3RoaXMuc3R5bGUucmVtb3ZlUHJvcGVydHkobil9ZnVuY3Rpb24gdSh0KXtyZXR1cm4gbnVsbD09dD9yOih0Kz0iIixmdW5jdGlvbigpe3ZhciByLHU9b2EuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLG51bGwpLmdldFByb3BlcnR5VmFsdWUobik7cmV0dXJuIHUhPT10JiYocj1tdSh1LHQpLGZ1bmN0aW9uKHQpe3RoaXMuc3R5bGUuc2V0UHJvcGVydHkobixyKHQpLGUpfSl9KX12YXIgaT1hcmd1bWVudHMubGVuZ3RoO2lmKDM+aSl7aWYoInN0cmluZyIhPXR5cGVvZiBuKXsyPmkmJih0PSIiKTtmb3IoZSBpbiBuKXRoaXMuc3R5bGUoZSxuW2VdLHQpO3JldHVybiB0aGlzfWU9IiJ9cmV0dXJuIFpvKHRoaXMsInN0eWxlLiIrbix0LHUpfSxIbC5zdHlsZVR3ZWVuPWZ1bmN0aW9uKG4sdCxlKXtmdW5jdGlvbiByKHIsdSl7dmFyIGk9dC5jYWxsKHRoaXMscix1LG9hLmdldENvbXB1dGVkU3R5bGUodGhpcyxudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKG4pKTtyZXR1cm4gaSYmZnVuY3Rpb24odCl7dGhpcy5zdHlsZS5zZXRQcm9wZXJ0eShuLGkodCksZSl9fXJldHVybiBhcmd1bWVudHMubGVuZ3RoPDMmJihlPSIiKSx0aGlzLnR3ZWVuKCJzdHlsZS4iK24scil9LEhsLnRleHQ9ZnVuY3Rpb24obil7cmV0dXJuIFpvKHRoaXMsInRleHQiLG4sVm8pfSxIbC5yZW1vdmU9ZnVuY3Rpb24oKXt2YXIgbj10aGlzLm5hbWVzcGFjZTtyZXR1cm4gdGhpcy5lYWNoKCJlbmQudHJhbnNpdGlvbiIsZnVuY3Rpb24oKXt2YXIgdDt0aGlzW25dLmNvdW50PDImJih0PXRoaXMucGFyZW50Tm9kZSkmJnQucmVtb3ZlQ2hpbGQodGhpcyl9KX0sSGwuZWFzZT1mdW5jdGlvbihuKXt2YXIgdD10aGlzLmlkLGU9dGhpcy5uYW1lc3BhY2U7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg8MT90aGlzLm5vZGUoKVtlXVt0XS5lYXNlOigiZnVuY3Rpb24iIT10eXBlb2YgbiYmKG49dGEuZWFzZS5hcHBseSh0YSxhcmd1bWVudHMpKSxIKHRoaXMsZnVuY3Rpb24ocil7cltlXVt0XS5lYXNlPW59KSl9LEhsLmRlbGF5PWZ1bmN0aW9uKG4pe3ZhciB0PXRoaXMuaWQsZT10aGlzLm5hbWVzcGFjZTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwxP3RoaXMubm9kZSgpW2VdW3RdLmRlbGF5OkgodGhpcywiZnVuY3Rpb24iPT10eXBlb2Ygbj9mdW5jdGlvbihyLHUsaSl7cltlXVt0XS5kZWxheT0rbi5jYWxsKHIsci5fX2RhdGFfXyx1LGkpfToobj0rbixmdW5jdGlvbihyKXtyW2VdW3RdLmRlbGF5PW59KSl9LEhsLmR1cmF0aW9uPWZ1bmN0aW9uKG4pe3ZhciB0PXRoaXMuaWQsZT10aGlzLm5hbWVzcGFjZTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aDwxP3RoaXMubm9kZSgpW2VdW3RdLmR1cmF0aW9uOkgodGhpcywiZnVuY3Rpb24iPT10eXBlb2Ygbj9mdW5jdGlvbihyLHUsaSl7cltlXVt0XS5kdXJhdGlvbj1NYXRoLm1heCgxLG4uY2FsbChyLHIuX19kYXRhX18sdSxpKSl9OihuPU1hdGgubWF4KDEsbiksZnVuY3Rpb24ocil7cltlXVt0XS5kdXJhdGlvbj1ufSkpfSxIbC5lYWNoPWZ1bmN0aW9uKG4sdCl7dmFyIGU9dGhpcy5pZCxyPXRoaXMubmFtZXNwYWNlO2lmKGFyZ3VtZW50cy5sZW5ndGg8Mil7dmFyIHU9amwsaT1VbDt0cnl7VWw9ZSxIKHRoaXMsZnVuY3Rpb24odCx1LGkpe2psPXRbcl1bZV0sbi5jYWxsKHQsdC5fX2RhdGFfXyx1LGkpfSl9ZmluYWxseXtqbD11LFVsPWl9fWVsc2UgSCh0aGlzLGZ1bmN0aW9uKHUpe3ZhciBpPXVbcl1bZV07KGkuZXZlbnR8fChpLmV2ZW50PXRhLmRpc3BhdGNoKCJzdGFydCIsImVuZCIsImludGVycnVwdCIpKSkub24obix0KX0pO3JldHVybiB0aGlzfSxIbC50cmFuc2l0aW9uPWZ1bmN0aW9uKCl7Zm9yKHZhciBuLHQsZSxyLHU9dGhpcy5pZCxpPSsrT2wsbz10aGlzLm5hbWVzcGFjZSxhPVtdLGM9MCxsPXRoaXMubGVuZ3RoO2w+YztjKyspe2EucHVzaChuPVtdKTtmb3IodmFyIHQ9dGhpc1tjXSxzPTAsZj10Lmxlbmd0aDtmPnM7cysrKShlPXRbc10pJiYocj1lW29dW3VdLCRvKGUscyxvLGkse3RpbWU6ci50aW1lLGVhc2U6ci5lYXNlLGRlbGF5OnIuZGVsYXkrci5kdXJhdGlvbixkdXJhdGlvbjpyLmR1cmF0aW9ufSkpLG4ucHVzaChlKX1yZXR1cm4gSW8oYSxvLGkpfSx0YS5zdmcuYXhpcz1mdW5jdGlvbigpe2Z1bmN0aW9uIG4obil7bi5lYWNoKGZ1bmN0aW9uKCl7dmFyIG4sbD10YS5zZWxlY3QodGhpcykscz10aGlzLl9fY2hhcnRfX3x8ZSxmPXRoaXMuX19jaGFydF9fPWUuY29weSgpLGg9bnVsbD09Yz9mLnRpY2tzP2YudGlja3MuYXBwbHkoZixhKTpmLmRvbWFpbigpOmMsZz1udWxsPT10P2YudGlja0Zvcm1hdD9mLnRpY2tGb3JtYXQuYXBwbHkoZixhKTpFdDp0LHA9bC5zZWxlY3RBbGwoIi50aWNrIikuZGF0YShoLGYpLHY9cC5lbnRlcigpLmluc2VydCgiZyIsIi5kb21haW4iKS5hdHRyKCJjbGFzcyIsInRpY2siKS5zdHlsZSgib3BhY2l0eSIsVGEpLGQ9dGEudHJhbnNpdGlvbihwLmV4aXQoKSkuc3R5bGUoIm9wYWNpdHkiLFRhKS5yZW1vdmUoKSxtPXRhLnRyYW5zaXRpb24ocC5vcmRlcigpKS5zdHlsZSgib3BhY2l0eSIsMSkseT1NYXRoLm1heCh1LDApK28sTT1VaShmKSx4PWwuc2VsZWN0QWxsKCIuZG9tYWluIikuZGF0YShbMF0pLGI9KHguZW50ZXIoKS5hcHBlbmQoInBhdGgiKS5hdHRyKCJjbGFzcyIsImRvbWFpbiIpLHRhLnRyYW5zaXRpb24oeCkpO3YuYXBwZW5kKCJsaW5lIiksdi5hcHBlbmQoInRleHQiKTt2YXIgXyx3LFMsayxFPXYuc2VsZWN0KCJsaW5lIiksQT1tLnNlbGVjdCgibGluZSIpLE49cC5zZWxlY3QoInRleHQiKS50ZXh0KGcpLEM9di5zZWxlY3QoInRleHQiKSx6PW0uc2VsZWN0KCJ0ZXh0IikscT0idG9wIj09PXJ8fCJsZWZ0Ij09PXI/LTE6MTtpZigiYm90dG9tIj09PXJ8fCJ0b3AiPT09cj8obj1CbyxfPSJ4IixTPSJ5Iix3PSJ4MiIsaz0ieTIiLE4uYXR0cigiZHkiLDA+cT8iMGVtIjoiLjcxZW0iKS5zdHlsZSgidGV4dC1hbmNob3IiLCJtaWRkbGUiKSxiLmF0dHIoImQiLCJNIitNWzBdKyIsIitxKmkrIlYwSCIrTVsxXSsiViIrcSppKSk6KG49V28sXz0ieSIsUz0ieCIsdz0ieTIiLGs9IngyIixOLmF0dHIoImR5IiwiLjMyZW0iKS5zdHlsZSgidGV4dC1hbmNob3IiLDA+cT8iZW5kIjoic3RhcnQiKSxiLmF0dHIoImQiLCJNIitxKmkrIiwiK01bMF0rIkgwViIrTVsxXSsiSCIrcSppKSksRS5hdHRyKGsscSp1KSxDLmF0dHIoUyxxKnkpLEEuYXR0cih3LDApLmF0dHIoayxxKnUpLHouYXR0cihfLDApLmF0dHIoUyxxKnkpLGYucmFuZ2VCYW5kKXt2YXIgTD1mLFQ9TC5yYW5nZUJhbmQoKS8yO3M9Zj1mdW5jdGlvbihuKXtyZXR1cm4gTChuKStUfX1lbHNlIHMucmFuZ2VCYW5kP3M9ZjpkLmNhbGwobixmLHMpO3YuY2FsbChuLHMsZiksbS5jYWxsKG4sZixmKX0pfXZhciB0LGU9dGEuc2NhbGUubGluZWFyKCkscj1ZbCx1PTYsaT02LG89MyxhPVsxMF0sYz1udWxsO3JldHVybiBuLnNjYWxlPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhlPXQsbik6ZX0sbi5vcmllbnQ9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KHI9dCBpbiBJbD90KyIiOllsLG4pOnJ9LG4udGlja3M9ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oYT1hcmd1bWVudHMsbik6YX0sbi50aWNrVmFsdWVzPWZ1bmN0aW9uKHQpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyhjPXQsbik6Y30sbi50aWNrRm9ybWF0PWZ1bmN0aW9uKGUpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPyh0PWUsbik6dH0sbi50aWNrU2l6ZT1mdW5jdGlvbih0KXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoO3JldHVybiBlPyh1PSt0LGk9K2FyZ3VtZW50c1tlLTFdLG4pOnV9LG4uaW5uZXJUaWNrU2l6ZT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odT0rdCxuKTp1fSxuLm91dGVyVGlja1NpemU9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGk9K3Qsbik6aX0sbi50aWNrUGFkZGluZz1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obz0rdCxuKTpvfSxuLnRpY2tTdWJkaXZpZGU9ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCYmbn0sbn07dmFyIFlsPSJib3R0b20iLElsPXt0b3A6MSxyaWdodDoxLGJvdHRvbToxLGxlZnQ6MX07dGEuc3ZnLmJydXNoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gbihpKXtpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT10YS5zZWxlY3QodGhpcykuc3R5bGUoInBvaW50ZXItZXZlbnRzIiwiYWxsIikuc3R5bGUoIi13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvciIsInJnYmEoMCwwLDAsMCkiKS5vbigibW91c2Vkb3duLmJydXNoIix1KS5vbigidG91Y2hzdGFydC5icnVzaCIsdSksbz1pLnNlbGVjdEFsbCgiLmJhY2tncm91bmQiKS5kYXRhKFswXSk7by5lbnRlcigpLmFwcGVuZCgicmVjdCIpLmF0dHIoImNsYXNzIiwiYmFja2dyb3VuZCIpLnN0eWxlKCJ2aXNpYmlsaXR5IiwiaGlkZGVuIikuc3R5bGUoImN1cnNvciIsImNyb3NzaGFpciIpLGkuc2VsZWN0QWxsKCIuZXh0ZW50IikuZGF0YShbMF0pLmVudGVyKCkuYXBwZW5kKCJyZWN0IikuYXR0cigiY2xhc3MiLCJleHRlbnQiKS5zdHlsZSgiY3Vyc29yIiwibW92ZSIpO3ZhciBhPWkuc2VsZWN0QWxsKCIucmVzaXplIikuZGF0YShwLEV0KTthLmV4aXQoKS5yZW1vdmUoKSxhLmVudGVyKCkuYXBwZW5kKCJnIikuYXR0cigiY2xhc3MiLGZ1bmN0aW9uKG4pe3JldHVybiJyZXNpemUgIitufSkuc3R5bGUoImN1cnNvciIsZnVuY3Rpb24obil7cmV0dXJuIFpsW25dfSkuYXBwZW5kKCJyZWN0IikuYXR0cigieCIsZnVuY3Rpb24obil7cmV0dXJuL1tld10kLy50ZXN0KG4pPy0zOm51bGx9KS5hdHRyKCJ5IixmdW5jdGlvbihuKXtyZXR1cm4vXltuc10vLnRlc3Qobik/LTM6bnVsbH0pLmF0dHIoIndpZHRoIiw2KS5hdHRyKCJoZWlnaHQiLDYpLnN0eWxlKCJ2aXNpYmlsaXR5IiwiaGlkZGVuIiksYS5zdHlsZSgiZGlzcGxheSIsbi5lbXB0eSgpPyJub25lIjpudWxsKTt2YXIgcyxmPXRhLnRyYW5zaXRpb24oaSksaD10YS50cmFuc2l0aW9uKG8pO2MmJihzPVVpKGMpLGguYXR0cigieCIsc1swXSkuYXR0cigid2lkdGgiLHNbMV0tc1swXSksZShmKSksbCYmKHM9VWkobCksaC5hdHRyKCJ5IixzWzBdKS5hdHRyKCJoZWlnaHQiLHNbMV0tc1swXSkscihmKSksdChmKX0pfWZ1bmN0aW9uIHQobil7bi5zZWxlY3RBbGwoIi5yZXNpemUiKS5hdHRyKCJ0cmFuc2Zvcm0iLGZ1bmN0aW9uKG4pe3JldHVybiJ0cmFuc2xhdGUoIitzWysvZSQvLnRlc3QobildKyIsIitmWysvXnMvLnRlc3QobildKyIpIn0pfWZ1bmN0aW9uIGUobil7bi5zZWxlY3QoIi5leHRlbnQiKS5hdHRyKCJ4IixzWzBdKSxuLnNlbGVjdEFsbCgiLmV4dGVudCwubj5yZWN0LC5zPnJlY3QiKS5hdHRyKCJ3aWR0aCIsc1sxXS1zWzBdKX1mdW5jdGlvbiByKG4pe24uc2VsZWN0KCIuZXh0ZW50IikuYXR0cigieSIsZlswXSksbi5zZWxlY3RBbGwoIi5leHRlbnQsLmU+cmVjdCwudz5yZWN0IikuYXR0cigiaGVpZ2h0IixmWzFdLWZbMF0pfWZ1bmN0aW9uIHUoKXtmdW5jdGlvbiB1KCl7MzI9PXRhLmV2ZW50LmtleUNvZGUmJihOfHwoeT1udWxsLHpbMF0tPXNbMV0selsxXS09ZlsxXSxOPTIpLGIoKSl9ZnVuY3Rpb24gcCgpezMyPT10YS5ldmVudC5rZXlDb2RlJiYyPT1OJiYoelswXSs9c1sxXSx6WzFdKz1mWzFdLE49MCxiKCkpfWZ1bmN0aW9uIHYoKXt2YXIgbj10YS5tb3VzZSh4KSx1PSExO00mJihuWzBdKz1NWzBdLG5bMV0rPU1bMV0pLE58fCh0YS5ldmVudC5hbHRLZXk/KHl8fCh5PVsoc1swXStzWzFdKS8yLChmWzBdK2ZbMV0pLzJdKSx6WzBdPXNbKyhuWzBdPHlbMF0pXSx6WzFdPWZbKyhuWzFdPHlbMV0pXSk6eT1udWxsKSxFJiZkKG4sYywwKSYmKGUoUyksdT0hMCksQSYmZChuLGwsMSkmJihyKFMpLHU9ITApLHUmJih0KFMpLHcoe3R5cGU6ImJydXNoIixtb2RlOk4/Im1vdmUiOiJyZXNpemUifSkpfWZ1bmN0aW9uIGQobix0LGUpe3ZhciByLHUsYT1VaSh0KSxjPWFbMF0sbD1hWzFdLHA9eltlXSx2PWU/ZjpzLGQ9dlsxXS12WzBdO3JldHVybiBOJiYoYy09cCxsLT1kK3ApLHI9KGU/ZzpoKT9NYXRoLm1heChjLE1hdGgubWluKGwsbltlXSkpOm5bZV0sTj91PShyKz1wKStkOih5JiYocD1NYXRoLm1heChjLE1hdGgubWluKGwsMip5W2VdLXIpKSkscj5wPyh1PXIscj1wKTp1PXApLHZbMF0hPXJ8fHZbMV0hPXU/KGU/bz1udWxsOmk9bnVsbCx2WzBdPXIsdlsxXT11LCEwKTp2b2lkIDB9ZnVuY3Rpb24gbSgpe3YoKSxTLnN0eWxlKCJwb2ludGVyLWV2ZW50cyIsImFsbCIpLnNlbGVjdEFsbCgiLnJlc2l6ZSIpLnN0eWxlKCJkaXNwbGF5IixuLmVtcHR5KCk/Im5vbmUiOm51bGwpLHRhLnNlbGVjdCgiYm9keSIpLnN0eWxlKCJjdXJzb3IiLG51bGwpLHEub24oIm1vdXNlbW92ZS5icnVzaCIsbnVsbCkub24oIm1vdXNldXAuYnJ1c2giLG51bGwpLm9uKCJ0b3VjaG1vdmUuYnJ1c2giLG51bGwpLm9uKCJ0b3VjaGVuZC5icnVzaCIsbnVsbCkub24oImtleWRvd24uYnJ1c2giLG51bGwpLm9uKCJrZXl1cC5icnVzaCIsbnVsbCksQygpLHcoe3R5cGU6ImJydXNoZW5kIn0pfXZhciB5LE0seD10aGlzLF89dGEuc2VsZWN0KHRhLmV2ZW50LnRhcmdldCksdz1hLm9mKHgsYXJndW1lbnRzKSxTPXRhLnNlbGVjdCh4KSxrPV8uZGF0dW0oKSxFPSEvXihufHMpJC8udGVzdChrKSYmYyxBPSEvXihlfHcpJC8udGVzdChrKSYmbCxOPV8uY2xhc3NlZCgiZXh0ZW50IiksQz1YKCksej10YS5tb3VzZSh4KSxxPXRhLnNlbGVjdChvYSkub24oImtleWRvd24uYnJ1c2giLHUpLm9uKCJrZXl1cC5icnVzaCIscCk7aWYodGEuZXZlbnQuY2hhbmdlZFRvdWNoZXM/cS5vbigidG91Y2htb3ZlLmJydXNoIix2KS5vbigidG91Y2hlbmQuYnJ1c2giLG0pOnEub24oIm1vdXNlbW92ZS5icnVzaCIsdikub24oIm1vdXNldXAuYnJ1c2giLG0pLFMuaW50ZXJydXB0KCkuc2VsZWN0QWxsKCIqIikuaW50ZXJydXB0KCksTil6WzBdPXNbMF0telswXSx6WzFdPWZbMF0telsxXTtlbHNlIGlmKGspe3ZhciBMPSsvdyQvLnRlc3QoayksVD0rL15uLy50ZXN0KGspO009W3NbMS1MXS16WzBdLGZbMS1UXS16WzFdXSx6WzBdPXNbTF0selsxXT1mW1RdfWVsc2UgdGEuZXZlbnQuYWx0S2V5JiYoeT16LnNsaWNlKCkpO1Muc3R5bGUoInBvaW50ZXItZXZlbnRzIiwibm9uZSIpLnNlbGVjdEFsbCgiLnJlc2l6ZSIpLnN0eWxlKCJkaXNwbGF5IixudWxsKSx0YS5zZWxlY3QoImJvZHkiKS5zdHlsZSgiY3Vyc29yIixfLnN0eWxlKCJjdXJzb3IiKSksdyh7dHlwZToiYnJ1c2hzdGFydCJ9KSx2KCl9dmFyIGksbyxhPXcobiwiYnJ1c2hzdGFydCIsImJydXNoIiwiYnJ1c2hlbmQiKSxjPW51bGwsbD1udWxsLHM9WzAsMF0sZj1bMCwwXSxoPSEwLGc9ITAscD1WbFswXTtyZXR1cm4gbi5ldmVudD1mdW5jdGlvbihuKXtuLmVhY2goZnVuY3Rpb24oKXt2YXIgbj1hLm9mKHRoaXMsYXJndW1lbnRzKSx0PXt4OnMseTpmLGk6aSxqOm99LGU9dGhpcy5fX2NoYXJ0X198fHQ7dGhpcy5fX2NoYXJ0X189dCxVbD90YS5zZWxlY3QodGhpcykudHJhbnNpdGlvbigpLmVhY2goInN0YXJ0LmJydXNoIixmdW5jdGlvbigpe2k9ZS5pLG89ZS5qLHM9ZS54LGY9ZS55LG4oe3R5cGU6ImJydXNoc3RhcnQifSl9KS50d2VlbigiYnJ1c2g6YnJ1c2giLGZ1bmN0aW9uKCl7dmFyIGU9eXUocyx0LngpLHI9eXUoZix0LnkpO3JldHVybiBpPW89bnVsbCxmdW5jdGlvbih1KXtzPXQueD1lKHUpLGY9dC55PXIodSksbih7dHlwZToiYnJ1c2giLG1vZGU6InJlc2l6ZSJ9KX19KS5lYWNoKCJlbmQuYnJ1c2giLGZ1bmN0aW9uKCl7aT10Lmksbz10Lmosbih7dHlwZToiYnJ1c2giLG1vZGU6InJlc2l6ZSJ9KSxuKHt0eXBlOiJicnVzaGVuZCJ9KX0pOihuKHt0eXBlOiJicnVzaHN0YXJ0In0pLG4oe3R5cGU6ImJydXNoIixtb2RlOiJyZXNpemUifSksbih7dHlwZToiYnJ1c2hlbmQifSkpfSl9LG4ueD1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oYz10LHA9VmxbIWM8PDF8IWxdLG4pOmN9LG4ueT1mdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8obD10LHA9VmxbIWM8PDF8IWxdLG4pOmx9LG4uY2xhbXA9ZnVuY3Rpb24odCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGMmJmw/KGg9ISF0WzBdLGc9ISF0WzFdKTpjP2g9ISF0OmwmJihnPSEhdCksbik6YyYmbD9baCxnXTpjP2g6bD9nOm51bGx9LG4uZXh0ZW50PWZ1bmN0aW9uKHQpe3ZhciBlLHIsdSxhLGg7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGMmJihlPXRbMF0scj10WzFdLGwmJihlPWVbMF0scj1yWzBdKSxpPVtlLHJdLGMuaW52ZXJ0JiYoZT1jKGUpLHI9YyhyKSksZT5yJiYoaD1lLGU9cixyPWgpLChlIT1zWzBdfHxyIT1zWzFdKSYmKHM9W2Uscl0pKSxsJiYodT10WzBdLGE9dFsxXSxjJiYodT11WzFdLGE9YVsxXSksbz1bdSxhXSxsLmludmVydCYmKHU9bCh1KSxhPWwoYSkpLHU+YSYmKGg9dSx1PWEsYT1oKSwodSE9ZlswXXx8YSE9ZlsxXSkmJihmPVt1LGFdKSksbik6KGMmJihpPyhlPWlbMF0scj1pWzFdKTooZT1zWzBdLHI9c1sxXSxjLmludmVydCYmKGU9Yy5pbnZlcnQoZSkscj1jLmludmVydChyKSksZT5yJiYoaD1lLGU9cixyPWgpKSksbCYmKG8/KHU9b1swXSxhPW9bMV0pOih1PWZbMF0sYT1mWzFdLGwuaW52ZXJ0JiYodT1sLmludmVydCh1KSxhPWwuaW52ZXJ0KGEpKSx1PmEmJihoPXUsdT1hLGE9aCkpKSxjJiZsP1tbZSx1XSxbcixhXV06Yz9bZSxyXTpsJiZbdSxhXSl9LG4uY2xlYXI9ZnVuY3Rpb24oKXtyZXR1cm4gbi5lbXB0eSgpfHwocz1bMCwwXSxmPVswLDBdLGk9bz1udWxsKSxufSxuLmVtcHR5PWZ1bmN0aW9uKCl7cmV0dXJuISFjJiZzWzBdPT1zWzFdfHwhIWwmJmZbMF09PWZbMV19LHRhLnJlYmluZChuLGEsIm9uIil9O3ZhciBabD17bjoibnMtcmVzaXplIixlOiJldy1yZXNpemUiLHM6Im5zLXJlc2l6ZSIsdzoiZXctcmVzaXplIixudzoibndzZS1yZXNpemUiLG5lOiJuZXN3LXJlc2l6ZSIsc2U6Im53c2UtcmVzaXplIixzdzoibmVzdy1yZXNpemUifSxWbD1bWyJuIiwiZSIsInMiLCJ3IiwibnciLCJuZSIsInNlIiwic3ciXSxbImUiLCJ3Il0sWyJuIiwicyJdLFtdXSxYbD1mYy5mb3JtYXQ9bWMudGltZUZvcm1hdCwkbD1YbC51dGMsQmw9JGwoIiVZLSVtLSVkVCVIOiVNOiVTLiVMWiIpO1hsLmlzbz1EYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyYmK25ldyBEYXRlKCIyMDAwLTAxLTAxVDAwOjAwOjAwLjAwMFoiKT9KbzpCbCxKby5wYXJzZT1mdW5jdGlvbihuKXt2YXIgdD1uZXcgRGF0ZShuKTtyZXR1cm4gaXNOYU4odCk/bnVsbDp0fSxKby50b1N0cmluZz1CbC50b1N0cmluZyxmYy5zZWNvbmQ9RnQoZnVuY3Rpb24obil7cmV0dXJuIG5ldyBoYygxZTMqTWF0aC5mbG9vcihuLzFlMykpfSxmdW5jdGlvbihuLHQpe24uc2V0VGltZShuLmdldFRpbWUoKSsxZTMqTWF0aC5mbG9vcih0KSl9LGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldFNlY29uZHMoKX0pLGZjLnNlY29uZHM9ZmMuc2Vjb25kLnJhbmdlLGZjLnNlY29uZHMudXRjPWZjLnNlY29uZC51dGMucmFuZ2UsZmMubWludXRlPUZ0KGZ1bmN0aW9uKG4pe3JldHVybiBuZXcgaGMoNmU0Kk1hdGguZmxvb3Iobi82ZTQpKX0sZnVuY3Rpb24obix0KXtuLnNldFRpbWUobi5nZXRUaW1lKCkrNmU0Kk1hdGguZmxvb3IodCkpfSxmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRNaW51dGVzKCl9KSxmYy5taW51dGVzPWZjLm1pbnV0ZS5yYW5nZSxmYy5taW51dGVzLnV0Yz1mYy5taW51dGUudXRjLnJhbmdlLGZjLmhvdXI9RnQoZnVuY3Rpb24obil7dmFyIHQ9bi5nZXRUaW1lem9uZU9mZnNldCgpLzYwO3JldHVybiBuZXcgaGMoMzZlNSooTWF0aC5mbG9vcihuLzM2ZTUtdCkrdCkpfSxmdW5jdGlvbihuLHQpe24uc2V0VGltZShuLmdldFRpbWUoKSszNmU1Kk1hdGguZmxvb3IodCkpfSxmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRIb3VycygpfSksZmMuaG91cnM9ZmMuaG91ci5yYW5nZSxmYy5ob3Vycy51dGM9ZmMuaG91ci51dGMucmFuZ2UsZmMubW9udGg9RnQoZnVuY3Rpb24obil7cmV0dXJuIG49ZmMuZGF5KG4pLG4uc2V0RGF0ZSgxKSxufSxmdW5jdGlvbihuLHQpe24uc2V0TW9udGgobi5nZXRNb250aCgpK3QpfSxmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRNb250aCgpfSksZmMubW9udGhzPWZjLm1vbnRoLnJhbmdlLGZjLm1vbnRocy51dGM9ZmMubW9udGgudXRjLnJhbmdlO3ZhciBXbD1bMWUzLDVlMywxNWUzLDNlNCw2ZTQsM2U1LDllNSwxOGU1LDM2ZTUsMTA4ZTUsMjE2ZTUsNDMyZTUsODY0ZTUsMTcyOGU1LDYwNDhlNSwyNTkyZTYsNzc3NmU2LDMxNTM2ZTZdLEpsPVtbZmMuc2Vjb25kLDFdLFtmYy5zZWNvbmQsNV0sW2ZjLnNlY29uZCwxNV0sW2ZjLnNlY29uZCwzMF0sW2ZjLm1pbnV0ZSwxXSxbZmMubWludXRlLDVdLFtmYy5taW51dGUsMTVdLFtmYy5taW51dGUsMzBdLFtmYy5ob3VyLDFdLFtmYy5ob3VyLDNdLFtmYy5ob3VyLDZdLFtmYy5ob3VyLDEyXSxbZmMuZGF5LDFdLFtmYy5kYXksMl0sW2ZjLndlZWssMV0sW2ZjLm1vbnRoLDFdLFtmYy5tb250aCwzXSxbZmMueWVhciwxXV0sR2w9WGwubXVsdGkoW1siLiVMIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRNaWxsaXNlY29uZHMoKX1dLFsiOiVTIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRTZWNvbmRzKCl9XSxbIiVJOiVNIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRNaW51dGVzKCl9XSxbIiVJICVwIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRIb3VycygpfV0sWyIlYSAlZCIsZnVuY3Rpb24obil7cmV0dXJuIG4uZ2V0RGF5KCkmJjEhPW4uZ2V0RGF0ZSgpfV0sWyIlYiAlZCIsZnVuY3Rpb24obil7cmV0dXJuIDEhPW4uZ2V0RGF0ZSgpfV0sWyIlQiIsZnVuY3Rpb24obil7cmV0dXJuIG4uZ2V0TW9udGgoKX1dLFsiJVkiLE5lXV0pLEtsPXtyYW5nZTpmdW5jdGlvbihuLHQsZSl7cmV0dXJuIHRhLnJhbmdlKE1hdGguY2VpbChuL2UpKmUsK3QsZSkubWFwKEtvKX0sZmxvb3I6RXQsY2VpbDpFdH07SmwueWVhcj1mYy55ZWFyLGZjLnNjYWxlPWZ1bmN0aW9uKCl7cmV0dXJuIEdvKHRhLnNjYWxlLmxpbmVhcigpLEpsLEdsKX07dmFyIFFsPUpsLm1hcChmdW5jdGlvbihuKXtyZXR1cm5bblswXS51dGMsblsxXV19KSxucz0kbC5tdWx0aShbWyIuJUwiLGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldFVUQ01pbGxpc2Vjb25kcygpfV0sWyI6JVMiLGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldFVUQ1NlY29uZHMoKX1dLFsiJUk6JU0iLGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldFVUQ01pbnV0ZXMoKX1dLFsiJUkgJXAiLGZ1bmN0aW9uKG4pe3JldHVybiBuLmdldFVUQ0hvdXJzKCl9XSxbIiVhICVkIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRVVENEYXkoKSYmMSE9bi5nZXRVVENEYXRlKCl9XSxbIiViICVkIixmdW5jdGlvbihuKXtyZXR1cm4gMSE9bi5nZXRVVENEYXRlKCl9XSxbIiVCIixmdW5jdGlvbihuKXtyZXR1cm4gbi5nZXRVVENNb250aCgpfV0sWyIlWSIsTmVdXSk7UWwueWVhcj1mYy55ZWFyLnV0YyxmYy5zY2FsZS51dGM9ZnVuY3Rpb24oKXtyZXR1cm4gR28odGEuc2NhbGUubGluZWFyKCksUWwsbnMpfSx0YS50ZXh0PUF0KGZ1bmN0aW9uKG4pe3JldHVybiBuLnJlc3BvbnNlVGV4dH0pLHRhLmpzb249ZnVuY3Rpb24obix0KXtyZXR1cm4gTnQobiwiYXBwbGljYXRpb24vanNvbiIsUW8sdCl9LHRhLmh0bWw9ZnVuY3Rpb24obix0KXtyZXR1cm4gTnQobiwidGV4dC9odG1sIixuYSx0KX0sdGEueG1sPUF0KGZ1bmN0aW9uKG4pe3JldHVybiBuLnJlc3BvbnNlWE1MfSksImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUodGEpOiJvYmplY3QiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cyYmKG1vZHVsZS5leHBvcnRzPXRhKSx0aGlzLmQzPXRhfSgpOw=="></script>
<link href="data:text/css;charset=utf-8,body%2Etheme%2Ddark%20%7B%0Abackground%2Dcolor%3A%20%23333%20%21important%3B%0A%7D%0A%2Elink%20%7B%0Afill%3A%20none%3B%0A%7D%0A%2Etheme%2Ddark%20%2Elink%20%7B%0A%7D%0A%2Ed3heatmap%20%7B%0Aposition%3A%20relative%3B%0Awidth%3A%20820px%3B%0Aheight%3A%20700px%3B%0Aoverflow%3A%20hidden%3B%0A%7D%0A%2Ed3heatmap%20%2Edomain%20%7B%0Afill%3A%20none%3B%0Astroke%3A%20none%3B%0A%7D%0A%2Ed3heatmap%20%2Eaxis%20%7B%0Aoverflow%3A%20hidden%3B%0A%7D%0A%2Ed3heatmap%20%2Eaxis%20line%20%7B%0Afill%3A%20none%3B%0Astroke%3A%20%23AAA%3B%0Astroke%2Dwidth%3A%201px%3B%0Ashape%2Drendering%3A%20crispEdges%3B%0A%7D%0A%2Ed3heatmap%20%2Eaxis%20text%2C%20%2Ed3heatmap%2Dtip%20%7B%0Afont%2Dsize%3A%2015px%3B%0Afont%2Dfamily%3A%20Ubuntu%20Sans%2C%20Segoe%20UI%2C%20Lucida%20Grande%2C%20sans%2Dserif%3B%0A%7D%0A%2Ed3heatmap%20%2Eaxis%20rect%20%7B%0Acursor%3A%20pointer%3B%0A%7D%0A%2Einner%20%7B%0Aposition%3A%20relative%3B%0A%7D%0A%2Einfo%20%7B%0Aposition%3A%20absolute%3B%0Aleft%3A%2020px%3B%0Atop%3A%2090px%3B%0Awidth%3A%20160px%3B%0Aheight%3A%20140px%3B%0Atext%2Dalign%3A%20right%3B%0Afont%2Dsize%3A%2040px%3B%0Apadding%2Dtop%3A%20118px%3B%0A%7D%0A%2Ed3heatmap%20text%20%7B%0Acursor%3A%20default%3B%0A%7D%0A%2Ed3heatmap%20%2Ebrush%20%2Eextent%7B%0Afill%2Dopacity%3A%200%2E15%3B%0Astroke%2Dwidth%3A%201px%3B%0A%7D%0A%2EcolDend%20%7B%0Aposition%3A%20absolute%3B%0Aoverflow%3A%20hidden%3B%0A%7D%0A%2ErowDend%20%7B%0Aposition%3A%20absolute%3B%0Aoverflow%3A%20hidden%3B%0A%7D%0A%2Ecolormap%20%7B%0Aposition%3A%20absolute%3B%0Aoverflow%3A%20hidden%3B%0A%7D%0A%2Etheme%2Ddark%20text%20%7B%0Afill%3A%20%23E2E2E2%3B%0A%7D%0A%2Ehighlighting%20%2Ecolormap%20%2Edatapt%20%7B%0Aopacity%3A%200%2E2%3B%0A%7D%0A%2Ehighlighting%20%2Ecolormap%20%2Edatapt%2Ehighlight%20%7B%0Aopacity%3A%201%3B%0A%7D%0A%2Ehighlighting%20%2Eaxis%20g%2Etick%2Efaded%20%7B%0Aopacity%3A%200%2E4%20%21important%3B%0A%7D%0A%2Ed3heatmap%2Dtip%20%7B%0Afont%2Dsize%3A%2013px%3B%0Acolor%3A%20white%3B%0Abackground%2Dcolor%3A%20%23444%3B%0Apadding%3A%206px%2012px%3B%0Abox%2Dshadow%3A%203px%203px%205px%200px%20rgba%280%2C%200%2C%200%2C%200%2E22%29%3B%0A%7D%0A%2Etheme%2Ddark%20%2Ed3heatmap%2Dtip%20%7B%0Abackground%2Dcolor%3A%20white%3B%0Acolor%3A%20%23444%3B%0A%7D%0A%2Ed3heatmap%2Dtip%20table%20%7B%0Aborder%2Dcollapse%3A%20separate%3B%0Aborder%2Dspacing%3A%202px%3B%0A%7D%0A%2Ed3heatmap%2Dtip%20th%2C%20%2Ed3heatmap%2Dtip%20td%20%7B%0Apadding%3A%200%201px%3B%0A%7D%0A" rel="stylesheet" />
<script src="data:application/x-javascript;base64,ZnVuY3Rpb24gaGVhdG1hcChzZWxlY3RvciwgZGF0YSwgb3B0aW9ucykgewoKICAvLyA9PT09IEJFR0lOIEhFTFBFUlMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgCiAgZnVuY3Rpb24gaHRtbEVzY2FwZShzdHIpIHsKICAgIHJldHVybiAoc3RyKyIiKS5yZXBsYWNlKC8mL2csICImYW1wOyIpLnJlcGxhY2UoLzwvZywgIiZsdDsiKS5yZXBsYWNlKC8+L2csICImZ3Q7Iik7CiAgfQogIAogIC8vIEdpdmVuIGEgbGlzdCBvZiB3aWR0aHMvaGVpZ2h0cyBhbmQgYSB0b3RhbCB3aWR0aC9oZWlnaHQsIHByb3ZpZGVzCiAgLy8gZWFzeSBhY2Nlc3MgdG8gdGhlIGFic29sdXRlIHRvcC9sZWZ0L3dpZHRoL2hlaWdodCBvZiBhbnkgaW5kaXZpZHVhbAogIC8vIGdyaWQgY2VsbC4gT3B0aW9uYWxseSwgYSBzaW5nbGUgY2VsbCBjYW4gYmUgc3BlY2lmaWVkIGFzIGEgImZpbGwiCiAgLy8gY2VsbCwgbWVhbmluZyBpdCB3aWxsIHRha2UgdXAgYW55IHJlbWFpbmluZyB3aWR0aC9oZWlnaHQuCiAgLy8gCiAgLy8gcm93cyBhbmQgY29scyBhcmUgYXJyYXlzIHRoYXQgY29udGFpbiBudW1lcmljIHBpeGVsIGRpbWVuc2lvbnMsCiAgLy8gYW5kIHVwIHRvIG9uZSAiKiIgdmFsdWUuCiAgZnVuY3Rpb24gR3JpZFNpemVyKHdpZHRocywgaGVpZ2h0cywgLypvcHRpb25hbCovIHRvdGFsV2lkdGgsIC8qb3B0aW9uYWwqLyB0b3RhbEhlaWdodCkgewogICAgdGhpcy53aWR0aHMgPSB3aWR0aHM7CiAgICB0aGlzLmhlaWdodHMgPSBoZWlnaHRzOwogIAogICAgdmFyIGZpbGxDb2xJbmRleCA9IG51bGw7CiAgICB2YXIgZmlsbFJvd0luZGV4ID0gbnVsbDsKICAgIHZhciB1c2VkV2lkdGggPSAwOwogICAgdmFyIHVzZWRIZWlnaHQgPSAwOwogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgd2lkdGhzLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmICh3aWR0aHNbaV0gPT09ICIqIikgewogICAgICAgIGlmIChmaWxsQ29sSW5kZXggIT09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiT25seSBvbmUgY29sdW1uIGNhbiBiZSBkZXNpZ25hdGVkIGFzIGZpbGwiKTsKICAgICAgICB9CiAgICAgICAgZmlsbENvbEluZGV4ID0gaTsKICAgICAgfSBlbHNlIHsKICAgICAgICB1c2VkV2lkdGggKz0gd2lkdGhzW2ldOwogICAgICB9CiAgICB9CiAgICBpZiAoZmlsbENvbEluZGV4ICE9PSBudWxsKSB7CiAgICAgIHdpZHRoc1tmaWxsQ29sSW5kZXhdID0gdG90YWxXaWR0aCAtIHVzZWRXaWR0aDsKICAgIH0gZWxzZSB7CiAgICAgIGlmICh0eXBlb2YodG90YWxXaWR0aCkgPT09ICJudW1iZXIiICYmIHRvdGFsV2lkdGggIT09IHVzZWRXaWR0aCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigiQ29sdW1uIHdpZHRocyBkb24ndCBhZGQgdXAgdG8gdG90YWwgd2lkdGgiKTsKICAgICAgfQogICAgfQogICAgZm9yIChpID0gMDsgaSA8IGhlaWdodHMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGhlaWdodHNbaV0gPT09ICIqIikgewogICAgICAgIGlmIChmaWxsUm93SW5kZXggIT09IG51bGwpIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiT25seSBvbmUgcm93IGNhbiBiZSBkZXNpZ25hdGVkIGFzIGZpbGwiKTsKICAgICAgICB9CiAgICAgICAgZmlsbFJvd0luZGV4ID0gaTsKICAgICAgfSBlbHNlIHsKICAgICAgICB1c2VkSGVpZ2h0ICs9IGhlaWdodHNbaV07CiAgICAgIH0KICAgIH0KICAgIGlmIChmaWxsUm93SW5kZXggIT09IG51bGwpIHsKICAgICAgaGVpZ2h0c1tmaWxsUm93SW5kZXhdID0gdG90YWxIZWlnaHQgLSB1c2VkSGVpZ2h0OwogICAgfSBlbHNlIHsKICAgICAgaWYgKHR5cGVvZih0b3RhbEhlaWdodCkgPT09ICJudW1iZXIiICYmIHRvdGFsSGVpZ2h0ICE9PSB1c2VkSGVpZ2h0KSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDb2x1bW4gaGVpZ2h0cyBkb24ndCBhZGQgdXAgdG8gdG90YWwgaGVpZ2h0Iik7CiAgICAgIH0KICAgIH0KICB9CiAgCiAgR3JpZFNpemVyLnByb3RvdHlwZS5nZXRDZWxsQm91bmRzID0gZnVuY3Rpb24oeCwgeSkgewogICAgaWYgKHggPCAwIHx8IHggPj0gdGhpcy53aWR0aHMubGVuZ3RoIHx8IHkgPCAwIHx8IHkgPj0gdGhpcy5oZWlnaHRzLmxlbmd0aCkKICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGNlbGwgYm91bmRzIik7CiAgCiAgICB2YXIgbGVmdCA9IDA7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHg7IGkrKykgewogICAgICBsZWZ0ICs9IHRoaXMud2lkdGhzW2ldOwogICAgfQogIAogICAgdmFyIHRvcCA9IDA7CiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHk7IGorKykgewogICAgICB0b3AgKz0gdGhpcy5oZWlnaHRzW2pdOwogICAgfQogIAogICAgcmV0dXJuIHsKICAgICAgd2lkdGg6IHRoaXMud2lkdGhzW3hdLAogICAgICBoZWlnaHQ6IHRoaXMuaGVpZ2h0c1t5XSwKICAgICAgdG9wOiB0b3AsCiAgICAgIGxlZnQ6IGxlZnQKICAgIH0KICB9CiAgCiAgLy8gPT09PSBFTkQgSEVMUEVSUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKCiAgdmFyIGVsID0gZDMuc2VsZWN0KHNlbGVjdG9yKTsKCiAgdmFyIGJib3ggPSBlbC5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgogIHZhciBDb250cm9sbGVyID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9ldmVudHMgPSBkMy5kaXNwYXRjaCgiaGlnaGxpZ2h0IiwgImRhdGFwb2ludF9ob3ZlciIsICJ0cmFuc2Zvcm0iKTsKICAgIHRoaXMuX2hpZ2hsaWdodCA9IHt4OiBudWxsLCB5OiBudWxsfTsKICAgIHRoaXMuX2RhdGFwb2ludF9ob3ZlciA9IHt4OiBudWxsLCB5OiBudWxsLCB2YWx1ZTogbnVsbH07CiAgICB0aGlzLl90cmFuc2Zvcm0gPSBudWxsOwogIH07CiAgKGZ1bmN0aW9uKCkgewogICAgdGhpcy5oaWdobGlnaHQgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgIC8vIENvcHkgZm9yIHNhZmV0eQogICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB7eDogdGhpcy5faGlnaGxpZ2h0LngsIHk6IHRoaXMuX2hpZ2hsaWdodC55fTsKCiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgICB0aGlzLl9oaWdobGlnaHQgPSB4OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX2hpZ2hsaWdodCA9IHt4OiB4LCB5OiB5fTsKICAgICAgfQogICAgICB0aGlzLl9ldmVudHMuaGlnaGxpZ2h0LmNhbGwodGhpcywgdGhpcy5faGlnaGxpZ2h0KTsKICAgIH07CgogICAgdGhpcy5kYXRhcG9pbnRfaG92ZXIgPSBmdW5jdGlvbihfKSB7CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX2RhdGFwb2ludF9ob3ZlcjsKICAgICAgCiAgICAgIHRoaXMuX2RhdGFwb2ludF9ob3ZlciA9IF87CiAgICAgIHRoaXMuX2V2ZW50cy5kYXRhcG9pbnRfaG92ZXIuY2FsbCh0aGlzLCBfKTsKICAgIH07CgogICAgdGhpcy50cmFuc2Zvcm0gPSBmdW5jdGlvbihfKSB7CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIHRoaXMuX3RyYW5zZm9ybTsKICAgICAgdGhpcy5fdHJhbnNmb3JtID0gXzsKICAgICAgdGhpcy5fZXZlbnRzLnRyYW5zZm9ybS5jYWxsKHRoaXMsIF8pOwogICAgfTsKCiAgICB0aGlzLm9uID0gZnVuY3Rpb24oZXZ0LCBjYWxsYmFjaykgewogICAgICB0aGlzLl9ldmVudHMub24oZXZ0LCBjYWxsYmFjayk7CiAgICB9OwogIH0pLmNhbGwoQ29udHJvbGxlci5wcm90b3R5cGUpOwoKICB2YXIgY29udHJvbGxlciA9IG5ldyBDb250cm9sbGVyKCk7CgogIC8vIFNldCBvcHRpb24gZGVmYXVsdHMKICB2YXIgb3B0cyA9IHt9OwogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogIG9wdHMud2lkdGggPSBvcHRpb25zLndpZHRoIHx8IGJib3gud2lkdGg7CiAgb3B0cy5oZWlnaHQgPSBvcHRpb25zLmhlaWdodCB8fCBiYm94LmhlaWdodDsKICBvcHRzLnhjbHVzdF9oZWlnaHQgPSBvcHRpb25zLnhjbHVzdF9oZWlnaHQgfHwgb3B0cy5oZWlnaHQgKiAwLjEyOwogIG9wdHMueWNsdXN0X3dpZHRoID0gb3B0aW9ucy55Y2x1c3Rfd2lkdGggfHwgb3B0cy53aWR0aCAqIDAuMTI7CiAgb3B0cy5saW5rX2NvbG9yID0gb3B0cy5saW5rX2NvbG9yIHx8ICIjQUFBIjsKICBvcHRzLnhheGlzX2hlaWdodCA9IG9wdGlvbnMueGF4aXNfaGVpZ2h0IHx8IDgwOwogIG9wdHMueWF4aXNfd2lkdGggPSBvcHRpb25zLnlheGlzX3dpZHRoIHx8IDEyMDsKICBvcHRzLmF4aXNfcGFkZGluZyA9IG9wdGlvbnMuYXhpc19wYWRkaW5nIHx8IDY7CiAgb3B0cy5zaG93X2dyaWQgPSBvcHRpb25zLnNob3dfZ3JpZDsKICBpZiAodHlwZW9mKG9wdHMuc2hvd19ncmlkKSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgIG9wdHMuc2hvd19ncmlkID0gdHJ1ZTsKICB9CiAgb3B0cy5icnVzaF9jb2xvciA9IG9wdGlvbnMuYnJ1c2hfY29sb3IgfHwgIiMwMDAwRkYiOwogIG9wdHMueGF4aXNfZm9udF9zaXplID0gb3B0aW9ucy54YXhpc19mb250X3NpemU7CiAgb3B0cy55YXhpc19mb250X3NpemUgPSBvcHRpb25zLnlheGlzX2ZvbnRfc2l6ZTsKICBvcHRzLmFuaW1fZHVyYXRpb24gPSBvcHRpb25zLmFuaW1fZHVyYXRpb247CiAgaWYgKHR5cGVvZihvcHRzLmFuaW1fZHVyYXRpb24pID09PSAndW5kZWZpbmVkJykgewogICAgb3B0cy5hbmltX2R1cmF0aW9uID0gNTAwOwogIH0KCiAgaWYgKCFkYXRhLnJvd3MpIHsKICAgIG9wdHMueWNsdXN0X3dpZHRoID0gMDsKICB9CiAgaWYgKCFkYXRhLmNvbHMpIHsKICAgIG9wdHMueGNsdXN0X2hlaWdodCA9IDA7CiAgfQogIAogIHZhciBncmlkU2l6ZXIgPSBuZXcgR3JpZFNpemVyKAogICAgW29wdHMueWNsdXN0X3dpZHRoLCAiKiIsIG9wdHMueWF4aXNfd2lkdGhdLAogICAgW29wdHMueGNsdXN0X2hlaWdodCwgIioiLCBvcHRzLnhheGlzX2hlaWdodF0sCiAgICBvcHRzLndpZHRoLAogICAgb3B0cy5oZWlnaHQKICApOwoKICB2YXIgY29sb3JtYXBCb3VuZHMgPSBncmlkU2l6ZXIuZ2V0Q2VsbEJvdW5kcygxLCAxKTsKICB2YXIgY29sRGVuZEJvdW5kcyA9IGdyaWRTaXplci5nZXRDZWxsQm91bmRzKDEsIDApOwogIHZhciByb3dEZW5kQm91bmRzID0gZ3JpZFNpemVyLmdldENlbGxCb3VuZHMoMCwgMSk7CiAgdmFyIHlheGlzQm91bmRzID0gZ3JpZFNpemVyLmdldENlbGxCb3VuZHMoMiwgMSk7CiAgdmFyIHhheGlzQm91bmRzID0gZ3JpZFNpemVyLmdldENlbGxCb3VuZHMoMSwgMik7CgogIGZ1bmN0aW9uIGNzc2lmeShzdHlsZXMpIHsKICAgIHJldHVybiB7CiAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgICB0b3A6IHN0eWxlcy50b3AgKyAicHgiLAogICAgICBsZWZ0OiBzdHlsZXMubGVmdCArICJweCIsCiAgICAgIHdpZHRoOiBzdHlsZXMud2lkdGggKyAicHgiLAogICAgICBoZWlnaHQ6IHN0eWxlcy5oZWlnaHQgKyAicHgiCiAgICB9OwogIH0KCiAgLy8gQ3JlYXRlIERPTSBzdHJ1Y3R1cmUKICAoZnVuY3Rpb24oKSB7CiAgICB2YXIgaW5uZXIgPSBlbC5hcHBlbmQoImRpdiIpLmNsYXNzZWQoImlubmVyIiwgdHJ1ZSk7CiAgICB2YXIgaW5mbyA9IGlubmVyLmFwcGVuZCgiZGl2IikuY2xhc3NlZCgiaW5mbyIsIHRydWUpOwogICAgdmFyIGNvbERlbmQgPSBpbm5lci5hcHBlbmQoInN2ZyIpLmNsYXNzZWQoImRlbmRyb2dyYW0gY29sRGVuZCIsIHRydWUpLnN0eWxlKGNzc2lmeShjb2xEZW5kQm91bmRzKSk7CiAgICB2YXIgcm93RGVuZCA9IGlubmVyLmFwcGVuZCgic3ZnIikuY2xhc3NlZCgiZGVuZHJvZ3JhbSByb3dEZW5kIiwgdHJ1ZSkuc3R5bGUoY3NzaWZ5KHJvd0RlbmRCb3VuZHMpKTsKICAgIHZhciBjb2xtYXAgPSBpbm5lci5hcHBlbmQoInN2ZyIpLmNsYXNzZWQoImNvbG9ybWFwIiwgdHJ1ZSkuc3R5bGUoY3NzaWZ5KGNvbG9ybWFwQm91bmRzKSk7CiAgICB2YXIgeGF4aXMgPSBpbm5lci5hcHBlbmQoInN2ZyIpLmNsYXNzZWQoImF4aXMgeGF4aXMiLCB0cnVlKS5zdHlsZShjc3NpZnkoeGF4aXNCb3VuZHMpKTsKICAgIHZhciB5YXhpcyA9IGlubmVyLmFwcGVuZCgic3ZnIikuY2xhc3NlZCgiYXhpcyB5YXhpcyIsIHRydWUpLnN0eWxlKGNzc2lmeSh5YXhpc0JvdW5kcykpOwogICAgCiAgICAvLyBIYWNrIHRoZSB3aWR0aCBvZiB0aGUgeC1heGlzIHRvIGFsbG93IHgtb3ZlcmZsb3cgb2Ygcm90YXRlZCBsYWJlbHM7IHRoZQogICAgLy8gUXRXZWJraXQgdmlld2VyIHdvbid0IGFsbG93IHN2ZyBlbGVtZW50cyB0byBvdmVyZmxvdzp2aXNpYmxlLgogICAgeGF4aXMuc3R5bGUoIndpZHRoIiwgKG9wdHMud2lkdGggLSBvcHRzLnljbHVzdF93aWR0aCkgKyAicHgiKTsKICAgIHhheGlzCiAgICAgIC5hcHBlbmQoImRlZnMiKQogICAgICAgIC5hcHBlbmQoImNsaXBQYXRoIikuYXR0cigiaWQiLCAieGF4aXMtY2xpcCIpCiAgICAgICAgICAuYXBwZW5kKCJwb2x5Z29uIikKICAgICAgICAgICAgLmF0dHIoInBvaW50cyIsICIiICsgWwogICAgICAgICAgICAgIFswLCAwXSwKICAgICAgICAgICAgICBbeGF4aXNCb3VuZHMud2lkdGgsIDBdLAogICAgICAgICAgICAgIFt4YXhpc0JvdW5kcy53aWR0aCArIHlheGlzQm91bmRzLndpZHRoLCB4YXhpc0JvdW5kcy5oZWlnaHRdLAogICAgICAgICAgICAgIFswLCB4YXhpc0JvdW5kcy5oZWlnaHRdCiAgICAgICAgICAgIF0pOwogICAgeGF4aXMubm9kZSgwKS5zZXRBdHRyaWJ1dGUoImNsaXAtcGF0aCIsICJ1cmwoI3hheGlzLWNsaXApIik7CgogICAgaW5uZXIub24oImNsaWNrIiwgZnVuY3Rpb24oKSB7CiAgICAgIGNvbnRyb2xsZXIuaGlnaGxpZ2h0KG51bGwsIG51bGwpOwogICAgfSk7CiAgICBjb250cm9sbGVyLm9uKCdoaWdobGlnaHQuaW5uZXInLCBmdW5jdGlvbihobCkgewogICAgICBpbm5lci5jbGFzc2VkKCdoaWdobGlnaHRpbmcnLAogICAgICAgIHR5cGVvZihobC54KSA9PT0gJ251bWJlcicgfHwgdHlwZW9mKGhsLnkpID09PSAnbnVtYmVyJyk7CiAgICB9KTsKICB9KSgpOwogIAogIHZhciByb3cgPSAhZGF0YS5yb3dzID8gbnVsbCA6IGRlbmRyb2dyYW0oZWwuc2VsZWN0KCdzdmcucm93RGVuZCcpLCBkYXRhLnJvd3MsIGZhbHNlLCByb3dEZW5kQm91bmRzLndpZHRoLCByb3dEZW5kQm91bmRzLmhlaWdodCwgb3B0cy5heGlzX3BhZGRpbmcpOwogIHZhciBjb2wgPSAhZGF0YS5jb2xzID8gbnVsbCA6IGRlbmRyb2dyYW0oZWwuc2VsZWN0KCdzdmcuY29sRGVuZCcpLCBkYXRhLmNvbHMsIHRydWUsIGNvbERlbmRCb3VuZHMud2lkdGgsIGNvbERlbmRCb3VuZHMuaGVpZ2h0LCBvcHRzLmF4aXNfcGFkZGluZyk7CiAgdmFyIGNvbG9ybWFwID0gY29sb3JtYXAoZWwuc2VsZWN0KCdzdmcuY29sb3JtYXAnKSwgZGF0YS5tYXRyaXgsIGNvbG9ybWFwQm91bmRzLndpZHRoLCBjb2xvcm1hcEJvdW5kcy5oZWlnaHQpOwogIHZhciB4YXggPSBheGlzTGFiZWxzKGVsLnNlbGVjdCgnc3ZnLnhheGlzJyksIGRhdGEuY29scyB8fCBkYXRhLm1hdHJpeC5jb2xzLCB0cnVlLCB4YXhpc0JvdW5kcy53aWR0aCwgeGF4aXNCb3VuZHMuaGVpZ2h0LCBvcHRzLmF4aXNfcGFkZGluZyk7CiAgdmFyIHlheCA9IGF4aXNMYWJlbHMoZWwuc2VsZWN0KCdzdmcueWF4aXMnKSwgZGF0YS5yb3dzIHx8IGRhdGEubWF0cml4LnJvd3MsIGZhbHNlLCB5YXhpc0JvdW5kcy53aWR0aCwgeWF4aXNCb3VuZHMuaGVpZ2h0LCBvcHRzLmF4aXNfcGFkZGluZyk7CiAgCiAgZnVuY3Rpb24gY29sb3JtYXAoc3ZnLCBkYXRhLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAvLyBDaGVjayBmb3Igbm8gZGF0YQogICAgaWYgKGRhdGEubGVuZ3RoID09PSAwKQogICAgICByZXR1cm4gZnVuY3Rpb24oKSB7fTsKCglpZiAoIW9wdHMuc2hvd19ncmlkKSB7CiAgICAgIHN2Zy5zdHlsZSgic2hhcGUtcmVuZGVyaW5nIiwgImNyaXNwRWRnZXMiKTsKCX0KIAogICAgdmFyIGNvbHMgPSBkYXRhLmRpbVsxXTsKICAgIHZhciByb3dzID0gZGF0YS5kaW1bMF07CiAgICAKICAgIHZhciBtZXJnZWQgPSBkYXRhLm1lcmdlZDsKICAgIAogICAgdmFyIHggPSBkMy5zY2FsZS5saW5lYXIoKS5kb21haW4oWzAsIGNvbHNdKS5yYW5nZShbMCwgd2lkdGhdKTsKICAgIHZhciB5ID0gZDMuc2NhbGUubGluZWFyKCkuZG9tYWluKFswLCByb3dzXSkucmFuZ2UoWzAsIGhlaWdodF0pOwogICAgdmFyIHRpcCA9IGQzLnRpcCgpCiAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2QzaGVhdG1hcC10aXAnKQogICAgICAgIC5odG1sKGZ1bmN0aW9uKGQsIGkpIHsKICAgICAgICAgIHJldHVybiAiPHRhYmxlPiIgKyAKICAgICAgICAgICAgIjx0cj48dGggYWxpZ249XCJyaWdodFwiPlJvdzwvdGg+PHRkPiIgKyBodG1sRXNjYXBlKGRhdGEucm93c1tkLnJvd10pICsgIjwvdGQ+PC90cj4iICsKICAgICAgICAgICAgIjx0cj48dGggYWxpZ249XCJyaWdodFwiPkNvbHVtbjwvdGg+PHRkPiIgKyBodG1sRXNjYXBlKGRhdGEuY29sc1tkLmNvbF0pICsgIjwvdGQ+PC90cj4iICsKICAgICAgICAgICAgIjx0cj48dGggYWxpZ249XCJyaWdodFwiPlZhbHVlPC90aD48dGQ+IiArIGh0bWxFc2NhcGUoZC5sYWJlbCkgKyAiPC90ZD48L3RyPiIgKwogICAgICAgICAgICAiPC90YWJsZT4iOwogICAgICAgIH0pCiAgICAgICAgLmRpcmVjdGlvbigic2UiKQogICAgICAgIC5zdHlsZSgicG9zaXRpb24iLCAiZml4ZWQiKTsKICAgIAogICAgdmFyIGJydXNoID0gZDMuc3ZnLmJydXNoKCkKICAgICAgICAueCh4KQogICAgICAgIC55KHkpCiAgICAgICAgLmNsYW1wKFt0cnVlLCB0cnVlXSkKICAgICAgICAub24oJ2JydXNoJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgZXh0ZW50ID0gYnJ1c2guZXh0ZW50KCk7CiAgICAgICAgICBleHRlbnRbMF1bMF0gPSBNYXRoLnJvdW5kKGV4dGVudFswXVswXSk7CiAgICAgICAgICBleHRlbnRbMF1bMV0gPSBNYXRoLnJvdW5kKGV4dGVudFswXVsxXSk7CiAgICAgICAgICBleHRlbnRbMV1bMF0gPSBNYXRoLnJvdW5kKGV4dGVudFsxXVswXSk7CiAgICAgICAgICBleHRlbnRbMV1bMV0gPSBNYXRoLnJvdW5kKGV4dGVudFsxXVsxXSk7CiAgICAgICAgICBkMy5zZWxlY3QodGhpcykuY2FsbChicnVzaC5leHRlbnQoZXh0ZW50KSk7CiAgICAgICAgfSkKICAgICAgICAub24oJ2JydXNoZW5kJywgZnVuY3Rpb24oKSB7CgogICAgICAgICAgaWYgKGJydXNoLmVtcHR5KCkpIHsKICAgICAgICAgICAgY29udHJvbGxlci50cmFuc2Zvcm0oewogICAgICAgICAgICAgIHNjYWxlOiBbMSwxXSwKICAgICAgICAgICAgICB0cmFuc2xhdGU6IFswLDBdLAogICAgICAgICAgICAgIGV4dGVudDogW1swLDBdLFtjb2xzLHJvd3NdXQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciB0ZiA9IGNvbnRyb2xsZXIudHJhbnNmb3JtKCk7CiAgICAgICAgICAgIHZhciBleCA9IGJydXNoLmV4dGVudCgpOwogICAgICAgICAgICB2YXIgc2NhbGUgPSBbCiAgICAgICAgICAgICAgY29scyAvIChleFsxXVswXSAtIGV4WzBdWzBdKSwKICAgICAgICAgICAgICByb3dzIC8gKGV4WzFdWzFdIC0gZXhbMF1bMV0pCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHZhciB0cmFuc2xhdGUgPSBbCiAgICAgICAgICAgICAgZXhbMF1bMF0gKiAod2lkdGggLyBjb2xzKSAqIHNjYWxlWzBdICogLTEsCiAgICAgICAgICAgICAgZXhbMF1bMV0gKiAoaGVpZ2h0IC8gcm93cykgKiBzY2FsZVsxXSAqIC0xCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIGNvbnRyb2xsZXIudHJhbnNmb3JtKHtzY2FsZTogc2NhbGUsIHRyYW5zbGF0ZTogdHJhbnNsYXRlLCBleHRlbnQ6IGV4fSk7CiAgICAgICAgICB9CiAgICAgICAgICBicnVzaC5jbGVhcigpOwogICAgICAgICAgZDMuc2VsZWN0KHRoaXMpLmNhbGwoYnJ1c2gpLnNlbGVjdCgiLmJydXNoIC5leHRlbnQiKQogICAgICAgICAgICAgIC5zdHlsZSh7ZmlsbDogb3B0cy5icnVzaF9jb2xvciwgc3Ryb2tlOiBvcHRzLmJydXNoX2NvbG9yfSk7CiAgICAgICAgfSk7CgogICAgc3ZnID0gc3ZnCiAgICAgICAgLmF0dHIoIndpZHRoIiwgd2lkdGgpCiAgICAgICAgLmF0dHIoImhlaWdodCIsIGhlaWdodCk7CiAgICB2YXIgcmVjdCA9IHN2Zy5zZWxlY3RBbGwoInJlY3QiKS5kYXRhKG1lcmdlZCk7CiAgICByZWN0LmVudGVyKCkuYXBwZW5kKCJyZWN0IikuY2xhc3NlZCgiZGF0YXB0IiwgdHJ1ZSkKICAgICAgICAucHJvcGVydHkoImNvbEluZGV4IiwgZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gaSAlIGNvbHM7IH0pCiAgICAgICAgLnByb3BlcnR5KCJyb3dJbmRleCIsIGZ1bmN0aW9uKGQsIGkpIHsgcmV0dXJuIE1hdGguZmxvb3IoaSAvIGNvbHMpOyB9KQogICAgICAgIC5wcm9wZXJ0eSgidmFsdWUiLCBmdW5jdGlvbihkLCBpKSB7IHJldHVybiBkLnZhbHVlOyB9KQogICAgICAgIC5hdHRyKCJmaWxsIiwgZnVuY3Rpb24oZCkgewogICAgICAgICAgaWYgKCFkLmNvbG9yKSB7CiAgICAgICAgICAgIHJldHVybiAidHJhbnNwYXJlbnQiOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGQuY29sb3I7CiAgICAgICAgfSk7CiAgICByZWN0LmV4aXQoKS5yZW1vdmUoKTsKICAgIHJlY3QuYXBwZW5kKCJ0aXRsZSIpCiAgICAgICAgLnRleHQoZnVuY3Rpb24oZCwgaSkgeyByZXR1cm4gZC5sYWJlbDsgfSk7CiAgICByZWN0LmNhbGwodGlwKTsKCiAgICB2YXIgc3BhY2luZzsKICAgIGlmICh0eXBlb2Yob3B0cy5zaG93X2dyaWQpID09PSAnbnVtYmVyJykgewogICAgICBzcGFjaW5nID0gb3B0cy5zaG93X2dyaWQ7CiAgICB9IGVsc2UgaWYgKCEhb3B0cy5zaG93X2dyaWQpIHsKICAgICAgc3BhY2luZyA9IDAuMjU7CiAgICB9IGVsc2UgewogICAgICBzcGFjaW5nID0gMDsKICAgIH0KICAgIGZ1bmN0aW9uIGRyYXcoc2VsZWN0aW9uKSB7CiAgICAgIHNlbGVjdGlvbgogICAgICAgICAgLmF0dHIoIngiLCBmdW5jdGlvbihkLCBpKSB7CiAgICAgICAgICAgIHJldHVybiB4KGkgJSBjb2xzKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuYXR0cigieSIsIGZ1bmN0aW9uKGQsIGkpIHsKICAgICAgICAgICAgcmV0dXJuIHkoTWF0aC5mbG9vcihpIC8gY29scykpOwogICAgICAgICAgfSkKICAgICAgICAgIC5hdHRyKCJ3aWR0aCIsICh4KDEpIC0geCgwKSkgLSBzcGFjaW5nKQogICAgICAgICAgLmF0dHIoImhlaWdodCIsICh5KDEpIC0geSgwKSkgLSBzcGFjaW5nKTsKICAgIH0KCiAgICBkcmF3KHJlY3QpOwoKICAgIGNvbnRyb2xsZXIub24oJ3RyYW5zZm9ybS5jb2xvcm1hcCcsIGZ1bmN0aW9uKF8pIHsKICAgICAgeC5yYW5nZShbXy50cmFuc2xhdGVbMF0sIHdpZHRoICogXy5zY2FsZVswXSArIF8udHJhbnNsYXRlWzBdXSk7CiAgICAgIHkucmFuZ2UoW18udHJhbnNsYXRlWzFdLCBoZWlnaHQgKiBfLnNjYWxlWzFdICsgXy50cmFuc2xhdGVbMV1dKTsKICAgICAgZHJhdyhyZWN0LnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRzLmFuaW1fZHVyYXRpb24pLmVhc2UoImxpbmVhciIpKTsKICAgIH0pOwogICAgCgogICAgdmFyIGJydXNoRyA9IHN2Zy5hcHBlbmQoImciKQogICAgICAgIC5hdHRyKCdjbGFzcycsICdicnVzaCcpCiAgICAgICAgLmNhbGwoYnJ1c2gpCiAgICAgICAgLmNhbGwoYnJ1c2guZXZlbnQpOwogICAgYnJ1c2hHLnNlbGVjdCgicmVjdC5iYWNrZ3JvdW5kIikKICAgICAgICAub24oIm1vdXNlZW50ZXIiLCBmdW5jdGlvbigpIHsKICAgICAgICAgIHRpcC5zdHlsZSgiZGlzcGxheSIsICJibG9jayIpOwogICAgICAgIH0pCiAgICAgICAgLm9uKCJtb3VzZW1vdmUiLCBmdW5jdGlvbigpIHsKICAgICAgICAgIHZhciBlID0gZDMuZXZlbnQ7CiAgICAgICAgICB2YXIgb2Zmc2V0WCA9IGQzLmV2ZW50Lm9mZnNldFg7CiAgICAgICAgICB2YXIgb2Zmc2V0WSA9IGQzLmV2ZW50Lm9mZnNldFk7CiAgICAgICAgICBpZiAodHlwZW9mKG9mZnNldFgpID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAvLyBGaXJlZm94IDM4IGFuZCBlYXJsaWVyCiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgIHZhciByZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICBvZmZzZXRYID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0LAogICAgICAgICAgICBvZmZzZXRZID0gZS5jbGllbnRZIC0gcmVjdC50b3A7CiAgICAgICAgICB9CiAgICAgICAgICAKICAgICAgICAgIHZhciBjb2wgPSBNYXRoLmZsb29yKHguaW52ZXJ0KG9mZnNldFgpKTsKICAgICAgICAgIHZhciByb3cgPSBNYXRoLmZsb29yKHkuaW52ZXJ0KG9mZnNldFkpKTsKICAgICAgICAgIHZhciBsYWJlbCA9IG1lcmdlZFtyb3cqY29scyArIGNvbF0ubGFiZWw7CiAgICAgICAgICB0aXAuc2hvdyh7Y29sOiBjb2wsIHJvdzogcm93LCBsYWJlbDogbGFiZWx9KS5zdHlsZSh7CiAgICAgICAgICAgIHRvcDogZDMuZXZlbnQuY2xpZW50WSArIDE1ICsgInB4IiwKICAgICAgICAgICAgbGVmdDogZDMuZXZlbnQuY2xpZW50WCArIDE1ICsgInB4IiwKICAgICAgICAgICAgb3BhY2l0eTogMC45CiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbnRyb2xsZXIuZGF0YXBvaW50X2hvdmVyKHtjb2w6Y29sLCByb3c6cm93LCBsYWJlbDpsYWJlbH0pOwogICAgICAgIH0pCiAgICAgICAgLm9uKCJtb3VzZWxlYXZlIiwgZnVuY3Rpb24oKSB7CiAgICAgICAgICB0aXAuaGlkZSgpLnN0eWxlKCJkaXNwbGF5IiwgIm5vbmUiKTsKICAgICAgICAgIGNvbnRyb2xsZXIuZGF0YXBvaW50X2hvdmVyKG51bGwpOwogICAgICAgIH0pOwoKICAgIGNvbnRyb2xsZXIub24oJ2hpZ2hsaWdodC5kYXRhcHQnLCBmdW5jdGlvbihobCkgewogICAgICByZWN0LmNsYXNzZWQoJ2hpZ2hsaWdodCcsIGZ1bmN0aW9uKGQsIGkpIHsKICAgICAgICByZXR1cm4gKHRoaXMucm93SW5kZXggPT09IGhsLnkpIHx8ICh0aGlzLmNvbEluZGV4ID09PSBobC54KTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGF4aXNMYWJlbHMoc3ZnLCBkYXRhLCByb3RhdGVkLCB3aWR0aCwgaGVpZ2h0LCBwYWRkaW5nKSB7CiAgICBzdmcgPSBzdmcuYXBwZW5kKCdnJyk7CgogICAgLy8gVGhlIGRhdGEgdmFyaWFibGUgaXMgZWl0aGVyIGNsdXN0ZXIgaW5mbywgb3IgYSBmbGF0IGxpc3Qgb2YgbmFtZXMuCiAgICAvLyBJZiB0aGUgZm9ybWVyLCB0cmFuc2Zvcm0gaXQgdG8gc2ltcGx5IGEgbGlzdCBvZiBuYW1lcy4KICAgIHZhciBsZWF2ZXM7CiAgICBpZiAoZGF0YS5jaGlsZHJlbikgewogICAgICBsZWF2ZXMgPSBkMy5sYXlvdXQuY2x1c3RlcigpLm5vZGVzKGRhdGEpCiAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uKHgpIHsgcmV0dXJuICF4LmNoaWxkcmVuOyB9KQogICAgICAgICAgLm1hcChmdW5jdGlvbih4KSB7IHJldHVybiB4LmxhYmVsICsgIiI7IH0pOwogICAgfSBlbHNlIGlmIChkYXRhLmxlbmd0aCkgewogICAgICBsZWF2ZXMgPSBkYXRhOwogICAgfQogICAgCiAgICAvLyBEZWZpbmUgc2NhbGUsIGF4aXMKICAgIHZhciBzY2FsZSA9IGQzLnNjYWxlLm9yZGluYWwoKQogICAgICAgIC5kb21haW4obGVhdmVzKQogICAgICAgIC5yYW5nZUJhbmRzKFswLCByb3RhdGVkID8gd2lkdGggOiBoZWlnaHRdKTsKICAgIHZhciBheGlzID0gZDMuc3ZnLmF4aXMoKQogICAgICAgIC5zY2FsZShzY2FsZSkKICAgICAgICAub3JpZW50KHJvdGF0ZWQgPyAiYm90dG9tIiA6ICJyaWdodCIpCiAgICAgICAgLm91dGVyVGlja1NpemUoMCkKICAgICAgICAudGlja1BhZGRpbmcocGFkZGluZykKICAgICAgICAudGlja1ZhbHVlcyhsZWF2ZXMpOwoKICAgIC8vIENyZWF0ZSB0aGUgYWN0dWFsIGF4aXMKICAgIHZhciBheGlzTm9kZXMgPSBzdmcuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgcm90YXRlZCA/ICJ0cmFuc2xhdGUoMCwiICsgcGFkZGluZyArICIpIiA6ICJ0cmFuc2xhdGUoIiArIHBhZGRpbmcgKyAiLDApIikKICAgICAgICAuY2FsbChheGlzKTsKICAgIHZhciBmb250U2l6ZSA9IG9wdHNbKHJvdGF0ZWQgPyAneCcgOiAneScpICsgJ2F4aXNfZm9udF9zaXplJ10KICAgICAgICB8fCBNYXRoLm1pbigxOCwgTWF0aC5tYXgoOSwgc2NhbGUucmFuZ2VCYW5kKCkgLSAocm90YXRlZCA/IDExOiA4KSkpICsgInB4IjsKICAgIGF4aXNOb2Rlcy5zZWxlY3RBbGwoInRleHQiKS5zdHlsZSgiZm9udC1zaXplIiwgZm9udFNpemUpOwogICAgCiAgICB2YXIgbW91c2VUYXJnZXRzID0gc3ZnLmFwcGVuZCgiZyIpCiAgICAgIC5zZWxlY3RBbGwoImciKS5kYXRhKGxlYXZlcyk7CiAgICBtb3VzZVRhcmdldHMKICAgICAgLmVudGVyKCkKICAgICAgICAuYXBwZW5kKCJnIikuYXBwZW5kKCJyZWN0IikKICAgICAgICAgIC5hdHRyKCJ0cmFuc2Zvcm0iLCByb3RhdGVkID8gInJvdGF0ZSg0NSksdHJhbnNsYXRlKDAsMCkiIDogIiIpCiAgICAgICAgICAuYXR0cigiZmlsbCIsICJ0cmFuc3BhcmVudCIpCiAgICAgICAgICAub24oImNsaWNrIiwgZnVuY3Rpb24oZCwgaSkgewogICAgICAgICAgICB2YXIgZGltID0gcm90YXRlZCA/ICd4JyA6ICd5JzsKICAgICAgICAgICAgdmFyIGhsID0gY29udHJvbGxlci5oaWdobGlnaHQoKSB8fCB7eDpudWxsLCB5Om51bGx9OwogICAgICAgICAgICBpZiAoaGxbZGltXSA9PSBpKSB7CiAgICAgICAgICAgICAgLy8gSWYgY2xpY2tlZCBhbHJlYWR5LWhpZ2hsaWdodGVkIHJvdy9jb2wsIHRoZW4gdW5oaWdobGlnaHQKICAgICAgICAgICAgICBobFtkaW1dID0gbnVsbDsKICAgICAgICAgICAgICBjb250cm9sbGVyLmhpZ2hsaWdodChobCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaGxbZGltXSA9IGk7CiAgICAgICAgICAgICAgY29udHJvbGxlci5oaWdobGlnaHQoaGwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGQzLmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgfSk7CiAgICBmdW5jdGlvbiBsYXlvdXRNb3VzZVRhcmdldHMoc2VsZWN0aW9uKSB7CiAgICAgIHNlbGVjdGlvbgogICAgICAgICAgLmF0dHIoInRyYW5zZm9ybSIsIGZ1bmN0aW9uKGQsIGkpIHsKICAgICAgICAgICAgdmFyIHggPSByb3RhdGVkID8gc2NhbGUoZCkgKyBzY2FsZS5yYW5nZUJhbmQoKS8yIDogMDsKICAgICAgICAgICAgdmFyIHkgPSByb3RhdGVkID8gcGFkZGluZyArIDYgOiBzY2FsZShkKTsKICAgICAgICAgICAgcmV0dXJuICJ0cmFuc2xhdGUoIiArIHggKyAiLCIgKyB5ICsgIikiOwogICAgICAgICAgfSkKICAgICAgICAuc2VsZWN0QWxsKCJyZWN0IikKICAgICAgICAgIC5hdHRyKCJoZWlnaHQiLCBzY2FsZS5yYW5nZUJhbmQoKSAvIChyb3RhdGVkID8gMS40MTQgOiAxKSkKICAgICAgICAgIC5hdHRyKCJ3aWR0aCIsIHJvdGF0ZWQgPyBoZWlnaHQgKiAxLjQxNCAqIDEuMiA6IHdpZHRoKTsKICAgIH0KICAgIGxheW91dE1vdXNlVGFyZ2V0cyhtb3VzZVRhcmdldHMpOwoKICAgIGlmIChyb3RhdGVkKSB7CiAgICAgIGF4aXNOb2Rlcy5zZWxlY3RBbGwoInRleHQiKQogICAgICAgIC5hdHRyKCJ0cmFuc2Zvcm0iLCAicm90YXRlKDQ1KSx0cmFuc2xhdGUoNiwgMCkiKQogICAgICAgIC5zdHlsZSgidGV4dC1hbmNob3IiLCAic3RhcnQiKTsKICAgIH0KICAgIAogICAgY29udHJvbGxlci5vbignaGlnaGxpZ2h0LmF4aXMtJyArIChyb3RhdGVkID8gJ3gnIDogJ3knKSwgZnVuY3Rpb24oaGwpIHsKICAgICAgdmFyIHRpY2tzID0gYXhpc05vZGVzLnNlbGVjdEFsbCgnLnRpY2snKTsKICAgICAgdmFyIHNlbGVjdGVkID0gaGxbcm90YXRlZCA/ICd4JyA6ICd5J107CiAgICAgIGlmICh0eXBlb2Yoc2VsZWN0ZWQpICE9PSAnbnVtYmVyJykgewogICAgICAgIHRpY2tzLmNsYXNzZWQoJ2ZhZGVkJywgZmFsc2UpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aWNrcy5jbGFzc2VkKCdmYWRlZCcsIGZ1bmN0aW9uKGQsIGkpIHsKICAgICAgICByZXR1cm4gaSAhPT0gc2VsZWN0ZWQ7CiAgICAgIH0pOwogICAgfSk7CgogICAgY29udHJvbGxlci5vbigndHJhbnNmb3JtLmF4aXMtJyArIChyb3RhdGVkID8gJ3gnIDogJ3knKSwgZnVuY3Rpb24oXykgewogICAgICB2YXIgZGltID0gcm90YXRlZCA/IDAgOiAxOwogICAgICAvL3NjYWxlLmRvbWFpbihsZWF2ZXMuc2xpY2UoXy5leHRlbnRbMF1bZGltXSwgXy5leHRlbnRbMV1bZGltXSkpOwogICAgICB2YXIgcmIgPSBbXy50cmFuc2xhdGVbZGltXSwgKHJvdGF0ZWQgPyB3aWR0aCA6IGhlaWdodCkgKiBfLnNjYWxlW2RpbV0gKyBfLnRyYW5zbGF0ZVtkaW1dXTsKICAgICAgc2NhbGUucmFuZ2VCYW5kcyhyYik7CiAgICAgIHZhciB0QXhpc05vZGVzID0gYXhpc05vZGVzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRzLmFuaW1fZHVyYXRpb24pLmVhc2UoJ2xpbmVhcicpOwogICAgICB0QXhpc05vZGVzLmNhbGwoYXhpcyk7CiAgICAgIC8vIFNldCB0ZXh0LWFuY2hvciBvbiB0aGUgbm9uLXRyYW5zaXRpb25lZCBub2RlIHRvIHByZXZlbnQganVtcGluZXNzCiAgICAgIC8vIGluIFJTdHVkaW8gVmlld2VyIHBhbmUKICAgICAgYXhpc05vZGVzLnNlbGVjdEFsbCgidGV4dCIpLnN0eWxlKCJ0ZXh0LWFuY2hvciIsICJzdGFydCIpOwogICAgICB0QXhpc05vZGVzLnNlbGVjdEFsbCgiZyIpCiAgICAgICAgICAuc3R5bGUoIm9wYWNpdHkiLCBmdW5jdGlvbihkLCBpKSB7CiAgICAgICAgICAgIGlmIChpID49IF8uZXh0ZW50WzBdW2RpbV0gJiYgaSA8IF8uZXh0ZW50WzFdW2RpbV0pIHsKICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgIHRBeGlzTm9kZXMKICAgICAgICAuc2VsZWN0QWxsKCJ0ZXh0IikKICAgICAgICAgIC5zdHlsZSgidGV4dC1hbmNob3IiLCAic3RhcnQiKTsKICAgICAgbW91c2VUYXJnZXRzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRzLmFuaW1fZHVyYXRpb24pLmVhc2UoJ2xpbmVhcicpCiAgICAgICAgICAuY2FsbChsYXlvdXRNb3VzZVRhcmdldHMpCiAgICAgICAgICAuc3R5bGUoIm9wYWNpdHkiLCBmdW5jdGlvbihkLCBpKSB7CiAgICAgICAgICAgIGlmIChpID49IF8uZXh0ZW50WzBdW2RpbV0gJiYgaSA8IF8uZXh0ZW50WzFdW2RpbV0pIHsKICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICB9KTsKCiAgfQogIAogIGZ1bmN0aW9uIGVkZ2VTdHJva2VXaWR0aChub2RlKSB7CiAgICBpZiAobm9kZS5lZGdlUGFyICYmIG5vZGUuZWRnZVBhci5sd2QpCiAgICAgIHJldHVybiBub2RlLmVkZ2VQYXIubHdkOwogICAgZWxzZQogICAgICByZXR1cm4gMTsKICB9CiAgCiAgZnVuY3Rpb24gbWF4Q2hpbGRTdHJva2VXaWR0aChub2RlLCByZWN1cnNpdmUpIHsKICAgIHZhciBtYXggPSAwOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2RlLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmIChyZWN1cnNpdmUpIHsKICAgICAgICBtYXggPSBNYXRoLm1heChtYXgsIG1heENoaWxkU3Ryb2tlV2lkdGgobm9kZS5jaGlsZHJlbltpXSwgdHJ1ZSkpOwogICAgICB9CiAgICAgIG1heCA9IE1hdGgubWF4KG1heCwgZWRnZVN0cm9rZVdpZHRoKG5vZGUuY2hpbGRyZW5baV0pKTsKICAgIH0KICAgIHJldHVybiBtYXg7CiAgfQogIAogIGZ1bmN0aW9uIGRlbmRyb2dyYW0oc3ZnLCBkYXRhLCByb3RhdGVkLCB3aWR0aCwgaGVpZ2h0LCBwYWRkaW5nKSB7CiAgICB2YXIgdG9wTGluZVdpZHRoID0gbWF4Q2hpbGRTdHJva2VXaWR0aChkYXRhLCBmYWxzZSk7CiAgICAKICAgIHZhciB4ID0gZDMuc2NhbGUubGluZWFyKCkKICAgICAgICAuZG9tYWluKFtkYXRhLmhlaWdodCwgMF0pCiAgICAgICAgLnJhbmdlKFt0b3BMaW5lV2lkdGgvMiwgd2lkdGgtcGFkZGluZ10pOwogICAgdmFyIHkgPSBkMy5zY2FsZS5saW5lYXIoKQogICAgICAgIC5kb21haW4oWzAsIGhlaWdodF0pCiAgICAgICAgLnJhbmdlKFswLCBoZWlnaHRdKTsKICAgIAogICAgdmFyIGNsdXN0ZXIgPSBkMy5sYXlvdXQuY2x1c3RlcigpCiAgICAgICAgLnNlcGFyYXRpb24oZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gMTsgfSkKICAgICAgICAuc2l6ZShbcm90YXRlZCA/IHdpZHRoIDogaGVpZ2h0LCBOYU5dKTsKICAgIAogICAgdmFyIHRyYW5zZm9ybSA9ICJ0cmFuc2xhdGUoMSwwKSI7CiAgICBpZiAocm90YXRlZCkgewogICAgICAvLyBGbGlwIGRlbmRyb2dyYW0gdmVydGljYWxseQogICAgICB4LnJhbmdlKFt0b3BMaW5lV2lkdGgvMiwgLWhlaWdodCtwYWRkaW5nKzJdKTsKICAgICAgLy8gUm90YXRlCiAgICAgIHRyYW5zZm9ybSA9ICJyb3RhdGUoLTkwKSB0cmFuc2xhdGUoLTIsMCkiOwogICAgfQoKICAgIHZhciBkZW5kckcgPSBzdmcKICAgICAgICAuYXR0cigid2lkdGgiLCB3aWR0aCkKICAgICAgICAuYXR0cigiaGVpZ2h0IiwgaGVpZ2h0KQogICAgICAuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgdHJhbnNmb3JtKTsKICAgIAogICAgdmFyIG5vZGVzID0gY2x1c3Rlci5ub2RlcyhkYXRhKSwKICAgICAgICBsaW5rcyA9IGNsdXN0ZXIubGlua3Mobm9kZXMpOwoKICAgIC8vIEknbSBub3Qgc3VyZSB3aHksIGJ1dCBhZnRlciB0aGUgaGVhdG1hcCBsb2FkcyB0aGUgImxpbmtzIgogICAgLy8gYXJyYXkgbXV0YXRlcyB0byBtdWNoIHNtYWxsZXIgdmFsdWVzLiBJIGNhbid0IGZpZ3VyZSBvdXQKICAgIC8vIHdoYXQncyBkb2luZyBpdCwgc28gaW5zdGVhZCB3ZSBqdXN0IG1ha2UgYSBkZWVwIGNvcHkgb2YKICAgIC8vIHRoZSBwYXJ0cyB3ZSB3YW50LgogICAgdmFyIGxpbmtzMSA9IGxpbmtzLm1hcChmdW5jdGlvbihsaW5rLCBpKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgc291cmNlOiB7eDogbGluay5zb3VyY2UueCwgeTogbGluay5zb3VyY2UuaGVpZ2h0fSwKICAgICAgICB0YXJnZXQ6IHt4OiBsaW5rLnRhcmdldC54LCB5OiBsaW5rLnRhcmdldC5oZWlnaHR9LAogICAgICAgIGVkZ2VQYXI6IGxpbmsudGFyZ2V0LmVkZ2VQYXIKICAgICAgfTsKICAgIH0pOwogICAgCiAgICB2YXIgbGluZXMgPSBkZW5kckcuc2VsZWN0QWxsKCJwb2x5bGluZSIpLmRhdGEobGlua3MxKTsKICAgIGxpbmVzCiAgICAgIC5lbnRlcigpLmFwcGVuZCgicG9seWxpbmUiKQogICAgICAgIC5hdHRyKCJjbGFzcyIsICJsaW5rIikKICAgICAgICAuYXR0cigic3Ryb2tlIiwgZnVuY3Rpb24oZCwgaSkgewogICAgICAgICAgaWYgKCFkLmVkZ2VQYXIuY29sKSB7CiAgICAgICAgICAgIHJldHVybiBvcHRzLmxpbmtfY29sb3I7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZC5lZGdlUGFyLmNvbDsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLCBlZGdlU3Ryb2tlV2lkdGgpCiAgICAgICAgLmF0dHIoInN0cm9rZS1kYXNoYXJyYXkiLCBmdW5jdGlvbihkLCBpKSB7CiAgICAgICAgICB2YXIgcGF0dGVybjsKICAgICAgICAgIHN3aXRjaCAoZC5lZGdlUGFyLmx0eSkgewogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgcGF0dGVybiA9IFszLDMsNSwzXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHBhdHRlcm4gPSBbMTUsNV07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBwYXR0ZXJuID0gWzIsNCw0LDRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcGF0dGVybiA9IFsyLDRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcGF0dGVybiA9IFs0LDRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgcGF0dGVybiA9IFtdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXR0ZXJuLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHBhdHRlcm5baV0gPSBwYXR0ZXJuW2ldICogKGQuZWRnZVBhci5sd2QgfHwgMSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcGF0dGVybi5qb2luKCIsIik7CiAgICAgICAgfSk7CgogICAgZnVuY3Rpb24gZHJhdyhzZWxlY3Rpb24pIHsKICAgICAgZnVuY3Rpb24gZWxib3coZCwgaSkgewogICAgICAgIHJldHVybiB4KGQuc291cmNlLnkpICsgIiwiICsgeShkLnNvdXJjZS54KSArICIgIiArCiAgICAgICAgICAgIHgoZC5zb3VyY2UueSkgKyAiLCIgKyB5KGQudGFyZ2V0LngpICsgIiAiICsKICAgICAgICAgICAgeChkLnRhcmdldC55KSArICIsIiArIHkoZC50YXJnZXQueCk7CiAgICAgIH0KICAgICAgCiAgICAgIHNlbGVjdGlvbgogICAgICAgICAgLmF0dHIoInBvaW50cyIsIGVsYm93KTsKICAgIH0KCiAgICBjb250cm9sbGVyLm9uKCd0cmFuc2Zvcm0uZGVuZHItJyArIChyb3RhdGVkID8gJ3gnIDogJ3knKSwgZnVuY3Rpb24oXykgewogICAgICB2YXIgc2NhbGVCeSA9IF8uc2NhbGVbcm90YXRlZCA/IDAgOiAxXTsKICAgICAgdmFyIHRyYW5zbGF0ZUJ5ID0gXy50cmFuc2xhdGVbcm90YXRlZCA/IDAgOiAxXTsKICAgICAgeS5yYW5nZShbdHJhbnNsYXRlQnksIGhlaWdodCAqIHNjYWxlQnkgKyB0cmFuc2xhdGVCeV0pOwogICAgICBkcmF3KGxpbmVzLnRyYW5zaXRpb24oKS5kdXJhdGlvbihvcHRzLmFuaW1fZHVyYXRpb24pLmVhc2UoImxpbmVhciIpKTsKICAgIH0pOwoKICAgIGRyYXcobGluZXMpOwogIH0KCiAKICB2YXIgZGlzcGF0Y2hlciA9IGQzLmRpc3BhdGNoKCdob3ZlcicsICdjbGljaycpOwogIAogIGNvbnRyb2xsZXIub24oImRhdGFwb2ludF9ob3ZlciIsIGZ1bmN0aW9uKF8pIHsKICAgIGRpc3BhdGNoZXIuaG92ZXIoe2RhdGE6IF99KTsKICB9KTsKICAKICBmdW5jdGlvbiBvbl9jb2xfbGFiZWxfbW91c2VlbnRlcihlKSB7CiAgICBjb250cm9sbGVyLmhpZ2hsaWdodCgrZDMuc2VsZWN0KHRoaXMpLmF0dHIoImluZGV4IiksIG51bGwpOwogIH0KICBmdW5jdGlvbiBvbl9jb2xfbGFiZWxfbW91c2VsZWF2ZShlKSB7CiAgICBjb250cm9sbGVyLmhpZ2hsaWdodChudWxsLCBudWxsKTsKICB9CiAgZnVuY3Rpb24gb25fcm93X2xhYmVsX21vdXNlZW50ZXIoZSkgewogICAgY29udHJvbGxlci5oaWdobGlnaHQobnVsbCwgK2QzLnNlbGVjdCh0aGlzKS5hdHRyKCJpbmRleCIpKTsKICB9CiAgZnVuY3Rpb24gb25fcm93X2xhYmVsX21vdXNlbGVhdmUoZSkgewogICAgY29udHJvbGxlci5oaWdobGlnaHQobnVsbCwgbnVsbCk7CiAgfQoKICByZXR1cm4gewogICAgb246IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7CiAgICAgIGRpc3BhdGNoZXIub24odHlwZSwgbGlzdGVuZXIpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9Owp9Cg=="></script>
<script src="data:application/x-javascript;base64,Ly8gZDMudGlwCi8vIENvcHlyaWdodCAoYykgMjAxMyBKdXN0aW4gUGFsbWVyCi8vCi8vIFRvb2x0aXBzIGZvciBkMy5qcyBTVkcgdmlzdWFsaXphdGlvbnMKCihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkgewogIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHsKICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZSB3aXRoIGQzIGFzIGEgZGVwZW5kZW5jeS4KICAgIGRlZmluZShbJ2QzJ10sIGZhY3RvcnkpCiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgLy8gQ29tbW9uSlMKICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZDMpIHsKICAgICAgZDMudGlwID0gZmFjdG9yeShkMykKICAgICAgcmV0dXJuIGQzLnRpcAogICAgfQogIH0gZWxzZSB7CiAgICAvLyBCcm93c2VyIGdsb2JhbC4KICAgIHJvb3QuZDMudGlwID0gZmFjdG9yeShyb290LmQzKQogIH0KfSh0aGlzLCBmdW5jdGlvbiAoZDMpIHsKCiAgLy8gUHVibGljIC0gY29udHJ1Y3RzIGEgbmV3IHRvb2x0aXAKICAvLwogIC8vIFJldHVybnMgYSB0aXAKICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICB2YXIgZGlyZWN0aW9uID0gZDNfdGlwX2RpcmVjdGlvbiwKICAgICAgICBvZmZzZXQgICAgPSBkM190aXBfb2Zmc2V0LAogICAgICAgIGh0bWwgICAgICA9IGQzX3RpcF9odG1sLAogICAgICAgIG5vZGUgICAgICA9IGluaXROb2RlKCksCiAgICAgICAgc3ZnICAgICAgID0gbnVsbCwKICAgICAgICBwb2ludCAgICAgPSBudWxsLAogICAgICAgIHRhcmdldCAgICA9IG51bGwKCiAgICBmdW5jdGlvbiB0aXAodmlzKSB7CiAgICAgIHN2ZyA9IGdldFNWR05vZGUodmlzKQogICAgICBwb2ludCA9IHN2Zy5jcmVhdGVTVkdQb2ludCgpCiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobm9kZSkKICAgIH0KCiAgICAvLyBQdWJsaWMgLSBzaG93IHRoZSB0b29sdGlwIG9uIHRoZSBzY3JlZW4KICAgIC8vCiAgICAvLyBSZXR1cm5zIGEgdGlwCiAgICB0aXAuc2hvdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykKICAgICAgaWYoYXJnc1thcmdzLmxlbmd0aCAtIDFdIGluc3RhbmNlb2YgU1ZHRWxlbWVudCkgdGFyZ2V0ID0gYXJncy5wb3AoKQoKICAgICAgdmFyIGNvbnRlbnQgPSBodG1sLmFwcGx5KHRoaXMsIGFyZ3MpLAogICAgICAgICAgcG9mZnNldCA9IG9mZnNldC5hcHBseSh0aGlzLCBhcmdzKSwKICAgICAgICAgIGRpciAgICAgPSBkaXJlY3Rpb24uYXBwbHkodGhpcywgYXJncyksCiAgICAgICAgICBub2RlbCAgID0gZDMuc2VsZWN0KG5vZGUpLAogICAgICAgICAgaSAgICAgICA9IGRpcmVjdGlvbnMubGVuZ3RoLAogICAgICAgICAgY29vcmRzLAogICAgICAgICAgc2Nyb2xsVG9wICA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsCiAgICAgICAgICBzY3JvbGxMZWZ0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0CgogICAgICBub2RlbC5odG1sKGNvbnRlbnQpCiAgICAgICAgLnN0eWxlKHsgb3BhY2l0eTogMSwgJ3BvaW50ZXItZXZlbnRzJzogJ2FsbCcgfSkKCiAgICAgIHdoaWxlKGktLSkgbm9kZWwuY2xhc3NlZChkaXJlY3Rpb25zW2ldLCBmYWxzZSkKICAgICAgY29vcmRzID0gZGlyZWN0aW9uX2NhbGxiYWNrcy5nZXQoZGlyKS5hcHBseSh0aGlzKQogICAgICBub2RlbC5jbGFzc2VkKGRpciwgdHJ1ZSkuc3R5bGUoewogICAgICAgIHRvcDogKGNvb3Jkcy50b3AgKyAgcG9mZnNldFswXSkgKyBzY3JvbGxUb3AgKyAncHgnLAogICAgICAgIGxlZnQ6IChjb29yZHMubGVmdCArIHBvZmZzZXRbMV0pICsgc2Nyb2xsTGVmdCArICdweCcKICAgICAgfSkKCiAgICAgIHJldHVybiB0aXAKICAgIH0KCiAgICAvLyBQdWJsaWMgLSBoaWRlIHRoZSB0b29sdGlwCiAgICAvLwogICAgLy8gUmV0dXJucyBhIHRpcAogICAgdGlwLmhpZGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG5vZGVsID0gZDMuc2VsZWN0KG5vZGUpCiAgICAgIG5vZGVsLnN0eWxlKHsgb3BhY2l0eTogMCwgJ3BvaW50ZXItZXZlbnRzJzogJ25vbmUnIH0pCiAgICAgIHJldHVybiB0aXAKICAgIH0KCiAgICAvLyBQdWJsaWM6IFByb3h5IGF0dHIgY2FsbHMgdG8gdGhlIGQzIHRpcCBjb250YWluZXIuICBTZXRzIG9yIGdldHMgYXR0cmlidXRlIHZhbHVlLgogICAgLy8KICAgIC8vIG4gLSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUKICAgIC8vIHYgLSB2YWx1ZSBvZiB0aGUgYXR0cmlidXRlCiAgICAvLwogICAgLy8gUmV0dXJucyB0aXAgb3IgYXR0cmlidXRlIHZhbHVlCiAgICB0aXAuYXR0ciA9IGZ1bmN0aW9uKG4sIHYpIHsKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyICYmIHR5cGVvZiBuID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBkMy5zZWxlY3Qobm9kZSkuYXR0cihuKQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBhcmdzID0gIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykKICAgICAgICBkMy5zZWxlY3Rpb24ucHJvdG90eXBlLmF0dHIuYXBwbHkoZDMuc2VsZWN0KG5vZGUpLCBhcmdzKQogICAgICB9CgogICAgICByZXR1cm4gdGlwCiAgICB9CgogICAgLy8gUHVibGljOiBQcm94eSBzdHlsZSBjYWxscyB0byB0aGUgZDMgdGlwIGNvbnRhaW5lci4gIFNldHMgb3IgZ2V0cyBhIHN0eWxlIHZhbHVlLgogICAgLy8KICAgIC8vIG4gLSBuYW1lIG9mIHRoZSBwcm9wZXJ0eQogICAgLy8gdiAtIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eQogICAgLy8KICAgIC8vIFJldHVybnMgdGlwIG9yIHN0eWxlIHByb3BlcnR5IHZhbHVlCiAgICB0aXAuc3R5bGUgPSBmdW5jdGlvbihuLCB2KSB7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMiAmJiB0eXBlb2YgbiA9PT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gZDMuc2VsZWN0KG5vZGUpLnN0eWxlKG4pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGFyZ3MgPSAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKQogICAgICAgIGQzLnNlbGVjdGlvbi5wcm90b3R5cGUuc3R5bGUuYXBwbHkoZDMuc2VsZWN0KG5vZGUpLCBhcmdzKQogICAgICB9CgogICAgICByZXR1cm4gdGlwCiAgICB9CgogICAgLy8gUHVibGljOiBTZXQgb3IgZ2V0IHRoZSBkaXJlY3Rpb24gb2YgdGhlIHRvb2x0aXAKICAgIC8vCiAgICAvLyB2IC0gT25lIG9mIG4obm9ydGgpLCBzKHNvdXRoKSwgZShlYXN0KSwgb3Igdyh3ZXN0KSwgbncobm9ydGh3ZXN0KSwKICAgIC8vICAgICBzdyhzb3V0aHdlc3QpLCBuZShub3J0aGVhc3QpIG9yIHNlKHNvdXRoZWFzdCkKICAgIC8vCiAgICAvLyBSZXR1cm5zIHRpcCBvciBkaXJlY3Rpb24KICAgIHRpcC5kaXJlY3Rpb24gPSBmdW5jdGlvbih2KSB7CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIGRpcmVjdGlvbgogICAgICBkaXJlY3Rpb24gPSB2ID09IG51bGwgPyB2IDogZDMuZnVuY3Rvcih2KQoKICAgICAgcmV0dXJuIHRpcAogICAgfQoKICAgIC8vIFB1YmxpYzogU2V0cyBvciBnZXRzIHRoZSBvZmZzZXQgb2YgdGhlIHRpcAogICAgLy8KICAgIC8vIHYgLSBBcnJheSBvZiBbeCwgeV0gb2Zmc2V0CiAgICAvLwogICAgLy8gUmV0dXJucyBvZmZzZXQgb3IKICAgIHRpcC5vZmZzZXQgPSBmdW5jdGlvbih2KSB7CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIG9mZnNldAogICAgICBvZmZzZXQgPSB2ID09IG51bGwgPyB2IDogZDMuZnVuY3Rvcih2KQoKICAgICAgcmV0dXJuIHRpcAogICAgfQoKICAgIC8vIFB1YmxpYzogc2V0cyBvciBnZXRzIHRoZSBodG1sIHZhbHVlIG9mIHRoZSB0b29sdGlwCiAgICAvLwogICAgLy8gdiAtIFN0cmluZyB2YWx1ZSBvZiB0aGUgdGlwCiAgICAvLwogICAgLy8gUmV0dXJucyBodG1sIHZhbHVlIG9yIHRpcAogICAgdGlwLmh0bWwgPSBmdW5jdGlvbih2KSB7CiAgICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIGh0bWwKICAgICAgaHRtbCA9IHYgPT0gbnVsbCA/IHYgOiBkMy5mdW5jdG9yKHYpCgogICAgICByZXR1cm4gdGlwCiAgICB9CgogICAgZnVuY3Rpb24gZDNfdGlwX2RpcmVjdGlvbigpIHsgcmV0dXJuICduJyB9CiAgICBmdW5jdGlvbiBkM190aXBfb2Zmc2V0KCkgeyByZXR1cm4gWzAsIDBdIH0KICAgIGZ1bmN0aW9uIGQzX3RpcF9odG1sKCkgeyByZXR1cm4gJyAnIH0KCiAgICB2YXIgZGlyZWN0aW9uX2NhbGxiYWNrcyA9IGQzLm1hcCh7CiAgICAgIG46ICBkaXJlY3Rpb25fbiwKICAgICAgczogIGRpcmVjdGlvbl9zLAogICAgICBlOiAgZGlyZWN0aW9uX2UsCiAgICAgIHc6ICBkaXJlY3Rpb25fdywKICAgICAgbnc6IGRpcmVjdGlvbl9udywKICAgICAgbmU6IGRpcmVjdGlvbl9uZSwKICAgICAgc3c6IGRpcmVjdGlvbl9zdywKICAgICAgc2U6IGRpcmVjdGlvbl9zZQogICAgfSksCgogICAgZGlyZWN0aW9ucyA9IGRpcmVjdGlvbl9jYWxsYmFja3Mua2V5cygpCgogICAgZnVuY3Rpb24gZGlyZWN0aW9uX24oKSB7CiAgICAgIHZhciBiYm94ID0gZ2V0U2NyZWVuQkJveCgpCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9wOiAgYmJveC5uLnkgLSBub2RlLm9mZnNldEhlaWdodCwKICAgICAgICBsZWZ0OiBiYm94Lm4ueCAtIG5vZGUub2Zmc2V0V2lkdGggLyAyCiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkaXJlY3Rpb25fcygpIHsKICAgICAgdmFyIGJib3ggPSBnZXRTY3JlZW5CQm94KCkKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6ICBiYm94LnMueSwKICAgICAgICBsZWZ0OiBiYm94LnMueCAtIG5vZGUub2Zmc2V0V2lkdGggLyAyCiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkaXJlY3Rpb25fZSgpIHsKICAgICAgdmFyIGJib3ggPSBnZXRTY3JlZW5CQm94KCkKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6ICBiYm94LmUueSAtIG5vZGUub2Zmc2V0SGVpZ2h0IC8gMiwKICAgICAgICBsZWZ0OiBiYm94LmUueAogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZGlyZWN0aW9uX3coKSB7CiAgICAgIHZhciBiYm94ID0gZ2V0U2NyZWVuQkJveCgpCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9wOiAgYmJveC53LnkgLSBub2RlLm9mZnNldEhlaWdodCAvIDIsCiAgICAgICAgbGVmdDogYmJveC53LnggLSBub2RlLm9mZnNldFdpZHRoCiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkaXJlY3Rpb25fbncoKSB7CiAgICAgIHZhciBiYm94ID0gZ2V0U2NyZWVuQkJveCgpCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9wOiAgYmJveC5udy55IC0gbm9kZS5vZmZzZXRIZWlnaHQsCiAgICAgICAgbGVmdDogYmJveC5udy54IC0gbm9kZS5vZmZzZXRXaWR0aAogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZGlyZWN0aW9uX25lKCkgewogICAgICB2YXIgYmJveCA9IGdldFNjcmVlbkJCb3goKQogICAgICByZXR1cm4gewogICAgICAgIHRvcDogIGJib3gubmUueSAtIG5vZGUub2Zmc2V0SGVpZ2h0LAogICAgICAgIGxlZnQ6IGJib3gubmUueAogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZGlyZWN0aW9uX3N3KCkgewogICAgICB2YXIgYmJveCA9IGdldFNjcmVlbkJCb3goKQogICAgICByZXR1cm4gewogICAgICAgIHRvcDogIGJib3guc3cueSwKICAgICAgICBsZWZ0OiBiYm94LnN3LnggLSBub2RlLm9mZnNldFdpZHRoCiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBkaXJlY3Rpb25fc2UoKSB7CiAgICAgIHZhciBiYm94ID0gZ2V0U2NyZWVuQkJveCgpCiAgICAgIHJldHVybiB7CiAgICAgICAgdG9wOiAgYmJveC5zZS55LAogICAgICAgIGxlZnQ6IGJib3guZS54CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpbml0Tm9kZSgpIHsKICAgICAgdmFyIG5vZGUgPSBkMy5zZWxlY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpCiAgICAgIG5vZGUuc3R5bGUoewogICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLAogICAgICAgIHRvcDogMCwKICAgICAgICBvcGFjaXR5OiAwLAogICAgICAgICdwb2ludGVyLWV2ZW50cyc6ICdub25lJywKICAgICAgICAnYm94LXNpemluZyc6ICdib3JkZXItYm94JwogICAgICB9KQoKICAgICAgcmV0dXJuIG5vZGUubm9kZSgpCiAgICB9CgogICAgZnVuY3Rpb24gZ2V0U1ZHTm9kZShlbCkgewogICAgICBlbCA9IGVsLm5vZGUoKQogICAgICBpZihlbC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzdmcnKQogICAgICAgIHJldHVybiBlbAoKICAgICAgcmV0dXJuIGVsLm93bmVyU1ZHRWxlbWVudAogICAgfQoKICAgIC8vIFByaXZhdGUgLSBnZXRzIHRoZSBzY3JlZW4gY29vcmRpbmF0ZXMgb2YgYSBzaGFwZQogICAgLy8KICAgIC8vIEdpdmVuIGEgc2hhcGUgb24gdGhlIHNjcmVlbiwgd2lsbCByZXR1cm4gYW4gU1ZHUG9pbnQgZm9yIHRoZSBkaXJlY3Rpb25zCiAgICAvLyBuKG5vcnRoKSwgcyhzb3V0aCksIGUoZWFzdCksIHcod2VzdCksIG5lKG5vcnRoZWFzdCksIHNlKHNvdXRoZWFzdCksIG53KG5vcnRod2VzdCksCiAgICAvLyBzdyhzb3V0aHdlc3QpLgogICAgLy8KICAgIC8vICAgICstKy0rCiAgICAvLyAgICB8ICAgfAogICAgLy8gICAgKyAgICsKICAgIC8vICAgIHwgICB8CiAgICAvLyAgICArLSstKwogICAgLy8KICAgIC8vIFJldHVybnMgYW4gT2JqZWN0IHtuLCBzLCBlLCB3LCBudywgc3csIG5lLCBzZX0KICAgIGZ1bmN0aW9uIGdldFNjcmVlbkJCb3goKSB7CiAgICAgIHZhciB0YXJnZXRlbCAgID0gdGFyZ2V0IHx8IGQzLmV2ZW50LnRhcmdldCwKICAgICAgICAgIGJib3ggICAgICAgPSB7fSwKICAgICAgICAgIG1hdHJpeCAgICAgPSB0YXJnZXRlbC5nZXRTY3JlZW5DVE0oKSwKICAgICAgICAgIHRiYm94ICAgICAgPSB0YXJnZXRlbC5nZXRCQm94KCksCiAgICAgICAgICB3aWR0aCAgICAgID0gdGJib3gud2lkdGgsCiAgICAgICAgICBoZWlnaHQgICAgID0gdGJib3guaGVpZ2h0LAogICAgICAgICAgeCAgICAgICAgICA9IHRiYm94LngsCiAgICAgICAgICB5ICAgICAgICAgID0gdGJib3gueQoKICAgICAgcG9pbnQueCA9IHgKICAgICAgcG9pbnQueSA9IHkKICAgICAgYmJveC5udyA9IHBvaW50Lm1hdHJpeFRyYW5zZm9ybShtYXRyaXgpCiAgICAgIHBvaW50LnggKz0gd2lkdGgKICAgICAgYmJveC5uZSA9IHBvaW50Lm1hdHJpeFRyYW5zZm9ybShtYXRyaXgpCiAgICAgIHBvaW50LnkgKz0gaGVpZ2h0CiAgICAgIGJib3guc2UgPSBwb2ludC5tYXRyaXhUcmFuc2Zvcm0obWF0cml4KQogICAgICBwb2ludC54IC09IHdpZHRoCiAgICAgIGJib3guc3cgPSBwb2ludC5tYXRyaXhUcmFuc2Zvcm0obWF0cml4KQogICAgICBwb2ludC55IC09IGhlaWdodCAvIDIKICAgICAgYmJveC53ICA9IHBvaW50Lm1hdHJpeFRyYW5zZm9ybShtYXRyaXgpCiAgICAgIHBvaW50LnggKz0gd2lkdGgKICAgICAgYmJveC5lID0gcG9pbnQubWF0cml4VHJhbnNmb3JtKG1hdHJpeCkKICAgICAgcG9pbnQueCAtPSB3aWR0aCAvIDIKICAgICAgcG9pbnQueSAtPSBoZWlnaHQgLyAyCiAgICAgIGJib3gubiA9IHBvaW50Lm1hdHJpeFRyYW5zZm9ybShtYXRyaXgpCiAgICAgIHBvaW50LnkgKz0gaGVpZ2h0CiAgICAgIGJib3gucyA9IHBvaW50Lm1hdHJpeFRyYW5zZm9ybShtYXRyaXgpCgogICAgICByZXR1cm4gYmJveAogICAgfQoKICAgIHJldHVybiB0aXAKICB9OwoKfSkpOwo="></script>
<script src="data:application/x-javascript;base64,SFRNTFdpZGdldHMud2lkZ2V0KHsKCiAgbmFtZTogJ2QzaGVhdG1hcCcsCgogIHR5cGU6ICdvdXRwdXQnLAoKICBpbml0aWFsaXplOiBmdW5jdGlvbihlbCwgd2lkdGgsIGhlaWdodCkgewoKICAgIHJldHVybiB7CiAgICAgIGxhc3RUaGVtZTogbnVsbCwKICAgICAgbGFzdFZhbHVlOiBudWxsCiAgICB9OwoKICB9LAogIAogIHJlbmRlclZhbHVlOiBmdW5jdGlvbihlbCwgeCwgaW5zdGFuY2UpIHsKICAgIHRoaXMuZG9SZW5kZXJWYWx1ZShlbCwgeCwgaW5zdGFuY2UpOwogIH0sCgogIC8vIE5lZWQgZGVkaWNhdGVkIGhlbHBlciBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgYnkgYm90aCByZW5kZXJWYWx1ZQogIC8vIGFuZCByZXNpemUuIHJlc2l6ZSBjYW4ndCBjYWxsIHRoaXMucmVuZGVyVmFsdWUgYmVjYXVzZSB0aGF0IHdpbGwgYmUKICAvLyByb3V0ZWQgdG8gdGhlIFNoaW55IHdyYXBwZXIgbWV0aG9kIGZyb20gaHRtbHdpZGdldHMsIHdoaWNoIGV4cGVjdHMgdGhlCiAgLy8gd3JhcHBlciBkYXRhIG9iamVjdCwgbm90IHguCiAgZG9SZW5kZXJWYWx1ZTogZnVuY3Rpb24oZWwsIHgsIGluc3RhbmNlKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAKICAgIGluc3RhbmNlLmxhc3RWYWx1ZSA9IHg7CiAgICAKICAgIGlmIChpbnN0YW5jZS5sYXN0VGhlbWUgJiYgaW5zdGFuY2UubGFzdFRoZW1lICE9IHgudGhlbWUpIHsKICAgICAgZDMuc2VsZWN0KGRvY3VtZW50LmJvZHkpLmNsYXNzZWQoInRoZW1lLSIgKyBpbnN0YW5jZS5sYXN0VGhlbWUsIGZhbHNlKTsKICAgIH0KICAgIGlmICh4LnRoZW1lKSB7CiAgICAgIGQzLnNlbGVjdChkb2N1bWVudC5ib2R5KS5jbGFzc2VkKCJ0aGVtZS0iICsgeC50aGVtZSwgdHJ1ZSk7CiAgICB9CgogICAgZWwuaW5uZXJIVE1MID0gIiI7CiAgICAKICAgIHRoaXMubG9hZEltYWdlKHguaW1hZ2UsIGZ1bmN0aW9uKGltZ0RhdGEsIHcsIGgpIHsKICAgICAgCiAgICAgIGlmICh3ICE9PSB4Lm1hdHJpeC5kaW1bMF0gfHwgaCAhPT0geC5tYXRyaXguZGltWzFdKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDb2xvciBkaW1lbnNpb25zIGRpZG4ndCBtYXRjaCBkYXRhIGRpbWVuc2lvbnMiKQogICAgICB9CiAgICAgIAogICAgICB2YXIgbWVyZ2VkID0gW107CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgeC5tYXRyaXguZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciByID0gaW1nRGF0YVtpKjRdOwogICAgICAgIHZhciBnID0gaW1nRGF0YVtpKjQrMV07CiAgICAgICAgdmFyIGIgPSBpbWdEYXRhW2kqNCsyXTsKICAgICAgICB2YXIgYSA9IGltZ0RhdGFbaSo0KzNdOwogICAgICAgIG1lcmdlZC5wdXNoKHsKICAgICAgICAgIGxhYmVsOiB4Lm1hdHJpeC5kYXRhW2ldLAogICAgICAgICAgY29sb3I6ICJyZ2JhKCIgKyBbcixnLGIsYS8yNTVdLmpvaW4oIiwiKSArICIpIgogICAgICAgIH0pCiAgICAgIH0KICAgICAgeC5tYXRyaXgubWVyZ2VkID0gbWVyZ2VkOwogICAgICAvL2NvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHttZXJnZWQ6IHgubWF0cml4Lm1lcmdlZH0sIG51bGwsICIgICIpKTsKCiAgICAgIHZhciBobSA9IGhlYXRtYXAoZWwsIHgsIHgub3B0aW9ucyk7CiAgICAgIGlmICh3aW5kb3cuU2hpbnkpIHsKICAgICAgICB2YXIgaWQgPSBzZWxmLmdldElkKGVsKTsKICAgICAgICBobS5vbignaG92ZXInLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICBTaGlueS5vbklucHV0Q2hhbmdlKGlkICsgJ19ob3ZlcicsICFlLmRhdGEgPyBlLmRhdGEgOiB7CiAgICAgICAgICAgIGxhYmVsOiBlLmRhdGEubGFiZWwsCiAgICAgICAgICAgIHJvdzogeC5tYXRyaXgucm93c1tlLmRhdGEucm93XSwKICAgICAgICAgICAgY29sOiB4Lm1hdHJpeC5jb2xzW2UuZGF0YS5jb2xdCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICAvKiBoZWF0bWFwIGRvZXNuJ3QgY3VycmVudGx5IHNlbmQgY2xpY2ssIHNpbmNlIGl0IG1lYW5zIHpvb20tb3V0CiAgICAgICAgaG0ub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgU2hpbnkub25JbnB1dENoYW5nZShpZCArICdfY2xpY2snLCAhZS5kYXRhID8gZS5kYXRhIDogewogICAgICAgICAgICBsYWJlbDogZS5kYXRhLmxhYmVsLAogICAgICAgICAgICByb3c6IGUuZGF0YS5yb3cgKyAxLAogICAgICAgICAgICBjb2w6IGUuZGF0YS5jb2wgKyAxCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICAqLwogIAkgIH0KICAgIH0pOwogIH0sCgogIHJlc2l6ZTogZnVuY3Rpb24oZWwsIHdpZHRoLCBoZWlnaHQsIGluc3RhbmNlKSB7CiAgICBpZiAoaW5zdGFuY2UubGFzdFZhbHVlKSB7CiAgICAgIHRoaXMuZG9SZW5kZXJWYWx1ZShlbCwgaW5zdGFuY2UubGFzdFZhbHVlLCBpbnN0YW5jZSk7CiAgICB9CiAgfSwKICAKICBsb2FkSW1hZ2U6IGZ1bmN0aW9uKHVyaSwgY2FsbGJhY2spIHsKICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTsKICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgLy8gU2F2ZSBzaXplCiAgICAgIHcgPSBpbWcud2lkdGg7CiAgICAgIGggPSBpbWcuaGVpZ2h0OwoKICAgICAgLy8gQ3JlYXRlIGEgZHVtbXkgY2FudmFzIHRvIGV4dHJhY3QgdGhlIGltYWdlIGRhdGEKICAgICAgdmFyIGltZ0RhdGFDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgaW1nRGF0YUNhbnZhcy53aWR0aCA9IHc7CiAgICAgIGltZ0RhdGFDYW52YXMuaGVpZ2h0ID0gaDsKICAgICAgaW1nRGF0YUNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGltZ0RhdGFDYW52YXMpOwoKICAgICAgdmFyIGltZ0RhdGFDdHggPSBpbWdEYXRhQ2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgIGltZ0RhdGFDdHguZHJhd0ltYWdlKGltZywgMCwgMCk7CgogICAgICAvLyBTYXZlIHRoZSBpbWFnZSBkYXRhLgogICAgICBpbWdEYXRhID0gaW1nRGF0YUN0eC5nZXRJbWFnZURhdGEoMCwgMCwgdywgaCkuZGF0YTsKCiAgICAgIC8vIERvbmUgd2l0aCB0aGUgY2FudmFzLCByZW1vdmUgaXQgZnJvbSB0aGUgcGFnZSBzbyBpdCBjYW4gYmUgZ2MnZC4KICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChpbWdEYXRhQ2FudmFzKTsKICAgICAgCiAgICAgIGNhbGxiYWNrKGltZ0RhdGEsIHcsIGgpOwogICAgfTsKICAgIGltZy5zcmMgPSB1cmk7CiAgfQoKfSk7Cg=="></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to dendextend</h1>
<h4 class="author"><em>Tal Galili</em></h4>
<h4 class="date"><em>2018-02-10</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a><ul>
<li><a href="#acknowledgement">Acknowledgement</a></li>
<li><a href="#chaining">Chaining</a></li>
<li><a href="#a-dendrogram-is-a-nested-list-of-lists-with-attributes">A dendrogram is a nested list of lists with attributes</a></li>
<li><a href="#installation">Installation</a></li>
</ul></li>
<li><a href="#how-to-explore-a-dendrograms-parameters">How to explore a dendrogram’s parameters</a><ul>
<li><a href="#taking-a-first-look-at-a-dendrogram">Taking a first look at a dendrogram</a></li>
<li><a href="#getting-nodes-attributes-in-a-depth-first-search">Getting nodes attributes in a depth-first search</a></li>
</ul></li>
<li><a href="#how-to-change-a-dendrogram">How to change a dendrogram</a><ul>
<li><a href="#the-set-function">The “set” function</a></li>
<li><a href="#two-simple-trees-to-play-with">Two simple trees to play with</a></li>
<li><a href="#setting-a-dendrograms-labels">Setting a dendrogram’s labels</a></li>
<li><a href="#setting-a-dendrograms-nodesleaves-points">Setting a dendrogram’s nodes/leaves (points)</a></li>
<li><a href="#setting-a-dendrograms-branches">Setting a dendrogram’s branches</a></li>
<li><a href="#changing-a-dendrograms-structure">Changing a dendrogram’s structure</a></li>
<li><a href="#adding-extra-bars-and-rectangles">Adding extra bars and rectangles</a></li>
</ul></li>
<li><a href="#ggplot2-integration">ggplot2 integration</a></li>
<li><a href="#enhancing-other-packages">Enhancing other packages</a><ul>
<li><a href="#dendser">DendSer</a></li>
<li><a href="#gplots">gplots</a></li>
<li><a href="#nmf">NMF</a></li>
<li><a href="#d3heatmap">d3heatmap</a></li>
<li><a href="#dynamictreecut">dynamicTreeCut</a></li>
<li><a href="#pvclust">pvclust</a></li>
<li><a href="#circlize">circlize</a></li>
</ul></li>
<li><a href="#comparing-two-dendrograms">Comparing two dendrograms</a><ul>
<li><a href="#dendlist">dendlist</a></li>
<li><a href="#dend_diff">dend_diff</a></li>
<li><a href="#tanglegram">tanglegram</a></li>
<li><a href="#correlation-measures">Correlation measures</a></li>
<li><a href="#the-fowlkes-mallows-index-and-the-bk-plot">The Fowlkes-Mallows Index and the Bk plot</a></li>
</ul></li>
<li><a href="#dendextendrcpp---on-the-need-for-speed">dendextendRcpp - on the need for speed</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</div>

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Introduction to dendextend}
-->
<p><strong>Author</strong>: <a href="http://www.r-statistics.com/">Tal Galili</a> ( <a href="mailto:Tal.Galili@gmail.com">Tal.Galili@gmail.com</a> )</p>
<p><strong>tl;dr</strong>: the <a href="https://cran.r-project.org/package=dendextend"><em>dendextend package</em></a> let’s you create figures like this:</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAg0AAAINCAMAAACKxrymAAACbVBMVEUAAAAAADoAAGYAOjoAOpAAZAAAZrYAj7cAj8MAj88AkjIAkloAkn4Aos8AotsAploApqAAtucAuMEAzQA6AAA6OgA6Ojo6ZrY6j7c6j8M6j886kLY6kNs6kjI6kn46ots6tuc6yNs6yPM6yuBmAABmAGZmOmZmOpBmZjpmZmZmZrZmj7dmj8Nmj89mkLZmkNtmkjJmordmottmtrZmts9mtttmtv9m2/9m3P+LAACQOgCQOjqQOmaQZgCQZjqQZmaQZpCQkDqQkGaQkLaQoreQosOQos+QpjKQtpCQttuQtv+QyMOQ27aQ2/+Q7eeQ7f+RdgCRdjqRdmaRj2aRj5CRprajUtGjUtmjUuGjcuGjcuijkPCldgCldjqldmalj2alj5ClpralvZClvduzUtGzUuGzrfe2ZgC2Zjq2Zma2kJC2tma2tre2tsO2uDK225C2/7a2//+4dgC4djq4dma4jwC4j5C4pjq4pma41P/CUtHCctHCyffCyf/KjwDKjzrKj2bKpgDKvTrKvWbK6bbK6f/MR2vMR4bMR5/MaYbMaZ/MabnMitDSctHSkNHS5P/VR2vVip/VqNDVqOfbkDrbkGbbkJDbpgDbpjrbtmbbyMPbylrb25Db2//b3H7b/9vb/+Db///dR2vdaWvdxtDdxv/hkNHh//fh///maWvmxrnm4//tvTrt///uimvu/+fu///wrdnwyeHw//fw///3qIb3xp/3////tmb/tpD/xp//yeH/1Gb/25D/28//3H7/47n/5Oj/6ZD/7aD/7dv//7b//8H//9D//9v//+D//+f///D///P///f///9YV01TAAAACXBIWXMAAAuIAAALiAHljilJAAAWJ0lEQVR4nO2ci59c5V2HzyawoVsvyG6I2sELRKFby2LVgaSxpq0KXsakWFI0WC9od1NQWHpRqhRvLCjURpktGsC6KEglIKix08AABQYGiudv8r2cM98zM2dnd2bO3M55nk8y8573fc8l83vO+/7eM7sJQoCYYNIXAFMENoDABhDYAAIbQGADCGwAgQ0gsAEENoDABhDYAAIbQGADCGwAgQ0gsAEENoDABhDYAAIbQGADCGwAgQ0gsAEENoDABhDYAAIbQGADCGwAgQ0gsAEENoDA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" style="display: block; margin: auto;" /></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <a href="https://cran.r-project.org/package=dendextend"><strong><em>dendextend package</em></strong></a> offers a set of functions for extending dendrogram objects in R, letting you <strong>visualize</strong> and <strong>compare</strong> trees of hierarchical clusterings, you can:</p>
<ul>
<li><strong>Adjust a tree’s graphical parameters</strong> - the color, size, type, etc of its branches, nodes and labels.</li>
<li>Visually and statistically <strong>compare different dendrograms</strong> to one another.</li>
</ul>
<p>The goal of this document is to introduce you to the basic functions that dendextend provides, and show how they may be applied. We will make extensive use of “chaining” (explained next).</p>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<div id="acknowledgement" class="section level3">
<h3>Acknowledgement</h3>
<p>This package was made possible by the the support of my thesis adviser <a href="http://www.math.tau.ac.il/~ybenja/">Yoav Benjamini</a>, as well as code contributions from many R users. They are:</p>
<pre><code>#&gt;  [1] &quot;Tal Galili &lt;tal.galili@gmail.com&gt; [aut, cre, cph] (http://www.r-statistics.com)&quot;                  
#&gt;  [2] &quot;Gavin Simpson [ctb]&quot;                                                                              
#&gt;  [3] &quot;Gregory Jefferis &lt;jefferis@gmail.com&gt; [ctb] (imported code from his dendroextras package)&quot;        
#&gt;  [4] &quot;Marco Gallotta [ctb] (a.k.a: marcog)&quot;                                                             
#&gt;  [5] &quot;Johan Renaudie [ctb] (https://github.com/plannapus)&quot;                                              
#&gt;  [6] &quot;R core team [ctb] (Thanks for the Infastructure, and code in the examples)&quot;                       
#&gt;  [7] &quot;Kurt Hornik [ctb]&quot;                                                                                
#&gt;  [8] &quot;Uwe Ligges [ctb]&quot;                                                                                 
#&gt;  [9] &quot;Andrej-Nikolai Spiess [ctb]&quot;                                                                      
#&gt; [10] &quot;Steve Horvath &lt;SHorvath@mednet.ucla.edu&gt; [ctb]&quot;                                                   
#&gt; [11] &quot;Peter Langfelder &lt;Peter.Langfelder@gmail.com&gt; [ctb]&quot;                                              
#&gt; [12] &quot;skullkey [ctb]&quot;                                                                                   
#&gt; [13] &quot;Mark Van Der Loo &lt;mark.vanderloo@gmail.com&gt; [ctb] (https://github.com/markvanderloo d3dendrogram)&quot;
#&gt; [14] &quot;Yoav Benjamini [ths]&quot;</code></pre>
<p>The <strong>design</strong> of the dendextend package (and this manual!) is heavily inspired by <a href="http://had.co.nz/">Hadley Wickham’s</a> work. Especially his text on <a href="http://r-pkgs.had.co.nz/">writing an R package</a>, the <a href="https://cran.r-project.org/package=devtools">devtools package</a>, and the dplyr package (specifically the use of chaining, and the <a href="https://CRAN.R-project.org/package=dplyr/vignettes/dplyr.html">Introduction text to dplyr</a>).</p>
</div>
<div id="chaining" class="section level3">
<h3>Chaining</h3>
<p>Function calls in dendextend often get a dendrogram and returns a (modified) dendrogram. This doesn’t lead to particularly elegant code if you want to do many operations at once. The same is true even in the first stage of creating a dendrogram.</p>
<p>In order to construct a dendrogram, you will (often) need to go through several steps. You can either do so while keeping the intermediate results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>) <span class="co"># some data</span>
d2 &lt;-<span class="st"> </span><span class="kw">dist</span>(d1)
d3 &lt;-<span class="st"> </span><span class="kw">hclust</span>(d2, <span class="dt">method =</span> <span class="st">&quot;average&quot;</span>)
dend &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(d3)</code></pre></div>
<p>Or, you can also wrap the function calls inside each other:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(<span class="kw">hclust</span>(<span class="kw">dist</span>(<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>)), <span class="dt">method =</span> <span class="st">&quot;average&quot;</span>))</code></pre></div>
<p>However, both solutions are not ideal: the first solution includes redundant intermediate objects, while the second is difficult to read (since the order of the operations is from inside to out, while the arguments are a long way away from the function).</p>
<p>To get around this problem, dendextend encourages the use of the <code>%&gt;%</code> (“pipe” or “chaining”) operator (imported from the magrittr package). This turns <code>x %&gt;% f(y)</code> into <code>f(x, y)</code> so you can use it to rewrite (“chain”) multiple operations such that they can be read from left-to-right, top-to-bottom.</p>
<p>For example, the following will be written as it would be explained:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>) %&gt;%<span class="st"> </span><span class="co"># take the a vector from 1 to 5</span>
<span class="st">         </span>dist %&gt;%<span class="st"> </span><span class="co"># calculate a distance matrix, </span>
<span class="st">         </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># on it compute hierarchical clustering using the &quot;average&quot; method, </span>
<span class="st">         </span>as.dendrogram <span class="co"># and lastly, turn that object into a dendrogram.</span></code></pre></div>
<p>For more details, you may look at:</p>
<ul>
<li><a href="https://cran.r-project.org/package=magrittr">magrittr on CRAN</a></li>
<li><a href="https://CRAN.R-project.org/package=magrittr/vignettes/magrittr.html">Introduction to the magrittr package</a></li>
<li><a href="http://www.r-statistics.com/2014/08/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/">Simpler R coding with pipes &gt; the present and future of the magrittr package</a></li>
</ul>
</div>
<div id="a-dendrogram-is-a-nested-list-of-lists-with-attributes" class="section level3">
<h3>A dendrogram is a nested list of lists with attributes</h3>
<p>The first step is working with dendrograms, is to understand that they are just a <strong>nested list of lists with attributes</strong>. Let us explore this for the following (tiny) tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a dend:</span>
dend &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">2</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
<span class="co"># and plot it:</span>
dend %&gt;%<span class="st"> </span>plot</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAASFBMVEUAAAAAAGYAOpAAZrY6AAA6AGY6kNtmAABmADpmAGZmtv+QOgCQ2/+2ZgC2/9u2///bkDrb25Db////tmb/25D//7b//9v////xi/IkAAAACXBIWXMAAAuIAAALiAHljilJAAADK0lEQVR4nO3b607bQBQAYYcU0hIghlz8/m/a5iYhXJWdXfusup6Rqv7as9GHY5zYdIMl19V+Af9TYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSC5SD1d3L3XP+Ml/Zdy+8wtr5j2ax6u8gVtBYsQLWihW0Z9UdxAoaK9bXjptu9bbtunXG2tw9i6uF9fo87LvnYejHWmJ96fjz5fJvODzupnpJbWP92omVNNa3IRjrCX6asWIFrG0f69MJvvjLv8x11XfwyAoaK9ao1+tb7ilnbe6epVW7znr4uP7vdVbSFfwlr+DFmnbs/e13fzuStbl7FlftBN97gp9irFgBa8UK2rPqDmIFjRUrYK1YQXtW3UGsmcf65V/gWrGC9qy6g1hBY8UKWCtW0J5VdxAraKxYf68ff6ks1qjj5n65vvKGxbdjDz/O3757ZCWO7f8cU2Kljj1u1mKlj913YhWOFStgbftYPvnnkRU2VqxRPvmXPtYn/9LH+jAbGCsWGeuTf2SsT/5NMlasgLViBe1ZdQexgsaKFbBWrKA9q+4g1sxj/fIvcK1YQXtW3UGsoLFiBawVK2jPqjuIFTRWrIC1DWN53zB9rPcN08d6KwyMFYuM9b4hGet9w0nGihWwtn0sH5OMeOENJRao5OPO4ir5uLO4Sq7gF5dYoJKPO4ur5OPO4mrv0uG0vf5kZzhvtId1Pm+czxkNYP3rD9Sn2eDyG2m/2jWANfsF2+3X9/7hvQWs03be3xW3H0Y/w6Hb3jnrtL1piVU1sUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRIL9BvgtXw0ryjIfgAAAABJRU5ErkJggg==" /><!-- --></p>
<p>And here is its structure (a nested list of lists with attributes):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>unclass %&gt;%<span class="st"> </span>str</code></pre></div>
<pre><code>#&gt; List of 2
#&gt;  $ : atomic [1:1] 1
#&gt;   ..- attr(*, &quot;label&quot;)= int 1
#&gt;   ..- attr(*, &quot;members&quot;)= int 1
#&gt;   ..- attr(*, &quot;height&quot;)= num 0
#&gt;   ..- attr(*, &quot;leaf&quot;)= logi TRUE
#&gt;  $ : atomic [1:1] 2
#&gt;   ..- attr(*, &quot;label&quot;)= int 2
#&gt;   ..- attr(*, &quot;members&quot;)= int 1
#&gt;   ..- attr(*, &quot;height&quot;)= num 0
#&gt;   ..- attr(*, &quot;leaf&quot;)= logi TRUE
#&gt;  - attr(*, &quot;members&quot;)= int 2
#&gt;  - attr(*, &quot;midpoint&quot;)= num 0.5
#&gt;  - attr(*, &quot;height&quot;)= num 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>class</code></pre></div>
<pre><code>#&gt; [1] &quot;dendrogram&quot;</code></pre>
</div>
<div id="installation" class="section level3">
<h3>Installation</h3>
<p>To install the stable version on CRAN use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">'dendextend'</span>)
&lt;!--<span class="st"> </span><span class="kw">install.packages</span>(<span class="st">'dendextendRcpp'</span>) --&gt;</code></pre></div>
<p>To install the GitHub version:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">require2 &lt;-<span class="st"> </span>function (package, ...) {
   if (!<span class="kw">require</span>(package)) <span class="kw">install.packages</span>(package); <span class="kw">library</span>(package)
}

## require2('installr')
## install.Rtools() # run this if you are using Windows and don't have Rtools installed

<span class="co"># Load devtools:</span>
<span class="kw">require2</span>(<span class="st">&quot;devtools&quot;</span>)
devtools::<span class="kw">install_github</span>(<span class="st">'talgalili/dendextend'</span>)
&lt;!--<span class="st"> </span><span class="kw">require2</span>(<span class="st">&quot;Rcpp&quot;</span>) --&gt;
<span class="er">&lt;</span>!--<span class="st"> </span>devtools::<span class="kw">install_github</span>(<span class="st">'talgalili/dendextendRcpp'</span>) --&gt;

<span class="co"># Having colorspace is also useful, since it is used</span>
<span class="co"># In various examples in the vignettes</span>
<span class="kw">require2</span>(<span class="st">&quot;colorspace&quot;</span>)</code></pre></div>
<p>And then you may load the package using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dendextend)
&lt;!--<span class="st"> </span><span class="kw">library</span>(dendextendRcpp) --&gt;</code></pre></div>
</div>
</div>
<div id="how-to-explore-a-dendrograms-parameters" class="section level2">
<h2>How to explore a dendrogram’s parameters</h2>
<div id="taking-a-first-look-at-a-dendrogram" class="section level3">
<h3>Taking a first look at a dendrogram</h3>
<p>For the following simple tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a dend:</span>
dend &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
<span class="co"># Plot it:</span>
dend %&gt;%<span class="st"> </span>plot</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAADhCAMAAABFoniZAAAARVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6AGY6kNtmAABmADpmtv+QOgCQ2/+2ZgC2///bkDrb25Db////tmb/25D//7b//9v////3ZBTTAAAACXBIWXMAAAuIAAALiAHljilJAAAD+UlEQVR4nO3dbXOaQBRAYZqXxtYYUqP8/5/amJoOUYQ9eHeXjOfM9Bt31z4jbSoFm86Sa2q/gO+UWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAiVjt/Z+8r+NbNIW1WzXH7l6KvKAlN/nOent86k7eWZ987BRuckV/y/NL2Kp9f08NnoYQCx1df92ZW+1WD2Klb7VtxLpyK7GyzYpVaKca6wZvJVa2WbEK7VRj3eCtxMo2K1ahnWqsG7yVWNlmxSq0U411g7cSK9usWIV2qrHunK12q+b+9bFpHmbMXnF0/XXnbLV56tqDVHuuJdZJu1/PH7+6t5//r+7MvGAx5+VVXHfGVkNYqbPXHF1/3TlbbY6nn6dhwlb79eG6YbcZuGIhVrZZsQrtVGPd4K3EyjYrVqGdaqwbvJVY2WbFKrRTjXWDtxIr26xYhXaqsW7wVmJlmxWr0E411g3eSqxss7eAtV83zeHjPz9WTvxY+fAxqVhpFyy6bnv3UvPqzlLuVUnD6rb3rxXfWfNHy2J9Xt1pB+4KE+u0/fqoJdb3+NFBrCKjYpXZNHg1sbLNilVmJ7GKjIpVZtPg1cTKNitWmZ3EKjIqVplNg1cTK9usWGV2EqvIaOHP4AceNpZwNSD2ekLqYbkvYkxPbgbuB5ucDVaocdisyeMtFmx2yQp1TmqxYmaXrCBW/GGhk2JFzS5ZQaz4w0InxYqaXbKCWPGHhU6KFTW7ZAWx4g8LnRQranbJCmLFHxY6KVbU7JIVcmJt/n1wPfBxqVinfT6xZ+CjeLFOOt5hQR82tmSFslg32/RpeDz9hh6gdWtNvyfbi3/A31zX/Ohwc4kFEgskFkgsUD2skdv6e338nLed/tt45BHQ5839ast6WCO39fc6YG0PAu241sgjoPurXffVlvFYiS9o6Lb+4cP2699dyhvw0lON+w18tSUoxzvr8n9/6zV2W//XwyKxRr7aMqEcWJf/+1u/kdv6e+1Wdy8fp9b4+TX2COizFYe/2jKhmn/AX7yt/0vvp/WP58l/mo48Avqs4a+2TMgfHUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBZILJBYILFAYoHEAokFEgskFkgskFggsUBigcQCiQUSCyQWSCyQWCCxQGKBxAKJBRILJBboL7CEY5TcL5ENAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Here are some basic parameters we can get:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>labels <span class="co"># get the labels of the tree</span></code></pre></div>
<pre><code>#&gt; [1] 1 2 5 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>nleaves <span class="co"># get the number of leaves of the tree</span></code></pre></div>
<pre><code>#&gt; [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>nnodes <span class="co"># get the number of nodes in the tree (including leaves)</span></code></pre></div>
<pre><code>#&gt; [1] 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>head <span class="co"># A combination of &quot;str&quot; with &quot;head&quot;</span></code></pre></div>
<pre><code>#&gt; --[dendrogram w/ 2 branches and 5 members at h = 4]
#&gt;   |--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;   |  |--leaf 1 
#&gt;   |  `--leaf 2 
#&gt;   `--[dendrogram w/ 2 branches and 3 members at h = 2]
#&gt;      |--leaf 5 
#&gt;      `--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;         |--leaf 3 
#&gt;         `--leaf 4 
#&gt; etc...</code></pre>
<p>Next let us look at more sophisticated outputs.</p>
</div>
<div id="getting-nodes-attributes-in-a-depth-first-search" class="section level3">
<h3>Getting nodes attributes in a depth-first search</h3>
<p>When extracting (or inserting) attributes from a dendrogram’s nodes, it is often in a “depth-first search”. <a href="http://en.wikipedia.org/wiki/Depth-first_search">Depth-first search</a> is when an algorithm for traversing or searching tree or graph data structures. One starts at the root and explores as far as possible along each branch before backtracking.</p>
<p>Here is a plot of a tree, illustrating the order in which you should read the “nodes attributes”:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can get several nodes attributes using <code>get_nodes_attr</code> (notice the order corresponds with what is shown in the above figure):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a dend:</span>
dend &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
<span class="co"># Get various attributes</span>
dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;height&quot;</span>) <span class="co"># node's height</span></code></pre></div>
<pre><code>#&gt; [1] 4 1 0 0 2 0 1 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span>hang.dendrogram %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;height&quot;</span>) <span class="co"># node's height (after raising the leaves)</span></code></pre></div>
<pre><code>#&gt; [1] 4.0 1.0 0.6 0.6 2.0 1.6 1.0 0.6 0.6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;members&quot;</span>) <span class="co"># number of members (leaves) under that node</span></code></pre></div>
<pre><code>#&gt; [1] 5 2 1 1 3 1 2 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;members&quot;</span>, <span class="dt">id =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)) <span class="co"># number of members for nodes 2 and 5</span></code></pre></div>
<pre><code>#&gt; [1] 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;midpoint&quot;</span>) <span class="co"># how much &quot;left&quot; is this node from its left-most child's location</span></code></pre></div>
<pre><code>#&gt; [1] 1.625 0.500    NA    NA 0.750    NA 0.500    NA    NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;leaf&quot;</span>) <span class="co"># is this node a leaf</span></code></pre></div>
<pre><code>#&gt; [1]   NA   NA TRUE TRUE   NA TRUE   NA TRUE TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;label&quot;</span>) <span class="co"># what is the label on this node</span></code></pre></div>
<pre><code>#&gt; [1] NA NA  1  2 NA  5 NA  3  4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;nodePar&quot;</span>) <span class="co"># empty (for now...)</span></code></pre></div>
<pre><code>#&gt; [1] NA NA NA NA NA NA NA NA NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;edgePar&quot;</span>) <span class="co"># empty (for now...)</span></code></pre></div>
<pre><code>#&gt; [1] NA NA NA NA NA NA NA NA NA</code></pre>
<p>A similar function for leaves only is <code>get_leaves_attr</code></p>
</div>
</div>
<div id="how-to-change-a-dendrogram" class="section level2">
<h2>How to change a dendrogram</h2>
<div id="the-set-function" class="section level3">
<h3>The “set” function</h3>
<p>The fastest way to start changing parameters with dendextend is by using the <code>set</code> function. It is written as: <code>set(object, what, value)</code>, and accepts the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>object</strong>: a dendrogram object,</li>
<li><strong>what</strong>: a character indicating what is the property of the tree that should be set/updated</li>
<li><strong>value</strong>: a vector with the value to set in the tree (the type of the value depends on the “what”). Many times, vectors which are too short are recycled.</li>
</ol>
<p>The <strong>what</strong> parameter accepts many options, each uses some general function in the background. These options deal with labels, nodes and branches. They are:</p>
<ul>
<li>labels - set the labels (using <code>labels&lt;-.dendrogram</code>)</li>
<li>labels_colors - set the labels’ colors (using <code>color_labels</code>)</li>
<li>labels_cex - set the labels’ size (using <code>assign_values_to_leaves_nodePar</code>)</li>
<li>labels_to_character - set the labels’ to be characters</li>
<li>leaves_pch - set the leaves’ point type (using <code>assign_values_to_leaves_nodePar</code>)</li>
<li>leaves_cex - set the leaves’ point size (using <code>assign_values_to_leaves_nodePar</code>)</li>
<li>leaves_col - set the leaves’ point color (using <code>assign_values_to_leaves_nodePar</code>)</li>
<li>nodes_pch - set the nodes’ point type (using <code>assign_values_to_nodes_nodePar</code>)</li>
<li>nodes_cex - set the nodes’ point size (using <code>assign_values_to_nodes_nodePar</code>)</li>
<li>nodes_col - set the nodes’ point color (using <code>assign_values_to_nodes_nodePar</code>)</li>
<li>hang_leaves - hang the leaves (using <code>hang.dendrogram</code>)</li>
<li>branches_k_color - color the branches (using <code>color_branches</code>)</li>
<li>branches_col - set the color of branches (using <code>assign_values_to_branches_edgePar</code>)</li>
<li>branches_lwd - set the line width of branches (using <code>assign_values_to_branches_edgePar</code>)</li>
<li>branches_lty - set the line type of branches (using <code>assign_values_to_branches_edgePar</code>)</li>
<li>by_labels_branches_col - set the color of branches with specific labels (using <code>branches_attr_by_labels</code>)</li>
<li>by_labels_branches_lwd - set the line width of branches with specific labels (using <code>branches_attr_by_labels</code>)</li>
<li>by_labels_branches_lty - set the line type of branches with specific labels (using <code>branches_attr_by_labels</code>)</li>
<li>clear_branches - clear branches’ attributes (using <code>remove_branches_edgePar</code>)</li>
<li>clear_leaves - clear leaves’ attributes (using <code>remove_branches_edgePar</code>)</li>
</ul>
</div>
<div id="two-simple-trees-to-play-with" class="section level3">
<h3>Two simple trees to play with</h3>
<p>For illustration purposes, we will create several small tree, and demonstrate these functions on them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend13 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="co"># take some data</span>
<span class="st">         </span>dist %&gt;%<span class="st"> </span><span class="co"># calculate a distance matrix, </span>
<span class="st">         </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span><span class="co"># on it compute hierarchical clustering using the &quot;average&quot; method, </span>
<span class="st">         </span>as.dendrogram <span class="co"># and lastly, turn that object into a dendrogram.</span>
<span class="co"># same, but for 5 leaves:</span>
dend15 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>) %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend13 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main=</span><span class="st">&quot;dend13&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main=</span><span class="st">&quot;dend15&quot;</span>)
<span class="co"># we could have also used plot(dend)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="setting-a-dendrograms-labels" class="section level3">
<h3>Setting a dendrogram’s labels</h3>
<p>We can get a vector with the tree’s labels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get the labels:</span>
dend15 %&gt;%<span class="st"> </span>labels</code></pre></div>
<pre><code>#&gt; [1] 1 2 5 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this is just like labels(dend)</span></code></pre></div>
<p>Notice how the tree’s labels are not 1 to 5 by order, since the tree happened to place them in a different order. We can change the names of the labels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># change the labels, and then print them:</span>
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels&quot;</span>, <span class="kw">c</span>(<span class="dv">111</span>:<span class="dv">115</span>)) %&gt;%<span class="st"> </span>labels</code></pre></div>
<pre><code>#&gt; [1] 111 112 113 114 115</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># could also be done using:</span>
<span class="co"># labels(dend) &lt;- c(111:115)</span></code></pre></div>
<p>We can change the type of labels to be characters. Not doing so may be a source of various bugs and problems in many functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend15 %&gt;%<span class="st"> </span>labels</code></pre></div>
<pre><code>#&gt; [1] 1 2 5 3 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_to_char&quot;</span>) %&gt;%<span class="st"> </span>labels</code></pre></div>
<pre><code>#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;5&quot; &quot;3&quot; &quot;4&quot;</code></pre>
<p>We may also change their color and size:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="st">&quot;blue&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Change label's color&quot;</span>) <span class="co"># change color </span>
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Change label's size&quot;</span>) <span class="co"># change color </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAADhCAMAAAAj4jt6AAAAgVBMVEUAAAAAADoAAGYAAP8AOjoAOpAAOv8AZrYAZv86AAA6AGY6AP86kJA6kNs6kP9mAABmADpmAP9mZjpmtv+QOgCQOv+QkDqQ27aQ2/+2ZgC2Zv+2tma225C2/7a2///bkDrbkP/b25Db2//b////tmb/tv//25D/2////7b//9v///9my47RAAAACXBIWXMAAAuIAAALiAHljilJAAAJIklEQVR4nO2di3baRhRFZdOE0NShqUlrOa1xG+zY/P8Hdl56YBAjId2R5Lv3WrEFzAMOWzODRORsDyBANvYTgPcJYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoggLNY2y7Kru/3+ZX390KVevfxxXXvP8yrSYtcuJ0H6vKRiEhXrdZM5bhGrFWPkNUux8sw8aZPW9cPwQb2sP/xo3cRMGDWvgZEU62VtR/X9y+939qX9s3aD/M4P9uaOv1fuDhPk1V8ui63bWUNVc0dV9HuWubBCCfvo62bpGytStLu7688WuinyLW9c/eEfnTBp8wrbfjQLA2W9yZ5IivW8KneSl7V76h9++Ndgd6BwRxj+zUvM3cZNKF+83LJorUSxT/oSvhPfTllo6QtVN2qRTpWkeRXbVU1zf73JnkiKtcvqQd3si2ne7pnujl1mX5TZybZuw5QuIqh+h6Lmx21Zoni01oFvPM9uXHsmqVufWHljmLhESZpXsR0ee924pGpN9iTZiBVGXb8z2lfvB+2HnRlPwobDz1eHRe22caYscbAHhglua9vZ28Dsb1O6bNzfmPo8uE+cV7EdHsvtDHjQZE/SrbHq03nYiU4F5af4o6K1oPxg5HqoJfUOxEqaV7FdLEXtgH7QZE9Sfiq0P7ZhiK8lVw7ttSH4sGg5tIcSB6N17nNwDxq7wuznE6vdmIFYSfMqtt1jzyu3V0YP4XRAVKywjCyOy/hXXxud/acVc/uXVbnUrGb+qmjxQFGiWjNUI7df1JrthsX7HMRKmdeu1nCosTxosifCR97zrHYkuXirb7ZhRwk/MvPR2o/e5Yt6U7T4+BxKlHvgrrYiiB1umIFYSfOqDk4Us+ryoMmeTONc4ZBjsAZmkNfoYoWDc8uxn8dcmEteo4vlJ/u0pxtmzUzyGl8seJcgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIMIlYmUFl9UamgteQTrUZtWnq45h9ehpjHaHRV1WiJUGdVkhVhrUZYVYaVCXFWKlQV1WiJUGdVkhVhrUZYVYaVCXVbwrf8HTU9ffVxdWFLJq31UeLh6XH1+cUF1YMciqfVf2avaO51+PLqeqLqwIZNWhK8JqD1l16aoY1vPj66mqCysGWXXpasuCtDVkNUhX6sLqgbqsECsN6rJq3VVtQXrhl9c6lR6/3R6QFSNWKtRlhVhpUJdVtCv719rspxyOzcQhqw5d2WMz9rgMYcUhq/Zd+aPJu+sHwopCVh26Cqcpdh/+JawYZNWlq3CaYpsd/01PdWHFIKsOXb1uQlqEFYWshulKXVg9UJcVYqVBXVaIlQZ1WSFWGtRlhVhpUJcVYqVBXVaIlQZ1WSFWGtRldUlXyb+8NotL2EWeerdaA3Q4clazGLEurzq6WAXqskKsNKjLCrHSoC4rxEqDuqwQKw3qskKsNKjLCrHSoC4rxEqDuqzirU3gKnVTCSsKWbVvbQpXqZtKWDHIqn1rk7iY2FTCikBWHVojrPaQVZfWpnCVuqmEFYOsurQ2gavUTSWsKGQ1SGvqwuqBuqwQKw3qsmrdWrer1A373bK2xcb4QtspyEpsxBo4hTGKDYu6rBArDeqyQqw0qMsKsdKgLqvokfd1sYzrdGmeKacgJhZZdap54oxqvO6UUxAcsciqQ83XzYkDybG6U05BUCyyGqCmwrB6oC4rxEqDuqwQKw3qskKsNKjLCrHSoC4rxEqDuqwQKw3qskKsNKjLCrHSoC6rS2q2+fLaoL1PJawLUJsVI1Ya1GWFWGlQlxVipUFdVoiVBnVZIVYa1GWFWGlQlxVipUFdVoiVBnVZIVYa1GUVr3nR5Q+nnIKgWGTVvuZllz+ccgpyYpFV+5oXXqVuyimIiUVWHWoSVnvIqkvNyy5/OOUUBKdCsupQ86LLH045BcHFO1kNUFNhWD1QlxVipUFdVq1rdrz84aC9TyWstpDVSLsvvH8QC0Toc0oH3kJWJX1O6cAbyKqiz5F3OISsaiDWcJBVjT6ndOANZFXR55QOvIWsSkY83PBtsfhifv38fHbe+Gqml6eFL3q23OLjf58Xi09ten78yIgizXhi3RsH7s07HBfrydryeN6s+y/7R2vV43mzvi4KWAXJIiBWyzfPDkVmLHqIi/Xtdt9qYLP/IsV+frZ+MmLJIzFi3beaj5xY+yczgSUUy0hldEcseUSmwm+xBZEl6PcYG9gWD256i8xxhcyRYq7FT4glz5iL98KsyBhjptY7txo735qTOVrM8rRALHE4CQ0iIBaIgFjT53mVZVfhbNF+d+Jv1tV53dhDtLfRRl25NifLt61KHYFYkycczg9vb4NYL2sv0y58YbX5pNLWeRf+tmLp67nuEetdYsarWyeMd+W8WKawO5+0bTTLf2XsJncFtg3DX/UnPZv/tGcExJo6uR+KzHvtXDkvVl6cp9w1nLB01a03haYniyHWjGn55r1uwt1mUWTnpLNivayLue1lfXrIyl2BXbEKayq2qyZTpsK5kbcSq3rrjTvLiFjPq+LB0seTrb1ugoANxfza3ruHWLNj2+bTW21MMfLcDCNWGLjOiOWe3dL/Rqy50bR2rlN/659XV3eRqbB4sGGOKwtsz0+FoUmrH2LNDzPfxL8TmNfKGKu+N4q13JcrfVvytA754SDZVMzjBi3EmiHV1HWuTM2svHkp5pZpv4URadt0hOqgNdPc+QNZpvT1n4g1Q/IWQ9aufhwzb/7kX/2nRnuovmn1tq0+750rVm8Usd4p1cppHxvk/NHUgwrHrS3LrRb/6WOHWDAlEAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUCE/wFbLXEctJ+JrgAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The function recycles, from left to right, the vector of values we give it. We can use this to create more complex patterns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Produce a more complex dendrogram:</span>
dend15_2 &lt;-<span class="st"> </span>dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels&quot;</span>, <span class="kw">c</span>(<span class="dv">111</span>:<span class="dv">115</span>)) %&gt;%<span class="st">    </span><span class="co"># change labels</span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) %&gt;%<span class="st">  </span><span class="co"># change color </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))        <span class="co"># change size</span>

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Before&quot;</span>)
dend15_2 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;After&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice how these “labels parameters” are nested within the nodePar attribute:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># looking at only the left-most node of the &quot;after tree&quot;:</span>
dend15_2[[<span class="dv">1</span>]][[<span class="dv">1</span>]] %&gt;%<span class="st"> </span>unclass %&gt;%<span class="st"> </span>str </code></pre></div>
<pre><code>#&gt;  atomic [1:1] 1
#&gt;  - attr(*, &quot;label&quot;)= int 111
#&gt;  - attr(*, &quot;members&quot;)= int 1
#&gt;  - attr(*, &quot;height&quot;)= num 0
#&gt;  - attr(*, &quot;leaf&quot;)= logi TRUE
#&gt;  - attr(*, &quot;nodePar&quot;)=List of 3
#&gt;   ..$ lab.col: num 1
#&gt;   ..$ pch    : logi NA
#&gt;   ..$ lab.cex: num 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># looking at only the nodePar attributes in this sub-tree:</span>
dend15_2[[<span class="dv">1</span>]][[<span class="dv">1</span>]] %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;nodePar&quot;</span>) </code></pre></div>
<pre><code>#&gt;         [,1]
#&gt; lab.col 1   
#&gt; pch     NA  
#&gt; lab.cex 2</code></pre>
<p>When it comes to color, we can also set the parameter “k”, which will cut the tree into k clusters, and assign a different color to each label (based on its cluster):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Recycles color </span><span class="ch">\n</span><span class="st">from left to right&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_col&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>), <span class="dt">k=</span><span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Color labels </span><span class="ch">\n</span><span class="st">per cluster&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="setting-a-dendrograms-nodesleaves-points" class="section level3">
<h3>Setting a dendrogram’s nodes/leaves (points)</h3>
<p>Each node in a tree can be represented and controlled using the <code>assign_values_to_nodes_nodePar</code>, and for the special case of the nodes of leaves, the <code>assign_values_to_leaves_nodePar</code> function is more appropriate (and faster) to use. We can control the following properties: pch (point type), cex (point size), and col (point color). For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(1) Show the</span><span class="ch">\n</span><span class="st"> nodes (as a dot)&quot;</span>) <span class="co">#1</span>
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(2) Show (larger)</span><span class="ch">\n</span><span class="st"> nodes&quot;</span>) <span class="co">#2</span>
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_col&quot;</span>, <span class="dv">3</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(3) Show (larger+colored)</span><span class="ch">\n</span><span class="st"> nodes&quot;</span>) <span class="co">#3</span>

dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(4) Show the</span><span class="ch">\n</span><span class="st"> leaves (as a dot)&quot;</span>) <span class="co">#4</span>
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(5) Show (larger)</span><span class="ch">\n</span><span class="st"> leaves&quot;</span>) <span class="co">#5</span>
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_col&quot;</span>, <span class="dv">3</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;(6) Show (larger+colored)</span><span class="ch">\n</span><span class="st"> leaves&quot;</span>) <span class="co">#6</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And with recycling we can produce more complex outputs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_cex&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_col&quot;</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Adjust nodes&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_col&quot;</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) %&gt;%
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Adjust nodes</span><span class="ch">\n</span><span class="st">(but only for leaves)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice how recycling works in a depth-first order (which is just left to right, when we only adjust the leaves). Here are the node’s parameters after adjustment:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="kw">c</span>(<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">4</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;nodes_cex&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>)) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_col&quot;</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span><span class="kw">get_nodes_attr</span>(<span class="st">&quot;nodePar&quot;</span>)</code></pre></div>
<pre><code>#&gt;     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
#&gt; pch 19   1    4    19   1    4    19   1    4   
#&gt; cex 2    1    2    2    1    2    2    1    2   
#&gt; col 3    4    3    4    3    4    3    4    3</code></pre>
<p>We can also change the height of of the leaves by using the <code>hang.dendrogram</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_col&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="co"># adjust the leaves</span>
<span class="st">   </span>hang.dendrogram %&gt;%<span class="st"> </span><span class="co"># hang the leaves</span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Hanging a tree&quot;</span>)
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_col&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="co"># adjust the leaves</span>
<span class="st">   </span><span class="kw">hang.dendrogram</span>(<span class="dt">hang_height =</span> .<span class="dv">6</span>) %&gt;%<span class="st"> </span><span class="co"># hang the leaves (at some height)</span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Hanging a tree (but lower)&quot;</span>)
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_cex&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;leaves_col&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="co"># adjust the leaves</span>
<span class="st">   </span>hang.dendrogram %&gt;%<span class="st"> </span><span class="co"># hang the leaves</span>
<span class="st">   </span><span class="kw">hang.dendrogram</span>(<span class="dt">hang =</span> -<span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="co"># un-hanging the leaves</span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Not hanging a tree&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>An example of what this function does to the leaves heights:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend13 %&gt;%<span class="st"> </span><span class="kw">get_leaves_attr</span>(<span class="st">&quot;height&quot;</span>)</code></pre></div>
<pre><code>#&gt; [1] 0 0 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend13 %&gt;%<span class="st"> </span>hang.dendrogram %&gt;%<span class="st"> </span><span class="kw">get_leaves_attr</span>(<span class="st">&quot;height&quot;</span>)</code></pre></div>
<pre><code>#&gt; [1] 1.35 0.85 0.85</code></pre>
<p>We can also control the general heights of nodes using <code>raise.dendrogram</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;First tree&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">raise.dendrogram</span> (-<span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;One point lower&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">raise.dendrogram</span> (<span class="dv">1</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;One point higher&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If you wish to make the branches under the root have the same height, you can use the <code>flatten.dendrogram</code> function.</p>
</div>
<div id="setting-a-dendrograms-branches" class="section level3">
<h3>Setting a dendrogram’s branches</h3>
<div id="adjusting-all-branches" class="section level4">
<h4>Adjusting all branches</h4>
<p>Similar to adjusting nodes, we can also control line width (lwd), line type (lty), and color (col) for branches:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="dv">4</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Thick branches&quot;</span>)
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Dashed branches&quot;</span>)
dend13 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_col&quot;</span>, <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Red branches&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We may also use recycling to create more complex patterns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Produce a more complex dendrogram:</span>
dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>)) %&gt;%<span class="st">    </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)) %&gt;%<span class="st">  </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_col&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Complex branches&quot;</span>, <span class="dt">edge.root =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice how the first branch (the root) is considered when going through and creating the tree, but it is <strong>ignored</strong> in the actual plotting (this is actually a “missing feature” in <code>plot.dendrogram</code>).</p>
</div>
<div id="coloring-branches-based-on-clustering" class="section level4">
<h4>Coloring branches based on clustering</h4>
<p>We may also control the colors of the branches based on using clustering:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Nice defaults&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">value =</span> <span class="dv">3</span>:<span class="dv">1</span>, <span class="dt">k =</span> <span class="dv">3</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Controlling branches' colors</span><span class="ch">\n</span><span class="st">(via clustering)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This is like using the `color_branches` function</span></code></pre></div>
</div>
<div id="adjusting-branches-based-on-labels" class="section level4">
<h4>Adjusting branches based on labels</h4>
<p>The most powerful way to control branches is through the <code>branches_attr_by_labels</code> function (with variations through the <code>set</code> function). The function allows you to change col/lwd/lty of branches if they match some “labels condition”. Follow carefully:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;by_labels_branches_col&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Adjust the branch</span><span class="ch">\n</span><span class="st"> if ALL (default) of its</span><span class="ch">\n</span><span class="st"> labels are in the list&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;by_labels_branches_col&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">type =</span> <span class="st">&quot;any&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Adjust the branch</span><span class="ch">\n</span><span class="st"> if ANY of its</span><span class="ch">\n</span><span class="st"> labels are in the list&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can use this to change the size/type/color of the branches:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using &quot;Inf&quot; in &quot;TF_values&quot; means to let the parameters stay as they are.</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;by_labels_branches_col&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">TF_values =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="ot">Inf</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Change colors&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;by_labels_branches_lwd&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">TF_values =</span> <span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">1</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Change line width&quot;</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;by_labels_branches_lty&quot;</span>, <span class="dt">value =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">TF_values =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="ot">Inf</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Change line type&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="highlighting-branches-different-heights-using-line-width-and-color" class="section level4">
<h4>Highlighting branches’ different heights using line width and color</h4>
<p>The <code>highlight_branches</code> function helps to more easily see the topological structure of a tree, by adjusting branches appearence (color and line width) based on their height in the tree. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>iris[<span class="dv">1</span>:<span class="dv">20</span>,-<span class="dv">5</span>]
hca &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(dat))
hca2 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(dat), <span class="dt">method =</span> <span class="st">&quot;single&quot;</span>)
dend &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(hca)
dend2 &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(hca2)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend %&gt;%<span class="st"> </span>highlight_branches_col %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Coloring branches&quot;</span>)
dend %&gt;%<span class="st"> </span>highlight_branches_lwd %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Emphasizing line-width&quot;</span>)
dend %&gt;%<span class="st"> </span>highlight_branches %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Emphasizing color</span><span class="ch">\n</span><span class="st"> and line-width&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Tanglegrams are even easier to compare when using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(viridis)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend %&gt;%<span class="st"> </span>highlight_branches_col %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Coloring branches </span><span class="ch">\n</span><span class="st">(default is reversed viridis)&quot;</span>)
dend %&gt;%<span class="st"> </span><span class="kw">highlight_branches_col</span>(<span class="kw">viridis</span>(<span class="dv">100</span>)) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;It is better to use</span><span class="ch">\n</span><span class="st">lighter colors in the leaves&quot;</span>)
dend %&gt;%<span class="st"> </span><span class="kw">highlight_branches_col</span>(<span class="kw">rev</span>(<span class="kw">magma</span>(<span class="dv">1000</span>))) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;The magma color pallatte</span><span class="ch">\n</span><span class="st"> is also good&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dl &lt;-<span class="st"> </span><span class="kw">dendlist</span>(dend, dend2)
<span class="kw">tanglegram</span>(dl, <span class="dt">sort =</span> <span class="ot">TRUE</span>, <span class="dt">common_subtrees_color_lines =</span> <span class="ot">FALSE</span>, <span class="dt">highlight_distinct_edges  =</span> <span class="ot">FALSE</span>, <span class="dt">highlight_branches_lwd =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tanglegram</span>(dl)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tanglegram</span>(dl, <span class="dt">fast =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dl &lt;-<span class="st"> </span><span class="kw">dendlist</span>(<span class="kw">highlight_branches</span>(dend), <span class="kw">highlight_branches</span>(dend2))
<span class="kw">tanglegram</span>(dl, <span class="dt">sort =</span> <span class="ot">TRUE</span>, <span class="dt">common_subtrees_color_lines =</span> <span class="ot">FALSE</span>, <span class="dt">highlight_distinct_edges  =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dend %&gt;% set(&quot;highlight_branches_col&quot;) %&gt;% plot</span>

dl &lt;-<span class="st"> </span><span class="kw">dendlist</span>(dend, dend2) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;highlight_branches_col&quot;</span>)
<span class="kw">tanglegram</span>(dl, <span class="dt">sort =</span> <span class="ot">TRUE</span>, <span class="dt">common_subtrees_color_lines =</span> <span class="ot">FALSE</span>, <span class="dt">highlight_distinct_edges  =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
</div>
<div id="changing-a-dendrograms-structure" class="section level3">
<h3>Changing a dendrogram’s structure</h3>
<div id="rotation" class="section level4">
<h4>Rotation</h4>
<p>A dendrogram is an object which can be rotated on its hinges without changing its topology. Rotating a dendrogram in base R can be done using the <code>reorder</code> function. The problem with this function is that it is not very intuitive. For this reason the <code>rotate</code> function was written. It has two main arguments: the “object” (a dendrogram), and the “order” we wish to rotate it by. The “order” parameter can be either a numeric vector, used in a similar way we would order a simple character vector. Or, the order parameter can also be a character vector of the labels of the tree, given in the new desired order of the tree. It is also worth noting that some order are impossible to achieve for a given tree’s topology. In such cases, the function will do its “best” to get as close as possible to the requested rotation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;First tree&quot;</span>)
dend15 %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">rotate</span>(<span class="kw">as.character</span>(<span class="dv">5</span>:<span class="dv">1</span>)) %&gt;%<span class="st"> </span><span class="co">#rotate to match labels new order</span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Rotated tree</span><span class="ch">\n</span><span class="st"> based on labels&quot;</span>)
dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">rotate</span>(<span class="dv">5</span>:<span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="co"># the fifth label to go first is &quot;4&quot;</span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Rotated tree</span><span class="ch">\n</span><span class="st"> based on order&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A new convenience S3 function for <code>sort</code> (<code>sort.dendrogram</code>) was added:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend110 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>:<span class="dv">5</span>, <span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">10</span>) %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span>as.dendrogram %&gt;%<span class="st"> </span>color_labels %&gt;%<span class="st"> </span>color_branches

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend110 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Original tree&quot;</span>)
dend110 %&gt;%<span class="st"> </span>sort %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;labels sort&quot;</span>)
dend110 %&gt;%<span class="st"> </span><span class="kw">sort</span>(<span class="dt">type =</span> <span class="st">&quot;nodes&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;nodes (ladderize) sort&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="unbranching" class="section level4">
<h4>Unbranching</h4>
<p>We can unbranch a tree:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;First tree&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span>unbranch %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Unbranched tree&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">unbranch</span>(<span class="dv">2</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Unbranched tree (2)&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="pruning" class="section level4">
<h4>Pruning</h4>
<p>We can prune a tree based on the labels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;First tree&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))
dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%
<span class="st">   </span><span class="kw">prune</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;5&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Prunned tree&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For pruning two trees to have matching labels, we can use the <code>intersect_trees</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
dend_intersected &lt;-<span class="st"> </span><span class="kw">intersect_trees</span>(dend13, dend15)
dend_intersected[[<span class="dv">1</span>]] %&gt;%<span class="st"> </span>plot
dend_intersected[[<span class="dv">2</span>]] %&gt;%<span class="st"> </span>plot</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAg0AAADhCAMAAAB833Z2AAAAP1BMVEUAAAAAAGYAOpAAZrY6AAA6AGY6kNtmAABmADqQOgCQ2/+2ZgC2///bkDrb25Db////tmb/25D//7b//9v///8RZUH/AAAACXBIWXMAAAuIAAALiAHljilJAAAFIklEQVR4nO3dbVsbRRiG4YDaikDFwv//rTYGvGtLwjAvy7hznl/0OMizy6xXQ5jGzeEJXhw++htgImog1ECogVADoQZCDYQaCDUQaiDUQKiBUAOhBkINhBoINRBqINRAqIFQA6EGQg2EGgg1EGog1ECogVADoQZCDYQaCDUQaiDUQKiBUAOhBkINhBoINRBqINRAqIFQA6EGQg2EGgg1EGog1ECogVADoQZCDYQaCDUQaiDUQKiBUANRU8PhRfEDe6n4Zsfp8E3NdoGa1jLy4Fscr4uhV3Dj46mhlRoKZ2db7BBqKJydbbFDqKFwdrbFDqGGwtnZFjuEGgpnZ1vsEGoonJ1tsUOooXB2tsW2uD1t73z66QtqKJydbbENbq//PP3zlx+/oobC2dkWW+/r73+c/uWv3+5++JIaCmdnW2w9NbTPzrbYBi8/IV5+YoQaCmdnW2yLe68iG2dnW+wQaiicnW2xQ6ihcHa2xXbw3avIHu926fAd9TyeGlqpoXB2tsUOoYbC2dkW2+Dx5vT7xOr7DWc36Jeq4bjfcNxrWLyG8xv0K9Vw2ot8uLpbu4YLW7Lr1fD0cP1FDUdr1/Dy1Hh/uFq5hgsb9EvV8HjznMPaNZzfoF+qhvPWqqFhdrbFDqGGwtnZFjvEkjW8skE/poaP+f9R6y1ZQ81sXQ01Qx/4tKGGwlk1DJwdcTw1tFJD4awaBs6OON6be5GfX16m/bTtsnoNS77b5ZW/riqd3XcNHc78/6vh8eaVbciyWTUMnB1xPK8bWqmhcFYNA2dHHE8NrdRQOKuGgbMjjqeGVmoonFXDwNkRx1NDIfd2aZ3dUQ3u7dI8u58a3M2jfVYNb1DDkKHxPync26V1dkc1uLdL8+yeahhyZjUMGVJDl+Op4X0q7u2y4ZvA1dAy1cOYq7Dlteszr4aiM6uh4eBqqJ9SQ8tUD2oonN1PDRfeOr56DcUve/dTw4W3jq9eQ/Hsnmo4+9ZxNRTO7qmG+jOroeHgaqifUkPLVA9qKJxVQ9ED+k2poWWqBzUUzqqh6AH9ptTQMtWDGgpn1VD0gH5TamiZ6kENhbP7rmHo/rwaGoY8NzScqs+8GorOrIaGg6uhfkoNLVM9qKFwVg1FD+g3pYaWqR7UUDirhqIH9JtSQ8tUD2oonFVD0QP6TY2vYetPR520hvo7/eyphs0/HXXOGhru9LOjGrb/PMwpa2i5t4saCh/QbUgNDad6x/zmn446ZQ0td/rZUw2bfzrqnDU03OlnVzU0zO6phvozq6Hh4Gqon9qshu0+HbVmaLMaau70U3WiuWtgAWogWnaml7LEZWjZmV7JGpehZS9yIYtcBjUUWeQytOxMr2SNy9CyM72UJS7DsN8wv34+XH/59XDY4FXX483pv9JunsXrFtThig+r4fbTtz9O376x+/E5HJ/Fj8/gu6mhbkEdrvioGo4vu/556fWuFV24SeflUz09PVzdTVjDhguqu+L/NVcNVb/PP7/ef7j+Ml8NGy5o5hr+vQrvfN46e5POt091/54/f5vZbkGVV/x7w2p4vgpb/Eb2ePN89WasoUbdgjpccX9rRaiBUAOhBkINhBoINRBqINRAqIFQA6EGQg2EGgg1EGog1ECogVADoQZCDYQaCDUQaiDUQKiBUAOhBkINhBoINRBqINRAqIFQA6EGQg2EGgg1EGog1ECogVADoQZCDYQaCDUQaiDUQKiBUAOhBkINhBoINRBqINRAqIFQA6EGQg2EGoi/AceOqJXgHTBIAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="collapse-branches" class="section level4">
<h4>Collapse branches</h4>
<p>We can collapse branches under a tolerance level using the <code>collapse_branch</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ladderize is like sort(..., type = &quot;node&quot;)</span>
dend &lt;-<span class="st"> </span>iris[<span class="dv">1</span>:<span class="dv">5</span>,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))
dend %&gt;%<span class="st"> </span>ladderize %&gt;%<span class="st">  </span><span class="kw">plot</span>(<span class="dt">horiz =</span> <span class="ot">TRUE</span>); <span class="kw">abline</span>(<span class="dt">v =</span> .<span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
dend %&gt;%<span class="st"> </span><span class="kw">collapse_branch</span>(<span class="dt">tol =</span> <span class="fl">0.2</span>) %&gt;%<span class="st"> </span>ladderize %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">horiz =</span> <span class="ot">TRUE</span>)
dend %&gt;%<span class="st"> </span><span class="kw">collapse_branch</span>(<span class="dt">tol =</span> <span class="fl">0.2</span>) %&gt;%<span class="st"> </span>ladderize %&gt;%<span class="st"> </span><span class="kw">hang.dendrogram</span>(<span class="dt">hang =</span> <span class="dv">0</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">horiz =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="adding-extra-bars-and-rectangles" class="section level3">
<h3>Adding extra bars and rectangles</h3>
<div id="adding-colored-rectangles" class="section level4">
<h4>Adding colored rectangles</h4>
<p>Earlier we have seen how to highlight clusters in a dendrogram by coloring branches. We can also draw rectangles around the branches of a dendrogram in order to highlight the corresponding clusters. First the dendrogram is cut at a certain level, then a rectangle is drawn around selected branches. This is done using the <code>rect.dendrogram</code>, which is modeled based on the <code>rect.hclust</code> function. One advantage of <code>rect.dendrogram</code> over <code>rect.hclust</code>, is that it also works on horizontally plotted trees:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">t</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)))

dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>) %&gt;%<span class="st"> </span>plot
dend15 %&gt;%<span class="st"> </span><span class="kw">rect.dendrogram</span>(<span class="dt">k=</span><span class="dv">3</span>, 
                           <span class="dt">border =</span> <span class="dv">8</span>, <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)

dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">horiz =</span> <span class="ot">TRUE</span>)
dend15 %&gt;%<span class="st"> </span><span class="kw">rect.dendrogram</span>(<span class="dt">k=</span><span class="dv">3</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>,
                           <span class="dt">border =</span> <span class="dv">8</span>, <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="adding-colored-bars" class="section level4">
<h4>Adding colored bars</h4>
<p>Adding colored bars to a dendrogram may be useful to show clusters or some outside categorization of the items. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">is_odd &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">labels</span>(dend15) %%<span class="st"> </span><span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">3</span>)
is_345 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">labels</span>(dend15) &gt;<span class="st"> </span><span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">4</span>)
is_12 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">labels</span>(dend15) &lt;=<span class="st"> </span><span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">4</span>)
k_3 &lt;-<span class="st"> </span><span class="kw">cutree</span>(dend15,<span class="dt">k =</span> <span class="dv">3</span>, <span class="dt">order_clusters_as_data =</span> <span class="ot">FALSE</span>) 
<span class="co"># The FALSE above makes sure we get the clusters in the order of the</span>
<span class="co"># dendrogram, and not in that of the original data. It is like:</span>
<span class="co"># cutree(dend15, k = 3)[order.dendrogram(dend15)]</span>
the_bars &lt;-<span class="st"> </span><span class="kw">cbind</span>(is_odd, is_345, is_12, k_3)
the_bars[the_bars==<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">8</span>

dend15 %&gt;%<span class="st"> </span>plot
<span class="kw">colored_bars</span>(<span class="dt">colors =</span> the_bars, <span class="dt">dend =</span> dend15, <span class="dt">sort_by_labels_order =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we use sort_by_labels_order = FALSE since &quot;the_bars&quot; were set based on the</span>
<span class="co"># labels order. The more common use case is when the bars are based on a second variable</span>
<span class="co"># from the same data.frame as dend was created from. Thus, the default </span>
<span class="co"># sort_by_labels_order = TRUE would make more sense.</span></code></pre></div>
<p>Another example, based on mtcars (in which the default of <code>sort_by_labels_order = TRUE</code> makes sense):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend_mtcars &lt;-<span class="st"> </span>mtcars[, <span class="kw">c</span>(<span class="st">&quot;mpg&quot;</span>, <span class="st">&quot;disp&quot;</span>)] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(dend_mtcars)
the_bars &lt;-<span class="st"> </span><span class="kw">ifelse</span>(mtcars$am, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;gold&quot;</span>)
<span class="kw">colored_bars</span>(<span class="dt">colors =</span> the_bars, <span class="dt">dend =</span> dend_mtcars, <span class="dt">rowLabels =</span> <span class="st">&quot;am&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="ggplot2-integration" class="section level2">
<h2>ggplot2 integration</h2>
<p>The core process is to transform a dendrogram into a <code>ggdend</code> object using <code>as.ggdend</code>, and then plot it using <code>ggplot</code> (a new S3 <code>ggplot.ggdend</code> function is available). These two steps can be done in one command with either the function <code>ggplot</code> or <code>ggdend</code>.</p>
<p>The reason we want to have <code>as.ggdend</code> (and not only <code>ggplot.dendrogram</code>), is (1) so that you could create your own mapping of <code>ggdend</code> and, (2) since <code>as.ggdend</code> might be slow for large trees, it is probably better to be able to run it only once for such cases.</p>
<p>A <code>ggdend</code> class object is a list with 3 components: segments, labels, nodes. Each one contains the graphical parameters from the original dendrogram, but in a tabular form that can be used by <code>ggplot2+geom_segment+geom_text</code> to create a dendrogram plot.</p>
<p>The function <code>prepare.ggdend</code> is used by <code>plot.ggdend</code> to take the ggdend object and prepare it for plotting. This is because the defaults of various parameters in dendrogram’s are not always stored in the object itself, but are built-in into the <code>plot.dendrogram</code> function. For example, the color of the labels is not (by default) specified in the dendrogram (only if we change it from black to something else). Hence, when taking the object into a different plotting engine (say ggplot2), we want to prepare the object by filling-in various defaults. This function is automatically invoked within the <code>plot.ggdend</code> function. You would probably use it only if you’d wish to build your own ggplot2 mapping.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a complex dend:</span>
dend &lt;-<span class="st"> </span>iris[<span class="dv">1</span>:<span class="dv">30</span>,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k=</span><span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="kw">c</span>(.<span class="dv">9</span>,<span class="fl">1.2</span>)) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_col&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;plum&quot;</span>, <span class="ot">NA</span>))
<span class="co"># plot the dend in usual &quot;base&quot; plotting engine:</span>
<span class="kw">plot</span>(dend)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now let's do it in ggplot2 :)</span>
ggd1 &lt;-<span class="st"> </span><span class="kw">as.ggdend</span>(dend)
<span class="kw">library</span>(ggplot2)
<span class="co"># the nodes are not implemented yet.</span>
<span class="kw">ggplot</span>(ggd1) <span class="co"># reproducing the above plot in ggplot2 :)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ggd1, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">theme =</span> <span class="ot">NULL</span>) <span class="co"># horiz plot (and let's remove theme) in ggplot2</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAHCCAIAAADzel4SAAAACXBIWXMAAAuIAAALiAHljilJAAAgAElEQVR4nO3df1xUdb4/8BeZv3NAmYM/gEQwy1+lJktq5CorKmyUZSzbLaq923LJLdfcunuvrGuGd3dryby7xtLeezfZ1viaZVGAWWhmaoSpZUapIAoockaBUfF38/3jDMOZXzDDmZlzDvN6PvaPOT885zPM7nvfn98hFosFRETUXdepXQAiIn1jGCUiUoRhlIhIEYZRIiJFrg/Ym0wmkz8eazQa/fRktV7Ed+noRXyXjl7kq3cZjUaHM8xGiYgUYRglIlKEYZSISBGGUSIiRRhGiYgUYRglIlKEYZSISBGGUSIiRRhGiYgUYRglIlKEYZSISBGGUSIiRRhGiYgUCdwKT0REbp3Y2/iriivtWxr1fzbbGO/ifIeQcMPL6aEjAlhC9xhGiUg15hKzGWYc39m6tVZ+/sIL+Y3/kjHs3sEqlcs7DKNEpAJzidn28eL+WoSE9b03NeJBAwBUflT3wuEr679ou/dHA0ZMGbZhit2/rPyo7oXDvR+co5FUFIrbRhs2Lk5LS0tLW13h6pCIqCutx68047opif1C28/E/yh8pru7a0wvHkZMQriWElVl2WjFhh2J+cVrIitWL97YkLCw3naYtrqieEmCj8pIRBog5Nf56lHVN4Z2HIROGPTIBOmjucRsSDVYz48c0tvpH7b95YMLCDcsmeJ8SUXKwmjCkjUJABrqamOiI9GwG4nTIgEkTJ+1vq4BCZEApk6dKt27Z88epYV1w3lNf72/iO/S0YuC6V0+C6NdvfTbo5+g3+NThjsUoO7Tqk+AObPjbu3+H8Eff0DlbaMVq9NWbZu1rBioqKvFNMfLtujJvZj4Lv5YPeBdYna08ofLGkYdmUyHW59503zX3Og5jkGj7X+3XUS4IbX7fwTN7sWUsKS4uHj6rsUbG6KiYxQ/jYg0yhI3xRI3xbhFUP6ojpq74/lrrc8UXZiREf3LWKeLNW2fAHdN1U7Pko2iMNqwcbG8MykyGjt2NwCo2LUtJjpSYcmISCOMWwR59HQ49JnWrxvTi66kZ7se51RZc8GC/gnO4VV9iir1kQufjV6clrYKGJWZvyYSSE9cn51WCMxaVsz+JSJ/ctfh467S7e39Ic/vs322xHlZOA9ICamtdm+I+Lxu3RnDy9nuks22isMIuWlAvO9LopzCttHIhWuKF7o9JCLds8RNcXneuEUwJYsKH25INRiNRlNZUd2LZzqdldR85Zjrvnst4PB7IlLXt6YXD8MC8+J8u46nkJvCN/xogPWg+cox4K4wbYZRLk1CRKraWXXBecq8gxMtV4HeURoaci/HbJRIl7wdeOTt/ZbfTpbGBpkguuxQUl6jt5qxIPrNxC7ucZ4SqiUMo0SkGkEQAGDQAwcmzr4CAOj/nwuN8g7qhqrGJ8yGdxMGuPrnGsEwSqRL8p53nwyJ74QpWRTy62x9TT7JQ60BFADu/O+Js7dVZz91CuL779f914etr8wJbR8w2fbmwSvw77dTjmGUiDwSUr3X+sl3k+sBYOikOy9uffQUACBhrGHUliv1gBRGKypO14Zqs1tJjmGUSK/sFvjQl+Wyhs5Tf5lyyvpREB6pmv4v7RfMrW8g/Jko8xNuZ45qBHvqifTHXGKWx1BzibmTWeo6cuuoORdGjQ9NAIArb1VcSByr5SZRG2ajRJrjfkk663kd56Hu3TrqudeGi+Evj+0NAPWtO6LCXzagoUHtcnWNYZRIZ9zFULvFOn3Nx71Y2aKsiwmwxlAYXvmdlH62vfwZfrpQ+62iEoZRIlKZlIeu2vWXv0Y+AQCob9uGC9s22nLy0/fUtTkMhNIShlEiUoEoipCGPQ164PnhMLzyu79G/q79YpTx3fbFOThulIgUktembasOu+xQ8l+N3n9EUbw+f+PRzTA/sdH2lRxH4GsewygRqSnst/8Wne1+RfrIscPeDWBpuoVhlEh/HBfr1GEe6qi+tuGJo1fajwYsmxXhKiFtW72tCeNjlkQEsGRd47hRIr2KO94ad7xV1zFUEISQkBBhwupaWQwF0LZqW8NbbQ43X3nr86ZtgSydp5iNEpEKZAOexjw9YhLQ+MbXT/1HjQgAFd/Urjp1ZV1t2/3jbD1Lbau3aTOGgtkoEals0PTEfqg/+ZeXzrafSRgXMUt+R1NT2rambRiwbLw2++uZjRLpm/spTwr5c1d6+Zz6s68t2P2a9FEQBGkgFADEDugYfj9Lag9tavJjmbqP2SgRaU3TuW3onRjRHkYjIjTWp+SA2SiRXvl1mVHbGFV/EJZ3crGt5VcH22aNj7lfmzV4F5iNElGgddTcHc8fa/lVxfnEBK0Naeocs1Ei0oZBjzakVfReNitSV1OYwDBKRKromFMvHb6/vXbVuYGv/CAsStVidQsr9USkGlEULRaLFEPD9BlDwWyUiNRW37TqFICWJ7a12J0fGlE8ThfdTMxGiUhVOxocZ33qDbNRIlJVYkJMcZxnt0ZEFGuxB59hlIhU09HF5GYIlC4wjBKRChz2YhIEAYbsz2/7mfHtmEHSqYbGo0+evAQA/Yx/HmuMDHwZPcUwSkS+1N05/ikv3rbgUsdhS8OTJ/v8ZvKoH+DSpqqjT9b2tYVX7WEXExEFnHxpEmBC7Gs7En8V3VzZgC3WUw0XL2Ow4QcA0HfB8EG4cEnDGy0zjBKR2to2ZO9Izjhe33EmMmzQqGbz5wCAz1vOjho8iJV6IiJ3vm4sdTrXz5g31rR037d/AEYNH5U3rK8K5fIUwygR+Vp7nd1t/3u26NDFJIlFcvvHlob7jl5+eOwtef0ubao6et/FSA23jTKMEpHPuOh/795gpoaLlzHYuKAfpLbRf5y81ADN1usZRonIOz5Zb99xaRJRREPj0ScvKn9y4LGLiYh8xL7/3cZl/V1iXZrEOV2NDBs0qtm06SKAS5tOnkX/vlpNRcFslEibqm8MVbsI6upnfHr42Servv0HgH7GP2u3YRQMo0RaYy4xy2OoucQMQNeb0Xsqctiotx0Oh6lWGG8wjBIFiIdNivrKQ+32g3LT/+5VF1PzK0eOYFj8EzcoL1vAsG2USEPcxVApJ+15jFsErA8xbrEG3wvFx4/sVLdE3cFslIh8xkX/uxu20Gk7bPxk99dH/Vo6f2E2SkS+tnIvVu71pi5/7/51u/cdxZCnhw3xY7H8hdkokQo62WLeZf1dc11MtrFN2W5jZSdtwZY4p6FRo/44/653cPreCvy7D4oXWAyjROQFn81TsvPOpLuUPUBVDKNE2iIlnracVHN5qAc6ybWttnRxXV8YRom0KO54KzyJR37mWDF3P0/Jq4TUlCw6dDG1n1+NdY3eFFAT2MVERKQIs1Ei6oItKRaW++yZpmQRsmFP0iFwzmcvCCCGUSLylCj6YJ6SnClZNBqNJpNJWblUxko9EZEiDKNE5AVRFLFyr/xQ11vM+wQr9UTkPVkk9akb4v45Os4/j/YfhlEi8o4Ph2GZS8xmmHH28oFtl89Kp6IG3fnbQXpa34lhlIg6s3wKAGG58nlKjuzmvJ77/mxkv+m3X6/HuQZgGCUil0JCQuSH8kmf7ibLu8tSXd4vXxLw9ImrAwx9ul1U1TGMEgU7n2xR5xX7ZVW/v3D2OuOY6wCYS8x6TEgDF0aNRqPunqzWi/guHb3Im3d1RCsP/kmdy9v8872cwqj7SZ8Wi8XF/QA6K1vnYfr7NjPavjh33Azgutt+FDvRn7vX+eMPGLgw6qcRtgEbuxvIQcJ8l15e1O13efhPHG7Twkj1TgrQzbKd/b4NMN5+Q9QgAFdrnjp8XcHgod0uX6d88gd0DsSs1BORd7ztqXd5f0cX06A+k9KsDaOG1P4oPnuuEUP1sZedFcMoEXWwhjxfbE4XPBhGiUgFHcuqnry4qxKTCyKGAmg8ez6q/2hdpaJgGCUilywWS8jz+2x9TX7KQw2pBqMx9rp/fPNp1gkAQP/JBYP1NfYeDKNE1Bl/Tfq0c8P8iHnzA/Aef2EYJSINaGrb9EJbs/Wg7+w/DYpRszTe4QpPRKQa4xYB60OMm16SxVAAl7b+umV/k3rF8hKzUSJSgXwvpkPVmc3A2Eljpz0kAmgpb3m77OrRA1cnJekjQOmjlESkLp9PGLU4LId3Q+GMCHwPAAhL6h9bdrbm1DW9BChW6oko0CxxdpNNjTccx7nMnU3WFLWl/EINMHhoL5VK5zV9BHsi8i/bJPpsFQbYD4mde++5qnf2V1UB2GICgCmDFuikRg+GUaIg5zBbSb4gXgClf+ewO/3ey7UP9o0JbCG6jWGUiFzz4Sr3DkwQZV1Mk3fveq4KxxNnzL1pgQhYBz9tfanXfU8PCPNTCXyKYZRIu5w6dny9MGgXC+IFxPl5VedgHP2baQNhXXwpYsCs+ZffLrtc2zRgUkSASqEEwygRqcCULEI27OnaTaUm/TSGOtBruYn0yH7V9864rFD7fL1RYbkPH9YdpmTRaOxr2NlQU3Zu/8Qwa+7Z1Lat7CrQN0wPqSgYRokCw1xilsdQabVN1TfMEEUtLIg3aNL862vKru59wSSfwD94fv+YABZCCYZRIoV7tHV87uR+z/PQIBSWFPazifI59ddPeTZMF62iEoZRIr9zF0O1sIObKIpCfp2/F8TrWsSABX8aoM6rFWMYJaIALYjnzFxiNkMT7RtKMIwSBTv/jQ/tRMdeTAAufv/Sc6elFZ0mpYdnjAUAmNrWrL1wEkBE/6ezB2i5is8wSmTHk5giv8eT3nNDqsEuasjOe1u8nuj7d7++Jozu/fMwGGJDfrOhZeiisFnGy0VrL2B26B8Sr2/a0fLS29f/4b4+apfTLYZRIlKkG4s/2TUWt1gO9u+VFQYA5prv50ZcOyUCuHoKfX6UeD2AiMQBk55r23ZXn1m+32HeN7jCE1EgGFINccdb5YdMRa3Cev3n+OvCrQeWU/pZrdmG2ShR4NgiqYieFkO9amB12cQB4PTJ7/dH9H96LIDrh+LCgSqMH4umHW37cW2SCGg1G2UYJVKnjyWYuWwsPn3yakFD74d/J/Um9clY1H/N2tO/AYbPHjQ34uwpFYrpKYZRIlLEugbzFus0+e45ffJqQQPmLho03nbKOGDx76SRpJeLtvYa6mKylVYwjBJRN8n3U7IdehhMpaZhKSdtz0NlMVTOdPUUek3Uao0eDKNE5Karva7LubCO+yl5z5BqMF4L+Xtus10eCgCXi55rG7oobJYRBz+5cHKimwirDQyjRNQdDvsp2Ri3CF7V7vdtNp0ETq49/UH7mUnp4Rlj+2SkX/qNdDKi/9PZ2h00CoZRIlLX5Edu/kOqq/kLYwf94XcBL023MIwSkQacOZ/+9/MH248WpEXk3uT6qgV9X1ka+sMAF69TDKNEwc7bJaKl++33U+rgVY3eutrppL9GzEuUn99U3HRoxpANd1wPOEbYEFx6Iu/0M4+FPzbE8/f4F8MokV0fC8eQBoZsuehJgxISLTh+8R/za/aLAHC4dXzxpa93nv/4jtAfAh/vPn9Qlp8e++x0ys5rZYeuPnaHVsKXVspBRLpjShaF/DpbX1NI9V4A8HaKfeS8PoPx/Z7/ONvQfuam0LW3ND3xbcctFuPAx9vr+CPvGLhgp/nt01e1E744p56IFAmp3iv9x4t/I9+RtOEPp/8w/vRH+2GXogLG60cBAEaF9woxnf/bYevpY5+d3wRMCNdKDIV2wjkRUbuLH32LCTP6jgQAjLwjfO3ppkXFTZvaL1tuMWzQTI0ezEaJSGOu/n2d+W27QHnxo2/tb/n20scBLlSnNBTRiUh3utkjl+1uR9KTf193puzmId90xNCrf19nfhu9Orrmz5xP//v5J9adL3tk4MhultrHmI0SkTZE/iY970z19Ai7CvuZS2UmTJgR2jG8acjAF2f0guni1jNqFNIVZqNEpAJpC1JbTiruOjKu+Op8LY0G9RzDKBHHiqpGFEWj0WjaXT2u+KrrEfVDeo0B3t7Z+vcxHZX6Z3ZeA/qO0kzAZRglInWZc4ovhQB/+nvTn2Rn2yd99nt8xvlNO685XJ0wY+APA1xM99g2SkSqOmje1On1kXeEH3xsoG2hPAt6/fqxCE0NeNJQUYgoGI2POri0ix2qMWTghqUDA1Ka7mAYJSLVWLuYon8d//iDlQCAzLnRebEAgObWlCKzdBLhhor00Fh1ytg1hlEiUoFs3Oj9ePzByuIp2AOxokr4oHFMxrCswUDzlcqbwsUfDVCzlJ5hGCUKXm62D5F0scKIJ8MbOn1+u6kzcWY99gAAYkNzwxsPNQODUV5zIX5IaNf/XAPYxUREASdfmmTPU3jZ2gkvCE8eOi19vHLkTO97RvUOfNG6gdkoEdcb1Yz5mYXhhopYAFcOnUbVh3U5pwH0zpWq+VrFbJSItGH+u5h2rEjqSmq+UgXcMydazI4Wsw2HikzlapeuE8xGiYJbe/1amp1p08kmIp5zm9o7L00y/11MQ27GT5Okw8GhpdnyhtGrR5qRpNWElGGUKEg5BDLp0CGYBsj8dzHtGJY/lZWtxtsVYxglUoFHXdgudO9faVHH0iTRv5by0Kzsn3ZcrjEJH6Ao25gEoPlKVXj/RVpNRcEwShSk5H3lMoIgBDIhFUWxckddytfIKarLaT+ZOTc6L9ZYkdCYYP0/m/5F2UbNjr0HwygRqWv+gsliootG2Ngpw0TXoV5z2FNPRKQIs1GiAI0VVf4Wn/SeW7ndxkPlTp7yj7/LwAjxh4PszracTtlkqmw/ypx9c55G9g8BwGyUiFRk3CJgfYhxizWg13xZm3HU6aZjJwRZDAVQuPW7lC8vBaaEnmA2ShSkHLfxCGweagudtsOyM5+mXHC+8VLBvrNA39wFMVlhAIBjJ4StZyv3ni6/bURSQIraJYXZaMXqNMnqCgBo2LhYdkRE2rdyL1buVbsun5bV8GnKBWTOHpHpcKXl3LvNiJ8y3BpDAYwcUTQqwMXrgqJstGHjeiwrLk5Aw8bFL2xsSIjesCMxv3hNZMXqtNUVxUsSfFVIIvIvV+NY/ThG1RLn1Aff/wXLkGJ8l/YInrU7HxZe+li4i0cM7qudWKoojEYuXLNE+hAdE4PIhjokTosEkDB91vq6BiREApg6dap08549exSW1R2j0einJ6v1Ir5LRy/S/7u0MKS/uKB9f7p+APoajEZXodPq9NajmJ4Y/QNjd5Yi9ceP5ZO20YrV66PT16B+Vy2mOV6zRU+f9TDa82XfpTZexHfp6EU94F3uxg/493ttcXvlIoBLZpPJ4ub6pYJ3al8dNUIc3WYytXn7Wp98KedArLynvmJ12q7paxZGAlHRMYqfRkQ9nynZdVOsKfnlTv/dpYJ3at8dFeM4HEptyrLRho2Ls+sebG8FjYzGjt0NCxdGVuzaFjN9iS+KRxQIXG9UB1pOp2wyjZ19c6mWRoxKFIXRig2FR4FVadsAjMrMX7MwPXF9dlohMGtZMfuXiMg9KSG1DXtqz0/Pur772Alh6+XcBTd39NdriaIwmrCkuNg+6Vy4pnihovIQqaP6Rn1s+9PDmJLFrtsrrTE0RpsxFBx+T2QuMctjqLnEDMCQalCvRCR3dunWswByNn2XY3d+UNFjPWT4PRGRPx07W6h2EbrEbJR8xoOliAM2RNHTF7mry5tLzExIA8BpKuqgvMduzpPfMXKE+FjAi+UlhlEiUkHH+lLTViI9Xni9Y3pO/G3jSyf2V6dY3cIwSj7WyYAhDQ6/l1pCSU27l2O39aP4xWfCJ1iqqxgKhlEKcoZUg8tIGrQ1elnLjD9bYFxvYTJf+KQ5866pGuk48hy7mIhIGxYshOmdRTeqXQzvMRulYGdINQj5dba+pqDNQ+XE7Gi/tsAIy53PjcO4EdhaEPurXD+91H8YRokAIO54q/RBBMOo34mi0xYmMYkwVhYV63KfelbqiUhm+RQsn+Jymyb/mvwDVO3WXauohNkoEQHyEUgAgJCQEPhzZxGHLUyKMkfkhRb46V3+xjBKFEQ8mCIRUKIozamvK3jv4NgbdTbOyYaVeiJyNwLJMUX1m4uHWvuP0e3iMMxGiUh1g/MeGqx2GbqPYZSINKD+gPDpKevnsNiKebGxqhbHKwyjREHKbtputtMIJOkeP2+8LC3b3HJx9U1twzrOttQkFJ0vypiol457hlEiUoFt3Xsg6cW2YehVdji0MCxZBFC+66OM46dK6ycmRalYQC8wjBIRIA2Jz6/r6GtauRf+7Nm3xNk+lhcMKZfGOkmzppLGx8Yfr6kynwcG+untvsUwSkQyK/cG4CWWONcDA4xbBFOyWH6wphIDcyP1EUPBAU9EpBlj1rS+IRR9lHF8YO78aVn6Gf/EMEpEGhH9zTXpw/mcst0FreoWxgus1BNxb3or+d/Brys8mSDKuphsyldlFK0CgKalRV/l7K6Zo5NhT8xGiYLM8inW/2hXxKJbB6Ll1Ic6SUiZjRIFC4eRodKhv0eGumNKFiENe7qWOaN1/pVbp5WO002fkgNmo0SkGlOyiIf/nBKGyq9qyjtON6396jzChs7RSS8Ts1EidXRrSKaCUZzuFx9RKyFtZ8iaMDTn01MZRadkJwfmTtNHwyiYjRKR+qImivNj4zuOhxZl6GnAE7NRIjV5NUhASe+5q+2PtCQ0tjRDL9mnI4ZRoqDgYvuj9vOBL4yNucRshhnXvoy7eBIAEJo7b26WdTcsc8EHm3NaAUQXpU/T8jIlrNQTkQrMJWZziRkAvq9+4OK53/afVz1wnjjdkLN5t9TXVL57c45hupieXhRdl7G7XtXCdoFhlChYiKIonzIviqLanUsAgOvi3hw441EpFEVFZ8J8xAygvrQuNHd8FICk8RPi6+rKO32GulipJwoyvlh8ROHKT9U3uu4/OvDOgcLQkRUGwGyugiFFqt0bDGNRd8SMJK1ufc0wShREtDvt9fvqBy4c3otBubPH6a6niWGUyC630m6g0Z5u/62sraJy18W9OTAO176M27x7tLY7lJyxbZSIvGaJm2KJm+JqeRGPGFJd188NaaPa20b1hGGUiLxg3CLIo6fDoc8YDGNt8dRsroJhtFYbRsFKPVFQcdc15K567ny/bPMPRaSE1FwiDRpFUXpiEgBzfVVo9CIDgKiU6F0ZB+uzpkWVH/y6Mnq6lqv5DKNE5KnON//oxgMNqQajcUHFJ/9M2LABgDTSXupiSpo2PXPDLqFOOqnpze0YRolIZbHj5orjnE9H5aWn5wW+NN5j2ygRkSLMRomCiLdDlBzud7P5B7pXo3ejZumbmwuj54l36Gb8KMMoEanGtlqKbVpq+WebC9UrT/cwjBKRF0zJopBfZ+tr6nYe6nJHk4rtf8lQNMtUHQyjROS1kOr2ifnKJtfbiZ3/y4OnM6fNw26dJaTsYiKigHOxo8lU/PqOyoPv5Wl6aJNrDKNEpAGL7kbTZ1i7R+1ydAfDKBGp7c6HMP4MCsvULkc3sW2UiLzjg0WwsmU7msTOx4M3Ydv/oEbqr69R+vCAYxglIlXdPgYAZv0csyC8+Yr1ZN1moS48d+5PsjS8IolNJ5X6sqwseY59ZM2MLL3m3ESkMVrZwsQXOslG5xfcmxUSkvvy4Z2LD2eFpLz6i1LL4sAVjIh6PlEUnXaN7mGzmOYXWCxH1swICZlQarEUBKpIRMFh+RQAwnKVtzgm5TrtqT+yZkbITd/kWCz3vhMSMmPNkUAViqhHEwRBPofH4ZB0p5NstCzrEayzWEYDgJSWZpXtLJgfqJIRqcLbPS8tvzX6/JnBw1xiNsMMu21FYvMeeEIX6+PZdNo2ulMeM0cv3sl6PZFiLibwAIAgCEFVu3fY1c5cYsb3n2dcaF2afr91ofv6t4RdBwAAQ3PnZWu5y54Dnoio+7qdaDttVX8k58KnlZhoPTLvSNnVlDtvRZYBqH9L2PzWaFt41R6GUSIKNIcYeuzKP2ZfFqdcf8uUq1espwyJpemJ1s9R4zLx8REzkrSakIZYLBa1y0A9RMjz+wBYfjtZ7YJoXUhIiPNJnf4vUfrRveUYRq8dQa/RI7///IELptwnfunQAXPki9/fdOT2wz9JHq2gnH4VuGzUfmiYzzgNOvOXgL1I7+/q5Gn8sTrhyUP0+L08MbJXR4Q0y99q3pGyubwSQ3PnTQnzRWl88qWMRsdORVbqiQJNFEUhv87W19Rjepa8mmvv0MUk6YXedsdS1Z5toxQ8rCuib/Htzjw918q9Xd+jBx0r4cM/v7vm20YZRskHHLY5kw4ZTHs84xbBEmd3CI9/d2mgqC0nNaQaYO6Lzb4vZABwvVEiUo0h1RD7SKxs7H27+reEDW+VS5/NpqrQCXO0moqC2ahLnJnnFcs/XZ83bhGYkPZU8l3tHPjmd4+6v2JCfsKGFQCAiUXp92t5nRKGUSLSBkNiaXrHUey4bHGceoXxBsOoWw79pz11rIkP3rWFyTspZt6cUvZOZftR5oy/6mhvO7aNklLuanCs0fdsHXss2/PqdxcEISQkRLj3XkEWQwEU7vy3lG8alRUwcJiNEpEKZD0Q4ZgzDDiHvA/Ez0UAqP8/YefnlQdKy8f9TLNjReUYRskHTMliwmtC9YiOQ1WLQwFiShblfU3W/NTbxUpGRcIIfLwHR9vPRP2s6MbPM477rqB+xjBKPhN3wvqhQtViUABIk+KlUZ/uavedka8WePQr/PIr6aPdaoGhI0YpLWaAMIwSkRccJnFK8TTueKtPX7K/9DjiJ07S8iAnOYZRouDlbrVQd7Pjhfw6p3VCfa6xYPNfC2/8N3HcMD+/yGcYRonIU+5iaPWNoS5mInUiW3Q5yUUUDxRsXvHujSt0FEPBMEpEWjHq1pT/t2LsjL+W6mfEqIRhlIhUIHUl2XJScd8fhZ0n7pmfo+U9l9xhGCUKXl6tEArAkGpwuU6odzV6eQFE0Wg0mva/IOw8kavPGAqGUSJS2+dLd34OIKfs33ssl+cAABpWSURBVHLszv+g6Cf6GH7PyaBE5AVDqkE+vMmQauh2KmpV/Vmh0kKpjNkoEXnNFklFKK6Hxz0l/uRBpQ9RFcMoUfCSjxv1tp3UNwWwdTHpeUMqVuqJSAWCIMiHjgqCIPxgcsobL5Z33FJfUDZXeGOuYHdSi5iNEgU1hRvSuZsH5T0jlkTI18or3/WvOaErxPnTynfNzdh1pzh9mo9e5HsMo+QbFY/quFIWnJRsSKfUcvsNSO4fj5l98Y0Z494GngEA7C49Njo3ZRqApPH/Gl/6afn0aZrttWcYJVKZNwmdr1I/AJDHUJU1nsJTJoyKwrh+1jOtdVWISZGmnoZGj8X2I61I8vds/u5i2yhRMOpkQ7oAlwQAdgZoyxw/YTZKRN7xQZ++m6VJ4nGf0iergdkoEZEizEaJVNC9hM6HW8aaILqsvwdsAxjHpUlEEa0bUkqPWS/L20Pl7aSaxGyUiFQjiqLFYnE19n5aysgjOQd3Ayg/+L+VI+/UbDc9mI0SBS0p8bTlpFrbiDBp+orMN1YIxwD8qOin2h00CoZRoiAnbUinykxQR6HppT+VH0/L++kHeWoVxhsMo0SkAS0FKe/l2GYxZc4U826UX64peC8hp8XdVZUxjBKRaqxdTNOAB+zOF24XqiZVlE6MBRwjrHQVWoqk7GIiIhXYLU0yCwDw3xAfFsWHRXFmJoDK/WulFUnKD+RUApkzRevVh4sygcIvC2rUKbgLzEbJNxJe6xg9w/n15IUYwAh8AtS2n7kxryimMMN6WF5aC4TlLurIPZPyHhY11WbKMEpELuf1+3L+viP50iS1wNPtxRCEjsFPYWNGATheWghk3pYV68fSKMUwSkRaU15ai/hJc9pDZ/wYA2oOpCTstzaQsouJiDTE3VAnH86YciYs7+RiTcF7GYUxReLEWAA1rVUA3t0h2Lrp4dABpQHsYiKiQHO3ZYgoVhS8l/BuTIWYKJ+1VFnZkln0sF0Xk60DSgsYRolIG2KQ8o+EQ7eJ8jQzNnQsEJ97d54srCYtmhQPVB1pcfEMVTCMEpEKRFGU56TiF5l4Kv6eu50aPQ1j4lF5yBzg0nmHYZSIVGNdmuSLTGF7Ve7dpVlhTneEzbknDIXbl8qq8OVr91ci7J45zjerhF1MRKSusqXbCwHkvCfk2J3PLHo4LwmxWYm5776Xk/GPQrtrWhoCxWyUiFR15J3Czm8Iyyp9uCiz4zg+17nurypmo0SkqtEF4sOrurpJczOX5JiNEpFqBEEICQmxTq5vKXjktaWfOtzh8qTGMBslIhU4bGknCMKwFzEAmQ63ffplzrdOJ7WGYZQoKMjXjtGafmkYkYgr3+KWW+wvHFu6tCX+Ftf/SENYqSeiQKt5xv64CSeeQV05DkDe21Tz+n7kzbwnoCXrFoZRIlLZxc9w0enk8S9/+WHMojtVKI7XGEaJSIPKX6u95/nbtDM2tDNsGyUKFraqtLuVQeT8usITHnXsYpJMbO9N+nR7BiaJWhob2hmGUaKez7lbHJ4FU5WUbz2KkqNCSfvx0tcKU2eJy0eqWaZOMIwSkQqkIG6L76IooqXgkXcOAQCSlj8qWpckbSl45J1Djz+ap+VGUoZR8o0euf+SlgcJec6xW7yd3Y4dKhFF0b+tBwHBMEpE2hCWte5Rz05qDMMoURc6T7QDmUx1713CM3rIqY8u/cVH7YNGh+SuvD9rmKrF8QrDKFEPJ4qiy25x1Wv0AIxbBACXWvGkfCn7MznL/3Yo+/G8yWoVy0sMo0SkAimASja2AMBMAf9yrwhYM9P8rSmvzk5y86+1xQdhtGHj4g3Ra5YkSB+zC48Cs5YVL0lQ/mQi8glRFBNeE2x9TbEvAu0daO6aLOL+FOLyvLv73XXHdd33eBnHgJgwLB4Aa4PFqLzsuML86tJ9s5N0kZAqncVUsTotu/Bo+8GGHYn5xcXFy7BqdYXSkhGRb8W+aP2P6uSpqPvzVY2a2bSucwqz0QpML86PXrwBANBQh8RpkQASps9aX9eAhEgAU6dOlW7ds2ePsne5ZTQaA/NYP73Iw7fzXYF/kZS+Cc8IFovF3+/ykM/f5e0DfX9/H4wEtrfg7f64rw+MRiO+y8qvBtB74GCjMdyrt/miPN5TGEYTEhLQUGc9qK+rxTTHO2zR00+9mf7rJ3V4rPY7ZPkuH77IoU8mJCQEbvpk9P4H9PaBPrnfIZItDMP2Frx+Eq8D+H0IEL9gauamPVXnm02mzv7/y2s++QM6B2JfdjFFRcfUdX0X9UxKRqp7MnRfy8/XBW/nR1T/2uJVxPHq+aZkUV5/jwzF271xn/UB8QseKJ18NGWT549Tmy/DaGQ0duxuWLgwsmLXtpjpS3z4ZKJA0vK0nx5rAN4eCVOy9c+7r7kSyBymmS2UO+fTAU8J6Ynrs9MKgVnLitlRT0TuSRHTlpPaAigAtBS8Vw0MGTNclZJ5zwdhNHLhmiUdH4sXKn8iEQUHU7JoNFb+8fcpFW8VtM9cqikrz6kHomLn6GUiE4ffk2940jSmpIHfq6a3brzI7vluVsNkjd4/5qdOja/Yk7P8bzkd54bk/mKyPtZsBle/JyLVDZtcunJqfMdxXNGrnFNPpHcO036Yh/rbsMmlr+pixpIrDKNEbmlhwk/PZi4xm2EGYEg1qF2W7mMYJSIVmEvMHQdXX1ub/7zUmD1xrnif1Chas/S5D6Sl8+JnZ5QmDg54ET3GMOqC5Z8AgC2C3SAMCmI9fnB+4H0oVLd//Lj0xPPhxuqHB8Aw9rnnPkgRMkoTUZD/QdXsDDFxMFCz9LmipcbsvLFqlrcz7GKyY9wiyCdXOBwSkU/IYijQ9tF3vX97xwAAMFc9Oju8UmwGBmdlZ7dnoLEpE1FlalalpB5hNkpEqhqQu2SA7eCoeNrxumlv3oHwexZpuFLPbLSDZ4t3EZG/nGldeyA89y7bgNHmgvx8YW0FZs/JCtwiWt5jNkrkmocD/vW+wpNa77LrYgIAnGl9YF3rhPRsWcQcnJWdncW2USKirp1pfWBdK2ZnuIqVmm8bZRjt4K5fnv31RD5nSDXYxoq256EfaHlUUycYRolINYZUQ2zqe2WtvRzz0Jqlz+UvrZI+Nx85FX7PWA1HWLaN2uls8S4i8oMvd/yqCdhaJGxtPzNxrnhfbN6ihJS1+dL/EjPTs/PYxaQzXxQuAjDy9RUql4MoCNy2wPK7RFcbjUwp/d2UwBenOxhGiUhDqsuEzShaNL99h/ozBUX/yHEaSwog/o6HS28fEsiiucW2USJSjSAIISEhttVdmz9P2XxI3RJ1B7NRIlKBw8LYgiDcnoG7RzvdNyQrY3GW3ZnqpWvfLwyf9heNpKJgGCUKEsceWuHd/f4phjsP5WA0MObHRXg/o9N8tPzD9wthzJ37Aw2tjc9KPREF2tQP1jqeOoIVuXjwjozO/2F1WcYhxN8xP0tTw58YRolIfa8XeXDTmYLKQ8CYpdqpzksYRolIH6orck4j/o6EpK5vDSy2jRIFC1tV2pOtpfy6NImIFW72Xi36cI27en15jSZTUTCMEgUD525x6G6fvurSQ8CYMZpLRcFKPRGpQhRFeRx3OHRWfagQyIyN83/JvMdslKjncDmqyUW3OABAEATVE1JRFD1rPahpOQMYx2ivQg8wGyUiPTh6xgQMGa2pcU42zEaJehrHVXUE19monpw5choIDx+ldjlcYxgl6uFEUXTTLa7BLqakOYvFOc6nnaeEagkr9USkGnOJuWZdjXVfptMFpS8urXO4w+VJjWEYJer5RFHcM3eR/FD1VNRcYpbvamcuKf74/3JaHO8q3+XipOawUk8ULGyRVN6h72558i/m/dLleXf3u1v6xJPlz8+ZHvi4ae8gw0/DZLuFtu5OKfm0MuyWzLBvu3yAypiNElGgOe6u3GfRD8dVzxRGX8OVjpPGpanPiCnTxwS4bN3AbJSIVHaD4YfOJ0Nv0uKEJZeYjRIRKcJslKjnsE5YEtY69yB5u0Xj7Zv/4tXSJF4935BqcKzXAwB6obfnD9EOhlGinqAnLD6iWwyjRIHg7R4erh+i/BGaYUg1QNbXZEg14HRfVKtapu5iGCXSPS0vPtI5Q6rBrwubBgbDKBFpQ3hWyjOendQY9tQTESnCbJQo0LztNLdxV/91vyeHpmv0dkwF2wtyzrYfjVgoTrnZ46tqYxglItUYtwgAjGfwmn3n0omNwtkfVsycEQsA3y19f2Oh26sawDBK1BNIiactJ9V+HioFUMmXJwBg8kREpomANW6e/XjtyRl5w1Fz+JNCIP7mrNKbjHC6qgkMo0Q9h7T4SLcbDbqh2wO5jJntny6i9gIGR+K2frA2WNycd/v4wi8OAgBMH55owqAf/sUaQx2uagPDKBEF2u2ZshFa/XBPvPWjcYtgSm7PoyPGDAJgzJq5zNWCzdJVbWBPPRFpTfnJgxg0bs4N3bmqAoZRItKUmsN/yzgxvshND1LnV9XBSj0RKTL4p09LH6T5nZ4wYYW8i6njfHLF4b8lnBhX8WO3MbSTq6phGCWibjKXmG0xFO0T5D0Ppo4uYvuqhEELxZkux4SaCrYX5Li9qiqGUSJSgdSVZMtJTSMz399Y1TGqycF3S9/fWHVzluj6qtoYRol6msCsJiXPQ+XMJWYvavfJotFoNO18xIMY6uaqBjCMEpG6yvZuLATwXYHwnd35zNuX5Q1HeadXNYFhlKjn8OHA+y7Xr3O5fH13HHjnRCdXvyvt7Ko2MIwSBYhtVVARK1QtiG+42wjEqy6mrmev3pz342V53pcuoBhGifyOO3w4s/ubDEPRckGqoQsZ4rhx0tmaY2sTak8ByBy3Ms/F8CjNYBiloKOkB8aTWrNPenh0wZBqOPbQCltfU/MbLwFofsPr5yxbgMbtePIbiNsztxelHHuydKQAcWNC7dCimYuSxI3CNxtTZi7U7n7LnMVE5F+d7PAR4JL4SfMbL0n/8fyf2P1NxmFyKzZ+AwDCzMKYoZXnRQDl4lfxMTOTAAgzcwd+Varl1D1w2ajR6K/RCj5/8jE3j/XfV3DGd/nvRUo2hnP5WIeTnj+/G38Nrf1YPthl7xss/Kbj6Oop9DUYjVcbL2Fy3FijEYBxymCU4qrROEz5y/zyBwxcGPXTrlX+2w/L4bGB3HiL79Lsi5wfq+Rd3v7DHvljyd08A/VDc+OjTCbx3DVcNJtMfQHAfAlX2ppNJsXhyidfyjkQs22Ugo6/l+N0eH5P2OHDve79MV3+TW6egVW3Zo5blDVAebECi22jRKS+m2dg1a2IeVLTPfLuMIwS+Z0oitK69LbDnpGKKiH/I1jz0JXiSFsQFUYPQFWbdF080oaxAzQcX1mpp6AjH5AUyP025JGUJKIoGq/+c/PKfwqOeWiScGvGN9vLRy5MErfnnL+1SMNRlGGUiFTVUPar88D5Pwu17WekEfjCwiJhecb2rwBkjlup3UGjYBglInVFPmaZebfL3vOkcSv10fTBMEpEGtK8XqhG0dQH7dPPg0v3rGvfqn547vglWf0DXzL32MVERKoxbhGwPsS2ePOFrSnV+x3vubA1pSOGAjiZc/DZpc2BKqEnmI0SkQoc9mIybhEav8bBRucby09srgQw+BExbjwAa2ZavT7FMWNVD8MoURBxt2yKuxEL/r7fZv9HaAQGP1KEdRl2mWbTkYtA/3kV1hgKYHxe3KTC6v2lzQ8mDe78oYHCSj0RBZqLbUGHYd6PkNCQ4fEzqi40+bRMCjCMEpH6Jk1wcyFidD/gwuZfnrAFzYNLndtP1cVKPRFpWdKIefHNmytP/Elo300kfsS8zBObq1QtlR2GUaLgYltl2ZPdPryd5eXh/aZk0UW9HjAlF+Ejx3p9/9mlU4faBjzFj/h16eCvUzS1QRPDKFGwMJeY5bsiSzspebV1kmrG5019oWNHpubGSiCzf4SKBbLDMEoUaN3eZUThGsnudpZXhSlZhKyvSToEyrv+l00FJ/YDw8f081/hvMQuJqKg4C6G+myf5G4xJYt40NIeQ10qr35W2LO64IL1sObEP3MuAP1vm6OdiUzMRikY9bC9jns0qYsp5+CzOR3nhufGzo5Vr0iOGEYpuHCvY93pP7t0PFIObq60Hk9ymnGvNoZRokDwycKmCrcScll/11gXU1LcCy7+L63/7NKpswNfGE8xjLrl0A/ggx0QPX813+WfF3Wy1zETUlW0Vw4GHPx1XFMDAPS7u3D0nChVC+U1djERBQtDqkGeezocBpggCLYGlh/PjGv61vTLNw5MWPYLvPd80ym1CtVNzEZdcFn/6ql72/bId7l9keA6Gw0qzW+8hMDuntKV8DtHXN744cmDAIZmjP5vz6fVawXDKAURURR78F7HXuly7KpfW2DsWleMfaJw6VMToNvWFYZRIlJVWN/Is5cw5eZtN/cBUPcVom9Vu0heYhil4CKK4rGHVnSMG9Vh7qOQh9V5/7bAOLSuDDJmoHrWG20YHbMNWX2XFUQM9deb/YFhlIIR9zpWl2PrylnT7/e2ARB3b2r6Y+alUwDDKJGWaal3hYCWSw2D+o4CDqpdkG7jgCciUoEoitYWFdPJohODlq3fJ4oivnq9qSHZwLZRIiIPiaJoNBpNpv1Nf8z8+j0ACP351lC1S+UthlEiUl1UxL9v1czyoV5jpZ6ISBFmo0SkIef+5xeNyB7988n2pxvPPLf8TL314IYnXh022elfqofZKBGpxrhFwPoQ2xr4l0tXNlY43dRYdvzxjhgK4Nwrv2jcF6ASeoLZKBGpwGFLO+MW4cxnC47Xubjz3PubLttloPsaH88/V1x2efL8PgEoqAcYRinoyKeTcwypNsQcfnPyaeCGJ7LxSv45u0v7zlUAUQuGdNTiJw/726uBLmCnGEaJNMfduiE9ZnHY2zOdltqK3nfHHbUQ930N+1bPfXvPATekaSXxdIlhlIhUV3vTHZ1cjeozHJdLVx7fZG0f1VoXE8MokUY5Nzj0nMVht3i68Ovlkw0AzhX8wqGL6fiClTemDPNH0bqBYZRIc6TNkM0lZo1tlOQzpmTRoYup/fyreDPf6XT95fqEYX/71xush/saH88/t6nkXIrtjMoYRok0xGHXOemwpwZTT/QZHglgyPPyiDl5yIKoc5saLjcC2shHGUYpqHnSa++uw8cf90t5aDAwJYuQDXuSDgGn4aDDR/RBxeWTWomYLnH4PZFWuIuhLjdG7hlMySIetLTHUFeGTb4hCude+V/ZKKh9ZzbVIyr+Bs0EVmajRKRlw4ZkLTj3202Nj9tNb9LUEChmo0SkbcPm3/i3bFnbaNSQ57U14CnEYrEE5k1+Gjyh/p69fJf23qXfL+Wy/m7rYtLv93LHtpVIYDbF8smXMhqNDmdYqSciFTjsdC0IAsLu/DLhobDX7x8gnTq548Qz5VekzzcmjfivxN6BLqOnGEaJNMSQajj20ApbX1PzGy8BaH7DerXHTAZ1ZfyahNuuyE+caLoy4ycjs8cGuiDeYxgl0hwpevZgtg2uJbfe8tD/jQytMx2rMx4TcL90su3zA70j71KjdF5jFxMRqe3cvp99sHZBdYvslHi5buiAeBcznTSI2SgRqeyreufNlU1XjuPKn1e0HgcwNPTF7LDhgS+XpxhGibSlkyVQe0xPvYgVDl1Mklj82PrppOkKMODJFWHDAVSJD73VZut60h6GUSLSnuGJI15PlB03XT6JAVpNSNk2SkQqEEVRPlZUFEXxE72uJ8AwSkSqEUXRYrG4GHv/xVvHHnqrTfp80nTlxgkDtZqKgpV6ItKi2+8fkZ5/wrr21UTh9fs1O/YeDKNEpBXDE0e83nHUOy17ZJp6hfEGK/VERIowjBIRKcIwSkSkiG/DaMPGxWlpaWlpqyu6vpeIqEfwaRit2LAjMb+4uHgZVjGQElGQ8OWyzQ0bV++etmRhJFCxenFd+pqFkQCmTp0qXd2zZ4+vXkREpB2+HPBUX1eLaY4nbdGTq9/zXfyx+C4VX+Srdzmvfu/LSn1UdIwPn0ZEpAu+DKOR0dixuwFAxa5tMdGRPnwyEZFm+XQWU0J64vrstEJg1rLiBF8+mIhIs3w7GTRy4ZrihT59IhGRxgVug2W9mzp1ao8cbNAjv1eP/FLood+rB3wpzmIiIlKEYZSISBFW6omIFGE2SkSkCMMoEZEiDKNERIowjLpUsTotzdWSfz1hJcCGjYudit/+vdIWb2xQpVBKdfal9PpjuSu/rn+srr6UTn8sCzmpf/Oplz6zfnjqzfqOC5+9JB1+9tLd0g2689lLd999t3PhP3tJp9/HYrG4+1J6/7Hcll/PP5a7L6XzH4vZqAuRC9csSQCAyOgY+eIADXVInBYJIGH6rNo6/WUCQAWmF+dnjnI83VBXu22VXvMbN19K7z+W2/Lr+cdy96X0/mMxjHaiYvX66HTZ4gD1dbWqlcU3EhJcrnVQX4fM/OLi4uJnsUF//9t0/aX0/mO5Lb+efyx3X0rvPxbDqDsVq9N2TZeWnm7XY1cCTFhi/aJ6/6+zjN5/LLfl1/OP5e5L6f3HYhh1pWHj4rRd04uXOGQ5PXUlQHn/TI/5Xnr/sdyVX9c/lrsvpfcfi2HUhYoNhUchtT9JDVAVq6V2qIT0xB3ZaWlpq7DMMcTqkvV7RS58Nnp9WlpaWtqu6fr/Xj3lx3Isf4/4sdx8Kb3/WJwMSkSkCLNRIiJFGEaJiBRhGCUiUoRhlIhIEYZRIiJFGEaJiBRhGCUiUoRhlIhIEYZR0r2yrJAZa450HGSVqVocCjqcxUT6d2TNjJu+ybEUzJd9IgoYZqOkf6NT06e/+k4ZcKRkA15+hjGUAovZKPUIZVkh79x7eFzuI1i3c/FotUtDwYVhlHqGsqyQ3K+nT8jZyQo9BRor9dQzzH/mZeyacC9jKAXe9WoXgMgnjpRswMvrGEVJBQyjpH9lWSEpr+IXpRY2ipIa2DZKRKQI20aJiBRhGCUiUoRhlIhIEYZRIiJFGEaJiBT5/7Q3bQWs1M1jAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Adding some extra spice to it...</span>
<span class="co"># creating a radial plot:</span>
<span class="co"># ggplot(ggd1) + scale_y_reverse(expand = c(0.2, 0)) + coord_polar(theta=&quot;x&quot;)</span>
<span class="co"># The text doesn't look so great, so let's remove it:</span>
<span class="kw">ggplot</span>(ggd1, <span class="dt">labels =</span> <span class="ot">FALSE</span>) +<span class="st"> </span><span class="kw">scale_y_reverse</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">coord_polar</span>(<span class="dt">theta=</span><span class="st">&quot;x&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAHCCAMAAABLxjl3AAAAFVBMVEUAAAAAgs4iiwDMR2vdoN3/pQD///+YzjULAAAACXBIWXMAAAuIAAALiAHljilJAAASIElEQVR4nO3d6YKjIBAE4HGz4/s/8m4OL24IdHdh1Z+dSYw4fosCovlZGfD8aG8A821ICB8SwoeE8CEhfEgIHxLCh4TwISF8SAgfEsKHhPAhIXxICB8SwoeE8CEhfEgIHxLCh4TwISF8SAgfEsKHhPAhIXxICB8SwoeE8CEhfEgIHxLCh4TwISF8SAgfEsKHhPAhIXxICB8SwoeE8CEhfEgIHxLCh4TwISF8SAgfEsKHhPAhIXxICB8SwoeE8CEhfEgIHxLCh4TwISF8SAgfEsKHhPAhIXxICB8SwoeE8CEhfEgIn/kJ//79q70JYzM74d93tDdjZEgIn8kJ//6d33ACwp+f+B+RJ/z9/R2xUYKBJ/x5J/JujvD3nVEbJ5LJCXPnQhLq5+enqBpG3v39ncBwdsL1kTkRklA7ecJleUQ/TUILyQimCXkutBASwhO+EJf4u2lC9gtNZHnm/MJFJUf4SL6LEAjC1IFyfRsevznHxgxhRjBTsonY38Ls2S5KuHzSTJgt2USsb99aQ/j8Ye8nLAsJjSTb81uXc86Ezzcfj5RSiaB1Q+Obt7YTft4koX4qCRe3OUNC/eT34873/KWGMN8etS84C+Hl12u/kIQWkh5/SecbwvVhHxCEcPUqWnm+IcQYuUEhXBUIMQSBCBsNSWgmFYSXAbd2QhBBHMIKw2LCKSohCaNBEQQiLDckoVZyfbBCwmOc5pUE4VeCdq72myEsGAkpMxQhtDTnZgJCZ6JoH8JMJSShn6KrAiHDz3Tt460U4UX7+0pow3A+QicnQmdy/veVkITnlF2b86H2W5diho8j5YTpi4wkDOcjmG6xfEXo3qiWroVpREOCYISO4f9zXvYe0ADhByc3NpNCJGEwT8Al13E43v5cqM/dxRsk/CRd1GeJyMqtAJoiXJy2ZGQhZ9mKe+n3RYsE19dyALfq2yEsAVxf1fBk/amHZZ1+tzmT/wQJa1Io6PqdJz5lk7xdNJj84xb0Y4SwHCLkVzr+XXT0vOQ4f9Z9TjI2CGsk2irgM2UnwEvcVqzF6xcGCD8t0crL8rV+a0sl3A0fB6E5Q3XCrT/YAlhdWPX+f3iV0J6hGcLCxb/wa8m7W7HbWxRUJ6y7b0EY0CUr7E4KB4lQGtCrdCYFgQjFAcOVUKzw4mgTFp8Lxf0CZCYFVQjPI8RLWYtUATDUCckTKtxHI094uU7zVHn3C5Of0QBsOW6q3M2mS/hkyet0qoK1Ig1nvnsQnucsVAl+XXIlSXslFDbUJHy55Hj6nQUbCCtLuB1hiWDPZkydSUsP4iaEq5ZgJUqD4ONxj3PhRngIRoE69ySqCBvG0h63IXz3C8sFuxXbQFh95NV4voLa6Iy4oEOY1alE1BsC1xxgKxAcV3jhLMRiFr0BVEVCfcHcTscw1CNUFSw9TFYgqh1JlQi3+TKRtyWGRMv2OIChCmHu6oTUoLbTugm2JmsNu21ccVQJI2/rXJaI9umsG2oQZsahlC4sxbfJuKE1wtcNEuKCRyX8zvC1nPT0fVuEubuuxyVJWGMofw+GBuES3Vkbofw2Hf+vglLlhjcnVL2PaBMMS5UaKvwJCoTPU130RGiBMEhVaHgPwvi4jCrh+ypDfNSmzPAmhGu0yal4Ltx4HlHEshG5e5wLo4/i2p59oNAiPY3UfGH4uEuLNCr4/3WlfuH18mHaMH5V9/2h071sIhlP6P+XjAi9X9YYm1m9K8Bxw/QAwPHh7dXxDzcZTRg6rkQr4WpFMGEYIzwvf/wo8YghBcKUYHZa6aD4WpHTXmwQ57L4wTkBYaCNnT+Mjt2kUMKdiNCSYULXezMUedyeLOFbKbSgqmDFPfhBQq/GTkl4etRIaDnVpkwF4X4udMm85Z6GjxkIj2sP+x0wEcIVQzBMGGsOPSY4F54Jc4Jqh9FSwsfeL/TbOv7v0xC++4VLmlD3RFgpuP+YXse2MH6/8JPlc3nComAh4XnIJtBrDBp22bxcxAbY4td5EQ6jD0fNN8weWodFbow0SqgsWLKv/ZHvgmooFTHC+NyUg1BqWy5pErRkKE/oQqkfRhundN+Z0JFCaMuExrzNVEPxc6FLpV4JmxcLHFu7bFJtFAivLyNUwthHbVRDOcLPtLVoJRTbkHO+2ulGqqEkYYgJtxKuVlo0cl37IBO0oJFqKEoYenEFJrRhKEU4YyW8IWHgxehbIvl+h1swlLxSEXg1+pZEeuxujzA+y3RUBAkDL0bfkkiXi0EOYeIexWGRKW3aSugeSecmDLwYfUsinc5aF8L45ZiB0SYEr4RONZyXMDxpZieU2AQv3ZqOB2H6mQvDMqiw66Sf4Mwn7SlPPQkfp7ueEoJjblobQuhOvUsTjtiCbDr23x6npAhH3XkoQWiwEnbtgp8IX6fDyKqRCN1p6HNXQv/e7vDKh92FP5Tw4zM7ods5DF/iRyVcjkdwT3scDc3GDywCRbieBY9cFpmpEhatftyDFEg4cvWXO3+hCPd+YV7Q8rS17woIzD0F6heec8NK6HQzRkdugM15ZdUjHL9fb0CofGO9AGHoODooYoTOC6FXhSKxY6X4nhEh9G6G0SQU2beSU2gECP2hX5AHlFgv5BNdwvGFe5HZuXMRBi6DKhIKnaMmJTzI9oHT4YV7Edq3r2KmeVzCmfDDthEOL9uLWO2Q61PIngvPo203IBSaQyPenDlqogKh3ClK8Ht9BYrwv9JAi1Cwvz0bYfjeUJVaKIUoOB9RaIAt8JJWn0KoSToZYSCKF5qE2onTEyp9ocgqbihQ0PgiAlH8Xh8xQxIOjGA9lChIhfAyH0+nYSpUzF0I5Zs2Mvt2pokXbs6E4elRozNTNexP6J3jAjpeJVSohyKFBIrp3sTpTRj8gh/P5/r9IxrdfC3CAe3U8YRBoMVj7rwd2ShMgsrfQ9qUzoTHt8PsbsEqpjY4s0eK8JoRYza3JZQwxCbcj43hEx0J+2XcufBE6C92T8IVrDlzmezk5h6EgTIACI9+YdLoQjj5NBon5vuFR0goFB3ChYT9okcY+00q47+VTih3JZT4bkihkBA+NyUU+Z5koYwjPD30wnuPhB0zinDfQ1FC1a49CfO5PD3If1ubkOfCbNzHsLkhYb/clXD9mQTwzoRa89i7Z3hzJhx1wnkESYifof3CuJI24USCQ0dnEkrOm+KiJCyJZcJ+gn/+9FpTc8YSRl10CTteOP/zSa/1NWTgAcUs4QBBTUhFQq2B7p6TV/6E0m3tZVEiVLxW0XX6UZBQGPJ2hH0nkG1WmpADCLedlCVUmABVP4czrXBVKoBE+KqR6xPX4supdO4bZuGm61LozQTkkGcMjCJcYlcKt8gTNk2jzhwR0+94gSAMPLoyHNkL9813o2ROa7nTXVCws6EaoXhHoq0Zk26cFLZYkAlTS0p355s+9jaKIpYJ7gtjEJbfugNDuP/gIRZWwiMQ58LJCE+dCh/x/59Z2fHDICzuPEu3Zzqs5ELY1kBC6BeWxyMcKdppTOZUCcUek5eLHcKxlbLbvnYqoQFDZcIl+mvvdL+3loQrajXc10dCcEKeC5+Rve47qBr2XWnThmgWDn0yXP+YADRFiHYkNTB57RV1wks1HFpanWHeh4TP2B2gyY9+WhEkYTgFA9gkfEV0nLSCEElQmVB49mHpkqmpFscy325Pr5DQD5agBcLFfWlUYYWGJYIkPOISjqyWZYRogiYI6wzbhYsICwWTi8gCixKWPDihYNZUa/ElhEWCOcPClXSKHGGkAxGqhvVrKUoBYfnOTywXnbM4JlKES3ReaV01/P9es2GesGbPxxedkXA5EnnT+T2xpvWLY2nOsHLHxxcWPZKOJDzujskapn6/vnX6p2GDkm/X7/jU8td3Bj5rahzhdWL+yyWE48sm7w12fqjdpOTbDVWn6CN//gx94psY4fMlvxomKqeX82KNjZq8YfUqC6ouKuHl5ortxcBpr7iJeV2uzTB7MqxfpYsYundm7NNPBQhPLy6uZ3kfwVuuBXHUTImToV8n8Qkvrx77vQ4wdPazZLjJhW+zACUMz/D6v9dfr1UCRtov9YjjJiw9DaOT2jDPhZFJeqU3kF4TW7RqJe/ia5auy3yE4VucSm8gvSSxbKWht0U9O+CpCd6Q/cJwcUc7Nb/wtkhaqQrR2b19x1CU5uhrERYs+5/m83WkmatPFYiXgnuPZJLQyQvw/bXA+UWLFfeS/Zt2v4/OHH3x8ioq4UZYtHAh4uecNAKQhF4qnw9RovhpGY4BXN/diq6rLIlCidcBm3iqH/GR76k4hKUrLozkpfpTVObOlJ23Wp7SklbcR0mG7GzR2RanKBHWGFYOwCzxnAhbNjsTJUGlGWx1hNVDoVnChk3ORqsSak1CLFR5AzYMZ0cyo6BxwrWkjVKRwYQj1puP1lTguhHSrvWw05qukZ06eonabG4tw0ERnXZ4jV4tnMxQrx6qnQurSIAM5RG1+oVNnb0xW9MtSoYKhE0aSIbCiPKEjRQAgqtORZQmbJdAEFSpiHKErx4ZRl36Kh9DuctOUuXsX7AtVJ5iktMRB0SaUKg43UxJ2P0age3qLDoRCpfQMiIJ8zHeTZyRsPtlnq7XoPpnwnNh/yt1+6X4fqvsmBkJ+1+pO02o6LreTpmvXzgii3FFoSATEvEVbMLV+jlRIvCE68BnC2P8v5iBcHV3dngWaf06SaiWLoS5D5nhtUPYcZeECasKyH7IThU1Q9hzl3xNmP+UoRaUFcLRu6Rm9Tte3HD55qGanWOEcNthIwuoeMbNRhcj3N/tt4HtMUO4jm0CFq/7evwMG26v2TC0Qeg9pDLzjIuWEoqftnhZNPC500smDE0QOvvk/Wih5OJjOnmBJoxfDV3h2i3pHguE132yPVsouXz1rst/ItIGdV9x3jdgaIDQ2UX5S21bW7GykOTy0U5E7riqb6hM6B8z83MW3stXVsXkwksUcL0ahpZYPg93VIsqYQirlLBy7kV8ySUJ+F7gfbk6soTOA4NO5auVvGYIP3XN/5RzXCtzjNSfrN9zsX0ac3iZOxOGK9wmGOsqhpobBY0Vt5ilEHDNzUQXna0W3ACtgtc8YXjvRs9XKYa9IFeugD8zgZKEgT/++Up0F+dPaYmi6v1WEqYLT/ztsd1c1rB0cpxgq/DeyU1jvvO5MPPHh3d3dseXEhZu47I/NKrtrxgf/X5h/E3/gPdT+hRFv5iNsPajeULJOaPB0hXLzidYl1pW9MVHl2XrFxqNbcKtU6FJaGeSTCS2CY+T1vmE1rSqus+pD3xWxD7h/vNxQhMtd3tleKGtMU143ZNftEnqi12czigJm+LuyKNjMLzU5doVremFiMc64fl3iUrodxtrO5LiMUwY2G+fYc7TImNKPY8kVA8GSMcuYcleG7Bnw36Wz4ZWCRPX544MqR77+q7Vb9G+OB+NyY0qfdDQsYu7zubfvuzr8h/km4GFsTG4SWvFwxW2fdyxLh5frXCt4SSsSdVTat6VcAzh6WX1y4LR2NuiteFBQ/0Fve/cI2FVTBA6r5OwLrUPGupHuMQIeS6sS57QnRXfh/C5ntjXtZGwMpk6eEXr8qDTrQUa/8Y9k4B2CTM5d9p6PN7t0gus+8pE9cASrvt+/4bwd3tguPWB0EQwCc+DYHvztX7/n2bak1A45z19JqyECBHiGd6W0Km/S+9BHrkgEjrf71t5ODwW8g/BZq9GpAK3wX6j/2jOFAienf1BILN9v1TANncNEDqdyHJCvy1LQolkv+2+9Di6+j1Ku+OgqWBt7dqH8Pjt2p8koUj6El5DQplkBHN3Py2Zz8IJTkeYQ/ju0yYDtrmvfFOPCurwV9umELgNTid3NsueSQFDQviQED6TEX59LgQMCeEzG2G+TTkZ4IyEtwsJ4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4UNC+JAQPiSEDwnhQ0L4kBA+JIQPCeFDQviQED4khA8J4fMPOObzxlvobEUAAAAASUVORK5CYII=" /><!-- --></p>
<p><strong>Credit:</strong> These functions are <em>extended</em> versions of the functions <code>ggdendrogram</code>, <code>dendro_data</code> (and the hidden <code>dendrogram_data</code>) from Andrie de Vries’s <a href="https://cran.r-project.org/package=ggdendro">ggdendro</a> package. The motivation for this fork is the need to add more graphical parameters to the plotted tree. This required a strong mixture of functions from ggdendro and dendextend (to the point that it seemed better to just fork the code into its current form).</p>
</div>
<div id="enhancing-other-packages" class="section level2">
<h2>Enhancing other packages</h2>
<p>The dendextend package aims to extend and enhance features from the R ecosystem. Let us take a look at several examples.</p>
<div id="dendser" class="section level3">
<h3>DendSer</h3>
<p>The DendSer package helps in re-arranging a dendrogram to optimize visualization-based cost functions. Until now it was only used for <code>hclust</code> objects, but it can easily be connected to <code>dendrogram</code> objects by trying to turn the dendrogram into hclust, on which it runs DendSer. This can be used to rotate the dendrogram easily by using the <code>rotate_DendSer</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if(<span class="kw">require</span>(DendSer)) {
   <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
   <span class="kw">DendSer.dendrogram</span>(dend15)
   
   dend15 %&gt;%<span class="st"> </span>color_branches %&gt;%<span class="st">                      </span>plot
   dend15 %&gt;%<span class="st"> </span>color_branches %&gt;%<span class="st"> </span>rotate_DendSer %&gt;%<span class="st">   </span>plot
}</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="gplots" class="section level3">
<h3>gplots</h3>
<p>The gplots package brings us the <code>heatmap.2</code> function. In it, we can use our modified dendrograms to get more informative heat-maps:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gplots)

x  &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(datasets::mtcars)

<span class="kw">heatmap.2</span>(x)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># now let's spice up the dendrograms a bit:</span>
Rowv  &lt;-<span class="st"> </span>x %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="dv">4</span>) %&gt;%
<span class="st">   </span>ladderize
<span class="co">#    rotate_DendSer(ser_weight = dist(x))</span>
Colv  &lt;-<span class="st"> </span>x %&gt;%<span class="st"> </span>t %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k =</span> <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="dv">4</span>) %&gt;%
<span class="st">   </span>ladderize
<span class="co">#    rotate_DendSer(ser_weight = dist(t(x)))</span>

<span class="kw">heatmap.2</span>(x, <span class="dt">Rowv =</span> Rowv, <span class="dt">Colv =</span> Colv)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="nmf" class="section level3">
<h3>NMF</h3>
<p>The same as gplots, NMF offers a heatmap function called <code>aheatmap</code>. We can update it just as we would <code>heatmap.2</code>.</p>
<p>Since NMF was removed from CRAN (it could still be installed from source), the example code is still available but not ran in this vignette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(NMF)</span>
<span class="co"># </span>
<span class="co"># x  &lt;- as.matrix(datasets::mtcars)</span>
<span class="co"># </span>
<span class="co"># # now let's spice up the dendrograms a bit:</span>
<span class="co"># Rowv  &lt;- x %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram %&gt;%</span>
<span class="co">#    set(&quot;branches_k_color&quot;, k = 3) %&gt;% set(&quot;branches_lwd&quot;, 4) %&gt;%</span>
<span class="co">#    ladderize</span>
<span class="co"># #    rotate_DendSer(ser_weight = dist(x))</span>
<span class="co"># Colv  &lt;- x %&gt;% t %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram %&gt;%</span>
<span class="co">#    set(&quot;branches_k_color&quot;, k = 2) %&gt;% set(&quot;branches_lwd&quot;, 4) %&gt;%</span>
<span class="co">#    ladderize</span>
<span class="co"># #    rotate_DendSer(ser_weight = dist(t(x)))</span>
<span class="co"># </span>
<span class="co"># aheatmap(x, Rowv = Rowv, Colv = Colv)</span></code></pre></div>
</div>
<div id="d3heatmap" class="section level3">
<h3>d3heatmap</h3>
<p>The d3heatmap package create interactive heat-maps that are usable from the R console, in the ‘RStudio’ viewer pane, in ‘R Markdown’ documents, and in ‘Shiny’ apps. By hovering the mouse pointer over a cell to show details, drag a rectangle to zoom, and click row/column labels to highlight.</p>
<p>The use is very similar to what we’ve seen before, we just use <code>d3heatmap</code> instead of <code>heatmap.2</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x  &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(datasets::mtcars)
<span class="co"># d3heatmap(x)</span>
<span class="co"># now let's spice up the dendrograms a bit:</span>
Rowv  &lt;-<span class="st"> </span>x %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="dv">4</span>) %&gt;%
<span class="st">   </span>ladderize
<span class="co">#    rotate_DendSer(ser_weight = dist(x))</span>
Colv  &lt;-<span class="st"> </span>x %&gt;%<span class="st"> </span>t %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k =</span> <span class="dv">2</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="dv">4</span>) %&gt;%
<span class="st">   </span>ladderize
<span class="co">#    rotate_DendSer(ser_weight = dist(t(x)))</span></code></pre></div>
<p>Here we need to use <code>cache=FALSe</code> in the markdown:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(d3heatmap)
<span class="kw">d3heatmap</span>(x, <span class="dt">Rowv =</span> Rowv, <span class="dt">Colv =</span> Colv)</code></pre></div>
<div id="htmlwidget-b598f031cddb7b5f547f" style="width:450px;height:450px;" class="d3heatmap html-widget"></div>
<script type="application/json" data-for="htmlwidget-b598f031cddb7b5f547f">{"x":{"rows":{"members":32,"height":425.344651694364,"edgePar":{"lwd":4,"col":""},"children":[{"members":9,"height":214.936685793747,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Maserati Bora","edgePar":{"col":"#CC476B","lwd":4}},{"members":8,"height":134.811946429091,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":3,"height":40.8399635773589,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Chrysler Imperial","edgePar":{"col":"#CC476B","lwd":4}},{"members":2,"height":15.6224446230416,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Lincoln Continental","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"Cadillac Fleetwood","edgePar":{"col":"#CC476B","lwd":4}}]}]},{"members":5,"height":101.738968566622,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":2,"height":40.005247468301,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Pontiac Firebird","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"Hornet Sportabout","edgePar":{"col":"#CC476B","lwd":4}}]},{"members":3,"height":21.2655989805131,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Ford Pantera L","edgePar":{"col":"#CC476B","lwd":4}},{"members":2,"height":10.0761202851097,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"Camaro Z28","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"Duster 360","edgePar":{"col":"#CC476B","lwd":4}}]}]}]}]}]},{"members":23,"height":261.849881468371,"edgePar":{"lwd":4,"col":""},"children":[{"members":7,"height":103.431069316719,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":2,"height":33.5508692137775,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":1,"height":0,"label":"Valiant","edgePar":{"col":"#228B00","lwd":4}},{"members":1,"height":0,"label":"Hornet 4 Drive","edgePar":{"col":"#228B00","lwd":4}}]},{"members":5,"height":51.8242520447715,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":2,"height":14.0154994559595,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":1,"height":0,"label":"AMC Javelin","edgePar":{"col":"#228B00","lwd":4}},{"members":1,"height":0,"label":"Dodge Challenger","edgePar":{"col":"#228B00","lwd":4}}]},{"members":3,"height":2.13834047803431,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":1,"height":0,"label":"Merc 450SLC","edgePar":{"col":"#228B00","lwd":4}},{"members":2,"height":0.982649479723062,"edgePar":{"col":"#228B00","lwd":4},"children":[{"members":1,"height":0,"label":"Merc 450SL","edgePar":{"col":"#228B00","lwd":4}},{"members":1,"height":0,"label":"Merc 450SE","edgePar":{"col":"#228B00","lwd":4}}]}]}]}]},{"members":16,"height":141.704447795403,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":4,"height":14.7807070196253,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Honda Civic","edgePar":{"col":"#0082CE","lwd":4}},{"members":3,"height":10.3922856003865,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Toyota Corolla","edgePar":{"col":"#0082CE","lwd":4}},{"members":2,"height":5.14734154685698,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Fiat X1-9","edgePar":{"col":"#0082CE","lwd":4}},{"members":1,"height":0,"label":"Fiat 128","edgePar":{"col":"#0082CE","lwd":4}}]}]}]},{"members":12,"height":113.302300506212,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Ferrari Dino","edgePar":{"col":"#0082CE","lwd":4}},{"members":11,"height":74.3824295717746,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":5,"height":64.889871320569,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Merc 240D","edgePar":{"col":"#0082CE","lwd":4}},{"members":4,"height":15.6724726830197,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":2,"height":1.52315462117278,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Merc 280C","edgePar":{"col":"#0082CE","lwd":4}},{"members":1,"height":0,"label":"Merc 280","edgePar":{"col":"#0082CE","lwd":4}}]},{"members":2,"height":0.61532511731604,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Mazda RX4 Wag","edgePar":{"col":"#0082CE","lwd":4}},{"members":1,"height":0,"label":"Mazda RX4","edgePar":{"col":"#0082CE","lwd":4}}]}]}]},{"members":6,"height":50.1094029998363,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Lotus Europa","edgePar":{"col":"#0082CE","lwd":4}},{"members":5,"height":33.180384265406,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Merc 230","edgePar":{"col":"#0082CE","lwd":4}},{"members":4,"height":20.6939435584424,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Volvo 142E","edgePar":{"col":"#0082CE","lwd":4}},{"members":3,"height":13.1357108677072,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Datsun 710","edgePar":{"col":"#0082CE","lwd":4}},{"members":2,"height":8.65359029536296,"edgePar":{"col":"#0082CE","lwd":4},"children":[{"members":1,"height":0,"label":"Porsche 914-2","edgePar":{"col":"#0082CE","lwd":4}},{"members":1,"height":0,"label":"Toyota Corona","edgePar":{"col":"#0082CE","lwd":4}}]}]}]}]}]}]}]}]}]}]},"cols":{"members":11,"height":1475.10429122825,"edgePar":{"lwd":4,"col":""},"children":[{"members":9,"height":115.849514457334,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":7,"height":34.7850542618522,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":6,"height":18.9208879284245,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":4,"height":10.6897474245185,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":2,"height":2.98172768709686,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"drat","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"gear","edgePar":{"col":"#CC476B","lwd":4}}]},{"members":2,"height":8.59634050046879,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"wt","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"carb","edgePar":{"col":"#CC476B","lwd":4}}]}]},{"members":2,"height":3.60555127546399,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"vs","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"am","edgePar":{"col":"#CC476B","lwd":4}}]}]},{"members":1,"height":0,"label":"cyl","edgePar":{"col":"#CC476B","lwd":4}}]},{"members":2,"height":33.2610913831762,"edgePar":{"col":"#CC476B","lwd":4},"children":[{"members":1,"height":0,"label":"mpg","edgePar":{"col":"#CC476B","lwd":4}},{"members":1,"height":0,"label":"qsec","edgePar":{"col":"#CC476B","lwd":4}}]}]},{"members":2,"height":656.640441946732,"edgePar":{"col":"#009681","lwd":4},"children":[{"members":1,"height":0,"label":"disp","edgePar":{"col":"#009681","lwd":4}},{"members":1,"height":0,"label":"hp","edgePar":{"col":"#009681","lwd":4}}]}]},"matrix":{"data":["3.54","5","3.57","8","0","1","8","15","14.6","301","335","3.23","3","5.345","4","0","0","8","14.7","17.42","440","230","3","3","5.424","4","0","0","8","10.4","17.82","460","215","2.93","3","5.25","4","0","0","8","10.4","17.98","472","205","3.08","3","3.845","2","0","0","8","19.2","17.05","400","175","3.15","3","3.44","2","0","0","8","18.7","17.02","360","175","4.22","5","3.17","4","0","1","8","15.8","14.5","351","264","3.73","3","3.84","4","0","0","8","13.3","15.41","350","245","3.21","3","3.57","4","0","0","8","14.3","15.84","360","245","2.76","3","3.46","1","1","0","6","18.1","20.22","225","105","3.08","3","3.215","1","1","0","6","21.4","19.44","258","110","3.15","3","3.435","2","0","0","8","15.2","17.3","304","150","2.76","3","3.52","2","0","0","8","15.5","16.87","318","150","3.07","3","3.78","3","0","0","8","15.2","18","275.8","180","3.07","3","3.73","3","0","0","8","17.3","17.6","275.8","180","3.07","3","4.07","3","0","0","8","16.4","17.4","275.8","180","4.93","4","1.615","2","1","1","4","30.4","18.52","75.7","52","4.22","4","1.835","1","1","1","4","33.9","19.9","71.1","65","4.08","4","1.935","1","1","1","4","27.3","18.9","79","66","4.08","4","2.2","1","1","1","4","32.4","19.47","78.7","66","3.62","5","2.77","6","0","1","6","19.7","15.5","145","175","3.69","4","3.19","2","1","0","4","24.4","20","146.7","62","3.92","4","3.44","4","1","0","6","17.8","18.9","167.6","123","3.92","4","3.44","4","1","0","6","19.2","18.3","167.6","123","3.9","4","2.875","4","0","1","6","21","17.02","160","110","3.9","4","2.62","4","0","1","6","21","16.46","160","110","3.77","5","1.513","2","1","1","4","30.4","16.9","95.1","113","3.92","4","3.15","2","1","0","4","22.8","22.9","140.8","95","4.11","4","2.78","2","1","1","4","21.4","18.6","121","109","3.85","4","2.32","1","1","1","4","22.8","18.61","108","93","4.43","5","2.14","2","0","1","4","26","16.7","120.3","91","3.7","3","2.465","1","1","0","4","21.5","20.01","120.1","97"],"dim":[32,11],"rows":["Maserati Bora","Chrysler Imperial","Lincoln Continental","Cadillac Fleetwood","Pontiac Firebird","Hornet Sportabout","Ford Pantera L","Camaro Z28","Duster 360","Valiant","Hornet 4 Drive","AMC Javelin","Dodge Challenger","Merc 450SLC","Merc 450SL","Merc 450SE","Honda Civic","Toyota Corolla","Fiat X1-9","Fiat 128","Ferrari Dino","Merc 240D","Merc 280C","Merc 280","Mazda RX4 Wag","Mazda RX4","Lotus Europa","Merc 230","Volvo 142E","Datsun 710","Porsche 914-2","Toyota Corona"],"cols":["drat","gear","wt","carb","vs","am","cyl","mpg","qsec","disp","hp"]},"image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAALCAYAAAAeEY8BAAAC/ElEQVQ4jYWST2hUVxjFf999b/7G1GhcqNGkUJlUaDptrEhXKVVBbdQGQUTciUXBdikWIgqCYFcuSynYRSjOkHZRFWJijEWJopC0SCm6EP8EBZ2mmSRT38y89z4XN2/GEaUX7ur+OPdwzpFcLKNiQENw4+CVQAQSaUimBAWW/3Wbe4USJtsDgONAqOBXACDZBImU4DhwettJxn5YTC71tWVdCMNG1nEhmRROZI8gWsxrrrUfAOOA6pvhbzu+YeJiE7kVpwBrMgwhDOrsomYhDOFc/4/81DNGbt3A/7JyevSeHll2jvz6AQsGIMaaiJJIpS384PwQe7sNI82bUbXvSKPheEIwBh78NsSBDc/5NbGvZuJ1NpEUTNee7XxX2EPfi4GaQyJxbCWlOcV1IbNrC0u4w46j71lMbXUi9nol8P5T4nFYs2sLnt/Clyc6ayxqU450y54iF5d1qjGw9M9brP/jKPnto2+NLZkWjIC5Nc7mv/sbWFUI/FfYhU18eP8myx99T77r7BtZ+aUpo+kmAYHs6/DCOF8VTqUFMXV28KOzqELo24g1tKwTg1WrhbkSfNyzhOLDWSYnrFDoLyQCyM+SUScG73YIxXn44NN38D2fG5dLFg7qopHwipXCCw+6N7bizXiMj8y/lW1vF2ZL0P35UryZMuPD84ixrOOCUYWgCo8eW0uT12ZpO7iO3bf31Tozjk0D7IiePlHiMZi88g8rD37Chs9SNdZx7ccROzWlaAgTo9O0Hd9K35ms3c2CCePGLVzxoPiv4jowcuAaWi7TdyZrB2lsd5FwUIXCc0UEhvf/Tnv/JnYe7wSt1xCx1TLMFRVjYKh3ELervcaKARP69Q+qZZiZVpoXwaXeQSp3p9l58v0arGF9xRUPpgt28WN7LxBb28oXh1Y3bCdiq2XLxlwY3n0BszjBjmMZyxiXhhNUYeqxFb6en0LLAdu+WoVQF4zqCKpQeKY4Dlw6dIP4mha27m+zSdgwasevWBOuA1dP3cFpSdB7uIOXrJ5bjNUneXYAAAAASUVORK5CYII=","theme":null,"options":{"xaxis_height":80,"yaxis_width":120,"xaxis_font_size":null,"yaxis_font_size":null,"brush_color":"#0000FF","show_grid":true,"anim_duration":500}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dynamictreecut" class="section level3">
<h3>dynamicTreeCut</h3>
<p>The <code>cutreeDynamic</code> function offers a wrapper for two methods of adaptive branch pruning of hierarchical clustering dendrograms. The results of which can now be visualized by both updating the branches, as well as using the <code>colored_bars</code> function (which was adjusted for use with plots of dendrograms):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># let's get the clusters</span>
<span class="kw">library</span>(dynamicTreeCut)
<span class="kw">data</span>(iris)
x  &lt;-<span class="st"> </span>iris[,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>as.matrix
hc &lt;-<span class="st"> </span>x %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust
dend &lt;-<span class="st"> </span>hc %&gt;%<span class="st"> </span>as.dendrogram 

<span class="co"># Find special clusters:</span>
clusters &lt;-<span class="st"> </span><span class="kw">cutreeDynamic</span>(hc, <span class="dt">distM =</span> <span class="kw">as.matrix</span>(<span class="kw">dist</span>(x)), <span class="dt">method =</span> <span class="st">&quot;tree&quot;</span>)
<span class="co"># we need to sort them to the order of the dendrogram:</span>
clusters &lt;-<span class="st"> </span>clusters[<span class="kw">order.dendrogram</span>(dend)]
clusters_numbers &lt;-<span class="st"> </span><span class="kw">unique</span>(clusters) -<span class="st"> </span>(<span class="dv">0</span> %in%<span class="st"> </span>clusters)
n_clusters &lt;-<span class="st"> </span><span class="kw">length</span>(clusters_numbers)

<span class="kw">library</span>(colorspace)
cols &lt;-<span class="st"> </span><span class="kw">rainbow_hcl</span>(n_clusters)
true_species_cols &lt;-<span class="st"> </span><span class="kw">rainbow_hcl</span>(<span class="dv">3</span>)[<span class="kw">as.numeric</span>(iris[,][<span class="kw">order.dendrogram</span>(dend),<span class="dv">5</span>])]
dend2 &lt;-<span class="st"> </span>dend %&gt;%<span class="st"> </span>
<span class="st">         </span><span class="kw">branches_attr_by_clusters</span>(clusters, <span class="dt">values =</span> cols) %&gt;%<span class="st"> </span>
<span class="st">         </span><span class="kw">color_labels</span>(<span class="dt">col =</span>   true_species_cols)
<span class="kw">plot</span>(dend2)
clusters &lt;-<span class="st"> </span><span class="kw">factor</span>(clusters)
<span class="kw">levels</span>(clusters)[-<span class="dv">1</span>]  &lt;-<span class="st"> </span>cols[-<span class="dv">5</span>][<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>)] 
   <span class="co"># Get the clusters to have proper colors.</span>
   <span class="co"># fix the order of the colors to match the branches.</span>
<span class="kw">colored_bars</span>(clusters, dend, <span class="dt">sort_by_labels_order =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcIAAAHCCAIAAADzel4SAAAACXBIWXMAAAuIAAALiAHljilJAAAgAElEQVR4nO3deXCUZ54n+O975J3KTB0oJYSRBZKQLY7CQOFGuLApXDbYU/bUVlFA97g7endhll4Hjujq3qjYiooOR0fMRtVUjImK8TTETk+0d8blcfVu2DVtY9dhl9vGbQw2BQgMSCBLIKHUmffx5nvsHylkoQtJjzIlJd9POBTizXzf91Eq9fXvOd43JcuyQEREcyUvdAOIiJY2xigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREMYoEZEQxigRkRDGKBGREHWhG1DkJEla6CbQomNZ1kI3geYTYzTv+DdDY/H/rMUn3536E4ckqeVoe57PQkS0YAowNrpt7aU/ZZQSUbEqxBTTg3910voH/KkkSYdOzHwvaWr5ayoR0WwVaqa+/shJy7KefUOSpBn28q0p5L+tRESzUNgFT7uPWZZljZSms6xOiYgWpQWZqa8/ctI6shAnJiKad9KS6yZL0lJq89JqLRUA3xLFh1cxEREJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJYYwSEQlhjBIRCWGMEhEJKUCMnjgkSS1H2wGg/WiLdNuhE/k/NRFR3uU7RtuPtuxpfant5JF6tB9tabj0I2tE24N/yyQloiKQ7xhtu/Txtr1P1QNof+v1jw8+u/v2A/VP7d12/I1pclSaQp4bTEQ0O/mO0YYHt418V9+4dlZ7WlOY/zYSEQmQ8h5MJw5JI936kV79sd0A2o+2NLy+t+3kkfrZHk+S8t/m+bO0WksFwLdE8SnMb/TEIWnP8Tu2bHtpLhEKLLV34dJqLRUA3xLFZ+n9RpfWu3BptZYKgG+J4sN1o0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERC8h2jJw5JLUfbx/zrtjFbiYiWsAJWoycOSW88a932D/hTJikRFYGCxWj70b89fvDZ3aP/rn9qL1746Ympd5CmUIC2EhHNnLrQDZiSZVmTbmeSEtGiUoBq9OMXGg6dQP1Te7cdf+Or6rP9rdc/HludEhEtTdJURd+8OnFI2nMcALa91HbySD1OHJL2tOa+nTVJKkyb58fSai0VAN8SxWfp/UaX1rtwabWWCoBvieLDdaNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIYo0REQhijRERCGKNEREIWIEbbj7ZILUfbC39iIqI8UPN8/BOHpD3HJ9n+cYP0AnDwbevY7jy3gO5lB3/3s4VuwiQkSVroJkzCsqyFbsJSJeX9tWs/2tLwAl5qO3mk/qsNr+/96t9TtWzqt9oS+n1LUv5fYZrawd/97Pg3/3KhW7EE8I0qIv+d+vojJy3rH/CnknToxGz2s6aQr3YSEc1JgcZG64+ctKxn35Bmm6VERItdIaeYdh+zLOvZNxpe+LiAJyUiyq98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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># here we used sort_by_labels_order = FALSE since the clusters were already sorted based on the dendrogram's order</span></code></pre></div>
</div>
<div id="pvclust" class="section level3">
<h3>pvclust</h3>
<p>The pvclust library calculates “p-values”&quot; for hierarchical clustering via multiscale bootstrap re-sampling. Hierarchical clustering is done for given data and p-values are computed for each of the clusters. The dendextend package let’s us reproduce the plot from pvclust, but with a dendrogram (instead of an hclust object), which also lets us extend the visualization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))

<span class="kw">library</span>(pvclust)
<span class="kw">data</span>(lung) <span class="co"># 916 genes for 73 subjects</span>
<span class="kw">set.seed</span>(<span class="dv">13134</span>)
result &lt;-<span class="st"> </span><span class="kw">pvclust</span>(lung[<span class="dv">1</span>:<span class="dv">100</span>, <span class="dv">1</span>:<span class="dv">10</span>], 
                  <span class="dt">method.dist=</span><span class="st">&quot;cor&quot;</span>, <span class="dt">method.hclust=</span><span class="st">&quot;average&quot;</span>, <span class="dt">nboot=</span><span class="dv">10</span>)

<span class="co"># with pvrect</span>
<span class="kw">plot</span>(result)
<span class="kw">pvrect</span>(result)

<span class="co"># with a dendrogram of pvrect</span>
dend &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(result)
result %&gt;%<span class="st"> </span>as.dendrogram %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Cluster dendrogram with AU/BP values (%)</span><span class="ch">\n</span><span class="st"> reproduced plot with dendrogram&quot;</span>)
result %&gt;%<span class="st"> </span>text
result %&gt;%<span class="st"> </span>pvrect</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let’s color and thicken the branches based on the p-values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))

<span class="co"># with a modified dendrogram of pvrect</span>
dend %&gt;%<span class="st"> </span><span class="kw">pvclust_show_signif</span>(result) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Cluster dendrogram </span><span class="ch">\n</span><span class="st"> bp values are highlighted by signif&quot;</span>)

dend %&gt;%<span class="st"> </span><span class="kw">pvclust_show_signif</span>(result, <span class="dt">show_type =</span> <span class="st">&quot;lwd&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Cluster dendrogram with AU/BP values (%)</span><span class="ch">\n</span><span class="st"> bp values are highlighted by signif&quot;</span>)
result %&gt;%<span class="st"> </span>text
result %&gt;%<span class="st"> </span><span class="kw">pvrect</span>(<span class="dt">alpha=</span><span class="fl">0.95</span>)


dend %&gt;%<span class="st"> </span><span class="kw">pvclust_show_signif_gradient</span>(result) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Cluster dendrogram with AU/BP values (%)</span><span class="ch">\n</span><span class="st"> bp values are colored by signif&quot;</span>)

dend %&gt;%
<span class="st">   </span><span class="kw">pvclust_show_signif_gradient</span>(result) %&gt;%
<span class="st">   </span><span class="kw">pvclust_show_signif</span>(result) %&gt;%
<span class="st">   </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Cluster dendrogram with AU/BP values (%)</span><span class="ch">\n</span><span class="st"> bp values are colored+highlighted by signif&quot;</span>)
result %&gt;%<span class="st"> </span>text
result %&gt;%<span class="st"> </span><span class="kw">pvrect</span>(<span class="dt">alpha=</span><span class="fl">0.95</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="circlize" class="section level3">
<h3>circlize</h3>
<p>Circular layout is an efficient way for the visualization of huge amounts of information. The circlize package provides an implementation of circular layout generation in R, including a solution for dendrogram objects produced using dendextend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(circlize)

dend &lt;-<span class="st"> </span>iris[<span class="dv">1</span>:<span class="dv">40</span>,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_k_color&quot;</span>, <span class="dt">k=</span><span class="dv">3</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;branches_lwd&quot;</span>, <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">2</span>,<span class="fl">1.5</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;branches_lty&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;labels_colors&quot;</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_cex&quot;</span>, <span class="kw">c</span>(.<span class="dv">6</span>,<span class="fl">1.5</span>)) %&gt;%
<span class="st">   </span><span class="kw">set</span>(<span class="st">&quot;nodes_pch&quot;</span>, <span class="dv">19</span>) %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;nodes_col&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;plum&quot;</span>, <span class="ot">NA</span>))

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))
<span class="kw">circlize_dendrogram</span>(dend)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># circlize_dendrogram(dend, labels = FALSE)</span>
<span class="co"># circlize_dendrogram(dend, facing = &quot;inside&quot;, labels = FALSE)</span></code></pre></div>
<p>The above is a wrapper for functions in circlize. An advantage for using the circlize package directly is for plotting a circular dendrogram so that you can add more graphics for the elements in the tree just by adding more tracks using . For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dend &lt;- iris[1:40,-5] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram %&gt;%</span>
<span class="co">#    set(&quot;branches_k_color&quot;, k=3) %&gt;% set(&quot;branches_lwd&quot;, c(5,2,1.5)) %&gt;%</span>
<span class="co">#    set(&quot;branches_lty&quot;, c(1,1,3,1,1,2)) %&gt;%</span>
<span class="co">#    set(&quot;labels_colors&quot;) %&gt;% set(&quot;labels_cex&quot;, c(.9,1.2)) %&gt;%</span>
<span class="co">#    set(&quot;nodes_pch&quot;, 19) %&gt;% set(&quot;nodes_col&quot;, c(&quot;orange&quot;, &quot;black&quot;, &quot;plum&quot;, NA))</span>

<span class="kw">set.seed</span>(<span class="dv">2015-07-10</span>)   
<span class="co"># In the following we get the dendrogram but can also get extra information on top of it</span>
<span class="kw">circos.initialize</span>(<span class="st">&quot;foo&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">40</span>))
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> function(x, y) {
   <span class="kw">circos.rect</span>(<span class="dv">1</span>:<span class="dv">40</span><span class="fl">-0.8</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="dv">1</span>:<span class="dv">40</span><span class="fl">-0.2</span>, <span class="kw">runif</span>(<span class="dv">40</span>), <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">40</span>), <span class="dt">border =</span> <span class="ot">NA</span>)
}, <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> function(x, y) {
   <span class="kw">circos.text</span>(<span class="dv">1</span>:<span class="dv">40</span><span class="fl">-0.5</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="kw">labels</span>(dend), <span class="dt">col =</span> <span class="kw">labels_colors</span>(dend),
               <span class="dt">facing =</span> <span class="st">&quot;clockwise&quot;</span>, <span class="dt">niceFacing =</span> <span class="ot">TRUE</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))
}, <span class="dt">bg.border =</span> <span class="ot">NA</span>, <span class="dt">track.height =</span> <span class="fl">0.1</span>)
max_height =<span class="st"> </span><span class="kw">attr</span>(dend, <span class="st">&quot;height&quot;</span>)
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, max_height), <span class="dt">panel.fun =</span> function(x, y) {
   <span class="kw">circos.dendrogram</span>(dend, <span class="dt">max_height =</span> max_height)
}, <span class="dt">track.height =</span> <span class="fl">0.5</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.clear</span>()</code></pre></div>
</div>
</div>
<div id="comparing-two-dendrograms" class="section level2">
<h2>Comparing two dendrograms</h2>
<div id="dendlist" class="section level3">
<h3>dendlist</h3>
<p>A <code>dendlist</code> is a function which produces the dendlist class. It accepts several dendrograms and/or dendlist objects and chain them all together. This function aim to help with the usability of comparing two or more dendrograms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend15 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>) %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">method =</span> <span class="st">&quot;average&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram
dend15 &lt;-<span class="st"> </span>dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels_to_char&quot;</span>)
dend51 &lt;-<span class="st"> </span>dend15 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels&quot;</span>, <span class="kw">as.character</span>(<span class="dv">5</span>:<span class="dv">1</span>)) %&gt;%<span class="st"> </span><span class="kw">match_order_by_labels</span>(dend15)
dends_15_51 &lt;-<span class="st"> </span><span class="kw">dendlist</span>(dend15, dend51)
dends_15_51</code></pre></div>
<pre><code>#&gt; [[1]]
#&gt; 'dendrogram' with 2 branches and 5 members total, at height 2.5 
#&gt; 
#&gt; [[2]]
#&gt; 'dendrogram' with 2 branches and 5 members total, at height 2.5 
#&gt; 
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;dendlist&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dends_15_51)</code></pre></div>
<pre><code>#&gt; ============
#&gt;  dend  1 
#&gt;  ---------
#&gt; --[dendrogram w/ 2 branches and 5 members at h = 2.5]
#&gt;   |--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;   |  |--leaf &quot;1&quot; 
#&gt;   |  `--leaf &quot;2&quot; 
#&gt;   `--[dendrogram w/ 2 branches and 3 members at h = 1.5]
#&gt;      |--leaf &quot;5&quot; 
#&gt;      `--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;         |--leaf &quot;3&quot; 
#&gt;         `--leaf &quot;4&quot; 
#&gt; etc... 
#&gt; ============
#&gt;  dend  2 
#&gt;  ---------
#&gt; --[dendrogram w/ 2 branches and 5 members at h = 2.5]
#&gt;   |--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;   |  |--leaf &quot;5&quot; 
#&gt;   |  `--leaf &quot;4&quot; 
#&gt;   `--[dendrogram w/ 2 branches and 3 members at h = 1.5]
#&gt;      |--leaf &quot;3&quot; 
#&gt;      `--[dendrogram w/ 2 branches and 2 members at h = 1]
#&gt;         |--leaf &quot;2&quot; 
#&gt;         `--leaf &quot;1&quot; 
#&gt; etc...</code></pre>
<p>The function <code>match_order_by_labels</code> makes sure that the order in the leaves corresponds to the same labels in both trees.</p>
</div>
<div id="dend_diff" class="section level3">
<h3>dend_diff</h3>
<p>The <code>dend_diff</code> function plots two trees side by side, highlighting edges unique to each tree in red, it relies on the <code>distinct_edges</code> function.</p>
<p>For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># example 1</span>
x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
y &lt;-<span class="st"> </span><span class="kw">set</span>(x, <span class="st">&quot;labels&quot;</span>, <span class="dv">5</span>:<span class="dv">1</span>)

<span class="co"># example 2</span>
dend1 &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
dend2 &lt;-<span class="st"> </span>dend1 %&gt;%<span class="st"> </span><span class="kw">set</span>(<span class="st">&quot;labels&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">5</span>:<span class="dv">10</span>) )
<span class="kw">dend_diff</span>(dend1, dend2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>See the <code>highlight_distinct_edges</code> function for more control over how to create the distinction (color, line width, line type).</p>
</div>
<div id="tanglegram" class="section level3">
<h3>tanglegram</h3>
<p>A tanglegram plot gives two dendrogram (with the same set of labels), one facing the other, and having their labels connected by lines. Tanglegram can be used for visually comparing two methods of Hierarchical clustering, and are sometimes used in biology when comparing two phylogenetic trees.</p>
<p>Here is an example of creating a tanglegram using dendextend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tanglegram</span>(dends_15_51)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Same as using:</span>
<span class="co"># plot(dends_15_51) # since there is a plot method for dendlist</span>
<span class="co"># and also: </span>
<span class="co"># tanglegram(dend15, dend51)</span></code></pre></div>
<p>Notice how “unique” nodes are highlighted with dashed lines (i.e.: nodes which contains a combination of labels/items, which are not present in the other tree). This can be turned off using <code>highlight_distinct_edges = FALSE</code>. Also notice how the connecting lines are colored to highlight two sub-trees which are present in both dendrograms. This can be turned off by setting <code>common_subtrees_color_lines = FALSE</code>. We can also color the branches of the trees to show the two common sub-trees using <code>common_subtrees_color_branches = TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tanglegram</span>(dends_15_51, <span class="dt">common_subtrees_color_branches =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We may wish to improve the layout of the trees. For this we have the <code>entanglement</code>, to measure the quality of the alignment of the two trees in the tanglegram layout, and the <code>untangle</code> function, for improving it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dends_15_51 %&gt;%<span class="st"> </span>entanglement <span class="co"># lower is better</span></code></pre></div>
<pre><code>#&gt; [1] 0.9167078</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dends_15_51 %&gt;% untangle(method = &quot;DendSer&quot;) %&gt;% entanglement # lower is better</span>
dends_15_51 %&gt;%<span class="st"> </span><span class="kw">untangle</span>(<span class="dt">method =</span> <span class="st">&quot;step1side&quot;</span>) %&gt;%<span class="st"> </span>entanglement <span class="co"># lower is better</span></code></pre></div>
<pre><code>#&gt; [1] 0</code></pre>
<p>Notice that just because we can get two trees to have horizontal connecting lines, it doesn’t mean these trees are identical (or even very similar topologically):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dends_15_51 %&gt;%<span class="st"> </span><span class="kw">untangle</span>(<span class="dt">method =</span> <span class="st">&quot;step1side&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">   </span><span class="kw">tanglegram</span>(<span class="dt">common_subtrees_color_branches =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Entanglement is measured by giving the left tree’s labels the values of 1 till tree size, and than match these numbers with the right tree. Now, entanglement is the L norm distance between these two vectors. That is, we take the sum of the absolute difference (each one in the power of L). e.g: <code>sum(abs(x-y)**L)</code>. And this is divided by the “worst case” entanglement level (e.g: when the right tree is the complete reverse of the left tree).</p>
<p>L tells us which penalty level we are at (L0, L1, L2, partial L’s etc). L&gt;1 means that we give a big penalty for sharp angles. While L-&gt;0 means that any time something is not a straight horizontal line, it gets a large penalty If L=0.1 it means that we much prefer straight lines over non straight lines</p>
<p>Finding an optimal rotation for the tanglegram of two dendrogram is a hard problem. This problem is also harder for larger trees.</p>
<p>Let’s see how well some untangle methods can do.</p>
<p>Without doing anything:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>dends_15_51 
x %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;entanglement =&quot;</span>, <span class="kw">round</span>(<span class="kw">entanglement</span>(x), <span class="dv">2</span>)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Using DendSer:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x &lt;- dends_15_51 %&gt;% untangle(method = &quot;DendSer&quot;) </span>
x &lt;-<span class="st"> </span>dends_15_51 %&gt;%<span class="st"> </span><span class="kw">untangle</span>(<span class="dt">method =</span> <span class="st">&quot;ladderize&quot;</span>) 
x %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;entanglement =&quot;</span>, <span class="kw">round</span>(<span class="kw">entanglement</span>(x), <span class="dv">2</span>)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>One solution for improving the tanglegram would be to randomly search the rotated tree space for a better solution. Here is how to use a random search:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">3958</span>)
x &lt;-<span class="st"> </span>dends_15_51 %&gt;%<span class="st"> </span><span class="kw">untangle</span>(<span class="dt">method =</span> <span class="st">&quot;random&quot;</span>, <span class="dt">R =</span> <span class="dv">10</span>) 
x %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;entanglement =&quot;</span>, <span class="kw">round</span>(<span class="kw">entanglement</span>(x), <span class="dv">2</span>)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see we already got something better. An advantage of the random search is the ability to create many many trees and compare them to find the best pair.</p>
<p>Let’s use a greedy forward step wise rotation of the two trees (first the left, then the right, and so on), to see if we can find a better solution for comparing the two trees. Notice that this may take some time to run (the larger the tree, the longer it would take), but we can limit the search for smaller k’s, and see what improvement that can bring us using step2side (slowest):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>dends_15_51 %&gt;%<span class="st"> </span><span class="kw">untangle</span>(<span class="dt">method =</span> <span class="st">&quot;step2side&quot;</span>) 
x %&gt;%<span class="st"> </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;entanglement =&quot;</span>, <span class="kw">round</span>(<span class="kw">entanglement</span>(x), <span class="dv">2</span>)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We got perfect entanglement (0).</p>
</div>
<div id="correlation-measures" class="section level3">
<h3>Correlation measures</h3>
<p>We shall use the following for the upcoming examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">23235</span>)
ss &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">150</span>, <span class="dv">10</span> )
dend1 &lt;-<span class="st"> </span>iris[ss,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="st">&quot;com&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram
dend2 &lt;-<span class="st"> </span>iris[ss,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="st">&quot;single&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram
dend3 &lt;-<span class="st"> </span>iris[ss,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="st">&quot;ave&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram
dend4 &lt;-<span class="st"> </span>iris[ss,-<span class="dv">5</span>] %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span><span class="kw">hclust</span>(<span class="st">&quot;centroid&quot;</span>) %&gt;%<span class="st"> </span>as.dendrogram

dend1234 &lt;-<span class="st"> </span><span class="kw">dendlist</span>(<span class="st">&quot;Complete&quot;</span> =<span class="st"> </span>dend1, <span class="st">&quot;Single&quot;</span> =<span class="st"> </span>dend2, <span class="st">&quot;Average&quot;</span> =<span class="st"> </span>dend3, <span class="st">&quot;Centroid&quot;</span> =<span class="st"> </span>dend4)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(dend1, <span class="dt">main =</span> <span class="st">&quot;Complete&quot;</span>)
<span class="kw">plot</span>(dend2, <span class="dt">main =</span> <span class="st">&quot;Single&quot;</span>)
<span class="kw">plot</span>(dend3, <span class="dt">main =</span> <span class="st">&quot;Average&quot;</span>)
<span class="kw">plot</span>(dend4, <span class="dt">main =</span> <span class="st">&quot;Centroid&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="global-comparison-of-two-or-more-dendrograms" class="section level4">
<h4>Global Comparison of two (or more) dendrograms</h4>
<p>The <code>all.equal.dendrogram</code> function makes a global comparison of two or more dendrograms trees.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1, dend1)</code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1, dend2)</code></pre></div>
<pre><code>#&gt; [1] &quot;Difference in branch heights -  Mean relative difference: 0.5336715&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1, dend2, <span class="dt">use.edge.length =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>#&gt; [1] &quot;Dendrograms contain diffreent edges (i.e.: topology). Unique edges in target: | 9 | Unique edges in current: 5&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1, dend2, <span class="dt">use.edge.length =</span> <span class="ot">FALSE</span>, <span class="dt">use.topology =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend2, dend4, <span class="dt">use.edge.length =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>#&gt; [1] &quot;Difference in branch heights -  Mean relative difference: 0.2002173&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend2, dend4, <span class="dt">use.edge.length =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="kw">dendlist</span>(dend1, dend1, dend1))</code></pre></div>
<pre><code>#&gt; [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1234)</code></pre></div>
<pre><code>#&gt;                                                                  1==2 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.5336715&quot; 
#&gt;                                                                  1==3 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.2860993&quot; 
#&gt;                                                                  1==4 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.4314977&quot; 
#&gt;                                                                  2==3 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.5308966&quot; 
#&gt;                                                                  2==4 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.2002173&quot; 
#&gt;                                                                  3==4 
#&gt; &quot;Difference in branch heights -  Mean relative difference: 0.2191675&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(dend1234, <span class="dt">use.edge.length =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>#&gt;                                                                                                             1==2 
#&gt; &quot;Dendrograms contain diffreent edges (i.e.: topology). Unique edges in target: | 9 | Unique edges in current: 5&quot; 
#&gt;                                                                                                             1==3 
#&gt; &quot;Dendrograms contain diffreent edges (i.e.: topology). Unique edges in target: | 9 | Unique edges in current: 5&quot; 
#&gt;                                                                                                             1==4 
#&gt; &quot;Dendrograms contain diffreent edges (i.e.: topology). Unique edges in target: | 9 | Unique edges in current: 5&quot; 
#&gt;                                                                                                             2==3 
#&gt;                                                                                                           &quot;TRUE&quot; 
#&gt;                                                                                                             2==4 
#&gt;                                                                                                           &quot;TRUE&quot; 
#&gt;                                                                                                             3==4 
#&gt;                                                                                                           &quot;TRUE&quot;</code></pre>
</div>
<div id="distance-matrix-using-dist.dendlist" class="section level4">
<h4>Distance matrix using dist.dendlist</h4>
<p>The <code>dist.dendlist</code> function computes the Robinson-Foulds distance (also known as symmetric difference) between two dendrograms. This is the sum of edges in both trees with labels that exist in only one of the two trees (i.e.: the length of <code>distinct_edges</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span> %&gt;%<span class="st"> </span>dist %&gt;%<span class="st"> </span>hclust %&gt;%<span class="st"> </span>as.dendrogram
y &lt;-<span class="st"> </span><span class="kw">set</span>(x, <span class="st">&quot;labels&quot;</span>, <span class="dv">5</span>:<span class="dv">1</span>)

<span class="kw">dist.dendlist</span>(<span class="kw">dendlist</span>(<span class="dt">x1 =</span> x,<span class="dt">x2 =</span> x,<span class="dt">y1 =</span> y))</code></pre></div>
<pre><code>#&gt;    x1 x2
#&gt; x2  0   
#&gt; y1  4  4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dend_diff</span>(x,y)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dist.dendlist</span>(dend1234)</code></pre></div>
<pre><code>#&gt;          Complete Single Average
#&gt; Single          2               
#&gt; Average         2      0        
#&gt; Centroid        2      0       0</code></pre>
<p>This function might implement other topological distances in the future.</p>
</div>
<div id="correlation-matrix-using-cor.dendlist" class="section level4">
<h4>Correlation matrix using cor.dendlist</h4>
<p>Both Baker’s Gamma and cophenetic correlation (Which will be introduced shortly), can be calculated to create a correlation matrix using the <code>cor.dendlist</code> function (the default method is cophenetic correlation):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.dendlist</span>(dend1234)</code></pre></div>
<pre><code>#&gt;           Complete    Single   Average  Centroid
#&gt; Complete 1.0000000 0.4925215 0.6043644 0.4821956
#&gt; Single   0.4925215 1.0000000 0.9850578 0.9959252
#&gt; Average  0.6043644 0.9850578 1.0000000 0.9871029
#&gt; Centroid 0.4821956 0.9959252 0.9871029 1.0000000</code></pre>
<p>The corrplot library offers a nice visualization:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(corrplot)
<span class="kw">corrplot</span>(<span class="kw">cor.dendlist</span>(dend1234), <span class="st">&quot;pie&quot;</span>, <span class="st">&quot;lower&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Which easily tells us that single, average and centroid give similar results, while complete is somewhat different.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># same subtrees, so there is no need to color the branches</span>
dend1234 %&gt;%<span class="st"> </span><span class="kw">tanglegram</span>(<span class="dt">which =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)) </code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAADhCAMAAAAEVgUmAAAAhFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6OgA6Ojo6ZrY6kLY6kNtmAABmAGZmOpBmZjpmZmZmZrZmtttmtv+QOgCQOjqQOmaQZjqQZmaQZpCQ2/+2ZgC2Zjq2Zma2tma225C2///MR2vbkDrb29vb/7bb/9vb////tmb/25D//7b//9v///9WdG8NAAAACXBIWXMAAAuIAAALiAHljilJAAAI3UlEQVR4nO2dgXqbNhSFaRdn7dx1S511a5JunrfFsfX+7zeuBE6MJCyB0AH5/N/mJgQjnd8E8I2QK0UQVOgOXCn0joHeMdA7BnrHQO8Y6B0DvWMI9b6rqur9Vqm9frTxLV82L7dTxQr0Ltq1+OvyLrE3k2w5zPvhU7U2Dz6K9H68rz5Uq0k2HeFdPVY3z+K3/u7LvTns1MuqlSwz3mX/WE/STwgvt+//un33ICnXSh5Xp4j1S/LTfVX/rBZQa1GvJsIshHk/tppV411TN/dYNQcg3aL57lKTy2FXrerka0ldZz18ajRLRDEiuR8tE2EWAo/v9QnGHOoa77qh99t68Uq6YLzXu8dW6YcyqINtavet8pfbm+dTxKPe2esv68fdmYkwC8HXkfpVXLXem1dgrxtvjzPm5DvVmSg/WurL6UCz0/83EWvFq3at6sxEmIWI6/da97uHrvf22rJE722etci9+e9e79qv3uvFzeHmzERK72ar8tL37+/6BFMKjVN99D7e12fY+t9TxMb7vtKHovP9PcRCmHd99Kq33/Wul9fftsf3enk5F5Q6juQUo7vqV/nuFLHxvjNfyoG/NRFmIep9k3V8N0f9D2Vez+yMO3MN3b5zfXM9Uy+V/f3tVcyH1NczpoG16nrvXL8/FqS9PXPq3bm5eFeniI132SFv/tU+Xq/fQyykqIvtijm0jCXcxDjv7Tuo9aitlECsiZH7u3k/FdpYyUSaYP0dA71joHcM9I6B3jHQOwZ6x0DvGK7Vu/xBSCoqqPZR3r25/56GbjNPDy8fldrB/kQzvffKRvXkzun9cNfp4eQyTmTw7lz6NvcZmbzvqx8+Wi/7FXh35s7Kfq2+d4q2V+DdmTsj+g903zp/CL0C787caK7A+yyhdwzL8+64WARcnI1lad77rC/Ke76eJ/I+dQt5qHq/nbKpgRuh95FNDdwIvY9sauBG6H1kUwM3Qu8jmxq4keV5l1G7Vh36Crw7cwuZ6pFPD/LYKcyV5d1Tf5efwervx99+fPdwqf6+bO9OznKfkcv7Q934hTr0DL2PfWcXlHtKnqT9C3Xo2XlPUAwIyT0lcq/WpTr0lCUPlPeQ3GAmrTUN2dKkHZoRc/Q+fivzp5uK3vNA7xjoHQO9Y6B3DPSOgd4x0Ht6pA59aVKkEr17c+epR6r9ph0L3pPTzh2dM3TbIU9xeI9D9eTO5F3m0mnb7+vn5ZTxAvW24p+RpFLxNvcZmbwrdbjTY8EjCHx5wrYV/4wk3ofkTomuQ8tY8Aig3sf9ep0YkjslUoeOnTdnDt6HtPWWIbnhOFJn9j6kqeVD7xjoHQO9Y6B3DPSOgd4x0DsGesdA76PRNejj17j3ywV49+bOVI/UtdB9ZJ0C730cqid3Ru/Hb39s4yK5dcQq1M+LfkKa/f1t7jMyeZca9H4zfkDy0rynyj2iB+tdgvnFluY9Ve6hmBr09e3vqXKjWZr3UqB3DPSOgd4x0DsGesdA7xjoHQO9Y6D3CA538vliF8e/hzDOe3gltErl3Zc9Qz3y5XaldpvD598vjH8PIdpc464a9uRxPejLnsG7MlNSfP+ld/z7ZN6rxN7DOurJjvD+Z9848MK992afCj31zeHzc9848IK9X8w+Fc25pXcc+Cy9j+hoTHYkoXFGeo/oUBrvcyfCe9Rm6b2fhXj3vRqLJTQPvaclNBDWu/dsu1gqtRTvMc3PH3rHQO8Y6B0Dvaenfq8s94vLXCzedUr17sueoR4pNeinh/3KzIXui7kY7+GonuwZvJv5z/df9Fzo3s4vxntM81b2E7m8H+7MXOh9QUNyLNH75ezTILXQn7fNXCxe5u/9dPSIICz7NNRNymeLyPmlZ623h8XetWKanoP3gOxIqiDxQO8hu8USaRLN2ntp5XeB3jHQOwZ6x0DvGOgdA71joHcM9J4YKU0cv2576++qUO++7BnqkVKDljlY9hc+lnF+3m2iKvCqJ3sG7/KayxwsMhe6P9FJyry9x9LJfiKTdzMHS1AtNGQ3Cma4d3c/YtrWxGVPi4wBr6pVYA26OO8R2dOim/y+Da1BJ9Q+xrtra/FPicyOJOWlGtz7gqB3DEnTnXsfu7HR3ZkzadPReyj0joHeMdA7BnrHQO8Y6D0RzRjwfbcm56Eo777sGeqR7Rjwf9SlCvzgdH1bS+k9DtWTPYP3Zgz4pp1/PqS/6UjpfQCd7Cdyedftj59vKZ4ZeEdlR44Bn4H3mY9/nwi895mPf58IsPerhd4x0DsGesdA7xjoHQO9Y6B3DPSO4bq9mzlYEHO1Yr17c+eoRyrVzMFSUD0ysP7uzZ3Ju9Sgn/zzv6fz4RCkH1+/TLTZ0BVfc5+Ry7uMA/fOgV6w997c0yM1aOWdA71c7/25p0dq0P450Mv13p8bTbne5w29Y8jmPSETdjkbSYU4DaX3XoL4tEJcgri/u5g+RPIW6B3TAr1jWqB3TAv0jmlhId77x7+X692bO1M9sn/8+xK9h11qenNn8n5h/HtqKxa4w4Jj7LuQyzts/LsB5h2cGzf+3YDyjs6NHgOO8o7OjWYhl33FQe8Y6B0DvWOgdwz0joHeMdA7BnrHQO8Y6B0DvWOgdwz0joHeMdA7BnrHQO8Y3N6TDhAGjJKIY+K0zsQe754O+joet3x23iOXp3gCvdM7CnrHMB/vZGroHQO9Y6B3DPSOgd4x0DsGy7sZHH341P3Ib3OfgP1J4Hq5Y3W9xFrfLLZXB+LtjG9wvm/4uP82teNX674Wy7vceKTUbnP4/Hze2Eopx/1IZrm1erPEWt8stlcH4uuMSebAGLLx36bmuJ/IcZyRZ3/fyn9v0a++9WnYp8+v7a5ulljrm8X26kC8nfHfjOLx67pdS5DPEe8us717RDa9sDrT691avwjv3h94btcynyN+juXdTPxl//Lpxhx3JJnfA89xxlp/QccZr15jyMZ7u5Z8jnh3meVdbjzab5zn1f3GcUrRy93nVcf6ZvGyz6uPDo1Cz+1aAfs7yQK9Y6B3DPSOgd4x0DuG/wE6v8+zGFUcsAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here the branches colors are very helpful:</span>
dend1234 %&gt;%<span class="st"> </span><span class="kw">tanglegram</span>(<span class="dt">which =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), 
                        <span class="dt">common_subtrees_color_branches =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bakers-gamma-index" class="section level4">
<h4>Baker’s Gamma Index</h4>
<p>Baker’s Gamma Index (see baker’s paper from 1974) is a measure of association (similarity) between two trees of Hierarchical clustering (dendrograms). It is defined as the rank correlation between the stages at which pairs of objects combine in each of the two trees.</p>
<p>Or more detailed: It is calculated by taking two items, and see what is the highest possible level of k (number of cluster groups created when cutting the tree) for which the two item still belongs to the same tree. That k is returned, and the same is done for these two items for the second tree. There are n over 2 combinations of such pairs of items from the items in the tree, and all of these numbers are calculated for each of the two trees. Then, these two sets of numbers (a set for the items in each tree) are paired according to the pairs of items compared, and a Spearman correlation is calculated.</p>
<p>The value can range between -1 to 1. With near 0 values meaning that the two trees are not statistically similar. For exact p-value one should use a permutation test. One such option will be to permute over the labels of one tree many times, calculating the distribution under the null hypothesis (keeping the trees topologies constant).</p>
<p>Notice that this measure is not affected by the height of a branch but only of its relative position compared with other branches.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor_bakers_gamma</span>(dend15, dend51)</code></pre></div>
<pre><code>#&gt; [1] 0.2751938</code></pre>
<p>Even that we can reach perfect entanglement, Baker’s gamma shows us that the tree’s topology is not identical. As opposed with the correlation of a tree with itself:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor_bakers_gamma</span>(dend15, dend15)</code></pre></div>
<pre><code>#&gt; [1] 1</code></pre>
<p>Since the observations creating the Baker’s Gamma Index of such a measure are correlated, we need to perform a permutation test for the calculation of the statistical significance of the index. Let’s look at the distribution of Baker’s Gamma Index under the null hypothesis (assuming fixed tree topologies). This will be different for different tree structures and sizes. Here are the results when the compared tree is itself (after shuffling its own labels), and when comparing tree 1 to the shuffled tree 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">23235</span>)
the_cor &lt;-<span class="st"> </span><span class="kw">cor_bakers_gamma</span>(dend15, dend15)
the_cor2 &lt;-<span class="st"> </span><span class="kw">cor_bakers_gamma</span>(dend15, dend51)
the_cor</code></pre></div>
<pre><code>#&gt; [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">the_cor2</code></pre></div>
<pre><code>#&gt; [1] 0.2751938</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R &lt;-<span class="st"> </span><span class="dv">100</span>
cor_bakers_gamma_results &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)
dend_mixed &lt;-<span class="st"> </span>dend15
for(i in <span class="dv">1</span>:R) {
   dend_mixed &lt;-<span class="st"> </span><span class="kw">sample.dendrogram</span>(dend_mixed, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
   cor_bakers_gamma_results[i] &lt;-<span class="st"> </span><span class="kw">cor_bakers_gamma</span>(dend15, dend_mixed)
}
<span class="kw">plot</span>(<span class="kw">density</span>(cor_bakers_gamma_results),
     <span class="dt">main =</span> <span class="st">&quot;Baker's gamma distribution under H0&quot;</span>,
     <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> the_cor, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> the_cor2, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;cor&quot;</span>, <span class="st">&quot;cor2&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))
<span class="kw">round</span>(<span class="kw">sum</span>(the_cor2 &lt;<span class="st"> </span>cor_bakers_gamma_results)/<span class="st"> </span>R, <span class="dv">4</span>)</code></pre></div>
<pre><code>#&gt; [1] 0.13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">title</span>(<span class="dt">sub =</span> <span class="kw">paste</span>(<span class="st">&quot;One sided p-value:&quot;</span>,
                  <span class="st">&quot;cor =&quot;</span>,  <span class="kw">round</span>(<span class="kw">sum</span>(the_cor &lt;<span class="st"> </span>cor_bakers_gamma_results)/<span class="st"> </span>R, <span class="dv">4</span>),
                  <span class="st">&quot; ; cor2 =&quot;</span>,  <span class="kw">round</span>(<span class="kw">sum</span>(the_cor2 &lt;<span class="st"> </span>cor_bakers_gamma_results)/<span class="st"> </span>R, <span class="dv">4</span>)
                  ))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see that we do not have enough evidence that dend15 and dend51 are significantly “similar” (i.e.: with a correlation larger than 0).</p>
<p>We can also build a bootstrap confidence interval, using <code>sample.dendrogram</code>, for the correlation. This function can be very slow for larger trees, so make sure you use if carefully:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dend1 &lt;-<span class="st"> </span>dend15
dend2 &lt;-<span class="st"> </span>dend51

<span class="kw">set.seed</span>(<span class="dv">23801</span>)

R &lt;-<span class="st"> </span><span class="dv">100</span>
dend1_labels &lt;-<span class="st"> </span><span class="kw">labels</span>(dend1)
dend2_labels &lt;-<span class="st"> </span><span class="kw">labels</span>(dend2)
cor_bakers_gamma_results &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)
for(i in <span class="dv">1</span>:R) {
   sampled_labels &lt;-<span class="st"> </span><span class="kw">sample</span>(dend1_labels, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
   <span class="co"># members needs to be fixed since it will be later used in nleaves</span>
   dend_mixed1 &lt;-<span class="st"> </span><span class="kw">sample.dendrogram</span>(dend1, 
                                    <span class="dt">dend_labels=</span>dend1_labels,
                                    <span class="dt">fix_members=</span><span class="ot">TRUE</span>,<span class="dt">fix_order=</span><span class="ot">TRUE</span>,<span class="dt">fix_midpoint=</span><span class="ot">FALSE</span>,
                                    <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">sampled_labels=</span>sampled_labels
                                      )
   dend_mixed2 &lt;-<span class="st"> </span><span class="kw">sample.dendrogram</span>(dend2, <span class="dt">dend_labels=</span>dend2_labels,
                                    <span class="dt">fix_members=</span><span class="ot">TRUE</span>,<span class="dt">fix_order=</span><span class="ot">TRUE</span>,<span class="dt">fix_midpoint=</span><span class="ot">FALSE</span>,
                                    <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">sampled_labels=</span>sampled_labels
                                      )                                    
   cor_bakers_gamma_results[i] &lt;-<span class="st"> </span><span class="kw">cor_bakers_gamma</span>(dend_mixed1, dend_mixed2, <span class="dt">warn =</span> <span class="ot">FALSE</span>)
}


<span class="co"># here is the tanglegram</span>
<span class="kw">tanglegram</span>(dend1, dend2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># And here is the tanglegram for one sample of our trees:</span>
dend_mixed1 &lt;-<span class="st"> </span><span class="kw">rank_order.dendrogram</span>(dend_mixed1)
dend_mixed2 &lt;-<span class="st"> </span><span class="kw">rank_order.dendrogram</span>(dend_mixed2)
dend_mixed1 &lt;-<span class="st"> </span><span class="kw">fix_members_attr.dendrogram</span>(dend_mixed1)
dend_mixed2 &lt;-<span class="st"> </span><span class="kw">fix_members_attr.dendrogram</span>(dend_mixed2)
<span class="kw">tanglegram</span>(dend_mixed1, dend_mixed2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor_bakers_gamma</span>(dend_mixed1, dend_mixed2, <span class="dt">warn =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>#&gt; [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CI95 &lt;-<span class="st"> </span><span class="kw">quantile</span>(cor_bakers_gamma_results, <span class="dt">probs=</span><span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))
CI95</code></pre></div>
<pre><code>#&gt;      2.5%     97.5% 
#&gt; 0.2751938 1.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(<span class="kw">density</span>(cor_bakers_gamma_results),
     <span class="dt">main =</span> <span class="st">&quot;Baker's gamma bootstrap distribution&quot;</span>,
     <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">v =</span> CI95, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">cor_bakers_gamma</span>(dend1, dend2), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;95% CI&quot;</span>, <span class="st">&quot;Baker's Gamma Index&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The bootstrap sampling can do weird things with small trees. In this case we had many times that the two trees got perfect correlation. The usage and interpretation should be done carefully!</p>
</div>
<div id="cophenetic-correlation" class="section level4">
<h4>Cophenetic correlation</h4>
<p>The cophenetic distance between two observations that have been clustered is defined to be the inter-group dissimilarity at which the two observations are first combined into a single cluster. This distance has many ties and restrictions. The cophenetic correlation (see sokal 1962) is the correlation between two cophenetic distance matrices of two trees.</p>
<p>The value can range between -1 to 1. With near 0 values meaning that the two trees are not statistically similar. For exact p-value one should result to a permutation test. One such option will be to permute over the labels of one tree many times, and calculating the distribution under the null hypothesis (keeping the trees topologies constant).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor_cophenetic</span>(dend15, dend51)</code></pre></div>
<pre><code>#&gt; [1] 0.3125</code></pre>
<p>The function <code>cor_cophenetic</code> is faster than <code>cor_bakers_gamma</code>, and might be preferred for that reason.</p>
</div>
</div>
<div id="the-fowlkes-mallows-index-and-the-bk-plot" class="section level3">
<h3>The Fowlkes-Mallows Index and the Bk plot</h3>
<div id="the-fowlkes-mallows-index" class="section level4">
<h4>The Fowlkes-Mallows Index</h4>
<p>The Fowlkes-Mallows Index (see fowlkes 1983) (FM Index, or Bk) is a measure of similarity between two clusterings. The FM index ranges from 0 to 1, a higher value indicates a greater similarity between the two clusters.</p>
<p>The dendextend package allows the calculation of FM-Index, its expectancy and variance under the null hypothesis, and a creation of permutations of the FM-Index under H0. Thanks to the profdpm package, we have another example of calculating the FM (though it does not offer the expectancy and variance under H0):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hc1 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(iris[,-<span class="dv">5</span>]), <span class="st">&quot;com&quot;</span>)
hc2 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(iris[,-<span class="dv">5</span>]), <span class="st">&quot;single&quot;</span>)

<span class="co"># FM index of a cluster with himself is 1:</span>
<span class="kw">FM_index</span>(<span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>), <span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>))</code></pre></div>
<pre><code>#&gt; [1] 1
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.37217
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 5.985372e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># FM index of two clusterings:</span>
<span class="kw">FM_index</span>(<span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>), <span class="kw">cutree</span>(hc2, <span class="dt">k=</span><span class="dv">3</span>)) </code></pre></div>
<pre><code>#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.4462325
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 6.464092e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we got a value far above the expected under H0</span>
         
<span class="co"># Using the R code:</span>
<span class="kw">FM_index_R</span>(<span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>), <span class="kw">cutree</span>(hc2, <span class="dt">k=</span><span class="dv">3</span>))</code></pre></div>
<pre><code>#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.4462325
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 6.464092e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Or wrapping the code from profdpm: (notice the NA's)</span>
<span class="kw">FM_index_profdpm</span>(<span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>), <span class="kw">cutree</span>(hc2, <span class="dt">k=</span><span class="dv">3</span>))</code></pre></div>
<pre><code>#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] NA
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] NA</code></pre>
<p>The E_FM and V_FM are the values expected under the null hypothesis that the two trees have the same topology but one is a random shuffle of the labels of the other (i.e.: “no connection” between the trees).</p>
<p>So for the values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">FM_index</span>(<span class="kw">cutree</span>(hc1, <span class="dt">k=</span><span class="dv">3</span>), <span class="kw">cutree</span>(hc2, <span class="dt">k=</span><span class="dv">3</span>)) </code></pre></div>
<pre><code>#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.4462325
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 6.464092e-05</code></pre>
<p>We can take (under a normal asymptotic distribution)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">0.4462</span> +<span class="st"> </span><span class="fl">1.645</span> *<span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">6.464092e-05</span>)</code></pre></div>
<pre><code>#&gt; [1] 0.4594257</code></pre>
<p>And since 0.8059 (our value) &gt; 0.4594 (the critical value under H0, with alpha=5% for a one sided test) - then we can say that we significantly reject the hypothesis that the two trees are “not-similar”.</p>
</div>
<div id="the-bk-plot" class="section level4">
<h4>The Bk plot</h4>
<p>In the Bk method we calculate the FM Index (Bk) for each k (k=2,3,…,n-1) number of clusters, giving the association between the two trees when each is cut to have k groups. The similarity between two hierarchical clustering dendrograms, can be investigated, using the (k,Bk) plot: For every level of splitting of the two dendrograms which produces k clusters in each tree, the plot shows the number Bk, and therefore enables the investigation of potential nuances in the structure of similarity. The Bk measures the number of pairs of items which are in the same cluster in both dendrograms, one of the clusters in one of the trees and one of the clusters in the other tree, divided by the geometric mean of the number of pairs of items which are in the same cluster in each tree. Namely, <span class="math inline">\({a_{uv}} = 1\left( {or{\rm{ }}{{\rm{b}}_{uv}} = 1} \right)\)</span> if the items u and v are in the same cluster in the first tree (second tree), when it is cut so to give k clusters, and otherwise 0:</p>
<p><span class="math display">\[{FM_k} = {B_k} = \frac{{\sum\limits_{}^{} {{a_{uv}}{b_{uv}}} }}{{\sqrt {\sum\limits_{}^{} {{a_{uv}}} \sum\limits_{}^{} {{b_{uv}}} } }}\]</span></p>
<p>The Bk measure can be plotted for every value of k (except k=n) in order to create the “(k,Bk) plot”. The plot compares the similarity of the two trees for different cuts. The mean and variance of Bk, under the null hypothesis (that the two trees are not “similar”), and under the assumption that the margins of the matching matrix are fixed, are given in Fowlkes and Mallows (see fowlkes 1983). They allow making inference on whether the results obtained are different from what would have been expected under the null hypothesis (of now particular order of the trees’ labels).</p>
<p>The <code>Bk</code> and the <code>Bk_plot</code> functions allow the calculation of the FM-Index for a range of k values on two trees. Here are examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">23235</span>)
ss &lt;-<span class="st"> </span><span class="ot">TRUE</span> <span class="co"># sample(1:150, 30 ) # TRUE #</span>
hc1 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(iris[ss,-<span class="dv">5</span>]), <span class="st">&quot;com&quot;</span>)
hc2 &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(iris[ss,-<span class="dv">5</span>]), <span class="st">&quot;single&quot;</span>)
dend1 &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(hc1)
dend2 &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(hc2)
<span class="co">#    cutree(tree1)   </span>

<span class="co"># It works the same for hclust and dendrograms:</span>
<span class="kw">Bk</span>(hc1, hc2, <span class="dt">k =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>#&gt; $`3`
#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.4462325
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 6.464092e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Bk</span>(dend1, dend2, <span class="dt">k =</span> <span class="dv">3</span>)</code></pre></div>
<pre><code>#&gt; $`3`
#&gt; [1] 0.8059522
#&gt; attr(,&quot;E_FM&quot;)
#&gt; [1] 0.4462325
#&gt; attr(,&quot;V_FM&quot;)
#&gt; [1] 6.464092e-05</code></pre>
<p>The Bk plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Bk_plot</span>(hc1, hc2, <span class="dt">main =</span> <span class="st">&quot;WRONG Bk plot </span><span class="ch">\n</span><span class="st">(due to the way cutree works with ties in hclust)&quot;</span>, <span class="dt">warn =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Bk_plot</span>(dend1, dend2, <span class="dt">main =</span> <span class="st">&quot;CORRECT Bk plot </span><span class="ch">\n</span><span class="st">(based on dendrograms)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="dendextendrcpp---on-the-need-for-speed" class="section level2">
<h2>dendextendRcpp - on the need for speed</h2>
<p><em>Update (2017-03-27): dendextendRcpp is currently unavailable since it requires some code improvements in order to stay up-to-date with current CRAN standards. People who knows Rcpp and are interested in helping are welcome to contact me.</em></p>
<p>Since dendrogram objects are often revised through the use of recursion, R often falls short when it comes to speed. In various function which are intended to run only once (such as <code>labels.color</code>), this does not bother us, and we are content at quickly writing the function with R and letting it handle many extreme cases.</p>
<p>However, some functions are intended to be used many times, and in such cases are well served to be handled with C++. Thanks the the Rcpp package, we can comfortably extend several core functions of the dendextend package. These modifications are included in a separate add-on package called <a href="https://cran.r-project.org/package=dendextendRcpp">“dendextendRcpp”</a> by Tal Galili (with essential contributions by Dirk Eddelbuettel, Romain Francois, and Kevin Ushey). When loading dendextendRcpp, it changes (and speeds up) several R functions from dendextend, these are: <code>get_branches_heights</code>, <code>heights_per_k.dendrogram</code>, <code>cut_lower_fun</code> and <code>labels.dendrogram</code>. Speed gains can range between 3 times to 100 times faster, depending on the size of the tree. These functions are regularly used by other functions in dendextend.</p>
<p>It is highly recommended to install dendextendRcpp for regular use. It is available on CRAN:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;dendextendRcpp&quot;</span>)</code></pre></div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>#&gt; R version 3.4.1 (2017-06-30)
#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)
#&gt; Running under: Windows 7 x64 (build 7601) Service Pack 1
#&gt; 
#&gt; Matrix products: default
#&gt; 
#&gt; locale:
#&gt; [1] LC_COLLATE=C                   LC_CTYPE=Hebrew_Israel.1255   
#&gt; [3] LC_MONETARY=Hebrew_Israel.1255 LC_NUMERIC=C                  
#&gt; [5] LC_TIME=Hebrew_Israel.1255    
#&gt; 
#&gt; attached base packages:
#&gt; [1] parallel  stats     graphics  grDevices utils     datasets  methods  
#&gt; [8] base     
#&gt; 
#&gt; other attached packages:
#&gt;  [1] viridis_0.4.0         viridisLite_0.2.0     RColorBrewer_1.1-2   
#&gt;  [4] pvclust_2.0-0         profdpm_3.3           plyr_1.8.4           
#&gt;  [7] NMF_0.20.6            Biobase_2.26.0        BiocGenerics_0.12.1  
#&gt; [10] rngtools_1.2.4        pkgmaker_0.22         registry_0.3         
#&gt; [13] dynamicTreeCut_1.63-1 DendSer_1.0.1         seriation_1.2-2      
#&gt; [16] gclus_1.3.1           dendextendRcpp_0.6.1  Rcpp_0.12.13         
#&gt; [19] d3heatmap_0.6.1.1     corrplot_0.77         cluster_2.0.6        
#&gt; [22] ggplot2_2.2.1.9000    circlize_0.4.0        MASS_7.3-47          
#&gt; [25] installr_0.20.0       stringr_1.2.0         gplots_3.0.1         
#&gt; [28] colorspace_1.3-2      knitr_1.16            dendextend_1.7.0     
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] jsonlite_1.5         foreach_1.4.3        gtools_3.5.0        
#&gt;  [4] stats4_3.4.1         yaml_2.1.14          robustbase_0.92-7   
#&gt;  [7] backports_1.1.1      lattice_0.20-35      digest_0.6.12       
#&gt; [10] htmltools_0.3.6      xtable_1.8-2         mvtnorm_1.0-6       
#&gt; [13] scales_0.5.0.9000    gdata_2.18.0         whisker_0.3-2       
#&gt; [16] tibble_1.3.4         nnet_7.3-12          lazyeval_0.2.1      
#&gt; [19] magrittr_1.5         mclust_5.3           evaluate_0.10.1     
#&gt; [22] doParallel_1.0.10    class_7.3-14         tools_3.4.1         
#&gt; [25] GlobalOptions_0.0.12 gridBase_0.4-7       trimcluster_0.1-2   
#&gt; [28] kernlab_0.9-25       munsell_0.4.3        fpc_2.1-10          
#&gt; [31] compiler_3.4.1       caTools_1.17.1       rlang_0.1.4         
#&gt; [34] grid_3.4.1           iterators_1.0.8      htmlwidgets_0.9     
#&gt; [37] bitops_1.0-6         base64enc_0.1-3      labeling_0.3        
#&gt; [40] rmarkdown_1.6        gtable_0.2.0         codetools_0.2-15    
#&gt; [43] flexmix_2.3-14       reshape2_1.4.2       TSP_1.1-5           
#&gt; [46] gridExtra_2.2.1      prabclus_2.2-6       rprojroot_1.2       
#&gt; [49] KernSmooth_2.23-15   shape_1.4.2          modeltools_0.2-21   
#&gt; [52] stringi_1.1.5        png_0.1-7            DEoptimR_1.0-8      
#&gt; [55] diptest_0.75-7</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
