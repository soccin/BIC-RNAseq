++++++++++++++++ BIC RNA-Seq Counts Analysis ++++++++++++++++


RunCountsAnalysis.R is a wrapper around all analyses downstream of alignments and counting (htseq), including:

    - normalization (using DESeq scaling method)
    - sample clustering
        - hierarchical clustering plot
        - MDS plot
    - differential expression (DESeq)
        - fold change, p-value, adjusted p-value on gene level
    - gene set analysis ('piano' package)
        - adjusted p-value indicating significance of up/down
          expression of a SET of genes

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Usage summary: /opt/common/R/R-3.0.3/bin/Rscript RunCountsAnalysis.R

    "bin='[Required: directory containing source R code]'"
    "counts.file='[Required: absolute path to htseq counts file]'"

    "key.file='[Required for differential expression analysis: absolute path to key file]'"
    "comps=[Required for differential expression analysis: vector containing all comparisons to be made based on conditions in key file
             Must be in the following format: c('CondA - CondB','CondA - CondC','CondB - CondC')]"
    "species='[Required for gene set analysis: (hg19|human|mm9|mm10|mouse)] Note: only human or mouse currently supported; specific
             build does not matter, as long as it is clearly human or mouse'"

    "diff.exp=[Optional (default=TRUE): run differential expression analysis]"
    "GSA=[Optional (default=TRUE): run gene set analysis; if running GSA but not DESeq, BE SURE TO SET diff.exp.dir (see below) to point
              to existing DESeq results directory.]"
    "counts.dir=[Optional (default='$PWD/htseq')]"
    "clustering.dir=[Optional (default='$PWD/clustering')]"
    "diff.exp.dir=[Optional (default='$PWD/DESeq')]: if running DESeq, this is where output will go; if NOT running DESeq, this is
              wherever DESeq results already exist. Must be correct in order for GSA to run properly."
    "gsa.dir=[Optional (default='$PWD/GSA')]"

    "no.replicates=[Optional (default=F): T|F, automatically sets fitType, method, and sharingMode to accommodate comparison
                     of single samples]"
    "q.cut=[Optional (default=0.05): insert description here]"
    "lfc=[Optional (default=1): insert description here]"
    "fc.cut=[Optional (default=2): Fold change cutoff]"
    "count.cut=[Optional (default=15): minimum count to be included in analysis]"
    "fitType=[Optional (default='parametric'): 'parametric'|'local', insert description here]"
    "orderPvalQ=[Optional (default=T): T|F, insert description here]"
    "method=[Optional (default='per-condition'): 'pooled'|'per-condition'|'blind', insert description here]"
    "sharingMode=[Optional (default='maximum'): 'maximum'|'fit-only'|'gene-est-only', insert description here]"
    "zeroaddQ=[Optional (default=T): T|F, insert description here]"
    "libsizeQ=[Optional (default=F): T|F, insert description here]"


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


Notes and details on usage:

    Analyses
      * normalization and clustering will be run every time the script is run
      * differential expression and gene set analyses can be turned off, but will
        run by default as long as all necessary input has been given

    Minimum input
      * bin - the directory containing all source R code (trunk of rnaseq_pipeline repo)
      * counts file - the RAW htseq counts file generated by the rnaseq 
                      pipeline
                    - this file may contain one or two columns of gene IDs
                       - column 1 must be any unique ID (ensembl, etc.)
                       - optionally, this file may contain one more column
                         containing gene symbols (must have column header
                         "GeneSymbol")
                    - each remaining column must contain raw counts for 
                      one sample

      * key file - contains two columns: SampleID and Group/Condition
                 - THIS FILE SHOULD NOT HAVE ANY HEADERS
                 - sample IDs must be unique and must match exactly
                   as they appear in the raw counts file

    Additional Input
      * comparisons - a vector containing the comparisons to make
                    - e.g., c('GroupA - GroupB','GroupD - GroupC')
                    - the group names here must match exactly those in the key 
                      file
                    - these comparisons apply to both differential expression
                      analysis and gene set analysis (if turned on)
                    - NOTE: unlike the microarray pipeline, comparisons will be 
                      done by dividing the SECOND group by the FIRST; i.e., 
                      if the comparison given at the command line is 'GroupA - GroupB', 
                      this code will give fold changes calculated by log2(GroupB/GroupA);
                      we can and should change this eventually
      * species - if given along with comparisons, gene set analysis WILL be run


    Analysis Dependencies
      * differential expression analysis depends on correctly formatted counts file,
        key file, and comparisons
      * gene set analysis depends on output from differential expression analysis, and
        species
          - by default, the code will look for all ResDESeq_*.xls files in $PWD/DESeq, 
            and run gene set analysis using each of those files; if ResDESeq_*.xls files 
            are in a different location, the user must specify using the "diff.exp.dir" 
            argument
          - currently we only have gene set files for human (hg19) and mouse (mm9/10)


+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
